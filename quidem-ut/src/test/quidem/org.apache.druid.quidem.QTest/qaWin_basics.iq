!set useApproximateCountDistinct false
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
SELECT count(*) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+-----+
| cnt |
+-----+
| 768 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_group_by_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_group_by_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_group_by_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_group_by_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A3_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER 123 AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW 123 AS (PARTITION BY client_ip
                                                 ORDER BY server_ip,
                                                          timezone);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A3_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER 123 AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW 123 AS (PARTITION BY client_ip
                                                    ORDER BY server_ip,
                                                             timezone);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A4_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER "123" AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW "123" AS (PARTITION BY client_ip
                                                   ORDER BY server_ip,
                                                            timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A4_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER "123" AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW "123" AS (PARTITION BY client_ip
                                                      ORDER BY server_ip,
                                                               timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A5_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER doesntexist AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
Window 'doesntexist' not found
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A5_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER doesntexist AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
Window 'doesntexist' not found
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A6_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number()
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
OVER clause is necessary for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_basic_syntax_A6_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number()
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
OVER clause is necessary for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY timezone
                             ORDER BY server_ip, timezone) AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  1 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  4 |  4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  4 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY timezone
                             ORDER BY server_ip, timezone) AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  1 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  4 |  4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  4 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w1 AS c1,
       count(timezone) OVER w2 AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w1 AS (PARTITION BY client_ip
                                                ORDER BY server_ip,
                                                         timezone),
                                         w2 OVER (PARTITION BY timezone
                                                  ORDER BY server_ip,
                                                           timezone);
Received an unexpected token
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w1 AS c1,
       count(timezone) OVER w2 AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w1 AS (PARTITION BY client_ip
                                                   ORDER BY server_ip,
                                                            timezone),
                                            w2 OVER (PARTITION BY timezone
                                                     ORDER BY server_ip,
                                                              timezone);
Received an unexpected token
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A3_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  1 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  4 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A3_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  1 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  4 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A4_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c1,
       count(timezone) OVER w AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  1 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  4 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A4_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c1,
       count(timezone) OVER w AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  1 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  4 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A5_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY timezone
                             ORDER BY server_ip, timezone) AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  5 |  4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  4 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A5_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY timezone
                             ORDER BY server_ip, timezone) AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  5 |  4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  4 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A6_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w1 AS c1,
       count(timezone) OVER w2 AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w1 AS (PARTITION BY client_ip
                                                ORDER BY server_ip,
                                                         timezone),
                                         w2 OVER (PARTITION BY timezone
                                                  ORDER BY server_ip,
                                                           timezone);
Received an unexpected token
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A6_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w1 AS c1,
       count(timezone) OVER w2 AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w1 AS (PARTITION BY client_ip
                                                   ORDER BY server_ip,
                                                            timezone),
                                            w2 OVER (PARTITION BY timezone
                                                     ORDER BY server_ip,
                                                              timezone);
Received an unexpected token
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A7_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A7_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c1,
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, timezone) AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A8_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c1,
       count(timezone) OVER w AS c2
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_multi_windows_A8_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c1,
       count(timezone) OVER w AS c2
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+----+----+
| server_ip    | client_ip     | timezone | t                   | c1 | c2 |
+--------------+---------------+----------+---------------------+----+----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  2 |  2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  3 |  3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  1 |  1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  5 |  5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  6 |  6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  2 |  2 |
+--------------+---------------+----------+---------------------+----+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY timezone
                          ORDER BY server_ip, timezone, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY timezone
                                               ORDER BY server_ip,
                                                        timezone,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY timezone
                          ORDER BY server_ip, timezone, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY timezone
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY length(timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY length(timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY cos(length(timezone))
                          ORDER BY server_ip, timezone, cos(length(timezone))) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY cos(length(timezone))
                                               ORDER BY server_ip,
                                                        timezone,
                                                        cos(length(timezone)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY cos(length(timezone))
                          ORDER BY server_ip, timezone, cos(length(timezone))) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY cos(length(timezone))
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           cos(length(timezone)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY (timezone IS NULL)
                          ORDER BY server_ip, timezone, (timezone IS NULL)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY (timezone IS NULL)
                                               ORDER BY server_ip,
                                                        timezone, (timezone IS NULL));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY (timezone IS NULL)
                          ORDER BY server_ip, timezone, (timezone IS NULL)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY (timezone IS NULL)
                                                  ORDER BY server_ip,
                                                           timezone, (timezone IS NULL));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY time_parse(cast(length(timezone) AS char))
                          ORDER BY server_ip, timezone, time_parse(cast(length(timezone) AS char))) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY time_parse(cast(length(timezone) AS char))
                                               ORDER BY server_ip,
                                                        timezone,
                                                        time_parse(cast(length(timezone) AS char)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY time_parse(cast(length(timezone) AS char))
                          ORDER BY server_ip, timezone, time_parse(cast(length(timezone) AS char))) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY time_parse(cast(length(timezone) AS char))
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           time_parse(cast(length(timezone) AS char)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY json_object('key': 'k', 'value': timezone)
                          ORDER BY server_ip, timezone, json_object('key': 'k', 'value': timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY json_object('key': 'k', 'value': timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        json_object('key': 'k', 'value': timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY json_object('key': 'k', 'value': timezone)
                          ORDER BY server_ip, timezone, json_object('key': 'k', 'value': timezone)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY json_object('key': 'k', 'value': timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           json_object('key': 'k', 'value': timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array['A', 'B', timezone]
                          ORDER BY server_ip, timezone, array['A', 'B', timezone]) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY array['A',
                                                                  'B',
                                                                  timezone]
                                               ORDER BY server_ip,
                                                        timezone, array['A',
                                                                        'B',
                                                                        timezone]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array['A', 'B', timezone]
                          ORDER BY server_ip, timezone, array['A', 'B', timezone]) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY array['A',
                                                                     'B',
                                                                     timezone]
                                                  ORDER BY server_ip,
                                                           timezone, array['A',
                                                                           'B',
                                                                           timezone]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A8_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array[1, 2, length(timezone)]
                          ORDER BY server_ip, timezone, array[1, 2, length(timezone)]) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A8_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY array[1,
                                                                  2,
                                                                  length(timezone)]
                                               ORDER BY server_ip,
                                                        timezone, array[1,
                                                                        2,
                                                                        length(timezone)]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A8_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array[1, 2, length(timezone)]
                          ORDER BY server_ip, timezone, array[1, 2, length(timezone)]) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A8_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY array[1,
                                                                     2,
                                                                     length(timezone)]
                                                  ORDER BY server_ip,
                                                           timezone, array[1,
                                                                           2,
                                                                           length(timezone)]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A9_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY string_to_mv('1,2,3', ',')
                          ORDER BY server_ip, timezone, string_to_mv('1,2,3', ',')) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A9_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY string_to_mv('1,2,3', ',')
                                               ORDER BY server_ip,
                                                        timezone,
                                                        string_to_mv('1,2,3', ','));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A9_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY string_to_mv('1,2,3', ',')
                          ORDER BY server_ip, timezone, string_to_mv('1,2,3', ',')) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A9_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY string_to_mv('1,2,3', ',')
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           string_to_mv('1,2,3', ','));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A10_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array_to_mv(array['A', 'B', timezone])
                          ORDER BY server_ip, timezone, array_to_mv(array['A', 'B', timezone])) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A10_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY array_to_mv(array['A', 'B', timezone])
                                               ORDER BY server_ip,
                                                        timezone,
                                                        array_to_mv(array['A', 'B', timezone]));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A10_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array_to_mv(array['A', 'B', timezone])
                          ORDER BY server_ip, timezone, array_to_mv(array['A', 'B', timezone])) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A10_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY array_to_mv(array['A', 'B', timezone])
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           array_to_mv(array['A', 'B', timezone]));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A12_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)+length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)+length(timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A12_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY length(timezone)+length(timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        length(timezone)+length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A12_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)+length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)+length(timezone)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_data_types_and_exprs_A12_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY length(timezone)+length(timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           length(timezone)+length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 2 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 2 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 2 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 2 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 8 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY length(timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        length(timezone));
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 8 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 8 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY length(timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           length(timezone));
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     3 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |     3 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     3 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     3 | 8 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY mycol
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY mycol
                                               ORDER BY server_ip,
                                                        timezone);
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY mycol
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY mycol
                                                  ORDER BY server_ip,
                                                           timezone);
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY timezone
                          ORDER BY server_ip, timezone, mycol) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY timezone
                                               ORDER BY server_ip,
                                                        timezone,
                                                        mycol);
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER (PARTITION BY timezone
                          ORDER BY server_ip, timezone, mycol) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       length(timezone) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY timezone
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           mycol);
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |   141 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |    15 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |    16 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |   266 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     8 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |    85 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |    49 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |   188 | 2 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |   141 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |    15 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |    16 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |   266 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     8 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |    85 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |    49 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |   188 | 2 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER (PARTITION BY count(*)
                          ORDER BY server_ip, timezone, count(*)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+---+
| server_ip    | client_ip     | timezone | t                   | mycol | c |
+--------------+---------------+----------+---------------------+-------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |   141 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |    15 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |    16 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |   266 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     8 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |    85 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |    49 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |   188 | 1 |
+--------------+---------------+----------+---------------------+-------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A6_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY count(*)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           count(*));
Aggregation inside window is currently not supported with syntax WINDOW W AS <DEF>. Try providing window definition directly without alias
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A7_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER (PARTITION BY mycol
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A7_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY mycol
                                                  ORDER BY server_ip,
                                                           timezone);
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A8_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone, mycol) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_and_aggr_A8_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) AS mycol,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           mycol);
Column 'mycol' not found in any table
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER () AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER () AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY app_version
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY app_version
                                               ORDER BY server_ip,
                                                        timezone);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY app_version
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY app_version
                                                  ORDER BY server_ip,
                                                           timezone);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip, length(server_ip)
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip,
                                                            length(server_ip)
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip, length(server_ip)
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip,
                                                               length(server_ip)
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip, length(server_ip), CURRENT_TIMESTAMP
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip,
                                                            length(server_ip),
                                                            CURRENT_TIMESTAMP
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip, length(server_ip), CURRENT_TIMESTAMP
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip,
                                                               length(server_ip),
                                                               CURRENT_TIMESTAMP
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip, client_ip, client_ip
                          ORDER BY server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip,
                                                            client_ip,
                                                            client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip, client_ip, client_ip
                          ORDER BY server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_partition_by_A7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip,
                                                               client_ip,
                                                               client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER (PARTITION BY client_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER (PARTITION BY client_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (
                          ORDER BY app_version) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY app_version);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (
                          ORDER BY app_version) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY app_version);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip ASC, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip ASC, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip DESC, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip DESC, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip ASC, length(server_ip) DESC, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) DESC, timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip ASC, length(server_ip) DESC, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) DESC, timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip DESC, length(server_ip) ASC, CURRENT_TIMESTAMP, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) ASC, CURRENT_TIMESTAMP,
                                                                               timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip DESC, length(server_ip) ASC, CURRENT_TIMESTAMP, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) ASC, CURRENT_TIMESTAMP,
                                                                                  timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, server_ip, server_ip, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        server_ip,
                                                        server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip, server_ip, server_ip, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           server_ip,
                                                           server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A8_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip ASC, server_ip DESC, server_ip ASC, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A8_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        server_ip DESC,
                                                        server_ip ASC,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A8_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip ASC, server_ip DESC, server_ip ASC, timezone) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_basic_A8_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           server_ip DESC,
                                                           server_ip ASC,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_nulls_first_last_A1_N1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone NULLS FIRST);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_nulls_first_last_A1_N2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone NULLS LAST);
ASCENDING ordering with NULLS LAST is not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_nulls_first_last_A2_N1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone ASC NULLS FIRST);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_nulls_first_last_A2_N2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone ASC NULLS LAST);
ASCENDING ordering with NULLS LAST is not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_nulls_first_last_A3_N1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone DESC NULLS FIRST);
DESCENDING ordering with NULLS FIRST is not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_order_by_nulls_first_last_A3_N2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone DESC NULLS LAST);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER (PARTITION BY client_ip
                                          ORDER BY server_ip)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER (PARTITION BY client_ip
                                          ORDER BY server_ip)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER (
                                          ORDER BY server_ip)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER (
                                          ORDER BY server_ip)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER (PARTITION BY client_ip)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER (PARTITION BY client_ip)) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 13.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 10.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER ()) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER ()) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_func_in_func_A1_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       floor(avg(length(client_ip)) OVER w) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 12.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 12.0 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY client_ip
                          ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (
                          ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (
                          ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A1_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER (PARTITION BY client_ip
                    ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER (PARTITION BY client_ip
                    ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER (
                    ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 5 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 5 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER (
                    ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 5 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 5 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER (PARTITION BY client_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER (PARTITION BY client_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER () AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER () AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A2_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER (PARTITION BY client_ip
                          ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER (PARTITION BY client_ip
                          ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER (
                          ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER (
                          ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER (PARTITION BY client_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER (PARTITION BY client_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER () AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER () AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A3_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       dense_rank() OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (PARTITION BY client_ip
                                  ORDER BY server_ip), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (PARTITION BY client_ip
                                  ORDER BY server_ip), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (
                                  ORDER BY server_ip), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.57 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.57 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (
                                  ORDER BY server_ip), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.57 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+------+
| server_ip    | client_ip     | timezone | t                   | c    |
+--------------+---------------+----------+---------------------+------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |  0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.57 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.57 |
+--------------+---------------+----------+---------------------+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (PARTITION BY client_ip), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (PARTITION BY client_ip), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER (), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A4_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(percent_rank() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (PARTITION BY client_ip
                               ORDER BY server_ip), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (PARTITION BY client_ip
                               ORDER BY server_ip), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (
                               ORDER BY server_ip), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (
                               ORDER BY server_ip), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0.5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1.0 |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (PARTITION BY client_ip), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (PARTITION BY client_ip), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (), 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER (), 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A5_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       round(cume_dist() OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
RANK or DENSE_RANK functions require ORDER BY clause in window specification
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W1_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER (PARTITION BY client_ip
                      ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W1_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER (PARTITION BY client_ip
                      ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER (
                      ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER (
                      ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER (PARTITION BY client_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER (PARTITION BY client_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER () AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER () AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A6_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(0) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
numBuckets[0] must be greater than zero
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER (PARTITION BY client_ip
                      ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER (PARTITION BY client_ip
                      ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER (
                      ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER (
                      ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A7_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(1) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER (PARTITION BY client_ip
                       ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER (PARTITION BY client_ip
                       ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER (
                       ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER (
                       ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A8_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       ntile(10) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER (PARTITION BY client_ip
                              ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER (PARTITION BY client_ip
                              ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER (
                              ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER (
                              ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A9_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lag(timezone, 1) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |     |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER (PARTITION BY client_ip
                               ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER (PARTITION BY client_ip
                               ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |     |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER (
                               ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER (
                               ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A10_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       lead(timezone, 1) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |     |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A11_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER (
                                  ORDER BY server_ip) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER (
                                  ORDER BY server_ip) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_window_funcs_A12_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       last_value(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B1_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B2_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B3_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
not supported
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B4_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B5_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B6_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B7_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B8_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B36_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B37_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B38_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_basics_test_agg_funcs_A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 647 Positive tests: 493 Negative tests: 154
#-------------------------------------------------------------------------
