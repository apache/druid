!set sqlJoinAlgorithm sortMerge
!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=DartComponentSupplier&datasets=sql/src/test/quidem/qatests/qaUnnest/mv
!set outputformat mysql
#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B26
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B27
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B28
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B29
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B30
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B31
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B1
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
CROSS JOIN test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B2
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN test_unnest t2,
           unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B3
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
CROSS JOIN test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B4
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B5
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
CROSS JOIN test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B6
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B7
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1)
CROSS JOIN test_unnest t2
CROSS JOIN unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+----+
| c_str | c_long | c1 |
+-------+--------+----+
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
+-------+--------+----+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B8
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
CROSS JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B9
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
CROSS JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B10
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
CROSS JOIN t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B1
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t2.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c),
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B2
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c),
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND u.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B4
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B5
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B6
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long=t1.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B7
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c=cast(t1.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B8
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B9
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B10
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long=t1.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B11
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c=cast(t1.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B16
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B17
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c1=cast(t2.c_long AS char);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B18
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c2;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B19
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c1=t2.c2;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B20
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B21
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B22
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B23
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B24
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B25
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B26
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B27
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B28
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B29
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B30
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B31
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

