!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=AllDruidEnginesComponentSupplier&datasets=sql/src/test/quidem/qatests/qaUnnest/mv
!set outputformat mysql
#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: SEL_DATASOURCE
#-------------------------------------------------------------------------
SELECT *
FROM test_unnest;
+-------------------------+-------+--------+---------+----------+------------------------------------------------+------------------------+--------------------------------------+----------------------------------+--------------------------------------+----------------------------------+-----------------------------+
| __time                  | c_str | c_long | c_float | c_double | c_mv_complex                                   | c_mv_num               | c_mv_complex_with_null_and_empty_val | c_mv_num_with_null_and_empty_val | c_mv_complex_with_null_and_empty_row | c_mv_num_with_null_and_empty_row | c_mv_all_null_and_empty_val |
+-------------------------+-------+--------+---------+----------+------------------------------------------------+------------------------+--------------------------------------+----------------------------------+--------------------------------------+----------------------------------+-----------------------------+
| 2022-01-01 00:00:00.000 |       |      1 |     0.1 |      0.1 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            |                                      |                                  | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 | str2  |      2 |     0.2 |      0.2 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 | str3  |      3 |     0.3 |      0.3 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 | str4  |      4 |     0.4 |      0.4 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 |       |      0 |     0.0 |      0.0 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            |                                      |                                  | [null,"",null,"",null]      |
+-------------------------+-------+--------+---------+----------+------------------------------------------------+------------------------+--------------------------------------+----------------------------------+--------------------------------------+----------------------------------+-----------------------------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A1_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_complex)) AS u1(c1),
     unnest(mv_to_array(c_mv_complex)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('my_null',
                 'my_empty',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 | 1           | 1           |
|      0 | 1           | [2]         |
|      0 | 1           | [3, [4, 5]] |
|      0 | 1           | my_empty    |
|      0 | 1           | my_null     |
|      0 | [2]         | 1           |
|      0 | [2]         | [2]         |
|      0 | [2]         | [3, [4, 5]] |
|      0 | [2]         | my_empty    |
|      0 | [2]         | my_null     |
|      0 | [3, [4, 5]] | 1           |
|      0 | [3, [4, 5]] | [2]         |
|      0 | [3, [4, 5]] | [3, [4, 5]] |
|      0 | [3, [4, 5]] | my_empty    |
|      0 | [3, [4, 5]] | my_null     |
|      0 | my_empty    | 1           |
|      0 | my_empty    | [2]         |
|      0 | my_empty    | [3, [4, 5]] |
|      0 | my_empty    | my_empty    |
|      0 | my_empty    | my_null     |
|      0 | my_null     | 1           |
|      0 | my_null     | [2]         |
|      0 | my_null     | [3, [4, 5]] |
|      0 | my_null     | my_empty    |
|      0 | my_null     | my_null     |
|      1 | 1           | 1           |
|      1 | 1           | [2]         |
|      1 | 1           | [3, [4, 5]] |
|      1 | 1           | my_empty    |
|      1 | 1           | my_null     |
|      1 | [2]         | 1           |
|      1 | [2]         | [2]         |
|      1 | [2]         | [3, [4, 5]] |
|      1 | [2]         | my_empty    |
|      1 | [2]         | my_null     |
|      1 | [3, [4, 5]] | 1           |
|      1 | [3, [4, 5]] | [2]         |
|      1 | [3, [4, 5]] | [3, [4, 5]] |
|      1 | [3, [4, 5]] | my_empty    |
|      1 | [3, [4, 5]] | my_null     |
|      1 | my_empty    | 1           |
|      1 | my_empty    | [2]         |
|      1 | my_empty    | [3, [4, 5]] |
|      1 | my_empty    | my_empty    |
|      1 | my_empty    | my_null     |
|      1 | my_null     | 1           |
|      1 | my_null     | [2]         |
|      1 | my_null     | [3, [4, 5]] |
|      1 | my_null     | my_empty    |
|      1 | my_null     | my_null     |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           | my_empty    |
|      2 | 1           | my_null     |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         | my_empty    |
|      2 | [2]         | my_null     |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] | my_empty    |
|      2 | [3, [4, 5]] | my_null     |
|      2 | my_empty    | 1           |
|      2 | my_empty    | [2]         |
|      2 | my_empty    | [3, [4, 5]] |
|      2 | my_empty    | my_empty    |
|      2 | my_empty    | my_null     |
|      2 | my_null     | 1           |
|      2 | my_null     | [2]         |
|      2 | my_null     | [3, [4, 5]] |
|      2 | my_null     | my_empty    |
|      2 | my_null     | my_null     |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           | my_empty    |
|      3 | 1           | my_null     |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         | my_empty    |
|      3 | [2]         | my_null     |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] | my_empty    |
|      3 | [3, [4, 5]] | my_null     |
|      3 | my_empty    | 1           |
|      3 | my_empty    | [2]         |
|      3 | my_empty    | [3, [4, 5]] |
|      3 | my_empty    | my_empty    |
|      3 | my_empty    | my_null     |
|      3 | my_null     | 1           |
|      3 | my_null     | [2]         |
|      3 | my_null     | [3, [4, 5]] |
|      3 | my_null     | my_empty    |
|      3 | my_null     | my_null     |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           | my_empty    |
|      4 | 1           | my_null     |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         | my_empty    |
|      4 | [2]         | my_null     |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] | my_empty    |
|      4 | [3, [4, 5]] | my_null     |
|      4 | my_empty    | 1           |
|      4 | my_empty    | [2]         |
|      4 | my_empty    | [3, [4, 5]] |
|      4 | my_empty    | my_empty    |
|      4 | my_empty    | my_null     |
|      4 | my_null     | 1           |
|      4 | my_null     | [2]         |
|      4 | my_null     | [3, [4, 5]] |
|      4 | my_null     | my_empty    |
|      4 | my_null     | my_null     |
+--------+-------------+-------------+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A1_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_complex)) AS u1(c1)), unnest(mv_to_array(c_mv_complex)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('my_null',
                 'my_empty',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 | 1           | 1           |
|      0 | 1           | [2]         |
|      0 | 1           | [3, [4, 5]] |
|      0 | 1           | my_empty    |
|      0 | 1           | my_null     |
|      0 | [2]         | 1           |
|      0 | [2]         | [2]         |
|      0 | [2]         | [3, [4, 5]] |
|      0 | [2]         | my_empty    |
|      0 | [2]         | my_null     |
|      0 | [3, [4, 5]] | 1           |
|      0 | [3, [4, 5]] | [2]         |
|      0 | [3, [4, 5]] | [3, [4, 5]] |
|      0 | [3, [4, 5]] | my_empty    |
|      0 | [3, [4, 5]] | my_null     |
|      0 | my_empty    | 1           |
|      0 | my_empty    | [2]         |
|      0 | my_empty    | [3, [4, 5]] |
|      0 | my_empty    | my_empty    |
|      0 | my_empty    | my_null     |
|      0 | my_null     | 1           |
|      0 | my_null     | [2]         |
|      0 | my_null     | [3, [4, 5]] |
|      0 | my_null     | my_empty    |
|      0 | my_null     | my_null     |
|      1 | 1           | 1           |
|      1 | 1           | [2]         |
|      1 | 1           | [3, [4, 5]] |
|      1 | 1           | my_empty    |
|      1 | 1           | my_null     |
|      1 | [2]         | 1           |
|      1 | [2]         | [2]         |
|      1 | [2]         | [3, [4, 5]] |
|      1 | [2]         | my_empty    |
|      1 | [2]         | my_null     |
|      1 | [3, [4, 5]] | 1           |
|      1 | [3, [4, 5]] | [2]         |
|      1 | [3, [4, 5]] | [3, [4, 5]] |
|      1 | [3, [4, 5]] | my_empty    |
|      1 | [3, [4, 5]] | my_null     |
|      1 | my_empty    | 1           |
|      1 | my_empty    | [2]         |
|      1 | my_empty    | [3, [4, 5]] |
|      1 | my_empty    | my_empty    |
|      1 | my_empty    | my_null     |
|      1 | my_null     | 1           |
|      1 | my_null     | [2]         |
|      1 | my_null     | [3, [4, 5]] |
|      1 | my_null     | my_empty    |
|      1 | my_null     | my_null     |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           | my_empty    |
|      2 | 1           | my_null     |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         | my_empty    |
|      2 | [2]         | my_null     |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] | my_empty    |
|      2 | [3, [4, 5]] | my_null     |
|      2 | my_empty    | 1           |
|      2 | my_empty    | [2]         |
|      2 | my_empty    | [3, [4, 5]] |
|      2 | my_empty    | my_empty    |
|      2 | my_empty    | my_null     |
|      2 | my_null     | 1           |
|      2 | my_null     | [2]         |
|      2 | my_null     | [3, [4, 5]] |
|      2 | my_null     | my_empty    |
|      2 | my_null     | my_null     |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           | my_empty    |
|      3 | 1           | my_null     |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         | my_empty    |
|      3 | [2]         | my_null     |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] | my_empty    |
|      3 | [3, [4, 5]] | my_null     |
|      3 | my_empty    | 1           |
|      3 | my_empty    | [2]         |
|      3 | my_empty    | [3, [4, 5]] |
|      3 | my_empty    | my_empty    |
|      3 | my_empty    | my_null     |
|      3 | my_null     | 1           |
|      3 | my_null     | [2]         |
|      3 | my_null     | [3, [4, 5]] |
|      3 | my_null     | my_empty    |
|      3 | my_null     | my_null     |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           | my_empty    |
|      4 | 1           | my_null     |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         | my_empty    |
|      4 | [2]         | my_null     |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] | my_empty    |
|      4 | [3, [4, 5]] | my_null     |
|      4 | my_empty    | 1           |
|      4 | my_empty    | [2]         |
|      4 | my_empty    | [3, [4, 5]] |
|      4 | my_empty    | my_empty    |
|      4 | my_empty    | my_null     |
|      4 | my_null     | 1           |
|      4 | my_null     | [2]         |
|      4 | my_null     | [3, [4, 5]] |
|      4 | my_null     | my_empty    |
|      4 | my_null     | my_null     |
+--------+-------------+-------------+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A1_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_complex)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_complex)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('my_null',
                 'my_empty',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 | 1           | 1           |
|      0 | 1           | [2]         |
|      0 | 1           | [3, [4, 5]] |
|      0 | 1           | my_empty    |
|      0 | 1           | my_null     |
|      0 | [2]         | 1           |
|      0 | [2]         | [2]         |
|      0 | [2]         | [3, [4, 5]] |
|      0 | [2]         | my_empty    |
|      0 | [2]         | my_null     |
|      0 | [3, [4, 5]] | 1           |
|      0 | [3, [4, 5]] | [2]         |
|      0 | [3, [4, 5]] | [3, [4, 5]] |
|      0 | [3, [4, 5]] | my_empty    |
|      0 | [3, [4, 5]] | my_null     |
|      0 | my_empty    | 1           |
|      0 | my_empty    | [2]         |
|      0 | my_empty    | [3, [4, 5]] |
|      0 | my_empty    | my_empty    |
|      0 | my_empty    | my_null     |
|      0 | my_null     | 1           |
|      0 | my_null     | [2]         |
|      0 | my_null     | [3, [4, 5]] |
|      0 | my_null     | my_empty    |
|      0 | my_null     | my_null     |
|      1 | 1           | 1           |
|      1 | 1           | [2]         |
|      1 | 1           | [3, [4, 5]] |
|      1 | 1           | my_empty    |
|      1 | 1           | my_null     |
|      1 | [2]         | 1           |
|      1 | [2]         | [2]         |
|      1 | [2]         | [3, [4, 5]] |
|      1 | [2]         | my_empty    |
|      1 | [2]         | my_null     |
|      1 | [3, [4, 5]] | 1           |
|      1 | [3, [4, 5]] | [2]         |
|      1 | [3, [4, 5]] | [3, [4, 5]] |
|      1 | [3, [4, 5]] | my_empty    |
|      1 | [3, [4, 5]] | my_null     |
|      1 | my_empty    | 1           |
|      1 | my_empty    | [2]         |
|      1 | my_empty    | [3, [4, 5]] |
|      1 | my_empty    | my_empty    |
|      1 | my_empty    | my_null     |
|      1 | my_null     | 1           |
|      1 | my_null     | [2]         |
|      1 | my_null     | [3, [4, 5]] |
|      1 | my_null     | my_empty    |
|      1 | my_null     | my_null     |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           | my_empty    |
|      2 | 1           | my_null     |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         | my_empty    |
|      2 | [2]         | my_null     |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] | my_empty    |
|      2 | [3, [4, 5]] | my_null     |
|      2 | my_empty    | 1           |
|      2 | my_empty    | [2]         |
|      2 | my_empty    | [3, [4, 5]] |
|      2 | my_empty    | my_empty    |
|      2 | my_empty    | my_null     |
|      2 | my_null     | 1           |
|      2 | my_null     | [2]         |
|      2 | my_null     | [3, [4, 5]] |
|      2 | my_null     | my_empty    |
|      2 | my_null     | my_null     |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           | my_empty    |
|      3 | 1           | my_null     |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         | my_empty    |
|      3 | [2]         | my_null     |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] | my_empty    |
|      3 | [3, [4, 5]] | my_null     |
|      3 | my_empty    | 1           |
|      3 | my_empty    | [2]         |
|      3 | my_empty    | [3, [4, 5]] |
|      3 | my_empty    | my_empty    |
|      3 | my_empty    | my_null     |
|      3 | my_null     | 1           |
|      3 | my_null     | [2]         |
|      3 | my_null     | [3, [4, 5]] |
|      3 | my_null     | my_empty    |
|      3 | my_null     | my_null     |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           | my_empty    |
|      4 | 1           | my_null     |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         | my_empty    |
|      4 | [2]         | my_null     |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] | my_empty    |
|      4 | [3, [4, 5]] | my_null     |
|      4 | my_empty    | 1           |
|      4 | my_empty    | [2]         |
|      4 | my_empty    | [3, [4, 5]] |
|      4 | my_empty    | my_empty    |
|      4 | my_empty    | my_null     |
|      4 | my_null     | 1           |
|      4 | my_null     | [2]         |
|      4 | my_null     | [3, [4, 5]] |
|      4 | my_null     | my_empty    |
|      4 | my_null     | my_null     |
+--------+-------------+-------------+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A2_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_num)) AS u1(c1),
     unnest(mv_to_array(c_mv_num)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('-1',
                 '0',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 | -1 | -1 |
|      0 | -1 | 0  |
|      0 | -1 | 1  |
|      0 | -1 | 2  |
|      0 | -1 | 3  |
|      0 | 0  | -1 |
|      0 | 0  | 0  |
|      0 | 0  | 1  |
|      0 | 0  | 2  |
|      0 | 0  | 3  |
|      0 | 1  | -1 |
|      0 | 1  | 0  |
|      0 | 1  | 1  |
|      0 | 1  | 2  |
|      0 | 1  | 3  |
|      0 | 2  | -1 |
|      0 | 2  | 0  |
|      0 | 2  | 1  |
|      0 | 2  | 2  |
|      0 | 2  | 3  |
|      0 | 3  | -1 |
|      0 | 3  | 0  |
|      0 | 3  | 1  |
|      0 | 3  | 2  |
|      0 | 3  | 3  |
|      1 | -1 | -1 |
|      1 | -1 | 0  |
|      1 | -1 | 1  |
|      1 | -1 | 2  |
|      1 | -1 | 3  |
|      1 | 0  | -1 |
|      1 | 0  | 0  |
|      1 | 0  | 1  |
|      1 | 0  | 2  |
|      1 | 0  | 3  |
|      1 | 1  | -1 |
|      1 | 1  | 0  |
|      1 | 1  | 1  |
|      1 | 1  | 2  |
|      1 | 1  | 3  |
|      1 | 2  | -1 |
|      1 | 2  | 0  |
|      1 | 2  | 1  |
|      1 | 2  | 2  |
|      1 | 2  | 3  |
|      1 | 3  | -1 |
|      1 | 3  | 0  |
|      1 | 3  | 1  |
|      1 | 3  | 2  |
|      1 | 3  | 3  |
|      2 | -1 | -1 |
|      2 | -1 | 0  |
|      2 | -1 | 1  |
|      2 | -1 | 2  |
|      2 | -1 | 3  |
|      2 | 0  | -1 |
|      2 | 0  | 0  |
|      2 | 0  | 1  |
|      2 | 0  | 2  |
|      2 | 0  | 3  |
|      2 | 1  | -1 |
|      2 | 1  | 0  |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 2  | -1 |
|      2 | 2  | 0  |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 3  | -1 |
|      2 | 3  | 0  |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      3 | -1 | -1 |
|      3 | -1 | 0  |
|      3 | -1 | 1  |
|      3 | -1 | 2  |
|      3 | -1 | 3  |
|      3 | 0  | -1 |
|      3 | 0  | 0  |
|      3 | 0  | 1  |
|      3 | 0  | 2  |
|      3 | 0  | 3  |
|      3 | 1  | -1 |
|      3 | 1  | 0  |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 2  | -1 |
|      3 | 2  | 0  |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 3  | -1 |
|      3 | 3  | 0  |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      4 | -1 | -1 |
|      4 | -1 | 0  |
|      4 | -1 | 1  |
|      4 | -1 | 2  |
|      4 | -1 | 3  |
|      4 | 0  | -1 |
|      4 | 0  | 0  |
|      4 | 0  | 1  |
|      4 | 0  | 2  |
|      4 | 0  | 3  |
|      4 | 1  | -1 |
|      4 | 1  | 0  |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 2  | -1 |
|      4 | 2  | 0  |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 3  | -1 |
|      4 | 3  | 0  |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A2_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num)) AS u1(c1)), unnest(mv_to_array(c_mv_num)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('-1',
                 '0',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 | -1 | -1 |
|      0 | -1 | 0  |
|      0 | -1 | 1  |
|      0 | -1 | 2  |
|      0 | -1 | 3  |
|      0 | 0  | -1 |
|      0 | 0  | 0  |
|      0 | 0  | 1  |
|      0 | 0  | 2  |
|      0 | 0  | 3  |
|      0 | 1  | -1 |
|      0 | 1  | 0  |
|      0 | 1  | 1  |
|      0 | 1  | 2  |
|      0 | 1  | 3  |
|      0 | 2  | -1 |
|      0 | 2  | 0  |
|      0 | 2  | 1  |
|      0 | 2  | 2  |
|      0 | 2  | 3  |
|      0 | 3  | -1 |
|      0 | 3  | 0  |
|      0 | 3  | 1  |
|      0 | 3  | 2  |
|      0 | 3  | 3  |
|      1 | -1 | -1 |
|      1 | -1 | 0  |
|      1 | -1 | 1  |
|      1 | -1 | 2  |
|      1 | -1 | 3  |
|      1 | 0  | -1 |
|      1 | 0  | 0  |
|      1 | 0  | 1  |
|      1 | 0  | 2  |
|      1 | 0  | 3  |
|      1 | 1  | -1 |
|      1 | 1  | 0  |
|      1 | 1  | 1  |
|      1 | 1  | 2  |
|      1 | 1  | 3  |
|      1 | 2  | -1 |
|      1 | 2  | 0  |
|      1 | 2  | 1  |
|      1 | 2  | 2  |
|      1 | 2  | 3  |
|      1 | 3  | -1 |
|      1 | 3  | 0  |
|      1 | 3  | 1  |
|      1 | 3  | 2  |
|      1 | 3  | 3  |
|      2 | -1 | -1 |
|      2 | -1 | 0  |
|      2 | -1 | 1  |
|      2 | -1 | 2  |
|      2 | -1 | 3  |
|      2 | 0  | -1 |
|      2 | 0  | 0  |
|      2 | 0  | 1  |
|      2 | 0  | 2  |
|      2 | 0  | 3  |
|      2 | 1  | -1 |
|      2 | 1  | 0  |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 2  | -1 |
|      2 | 2  | 0  |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 3  | -1 |
|      2 | 3  | 0  |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      3 | -1 | -1 |
|      3 | -1 | 0  |
|      3 | -1 | 1  |
|      3 | -1 | 2  |
|      3 | -1 | 3  |
|      3 | 0  | -1 |
|      3 | 0  | 0  |
|      3 | 0  | 1  |
|      3 | 0  | 2  |
|      3 | 0  | 3  |
|      3 | 1  | -1 |
|      3 | 1  | 0  |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 2  | -1 |
|      3 | 2  | 0  |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 3  | -1 |
|      3 | 3  | 0  |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      4 | -1 | -1 |
|      4 | -1 | 0  |
|      4 | -1 | 1  |
|      4 | -1 | 2  |
|      4 | -1 | 3  |
|      4 | 0  | -1 |
|      4 | 0  | 0  |
|      4 | 0  | 1  |
|      4 | 0  | 2  |
|      4 | 0  | 3  |
|      4 | 1  | -1 |
|      4 | 1  | 0  |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 2  | -1 |
|      4 | 2  | 0  |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 3  | -1 |
|      4 | 3  | 0  |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A2_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_num)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('-1',
                 '0',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 | -1 | -1 |
|      0 | -1 | 0  |
|      0 | -1 | 1  |
|      0 | -1 | 2  |
|      0 | -1 | 3  |
|      0 | 0  | -1 |
|      0 | 0  | 0  |
|      0 | 0  | 1  |
|      0 | 0  | 2  |
|      0 | 0  | 3  |
|      0 | 1  | -1 |
|      0 | 1  | 0  |
|      0 | 1  | 1  |
|      0 | 1  | 2  |
|      0 | 1  | 3  |
|      0 | 2  | -1 |
|      0 | 2  | 0  |
|      0 | 2  | 1  |
|      0 | 2  | 2  |
|      0 | 2  | 3  |
|      0 | 3  | -1 |
|      0 | 3  | 0  |
|      0 | 3  | 1  |
|      0 | 3  | 2  |
|      0 | 3  | 3  |
|      1 | -1 | -1 |
|      1 | -1 | 0  |
|      1 | -1 | 1  |
|      1 | -1 | 2  |
|      1 | -1 | 3  |
|      1 | 0  | -1 |
|      1 | 0  | 0  |
|      1 | 0  | 1  |
|      1 | 0  | 2  |
|      1 | 0  | 3  |
|      1 | 1  | -1 |
|      1 | 1  | 0  |
|      1 | 1  | 1  |
|      1 | 1  | 2  |
|      1 | 1  | 3  |
|      1 | 2  | -1 |
|      1 | 2  | 0  |
|      1 | 2  | 1  |
|      1 | 2  | 2  |
|      1 | 2  | 3  |
|      1 | 3  | -1 |
|      1 | 3  | 0  |
|      1 | 3  | 1  |
|      1 | 3  | 2  |
|      1 | 3  | 3  |
|      2 | -1 | -1 |
|      2 | -1 | 0  |
|      2 | -1 | 1  |
|      2 | -1 | 2  |
|      2 | -1 | 3  |
|      2 | 0  | -1 |
|      2 | 0  | 0  |
|      2 | 0  | 1  |
|      2 | 0  | 2  |
|      2 | 0  | 3  |
|      2 | 1  | -1 |
|      2 | 1  | 0  |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 2  | -1 |
|      2 | 2  | 0  |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 3  | -1 |
|      2 | 3  | 0  |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      3 | -1 | -1 |
|      3 | -1 | 0  |
|      3 | -1 | 1  |
|      3 | -1 | 2  |
|      3 | -1 | 3  |
|      3 | 0  | -1 |
|      3 | 0  | 0  |
|      3 | 0  | 1  |
|      3 | 0  | 2  |
|      3 | 0  | 3  |
|      3 | 1  | -1 |
|      3 | 1  | 0  |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 2  | -1 |
|      3 | 2  | 0  |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 3  | -1 |
|      3 | 3  | 0  |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      4 | -1 | -1 |
|      4 | -1 | 0  |
|      4 | -1 | 1  |
|      4 | -1 | 2  |
|      4 | -1 | 3  |
|      4 | 0  | -1 |
|      4 | 0  | 0  |
|      4 | 0  | 1  |
|      4 | 0  | 2  |
|      4 | 0  | 3  |
|      4 | 1  | -1 |
|      4 | 1  | 0  |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 2  | -1 |
|      4 | 2  | 0  |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 3  | -1 |
|      4 | 3  | 0  |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A3_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_complex_with_null_and_empty_val)) AS u1(c1),
     unnest(mv_to_array(c_mv_complex_with_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 |             |             |
|      0 |             | 1           |
|      0 |             | [2]         |
|      0 |             | [3, [4, 5]] |
|      0 |             |             |
|      0 | 1           |             |
|      0 | 1           | 1           |
|      0 | 1           | [2]         |
|      0 | 1           | [3, [4, 5]] |
|      0 | 1           |             |
|      0 | [2]         |             |
|      0 | [2]         | 1           |
|      0 | [2]         | [2]         |
|      0 | [2]         | [3, [4, 5]] |
|      0 | [2]         |             |
|      0 | [3, [4, 5]] |             |
|      0 | [3, [4, 5]] | 1           |
|      0 | [3, [4, 5]] | [2]         |
|      0 | [3, [4, 5]] | [3, [4, 5]] |
|      0 | [3, [4, 5]] |             |
|      0 |             |             |
|      0 |             | 1           |
|      0 |             | [2]         |
|      0 |             | [3, [4, 5]] |
|      0 |             |             |
|      1 |             |             |
|      1 |             | 1           |
|      1 |             | [2]         |
|      1 |             | [3, [4, 5]] |
|      1 |             |             |
|      1 | 1           |             |
|      1 | 1           | 1           |
|      1 | 1           | [2]         |
|      1 | 1           | [3, [4, 5]] |
|      1 | 1           |             |
|      1 | [2]         |             |
|      1 | [2]         | 1           |
|      1 | [2]         | [2]         |
|      1 | [2]         | [3, [4, 5]] |
|      1 | [2]         |             |
|      1 | [3, [4, 5]] |             |
|      1 | [3, [4, 5]] | 1           |
|      1 | [3, [4, 5]] | [2]         |
|      1 | [3, [4, 5]] | [3, [4, 5]] |
|      1 | [3, [4, 5]] |             |
|      1 |             |             |
|      1 |             | 1           |
|      1 |             | [2]         |
|      1 |             | [3, [4, 5]] |
|      1 |             |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      2 | 1           |             |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           |             |
|      2 | [2]         |             |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         |             |
|      2 | [3, [4, 5]] |             |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      3 | 1           |             |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           |             |
|      3 | [2]         |             |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         |             |
|      3 | [3, [4, 5]] |             |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
|      4 | 1           |             |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           |             |
|      4 | [2]         |             |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         |             |
|      4 | [3, [4, 5]] |             |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
+--------+-------------+-------------+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A3_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_complex_with_null_and_empty_val)) AS u1(c1)), unnest(mv_to_array(c_mv_complex_with_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 |             |             |
|      0 |             | 1           |
|      0 |             | [2]         |
|      0 |             | [3, [4, 5]] |
|      0 |             |             |
|      0 | 1           |             |
|      0 | 1           | 1           |
|      0 | 1           | [2]         |
|      0 | 1           | [3, [4, 5]] |
|      0 | 1           |             |
|      0 | [2]         |             |
|      0 | [2]         | 1           |
|      0 | [2]         | [2]         |
|      0 | [2]         | [3, [4, 5]] |
|      0 | [2]         |             |
|      0 | [3, [4, 5]] |             |
|      0 | [3, [4, 5]] | 1           |
|      0 | [3, [4, 5]] | [2]         |
|      0 | [3, [4, 5]] | [3, [4, 5]] |
|      0 | [3, [4, 5]] |             |
|      0 |             |             |
|      0 |             | 1           |
|      0 |             | [2]         |
|      0 |             | [3, [4, 5]] |
|      0 |             |             |
|      1 |             |             |
|      1 |             | 1           |
|      1 |             | [2]         |
|      1 |             | [3, [4, 5]] |
|      1 |             |             |
|      1 | 1           |             |
|      1 | 1           | 1           |
|      1 | 1           | [2]         |
|      1 | 1           | [3, [4, 5]] |
|      1 | 1           |             |
|      1 | [2]         |             |
|      1 | [2]         | 1           |
|      1 | [2]         | [2]         |
|      1 | [2]         | [3, [4, 5]] |
|      1 | [2]         |             |
|      1 | [3, [4, 5]] |             |
|      1 | [3, [4, 5]] | 1           |
|      1 | [3, [4, 5]] | [2]         |
|      1 | [3, [4, 5]] | [3, [4, 5]] |
|      1 | [3, [4, 5]] |             |
|      1 |             |             |
|      1 |             | 1           |
|      1 |             | [2]         |
|      1 |             | [3, [4, 5]] |
|      1 |             |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      2 | 1           |             |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           |             |
|      2 | [2]         |             |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         |             |
|      2 | [3, [4, 5]] |             |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      3 | 1           |             |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           |             |
|      3 | [2]         |             |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         |             |
|      3 | [3, [4, 5]] |             |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
|      4 | 1           |             |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           |             |
|      4 | [2]         |             |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         |             |
|      4 | [3, [4, 5]] |             |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
+--------+-------------+-------------+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A3_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_complex_with_null_and_empty_val)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_complex_with_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 |             |             |
|      0 |             | 1           |
|      0 |             | [2]         |
|      0 |             | [3, [4, 5]] |
|      0 |             |             |
|      0 | 1           |             |
|      0 | 1           | 1           |
|      0 | 1           | [2]         |
|      0 | 1           | [3, [4, 5]] |
|      0 | 1           |             |
|      0 | [2]         |             |
|      0 | [2]         | 1           |
|      0 | [2]         | [2]         |
|      0 | [2]         | [3, [4, 5]] |
|      0 | [2]         |             |
|      0 | [3, [4, 5]] |             |
|      0 | [3, [4, 5]] | 1           |
|      0 | [3, [4, 5]] | [2]         |
|      0 | [3, [4, 5]] | [3, [4, 5]] |
|      0 | [3, [4, 5]] |             |
|      0 |             |             |
|      0 |             | 1           |
|      0 |             | [2]         |
|      0 |             | [3, [4, 5]] |
|      0 |             |             |
|      1 |             |             |
|      1 |             | 1           |
|      1 |             | [2]         |
|      1 |             | [3, [4, 5]] |
|      1 |             |             |
|      1 | 1           |             |
|      1 | 1           | 1           |
|      1 | 1           | [2]         |
|      1 | 1           | [3, [4, 5]] |
|      1 | 1           |             |
|      1 | [2]         |             |
|      1 | [2]         | 1           |
|      1 | [2]         | [2]         |
|      1 | [2]         | [3, [4, 5]] |
|      1 | [2]         |             |
|      1 | [3, [4, 5]] |             |
|      1 | [3, [4, 5]] | 1           |
|      1 | [3, [4, 5]] | [2]         |
|      1 | [3, [4, 5]] | [3, [4, 5]] |
|      1 | [3, [4, 5]] |             |
|      1 |             |             |
|      1 |             | 1           |
|      1 |             | [2]         |
|      1 |             | [3, [4, 5]] |
|      1 |             |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      2 | 1           |             |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           |             |
|      2 | [2]         |             |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         |             |
|      2 | [3, [4, 5]] |             |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      3 | 1           |             |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           |             |
|      3 | [2]         |             |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         |             |
|      3 | [3, [4, 5]] |             |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
|      4 | 1           |             |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           |             |
|      4 | [2]         |             |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         |             |
|      4 | [3, [4, 5]] |             |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
+--------+-------------+-------------+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A4_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u1(c1),
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      0 |    | 1  |
|      0 |    | 2  |
|      0 |    | 3  |
|      0 |    |    |
|      0 | 1  |    |
|      0 | 1  | 1  |
|      0 | 1  | 2  |
|      0 | 1  | 3  |
|      0 | 1  |    |
|      0 | 2  |    |
|      0 | 2  | 1  |
|      0 | 2  | 2  |
|      0 | 2  | 3  |
|      0 | 2  |    |
|      0 | 3  |    |
|      0 | 3  | 1  |
|      0 | 3  | 2  |
|      0 | 3  | 3  |
|      0 | 3  |    |
|      0 |    |    |
|      0 |    | 1  |
|      0 |    | 2  |
|      0 |    | 3  |
|      0 |    |    |
|      1 |    |    |
|      1 |    | 1  |
|      1 |    | 2  |
|      1 |    | 3  |
|      1 |    |    |
|      1 | 1  |    |
|      1 | 1  | 1  |
|      1 | 1  | 2  |
|      1 | 1  | 3  |
|      1 | 1  |    |
|      1 | 2  |    |
|      1 | 2  | 1  |
|      1 | 2  | 2  |
|      1 | 2  | 3  |
|      1 | 2  |    |
|      1 | 3  |    |
|      1 | 3  | 1  |
|      1 | 3  | 2  |
|      1 | 3  | 3  |
|      1 | 3  |    |
|      1 |    |    |
|      1 |    | 1  |
|      1 |    | 2  |
|      1 |    | 3  |
|      1 |    |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      2 | 1  |    |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 1  |    |
|      2 | 2  |    |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 2  |    |
|      2 | 3  |    |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      2 | 3  |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      3 | 1  |    |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 1  |    |
|      3 | 2  |    |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 2  |    |
|      3 | 3  |    |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      3 | 3  |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
|      4 | 1  |    |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 1  |    |
|      4 | 2  |    |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 2  |    |
|      4 | 3  |    |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
|      4 | 3  |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A4_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u1(c1)), unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      0 |    | 1  |
|      0 |    | 2  |
|      0 |    | 3  |
|      0 |    |    |
|      0 | 1  |    |
|      0 | 1  | 1  |
|      0 | 1  | 2  |
|      0 | 1  | 3  |
|      0 | 1  |    |
|      0 | 2  |    |
|      0 | 2  | 1  |
|      0 | 2  | 2  |
|      0 | 2  | 3  |
|      0 | 2  |    |
|      0 | 3  |    |
|      0 | 3  | 1  |
|      0 | 3  | 2  |
|      0 | 3  | 3  |
|      0 | 3  |    |
|      0 |    |    |
|      0 |    | 1  |
|      0 |    | 2  |
|      0 |    | 3  |
|      0 |    |    |
|      1 |    |    |
|      1 |    | 1  |
|      1 |    | 2  |
|      1 |    | 3  |
|      1 |    |    |
|      1 | 1  |    |
|      1 | 1  | 1  |
|      1 | 1  | 2  |
|      1 | 1  | 3  |
|      1 | 1  |    |
|      1 | 2  |    |
|      1 | 2  | 1  |
|      1 | 2  | 2  |
|      1 | 2  | 3  |
|      1 | 2  |    |
|      1 | 3  |    |
|      1 | 3  | 1  |
|      1 | 3  | 2  |
|      1 | 3  | 3  |
|      1 | 3  |    |
|      1 |    |    |
|      1 |    | 1  |
|      1 |    | 2  |
|      1 |    | 3  |
|      1 |    |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      2 | 1  |    |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 1  |    |
|      2 | 2  |    |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 2  |    |
|      2 | 3  |    |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      2 | 3  |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      3 | 1  |    |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 1  |    |
|      3 | 2  |    |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 2  |    |
|      3 | 3  |    |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      3 | 3  |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
|      4 | 1  |    |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 1  |    |
|      4 | 2  |    |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 2  |    |
|      4 | 3  |    |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
|      4 | 3  |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A4_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      0 |    | 1  |
|      0 |    | 2  |
|      0 |    | 3  |
|      0 |    |    |
|      0 | 1  |    |
|      0 | 1  | 1  |
|      0 | 1  | 2  |
|      0 | 1  | 3  |
|      0 | 1  |    |
|      0 | 2  |    |
|      0 | 2  | 1  |
|      0 | 2  | 2  |
|      0 | 2  | 3  |
|      0 | 2  |    |
|      0 | 3  |    |
|      0 | 3  | 1  |
|      0 | 3  | 2  |
|      0 | 3  | 3  |
|      0 | 3  |    |
|      0 |    |    |
|      0 |    | 1  |
|      0 |    | 2  |
|      0 |    | 3  |
|      0 |    |    |
|      1 |    |    |
|      1 |    | 1  |
|      1 |    | 2  |
|      1 |    | 3  |
|      1 |    |    |
|      1 | 1  |    |
|      1 | 1  | 1  |
|      1 | 1  | 2  |
|      1 | 1  | 3  |
|      1 | 1  |    |
|      1 | 2  |    |
|      1 | 2  | 1  |
|      1 | 2  | 2  |
|      1 | 2  | 3  |
|      1 | 2  |    |
|      1 | 3  |    |
|      1 | 3  | 1  |
|      1 | 3  | 2  |
|      1 | 3  | 3  |
|      1 | 3  |    |
|      1 |    |    |
|      1 |    | 1  |
|      1 |    | 2  |
|      1 |    | 3  |
|      1 |    |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      2 | 1  |    |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 1  |    |
|      2 | 2  |    |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 2  |    |
|      2 | 3  |    |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      2 | 3  |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      3 | 1  |    |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 1  |    |
|      3 | 2  |    |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 2  |    |
|      3 | 3  |    |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      3 | 3  |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
|      4 | 1  |    |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 1  |    |
|      4 | 2  |    |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 2  |    |
|      4 | 3  |    |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
|      4 | 3  |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A5_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_complex_with_null_and_empty_row)) AS u1(c1),
     unnest(mv_to_array(c_mv_complex_with_null_and_empty_row)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 |             |             |
|      1 |             |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      2 | 1           |             |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           |             |
|      2 | [2]         |             |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         |             |
|      2 | [3, [4, 5]] |             |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      3 | 1           |             |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           |             |
|      3 | [2]         |             |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         |             |
|      3 | [3, [4, 5]] |             |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
|      4 | 1           |             |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           |             |
|      4 | [2]         |             |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         |             |
|      4 | [3, [4, 5]] |             |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
+--------+-------------+-------------+
(77 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A5_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_complex_with_null_and_empty_row)) AS u1(c1)), unnest(mv_to_array(c_mv_complex_with_null_and_empty_row)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 |             |             |
|      1 |             |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      2 | 1           |             |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           |             |
|      2 | [2]         |             |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         |             |
|      2 | [3, [4, 5]] |             |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      3 | 1           |             |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           |             |
|      3 | [2]         |             |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         |             |
|      3 | [3, [4, 5]] |             |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
|      4 | 1           |             |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           |             |
|      4 | [2]         |             |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         |             |
|      4 | [3, [4, 5]] |             |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
+--------+-------------+-------------+
(77 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A5_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_complex_with_null_and_empty_row)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_complex_with_null_and_empty_row)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '[2]',
                 '[3, [4, 5]]'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+-------------+-------------+
| c_long | c1          | c2          |
+--------+-------------+-------------+
|      0 |             |             |
|      1 |             |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      2 | 1           |             |
|      2 | 1           | 1           |
|      2 | 1           | [2]         |
|      2 | 1           | [3, [4, 5]] |
|      2 | 1           |             |
|      2 | [2]         |             |
|      2 | [2]         | 1           |
|      2 | [2]         | [2]         |
|      2 | [2]         | [3, [4, 5]] |
|      2 | [2]         |             |
|      2 | [3, [4, 5]] |             |
|      2 | [3, [4, 5]] | 1           |
|      2 | [3, [4, 5]] | [2]         |
|      2 | [3, [4, 5]] | [3, [4, 5]] |
|      2 | [3, [4, 5]] |             |
|      2 |             |             |
|      2 |             | 1           |
|      2 |             | [2]         |
|      2 |             | [3, [4, 5]] |
|      2 |             |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      3 | 1           |             |
|      3 | 1           | 1           |
|      3 | 1           | [2]         |
|      3 | 1           | [3, [4, 5]] |
|      3 | 1           |             |
|      3 | [2]         |             |
|      3 | [2]         | 1           |
|      3 | [2]         | [2]         |
|      3 | [2]         | [3, [4, 5]] |
|      3 | [2]         |             |
|      3 | [3, [4, 5]] |             |
|      3 | [3, [4, 5]] | 1           |
|      3 | [3, [4, 5]] | [2]         |
|      3 | [3, [4, 5]] | [3, [4, 5]] |
|      3 | [3, [4, 5]] |             |
|      3 |             |             |
|      3 |             | 1           |
|      3 |             | [2]         |
|      3 |             | [3, [4, 5]] |
|      3 |             |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
|      4 | 1           |             |
|      4 | 1           | 1           |
|      4 | 1           | [2]         |
|      4 | 1           | [3, [4, 5]] |
|      4 | 1           |             |
|      4 | [2]         |             |
|      4 | [2]         | 1           |
|      4 | [2]         | [2]         |
|      4 | [2]         | [3, [4, 5]] |
|      4 | [2]         |             |
|      4 | [3, [4, 5]] |             |
|      4 | [3, [4, 5]] | 1           |
|      4 | [3, [4, 5]] | [2]         |
|      4 | [3, [4, 5]] | [3, [4, 5]] |
|      4 | [3, [4, 5]] |             |
|      4 |             |             |
|      4 |             | 1           |
|      4 |             | [2]         |
|      4 |             | [3, [4, 5]] |
|      4 |             |             |
+--------+-------------+-------------+
(77 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A6_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_row)) AS u1(c1),
     unnest(mv_to_array(c_mv_num_with_null_and_empty_row)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      1 |    |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      2 | 1  |    |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 1  |    |
|      2 | 2  |    |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 2  |    |
|      2 | 3  |    |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      2 | 3  |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      3 | 1  |    |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 1  |    |
|      3 | 2  |    |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 2  |    |
|      3 | 3  |    |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      3 | 3  |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
|      4 | 1  |    |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 1  |    |
|      4 | 2  |    |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 2  |    |
|      4 | 3  |    |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
|      4 | 3  |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
+--------+----+----+
(77 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A6_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_row)) AS u1(c1)), unnest(mv_to_array(c_mv_num_with_null_and_empty_row)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      1 |    |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      2 | 1  |    |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 1  |    |
|      2 | 2  |    |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 2  |    |
|      2 | 3  |    |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      2 | 3  |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      3 | 1  |    |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 1  |    |
|      3 | 2  |    |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 2  |    |
|      3 | 3  |    |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      3 | 3  |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
|      4 | 1  |    |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 1  |    |
|      4 | 2  |    |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 2  |    |
|      4 | 3  |    |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
|      4 | 3  |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
+--------+----+----+
(77 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A6_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_row)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_row)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN ('',
                 '1',
                 '2',
                 '3'))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      1 |    |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      2 | 1  |    |
|      2 | 1  | 1  |
|      2 | 1  | 2  |
|      2 | 1  | 3  |
|      2 | 1  |    |
|      2 | 2  |    |
|      2 | 2  | 1  |
|      2 | 2  | 2  |
|      2 | 2  | 3  |
|      2 | 2  |    |
|      2 | 3  |    |
|      2 | 3  | 1  |
|      2 | 3  | 2  |
|      2 | 3  | 3  |
|      2 | 3  |    |
|      2 |    |    |
|      2 |    | 1  |
|      2 |    | 2  |
|      2 |    | 3  |
|      2 |    |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      3 | 1  |    |
|      3 | 1  | 1  |
|      3 | 1  | 2  |
|      3 | 1  | 3  |
|      3 | 1  |    |
|      3 | 2  |    |
|      3 | 2  | 1  |
|      3 | 2  | 2  |
|      3 | 2  | 3  |
|      3 | 2  |    |
|      3 | 3  |    |
|      3 | 3  | 1  |
|      3 | 3  | 2  |
|      3 | 3  | 3  |
|      3 | 3  |    |
|      3 |    |    |
|      3 |    | 1  |
|      3 |    | 2  |
|      3 |    | 3  |
|      3 |    |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
|      4 | 1  |    |
|      4 | 1  | 1  |
|      4 | 1  | 2  |
|      4 | 1  | 3  |
|      4 | 1  |    |
|      4 | 2  |    |
|      4 | 2  | 1  |
|      4 | 2  | 2  |
|      4 | 2  | 3  |
|      4 | 2  |    |
|      4 | 3  |    |
|      4 | 3  | 1  |
|      4 | 3  | 2  |
|      4 | 3  | 3  |
|      4 | 3  |    |
|      4 |    |    |
|      4 |    | 1  |
|      4 |    | 2  |
|      4 |    | 3  |
|      4 |    |    |
+--------+----+----+
(77 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A7_B1
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM test_unnest,
     unnest(mv_to_array(c_mv_all_null_and_empty_val)) AS u1(c1),
     unnest(mv_to_array(c_mv_all_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN (''))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A7_B2
#-------------------------------------------------------------------------
SELECT c_long,
       c1,
       c2
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_all_null_and_empty_val)) AS u1(c1)), unnest(mv_to_array(c_mv_all_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN (''))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
+--------+----+----+
(125 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_multi_unnests TEST_ID: A7_B3
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_all_null_and_empty_val)) AS u1(c1))
SELECT c_long,
       c1,
       c2
FROM t1,
     unnest(mv_to_array(c_mv_all_null_and_empty_val)) AS u2(c2)
WHERE (c1 IS NULL
       OR c1 IN (''))
  AND (c2 IS NULL
       OR c2 NOT IN ('doesntexist1',
                     'doesntexist2'))
  AND c_long>=0;
+--------+----+----+
| c_long | c1 | c2 |
+--------+----+----+
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      0 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      1 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      2 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      3 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
|      4 |    |    |
+--------+----+----+
(125 rows)

!ok

