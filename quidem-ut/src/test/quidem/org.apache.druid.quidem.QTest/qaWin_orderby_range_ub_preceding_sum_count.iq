!set useApproximateCountDistinct false
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
SELECT count(*) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+-----+
| cnt |
+-----+
| 768 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W8_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W8_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W8_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W8_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W9_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W9_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W9_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W9_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W10_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W10_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W10_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W10_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W11_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W11_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W11_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W11_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W12_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W12_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W12_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W12_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W13_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W13_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W13_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W13_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W14_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W14_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W14_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W14_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W15_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W15_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W15_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W15_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W16_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W16_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W16_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W16_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W17_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W17_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W17_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W17_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W18_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W18_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W18_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W18_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W19_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W19_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W19_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W19_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W20_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W20_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W20_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W20_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W21_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W21_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W21_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W21_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W22_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (RANGE UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W22_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W22_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (RANGE UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1_sum_count_W22_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE UNBOUNDED PRECEDING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W1_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W1_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W5_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W5_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W5_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W5_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W6_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W6_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W6_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W6_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W7_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W7_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W7_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W7_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W8_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W8_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W8_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W8_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W9_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W9_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W9_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W9_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W10_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W10_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W10_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W10_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W11_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W11_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W11_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W11_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W12_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W12_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W12_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W12_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W13_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W13_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W13_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W13_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W14_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W14_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W14_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W14_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W15_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W15_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W15_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W15_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W16_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W16_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W16_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W16_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W17_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W17_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W17_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W17_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W18_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W18_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W18_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W18_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W19_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W19_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W19_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W19_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W20_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W20_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W20_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W20_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W21_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W21_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W21_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W21_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W22_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W22_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W22_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A2_sum_count_W22_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W1_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W1_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W5_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W5_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W5_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W5_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W6_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W6_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W6_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W6_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W7_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W7_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W7_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W7_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W8_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W8_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W8_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W8_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W9_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W9_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W9_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W9_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W10_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W10_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W10_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W10_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W11_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W11_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W11_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W11_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W12_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W12_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W12_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W12_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W13_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W13_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W13_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W13_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W14_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W14_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W14_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W14_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W15_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W15_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W15_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W15_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W16_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W16_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W16_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W16_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W17_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W17_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W17_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W17_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W18_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W18_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W18_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W18_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W19_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W19_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W19_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W19_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W20_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W20_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W20_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W20_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W21_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W21_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W21_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W21_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W22_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W22_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W22_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A3_sum_count_W22_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W1_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W1_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W5_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W5_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W5_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W5_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W6_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W6_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W6_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W6_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W7_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W7_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W7_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W7_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W8_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W8_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W8_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W8_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W9_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W9_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W9_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W9_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W10_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W10_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W10_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W10_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W11_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W11_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W11_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W11_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W12_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W12_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W12_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W12_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W13_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W13_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W13_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W13_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W14_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W14_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W14_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W14_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W15_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W15_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W15_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W15_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W16_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W16_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W16_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W16_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W17_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W17_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W17_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W17_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W18_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W18_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W18_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W18_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W19_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W19_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W19_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W19_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W20_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W20_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W20_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W20_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W21_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W21_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W21_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W21_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W22_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W22_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W22_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A4_sum_count_W22_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W8_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W8_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W8_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W8_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W9_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W9_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W9_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W9_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W10_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W10_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W10_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W10_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W11_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W11_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W11_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W11_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W12_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W12_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W12_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W12_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W13_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W13_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W13_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W13_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W14_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W14_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W14_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W14_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       9 |       3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W15_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W15_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W15_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W15_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W16_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W16_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W16_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W16_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      12 |       4 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      21 |       7 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W17_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W17_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W17_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W17_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W18_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W18_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W18_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W18_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      15 |       5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |       9 |       3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       3 |       1 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W19_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W19_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W19_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W19_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W20_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W20_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W20_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W20_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      12 |       4 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W21_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W21_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W21_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W21_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W22_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W22_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W22_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5_sum_count_W22_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W1_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W1_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W5_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W5_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W5_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W5_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W6_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W6_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W6_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W6_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W7_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W7_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W7_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W7_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W8_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W8_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W8_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W8_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W9_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W9_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W9_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W9_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W10_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W10_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W10_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W10_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W11_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W11_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W11_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W11_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W12_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W12_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W12_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W12_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W13_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W13_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W13_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W13_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W14_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W14_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W14_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W14_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W15_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W15_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W15_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W15_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W16_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W16_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W16_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W16_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W17_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W17_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W17_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W17_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W18_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W18_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W18_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W18_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W19_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W19_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W19_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W19_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W20_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W20_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W20_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W20_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W21_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W21_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W21_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W21_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W22_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W22_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W22_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A6_sum_count_W22_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 0 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W1_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W1_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W2_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W2_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W3_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W3_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W4_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W4_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W5_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W5_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W5_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W5_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W6_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W6_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W6_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W6_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W7_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W7_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W7_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W7_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W8_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W8_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W8_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W8_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W9_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W9_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W9_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W9_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W10_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W10_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W10_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W10_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W11_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W11_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W11_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W11_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W12_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W12_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W12_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W12_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W13_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W13_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W13_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W13_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W14_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W14_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W14_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W14_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W15_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W15_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W15_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W15_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W16_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W16_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W16_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W16_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W17_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W17_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W17_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W17_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W18_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W18_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W18_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W18_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W19_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W19_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W19_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W19_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W20_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W20_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W20_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W20_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W21_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W21_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W21_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W21_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W22_G1_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W22_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W22_G2_Q1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A7_sum_count_W22_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W8_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W8_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W8_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W8_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W9_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W9_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W9_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W9_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W10_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W10_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W10_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W10_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W11_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W11_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W11_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W11_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W12_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W12_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W12_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W12_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W13_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W13_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W13_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W13_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W14_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W14_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W14_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W14_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W15_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W15_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W15_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W15_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W16_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W16_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W16_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip, time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W16_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           time_floor(__time, 'PT12H') DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W17_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W17_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W17_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W17_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W18_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W18_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W18_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W18_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W19_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W19_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                               timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W19_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W19_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                                                  timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W20_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W20_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W20_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (
                                   ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (
                             ORDER BY server_ip DESC, length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W20_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           length(server_ip) DESC, cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                                                   timezone RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W21_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W21_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W21_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W21_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      18 |       6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |       6 |       2 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W22_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W22_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W22_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) "sum_val",
       count(timezone) OVER (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8_sum_count_W22_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       sum(length(timezone)) OVER w "sum_val",
       count(timezone) OVER w cnt_val
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+---------+---------+
| server_ip    | client_ip     | timezone | t                   | sum_val | cnt_val |
+--------------+---------------+----------+---------------------+---------+---------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      24 |       8 |
+--------------+---------------+----------+---------------------+---------+---------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 705 Positive tests: 265 Negative tests: 440
#-------------------------------------------------------------------------
