!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=AllDruidEnginesComponentSupplier&datasets=sql/src/test/quidem/qatests/qaAggFuncs
!set outputformat mysql
#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: SEL_DATASOURCE
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_agg_funcs;
+-----+
| cnt |
+-----+
|  18 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A01
#-------------------------------------------------------------------------
SELECT string_agg(timestamp '2020-01-01 01:01:01.000', '|') AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A02
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(__time, '|') AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A03
#-------------------------------------------------------------------------
SELECT string_agg(__time, '|') || '-1583024461000' AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000-1583024461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A04
#-------------------------------------------------------------------------
SELECT '1583024461000-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A05
#-------------------------------------------------------------------------
SELECT string_agg(__time, ',') || '-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A06
#-------------------------------------------------------------------------
SELECT concat(string_agg(__time, ','), '-', string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A07
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, '|'), '-1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000-1583024461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A08
#-------------------------------------------------------------------------
SELECT textcat('1583024461000-', string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A09
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, ','), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,15778404610001577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A10
#-------------------------------------------------------------------------
SELECT string_format('%s-%s', string_agg(__time, ','), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A11
#-------------------------------------------------------------------------
SELECT length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A12
#-------------------------------------------------------------------------
SELECT char_length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A13
#-------------------------------------------------------------------------
SELECT character_length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A14
#-------------------------------------------------------------------------
SELECT character_length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A15
#-------------------------------------------------------------------------
SELECT lower(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A16
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(__time, '|'), 16) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A17
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A18
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(__time, '|')
                FROM 20) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|  29 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A19
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(__time, '|'), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A20
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(__time, '|'), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A21
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(__time, '|'), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A22
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(__time, '|'), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A23
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(__time, '|'), '1577840461000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A24
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(__time, '|'), '1580518861000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A25
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(__time, '|'), '1577840461000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A26
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(__time, '|'), '1580518861000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A27
#-------------------------------------------------------------------------
SELECT replace(string_agg(__time, '|'), '1577840461000', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A28
#-------------------------------------------------------------------------
SELECT replace(string_agg(__time, '|'), '4444444444', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A29
#-------------------------------------------------------------------------
SELECT strpos(string_agg(__time, '|'), '|1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|  14 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A30
#-------------------------------------------------------------------------
SELECT strpos(string_agg(__time, '|'), '|4444444444') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A31
#-------------------------------------------------------------------------
SELECT substring(string_agg(__time, '|'), 15) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------+
| col                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A32
#-------------------------------------------------------------------------
SELECT substring(string_agg(__time, '|'), 15, 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A33
#-------------------------------------------------------------------------
SELECT trim(BOTH
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A34
#-------------------------------------------------------------------------
SELECT trim(LEADING
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A35
#-------------------------------------------------------------------------
SELECT trim(TRAILING
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A36
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890'
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------+
| col                                                                                                 |
+-----------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+-----------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A37
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890'
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A38
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890'
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A39
#-------------------------------------------------------------------------
SELECT btrim(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A40
#-------------------------------------------------------------------------
SELECT btrim(string_agg(__time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------+
| col                                                                                                 |
+-----------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+-----------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A41
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A42
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(__time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A43
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A44
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(__time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A45
#-------------------------------------------------------------------------
SELECT upper(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A46
#-------------------------------------------------------------------------
SELECT reverse(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A47
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|'), -1) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A48
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|'), 0) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A49
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|'), 2) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|15778404610001577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

