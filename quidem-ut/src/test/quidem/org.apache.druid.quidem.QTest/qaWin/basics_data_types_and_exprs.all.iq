!set dartQueryId 00000000-0000-0000-0000-000000000000
!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardAndMSQComponentSupplier&datasets=sql/src/test/quidem/qatests/qaWin
!set outputformat mysql
#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: SEL_DATASOURCE
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+-----+
| cnt |
+-----+
| 768 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A1_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY timezone
                          ORDER BY server_ip, timezone, timezone) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A1_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY timezone
                                               ORDER BY server_ip,
                                                        timezone,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A1_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY timezone
                          ORDER BY server_ip, timezone, timezone) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A1_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY timezone
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A2_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A2_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY length(timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A2_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A2_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY length(timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A3_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY cos(length(timezone))
                          ORDER BY server_ip, timezone, cos(length(timezone))) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A3_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY cos(length(timezone))
                                               ORDER BY server_ip,
                                                        timezone,
                                                        cos(length(timezone)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A3_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY cos(length(timezone))
                          ORDER BY server_ip, timezone, cos(length(timezone))) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A3_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY cos(length(timezone))
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           cos(length(timezone)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A4_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY (timezone IS NULL)
                          ORDER BY server_ip, timezone, (timezone IS NULL)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A4_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY (timezone IS NULL)
                                               ORDER BY server_ip,
                                                        timezone, (timezone IS NULL));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A4_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY (timezone IS NULL)
                          ORDER BY server_ip, timezone, (timezone IS NULL)) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A4_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY (timezone IS NULL)
                                                  ORDER BY server_ip,
                                                           timezone, (timezone IS NULL));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A5_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY time_parse(cast(length(timezone) AS char))
                          ORDER BY server_ip, timezone, time_parse(cast(length(timezone) AS char))) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A5_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY time_parse(cast(length(timezone) AS char))
                                               ORDER BY server_ip,
                                                        timezone,
                                                        time_parse(cast(length(timezone) AS char)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A5_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY time_parse(cast(length(timezone) AS char))
                          ORDER BY server_ip, timezone, time_parse(cast(length(timezone) AS char))) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A5_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY time_parse(cast(length(timezone) AS char))
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           time_parse(cast(length(timezone) AS char)));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A6_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY json_object('key': 'k', 'value': timezone)
                          ORDER BY server_ip, timezone, json_object('key': 'k', 'value': timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A6_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY json_object('key': 'k', 'value': timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        json_object('key': 'k', 'value': timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A6_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY json_object('key': 'k', 'value': timezone)
                          ORDER BY server_ip, timezone, json_object('key': 'k', 'value': timezone)) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A6_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY json_object('key': 'k', 'value': timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           json_object('key': 'k', 'value': timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A7_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array['A', 'B', timezone]
                          ORDER BY server_ip, timezone, array['A', 'B', timezone]) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A7_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY array['A',
                                                                  'B',
                                                                  timezone]
                                               ORDER BY server_ip,
                                                        timezone, array['A',
                                                                        'B',
                                                                        timezone]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A7_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array['A', 'B', timezone]
                          ORDER BY server_ip, timezone, array['A', 'B', timezone]) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A7_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY array['A',
                                                                     'B',
                                                                     timezone]
                                                  ORDER BY server_ip,
                                                           timezone, array['A',
                                                                           'B',
                                                                           timezone]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A8_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array[1, 2, length(timezone)]
                          ORDER BY server_ip, timezone, array[1, 2, length(timezone)]) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A8_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY array[1,
                                                                  2,
                                                                  length(timezone)]
                                               ORDER BY server_ip,
                                                        timezone, array[1,
                                                                        2,
                                                                        length(timezone)]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A8_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array[1, 2, length(timezone)]
                          ORDER BY server_ip, timezone, array[1, 2, length(timezone)]) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A8_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY array[1,
                                                                     2,
                                                                     length(timezone)]
                                                  ORDER BY server_ip,
                                                           timezone, array[1,
                                                                           2,
                                                                           length(timezone)]);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A9_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY string_to_mv('1,2,3', ',')
                          ORDER BY server_ip, timezone, string_to_mv('1,2,3', ',')) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A9_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY string_to_mv('1,2,3', ',')
                                               ORDER BY server_ip,
                                                        timezone,
                                                        string_to_mv('1,2,3', ','));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A9_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY string_to_mv('1,2,3', ',')
                          ORDER BY server_ip, timezone, string_to_mv('1,2,3', ',')) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A9_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY string_to_mv('1,2,3', ',')
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           string_to_mv('1,2,3', ','));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A10_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array_to_mv(array['A', 'B', timezone])
                          ORDER BY server_ip, timezone, array_to_mv(array['A', 'B', timezone])) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A10_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY array_to_mv(array['A', 'B', timezone])
                                               ORDER BY server_ip,
                                                        timezone,
                                                        array_to_mv(array['A', 'B', timezone]));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A10_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY array_to_mv(array['A', 'B', timezone])
                          ORDER BY server_ip, timezone, array_to_mv(array['A', 'B', timezone])) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A10_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY array_to_mv(array['A', 'B', timezone])
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           array_to_mv(array['A', 'B', timezone]));
Window processing does not support MVDs. Consider using UNNEST or MV_TO_ARRAY.
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A12_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)+length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)+length(timezone)) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A12_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY length(timezone)+length(timezone)
                                               ORDER BY server_ip,
                                                        timezone,
                                                        length(timezone)+length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A12_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER (PARTITION BY length(timezone)+length(timezone)
                          ORDER BY server_ip, timezone, length(timezone)+length(timezone)) AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_data_types_and_exprs TEST_ID: A12_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       row_number() OVER w AS c
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY length(timezone)+length(timezone)
                                                  ORDER BY server_ip,
                                                           timezone,
                                                           length(timezone)+length(timezone));
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 7 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

