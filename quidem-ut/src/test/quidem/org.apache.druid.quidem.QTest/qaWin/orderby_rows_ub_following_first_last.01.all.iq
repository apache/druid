!set dartQueryId 00000000-0000-0000-0000-000000000000
!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardAndMSQComponentSupplier&datasets=sql/src/test/quidem/qatests/qaWin
!set outputformat mysql
#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: SEL_DATASOURCE
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+-----+
| cnt |
+-----+
| 768 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W1_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W1_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W1_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W1_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W2_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W2_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip DESC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W2_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W2_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip DESC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W3_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W3_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip ASC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W3_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY server_ip ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W3_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip ASC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W4_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W4_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip DESC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W4_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY server_ip DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W4_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip DESC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W5_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W5_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W5_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W5_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W6_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W6_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W6_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W6_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W7_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W7_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W7_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W7_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) ASC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W8_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W8_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W8_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W8_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY length(server_ip) DESC, timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W9_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W9_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W9_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W9_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W10_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W10_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W10_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W10_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W11_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W11_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W11_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W11_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 ASC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W12_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W12_G1_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                        timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W12_G2_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (
                                   ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (
                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W12_G2_Q2
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w first_val,
       last_value(timezone) OVER w last_val
FROM test_win
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY cast(length(server_ip) AS DOUBLE)+0.123 DESC,
                                                           timezone ROWS UNBOUNDED FOLLOWING);
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_first_last_W13_G1_Q1
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone ROWS UNBOUNDED FOLLOWING) first_val,
       last_value(timezone) OVER (PARTITION BY client_ip
                                  ORDER BY server_ip, time_floor(__time, 'PT12H') ASC, timezone ROWS UNBOUNDED FOLLOWING) last_val
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          count(*)
   FROM test_win
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-----------+----------+
| server_ip    | client_ip     | timezone | t                   | first_val | last_val |
+--------------+---------------+----------+---------------------+-----------+----------+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT       | N/A      |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A       | N/A      |
+--------------+---------------+----------+---------------------+-----------+----------+
(8 rows)

!ok

