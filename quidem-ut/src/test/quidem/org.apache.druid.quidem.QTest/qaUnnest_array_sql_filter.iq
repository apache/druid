!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardComponentSupplier&datasets=sql/src/test/quidem/qatests/qaUnnest/array&numMergeBuffers=3
!set outputformat mysql
SELECT *
FROM test_unnest;
+-------------------------+-------+--------+--------------+--------------+------------------+----------------+--------------------+---------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| __time                  | s_int | s_null | a_bool       | a_int        | a_float          | a_str          | a_null             | a_empty | a_mixed                  | a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------+-------+--------+--------------+--------------+------------------+----------------+--------------------+---------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2022-01-01 00:00:00.000 |     1 |        | [1, 0, null] | [1, 2, null] | [0.1, 0.2, null] | [S1, S2, null] | [null, null, null] | []      | [true, 1, 0.1, S1, null] | [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| 2022-02-01 00:00:00.000 |     2 |        | [null, 1, 0] | [null, 1, 2] | [null, 0.1, 0.2] | [null, S1, S2] | [null, null, null] | []      | [null, true, 1, 0.1, S1] | [[null,true,false],[null,1,2],[null,0.1,0.2],[null,"S1","S2"],[null,null,null],[],[null,true,1,0.1,"S1"],[[null,true,false],[null,1,2],[null,0.1,0.2],[null,"S1","S2"],[null,null,null],[],[null,true,1,0.1,"S1"],[[null,true,false],[null,1,2],[null,0.1,0.2],[null,"S1","S2"],[null,null,null],[],[null,true,1,0.1,"S1"]]]] |
| 2022-03-01 00:00:00.000 |       |        | [0, null, 1] | [2, null, 1] | [0.2, null, 0.1] | [S2, null, S1] | [null, null, null] | []      | [S1, null, true, 1, 0.1] | [[false,null,true],[2,null,1],[0.2,null,0.1],["S2",null,"S1"],[null,null,null],[],["S1",null,true,1,0.1],[[false,null,true],[2,null,1],[0.2,null,0.1],["S2",null,"S1"],[null,null,null],[],["S1",null,true,1,0.1],[[false,null,true],[2,null,1],[0.2,null,0.1],["S2",null,"S1"],[null,null,null],[],["S1",null,true,1,0.1]]]] |
+-------------------------+-------+--------+--------------+--------------+------------------+----------------+--------------------+---------+--------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c=1);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c=1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c<>1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c<>1);
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<>1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c<>1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c<>1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c>1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c>1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c>1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c>1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c>=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c>=1);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>=1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c>=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c>=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c<1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c<1);
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c<1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c<1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c<=1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c<=1);
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<=1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c<=1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c<=1;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (NOT c<>1
       OR NOT c<>998)
  AND (NOT c=0
       OR NOT c=999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (NOT c<>1
          OR NOT c<>998)
     AND (NOT c=0
          OR NOT c=999));
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT c<>1
          OR NOT c<>998)
     AND (NOT c=0
          OR NOT c=999)), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (NOT c<>1
       OR NOT c<>998)
  AND (NOT c=0
       OR NOT c=999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (NOT c<>1
       OR NOT c<>998)
  AND (NOT c=0
       OR NOT c=999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (c=1
       OR c=998)
  AND NOT c=0
  AND NOT c=999;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (c=1
          OR c=998)
     AND NOT c=0
     AND NOT c=999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c=1
          OR c=998)
     AND NOT c=0
     AND NOT c=999), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (c=1
       OR c=998)
  AND NOT c=0
  AND NOT c=999;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (c=1
       OR c=998)
  AND NOT c=0
  AND NOT c=999;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c IS NULL);
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NULL), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c IS NOT NULL);
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NOT NULL), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
| 1 |
| 1 |
| 1 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c IN (1,
            998) IS TRUE
  AND c IN (0,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c IN (1,
               998) IS TRUE
     AND c IN (0,
               999) IS NOT TRUE);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (1,
               998) IS TRUE
     AND c IN (0,
               999) IS NOT TRUE), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c IN (1,
            998) IS TRUE
  AND c IN (0,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c IN (1,
            998) IS TRUE
  AND c IN (0,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c IN (1,
            998) IS FALSE
  AND c IN (0,
            999) IS NOT FALSE;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c IN (1,
               998) IS FALSE
     AND c IN (0,
               999) IS NOT FALSE);
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (1,
               998) IS FALSE
     AND c IN (0,
               999) IS NOT FALSE), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c IN (1,
            998) IS FALSE
  AND c IN (0,
            999) IS NOT FALSE;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c IN (1,
            998) IS FALSE
  AND c IN (0,
            999) IS NOT FALSE;
+---+
| c |
+---+
| 0 |
| 0 |
| 0 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (c BETWEEN 1 AND 2)
  AND (c NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (c BETWEEN 1 AND 2)
     AND (c NOT BETWEEN 3 AND 4));
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c BETWEEN 1 AND 2)
     AND (c NOT BETWEEN 3 AND 4)), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (c BETWEEN 1 AND 2)
  AND (c NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (c BETWEEN 1 AND 2)
  AND (c NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%3%'));
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c IN (1,
            998)
  AND c NOT IN (0,
                999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c IN (1,
               998)
     AND c NOT IN (0,
                   999));
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (1,
               998)
     AND c NOT IN (0,
                   999)), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c IN (1,
            998)
  AND c NOT IN (0,
                999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c IN (1,
            998)
  AND c NOT IN (0,
                999);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES(1),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE c IN
       (SELECT col
        FROM (
              VALUES(1),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0),(999)) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN
       (SELECT col
        FROM (
              VALUES(1),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0),(999)) AS t(col))), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE c IN
    (SELECT col
     FROM (
           VALUES(1),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES(1),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int=1
  AND c=1;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int=1
     AND c=1);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1
     AND c=1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int=1
  AND c=1;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int=1
  AND c=1;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int<>1
  AND c<>1;
+---+
| c |
+---+
| 0 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int<>1
     AND c<>1);
+---+
| c |
+---+
| 0 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1
     AND c<>1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int<>1
  AND c<>1;
+---+
| c |
+---+
| 0 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int<>1
  AND c<>1;
+---+
| c |
+---+
| 0 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int>1
  AND c>1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int>1
     AND c>1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1
     AND c>1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int>1
  AND c>1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int>1
  AND c>1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int>=1
  AND c>=1;
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int>=1
     AND c>=1);
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1
     AND c>=1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int>=1
  AND c>=1;
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int>=1
  AND c>=1;
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int<1
  AND c<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int<1
     AND c<1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1
     AND c<1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int<1
  AND c<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int<1
  AND c<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int<=1
  AND c<=1;
+---+
| c |
+---+
| 0 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int<=1
     AND c<=1);
+---+
| c |
+---+
| 0 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1
     AND c<=1), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int<=1
  AND c<=1;
+---+
| c |
+---+
| 0 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int<=1
  AND c<=1;
+---+
| c |
+---+
| 0 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>1
       OR NOT c<>998)
  AND (NOT c=0
       OR NOT c=999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)
     AND (NOT c<>1
          OR NOT c<>998)
     AND (NOT c=0
          OR NOT c=999));
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)
     AND (NOT c<>1
          OR NOT c<>998)
     AND (NOT c=0
          OR NOT c=999)), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>1
       OR NOT c<>998)
  AND (NOT c=0
       OR NOT c=999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>1
       OR NOT c<>998)
  AND (NOT c=0
       OR NOT c=999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=1
       OR c=998)
  AND NOT c=0
  AND NOT c=999;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999
     AND (c=1
          OR c=998)
     AND NOT c=0
     AND NOT c=999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999
     AND (c=1
          OR c=998)
     AND NOT c=0
     AND NOT c=999), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=1
       OR c=998)
  AND NOT c=0
  AND NOT c=999;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=1
       OR c=998)
  AND NOT c=0
  AND NOT c=999;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IS NULL
     AND c IS NULL);
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL
     AND c IS NULL), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (1,
            998) IS TRUE
  AND c IN (0,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN (1,
               998) IS TRUE
     AND c IN (0,
               999) IS NOT TRUE);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN (1,
               998) IS TRUE
     AND c IN (0,
               999) IS NOT TRUE), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (1,
            998) IS TRUE
  AND c IN (0,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (1,
            998) IS TRUE
  AND c IN (0,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (1,
            998) IS FALSE
  AND c IN (0,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN (1,
               998) IS FALSE
     AND c IN (0,
               999) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN (1,
               998) IS FALSE
     AND c IN (0,
               999) IS NOT FALSE), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (1,
            998) IS FALSE
  AND c IN (0,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (1,
            998) IS FALSE
  AND c IN (0,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 1 AND 2)
  AND (c NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 1 AND 2)
     AND (c NOT BETWEEN 3 AND 4));
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 1 AND 2)
     AND (c NOT BETWEEN 3 AND 4)), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 1 AND 2)
  AND (c NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 1 AND 2)
  AND (c NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%3%'));
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (1,
            998)
  AND c NOT IN (0,
                999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN (1,
               998)
     AND c NOT IN (0,
                   999));
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN (1,
               998)
     AND c NOT IN (0,
                   999)), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (1,
            998)
  AND c NOT IN (0,
                999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (1,
            998)
  AND c NOT IN (0,
                999);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(1),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES(1),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0),(999)) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES(1),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0),(999)) AS t(col))), unnest(a_bool) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(1),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(1),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int=1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int=1);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int=1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int=1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int<>1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int<>1);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int<>1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int<>1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int>1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int>1);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int>1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int>1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int>=1;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int>=1);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int>=1;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int>=1;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int<1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1), unnest(a_bool) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int<=1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int<=1);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int<=1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int<=1;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IS NULL;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IS NULL);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IS NULL;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IS NULL;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IS NOT NULL);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IS NOT NULL;
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE), unnest(a_bool) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4));
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 0 |
| 0 |
| 1 |
| 1 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%'));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B47_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B47_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B47_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B47_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B47_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B48_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_bool) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B48_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col)));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B48_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))), unnest(a_bool) AS u(c);
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B48_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_bool) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B48_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_bool) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+---+
| c |
+---+
| 0 |
| 1 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c=2;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c=2);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c=2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c=2;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c=2;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c<>2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c<>2);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<>2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c<>2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c<>2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c>2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c>2);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c>2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c>2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c>=2;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c>=2);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>=2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c>=2;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c>=2;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c<2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c<2);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c<2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c<2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c<=2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c<=2);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<=2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c<=2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c<=2;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (NOT c<>2
       OR NOT c<>998)
  AND (NOT c=1
       OR NOT c=999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (NOT c<>2
          OR NOT c<>998)
     AND (NOT c=1
          OR NOT c=999));
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT c<>2
          OR NOT c<>998)
     AND (NOT c=1
          OR NOT c=999)), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (NOT c<>2
       OR NOT c<>998)
  AND (NOT c=1
       OR NOT c=999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (NOT c<>2
       OR NOT c<>998)
  AND (NOT c=1
       OR NOT c=999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (c=2
       OR c=998)
  AND NOT c=1
  AND NOT c=999;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (c=2
          OR c=998)
     AND NOT c=1
     AND NOT c=999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c=2
          OR c=998)
     AND NOT c=1
     AND NOT c=999), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (c=2
       OR c=998)
  AND NOT c=1
  AND NOT c=999;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (c=2
       OR c=998)
  AND NOT c=1
  AND NOT c=999;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c IS NULL);
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NULL), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c IS NOT NULL);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NOT NULL), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
| 2 |
| 2 |
| 2 |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c IN (2,
            998) IS TRUE
  AND c IN (1,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c IN (2,
               998) IS TRUE
     AND c IN (1,
               999) IS NOT TRUE);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (2,
               998) IS TRUE
     AND c IN (1,
               999) IS NOT TRUE), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c IN (2,
            998) IS TRUE
  AND c IN (1,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c IN (2,
            998) IS TRUE
  AND c IN (1,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c IN (2,
            998) IS FALSE
  AND c IN (1,
            999) IS NOT FALSE;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c IN (2,
               998) IS FALSE
     AND c IN (1,
               999) IS NOT FALSE);
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (2,
               998) IS FALSE
     AND c IN (1,
               999) IS NOT FALSE), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c IN (2,
            998) IS FALSE
  AND c IN (1,
            999) IS NOT FALSE;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c IN (2,
            998) IS FALSE
  AND c IN (1,
            999) IS NOT FALSE;
+---+
| c |
+---+
| 1 |
| 1 |
| 1 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (c BETWEEN 2 AND 3)
  AND (c NOT BETWEEN 4 AND 5);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (c BETWEEN 2 AND 3)
     AND (c NOT BETWEEN 4 AND 5));
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c BETWEEN 2 AND 3)
     AND (c NOT BETWEEN 4 AND 5)), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (c BETWEEN 2 AND 3)
  AND (c NOT BETWEEN 4 AND 5);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (c BETWEEN 2 AND 3)
  AND (c NOT BETWEEN 4 AND 5);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%'));
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c IN (2,
            998)
  AND c NOT IN (1,
                999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c IN (2,
               998)
     AND c NOT IN (1,
                   999));
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (2,
               998)
     AND c NOT IN (1,
                   999)), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c IN (2,
            998)
  AND c NOT IN (1,
                999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c IN (2,
            998)
  AND c NOT IN (1,
                999);
+---+
| c |
+---+
| 2 |
| 2 |
| 2 |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES(2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE c IN
       (SELECT col
        FROM (
              VALUES(2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(1),(999)) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN
       (SELECT col
        FROM (
              VALUES(2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(1),(999)) AS t(col))), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE c IN
    (SELECT col
     FROM (
           VALUES(2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES(2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int=1
  AND c=2;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int=1
     AND c=2);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1
     AND c=2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int=1
  AND c=2;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int=1
  AND c=2;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int<>1
  AND c<>2;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int<>1
     AND c<>2);
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1
     AND c<>2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int<>1
  AND c<>2;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int<>1
  AND c<>2;
+---+
| c |
+---+
| 1 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int>1
  AND c>2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int>1
     AND c>2);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1
     AND c>2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int>1
  AND c>2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int>1
  AND c>2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int>=1
  AND c>=2;
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int>=1
     AND c>=2);
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1
     AND c>=2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int>=1
  AND c>=2;
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int>=1
  AND c>=2;
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int<1
  AND c<2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int<1
     AND c<2);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1
     AND c<2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int<1
  AND c<2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int<1
  AND c<2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int<=1
  AND c<=2;
+---+
| c |
+---+
| 1 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int<=1
     AND c<=2);
+---+
| c |
+---+
| 1 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1
     AND c<=2), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int<=1
  AND c<=2;
+---+
| c |
+---+
| 1 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int<=1
  AND c<=2;
+---+
| c |
+---+
| 1 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>2
       OR NOT c<>998)
  AND (NOT c=1
       OR NOT c=999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)
     AND (NOT c<>2
          OR NOT c<>998)
     AND (NOT c=1
          OR NOT c=999));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)
     AND (NOT c<>2
          OR NOT c<>998)
     AND (NOT c=1
          OR NOT c=999)), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>2
       OR NOT c<>998)
  AND (NOT c=1
       OR NOT c=999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>2
       OR NOT c<>998)
  AND (NOT c=1
       OR NOT c=999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=2
       OR c=998)
  AND NOT c=1
  AND NOT c=999;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999
     AND (c=2
          OR c=998)
     AND NOT c=1
     AND NOT c=999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999
     AND (c=2
          OR c=998)
     AND NOT c=1
     AND NOT c=999), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=2
       OR c=998)
  AND NOT c=1
  AND NOT c=999;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=2
       OR c=998)
  AND NOT c=1
  AND NOT c=999;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IS NULL
     AND c IS NULL);
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL
     AND c IS NULL), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
+---+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (2,
            998) IS TRUE
  AND c IN (1,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN (2,
               998) IS TRUE
     AND c IN (1,
               999) IS NOT TRUE);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN (2,
               998) IS TRUE
     AND c IN (1,
               999) IS NOT TRUE), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (2,
            998) IS TRUE
  AND c IN (1,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (2,
            998) IS TRUE
  AND c IN (1,
            999) IS NOT TRUE;
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (2,
            998) IS FALSE
  AND c IN (1,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN (2,
               998) IS FALSE
     AND c IN (1,
               999) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN (2,
               998) IS FALSE
     AND c IN (1,
               999) IS NOT FALSE), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (2,
            998) IS FALSE
  AND c IN (1,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (2,
            998) IS FALSE
  AND c IN (1,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 2 AND 3)
  AND (c NOT BETWEEN 4 AND 5);
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 2 AND 3)
     AND (c NOT BETWEEN 4 AND 5));
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 2 AND 3)
     AND (c NOT BETWEEN 4 AND 5)), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 2 AND 3)
  AND (c NOT BETWEEN 4 AND 5);
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 2 AND 3)
  AND (c NOT BETWEEN 4 AND 5);
+---+
| c |
+---+
| 2 |
| 2 |
+---+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%'));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (2,
            998)
  AND c NOT IN (1,
                999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN (2,
               998)
     AND c NOT IN (1,
                   999));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN (2,
               998)
     AND c NOT IN (1,
                   999)), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (2,
            998)
  AND c NOT IN (1,
                999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (2,
            998)
  AND c NOT IN (1,
                999);
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES(2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(1),(999)) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES(2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(1),(999)) AS t(col))), unnest(a_int) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int=1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int=1);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int=1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int=1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int<>1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int<>1);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int<>1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int<>1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int>1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int>1);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int>1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int>1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int>=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int>=1);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int>=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int>=1;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int<1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1), unnest(a_int) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int<=1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int<=1);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int<=1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int<=1;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IS NULL;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IS NULL);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IS NULL;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IS NULL;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IS NOT NULL);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IS NOT NULL;
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE), unnest(a_int) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4));
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+---+
| c |
+---+
| 1 |
| 1 |
| 2 |
| 2 |
|   |
|   |
+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%'));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B47_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B47_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B47_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B47_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B47_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B48_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_int) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B48_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col)));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B48_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))), unnest(a_int) AS u(c);
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B48_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_int) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B48_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_int) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+---+
| c |
+---+
| 1 |
| 2 |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c=0.2);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c=0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c<>0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c<>0.2);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<>0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c<>0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c<>0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c>0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c>0.2);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c>0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c>0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c>=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c>=0.2);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>=0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c>=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c>=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c<0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c<0.2);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c<0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c<0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c<=0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c<=0.2);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<=0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c<=0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c<=0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (NOT c<>0.2
       OR NOT c<>998)
  AND (NOT c=0.1
       OR NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (NOT c<>0.2
          OR NOT c<>998)
     AND (NOT c=0.1
          OR NOT c=999));
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT c<>0.2
          OR NOT c<>998)
     AND (NOT c=0.1
          OR NOT c=999)), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (NOT c<>0.2
       OR NOT c<>998)
  AND (NOT c=0.1
       OR NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (NOT c<>0.2
       OR NOT c<>998)
  AND (NOT c=0.1
       OR NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (c=0.2
       OR c=998)
  AND NOT c=0.1
  AND NOT c=999;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (c=0.2
          OR c=998)
     AND NOT c=0.1
     AND NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c=0.2
          OR c=998)
     AND NOT c=0.1
     AND NOT c=999), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (c=0.2
       OR c=998)
  AND NOT c=0.1
  AND NOT c=999;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (c=0.2
       OR c=998)
  AND NOT c=0.1
  AND NOT c=999;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c IS NULL);
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NULL), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c IS NOT NULL);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NOT NULL), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c IN (0.2,
            998) IS TRUE
  AND c IN (0.1,
            999) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c IN (0.2,
               998) IS TRUE
     AND c IN (0.1,
               999) IS NOT TRUE);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (0.2,
               998) IS TRUE
     AND c IN (0.1,
               999) IS NOT TRUE), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c IN (0.2,
            998) IS TRUE
  AND c IN (0.1,
            999) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c IN (0.2,
            998) IS TRUE
  AND c IN (0.1,
            999) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c IN (0.2,
            998) IS FALSE
  AND c IN (0.1,
            999) IS NOT FALSE;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c IN (0.2,
               998) IS FALSE
     AND c IN (0.1,
               999) IS NOT FALSE);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (0.2,
               998) IS FALSE
     AND c IN (0.1,
               999) IS NOT FALSE), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c IN (0.2,
            998) IS FALSE
  AND c IN (0.1,
            999) IS NOT FALSE;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c IN (0.2,
            998) IS FALSE
  AND c IN (0.1,
            999) IS NOT FALSE;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (c BETWEEN 0.2 AND 0.3)
  AND (c NOT BETWEEN 0.4 AND 0.5);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (c BETWEEN 0.2 AND 0.3)
     AND (c NOT BETWEEN 0.4 AND 0.5));
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c BETWEEN 0.2 AND 0.3)
     AND (c NOT BETWEEN 0.4 AND 0.5)), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (c BETWEEN 0.2 AND 0.3)
  AND (c NOT BETWEEN 0.4 AND 0.5);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (c BETWEEN 0.2 AND 0.3)
  AND (c NOT BETWEEN 0.4 AND 0.5);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%'));
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c IN (0.2,
            998)
  AND c NOT IN (0.1,
                999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c IN (0.2,
               998)
     AND c NOT IN (0.1,
                   999));
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN (0.2,
               998)
     AND c NOT IN (0.1,
                   999)), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c IN (0.2,
            998)
  AND c NOT IN (0.1,
                999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c IN (0.2,
            998)
  AND c NOT IN (0.1,
                999);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
| 0.2 |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES(0.2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0.1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE c IN
       (SELECT col
        FROM (
              VALUES(0.2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0.1),(999)) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN
       (SELECT col
        FROM (
              VALUES(0.2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0.1),(999)) AS t(col))), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE c IN
    (SELECT col
     FROM (
           VALUES(0.2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0.1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES(0.2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0.1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int=1
  AND c=0.2;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int=1
     AND c=0.2);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1
     AND c=0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int=1
  AND c=0.2;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int=1
  AND c=0.2;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int<>1
  AND c<>0.2;
+-----+
| c   |
+-----+
| 0.1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int<>1
     AND c<>0.2);
+-----+
| c   |
+-----+
| 0.1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1
     AND c<>0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int<>1
  AND c<>0.2;
+-----+
| c   |
+-----+
| 0.1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int<>1
  AND c<>0.2;
+-----+
| c   |
+-----+
| 0.1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int>1
  AND c>0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int>1
     AND c>0.2);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1
     AND c>0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int>1
  AND c>0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int>1
  AND c>0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int>=1
  AND c>=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int>=1
     AND c>=0.2);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1
     AND c>=0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int>=1
  AND c>=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int>=1
  AND c>=0.2;
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int<1
  AND c<0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int<1
     AND c<0.2);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1
     AND c<0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int<1
  AND c<0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int<1
  AND c<0.2;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int<=1
  AND c<=0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int<=1
     AND c<=0.2);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1
     AND c<=0.2), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int<=1
  AND c<=0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int<=1
  AND c<=0.2;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>0.2
       OR NOT c<>998)
  AND (NOT c=0.1
       OR NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)
     AND (NOT c<>0.2
          OR NOT c<>998)
     AND (NOT c=0.1
          OR NOT c=999));
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)
     AND (NOT c<>0.2
          OR NOT c<>998)
     AND (NOT c=0.1
          OR NOT c=999)), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>0.2
       OR NOT c<>998)
  AND (NOT c=0.1
       OR NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999)
  AND (NOT c<>0.2
       OR NOT c<>998)
  AND (NOT c=0.1
       OR NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=0.2
       OR c=998)
  AND NOT c=0.1
  AND NOT c=999;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999
     AND (c=0.2
          OR c=998)
     AND NOT c=0.1
     AND NOT c=999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999
     AND (c=0.2
          OR c=998)
     AND NOT c=0.1
     AND NOT c=999), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=0.2
       OR c=998)
  AND NOT c=0.1
  AND NOT c=999;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999
  AND (c=0.2
       OR c=998)
  AND NOT c=0.1
  AND NOT c=999;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IS NULL
     AND c IS NULL);
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL
     AND c IS NULL), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (0.2,
            998) IS TRUE
  AND c IN (0.1,
            999) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN (0.2,
               998) IS TRUE
     AND c IN (0.1,
               999) IS NOT TRUE);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN (0.2,
               998) IS TRUE
     AND c IN (0.1,
               999) IS NOT TRUE), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (0.2,
            998) IS TRUE
  AND c IN (0.1,
            999) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN (0.2,
            998) IS TRUE
  AND c IN (0.1,
            999) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (0.2,
            998) IS FALSE
  AND c IN (0.1,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN (0.2,
               998) IS FALSE
     AND c IN (0.1,
               999) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN (0.2,
               998) IS FALSE
     AND c IN (0.1,
               999) IS NOT FALSE), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (0.2,
            998) IS FALSE
  AND c IN (0.1,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN (0.2,
            998) IS FALSE
  AND c IN (0.1,
            999) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 0.2 AND 0.3)
  AND (c NOT BETWEEN 0.4 AND 0.5);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 0.2 AND 0.3)
     AND (c NOT BETWEEN 0.4 AND 0.5));
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 0.2 AND 0.3)
     AND (c NOT BETWEEN 0.4 AND 0.5)), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 0.2 AND 0.3)
  AND (c NOT BETWEEN 0.4 AND 0.5);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 0.2 AND 0.3)
  AND (c NOT BETWEEN 0.4 AND 0.5);
+-----+
| c   |
+-----+
| 0.2 |
| 0.2 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%'));
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (0.2,
            998)
  AND c NOT IN (0.1,
                999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN (0.2,
               998)
     AND c NOT IN (0.1,
                   999));
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN (0.2,
               998)
     AND c NOT IN (0.1,
                   999)), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (0.2,
            998)
  AND c NOT IN (0.1,
                999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN (0.2,
            998)
  AND c NOT IN (0.1,
                999);
+-----+
| c   |
+-----+
| 0.2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(0.2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0.1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES(0.2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0.1),(999)) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES(0.2),(998)) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES(0.1),(999)) AS t(col))), unnest(a_float) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(0.2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0.1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES(0.2),(998)) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES(0.1),(999)) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int=1);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int<>1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int<>1);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int<>1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int<>1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int>1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int>1);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int>1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int>1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int>=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int>=1);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int>=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int>=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int<1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1), unnest(a_float) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int<=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int<=1);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int<=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int<=1;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int=999)), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int=999);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int=999), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int=999;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IS NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IS NULL);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IS NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IS NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IS NOT NULL);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IS NOT NULL;
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE), unnest(a_float) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4));
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.2 |
| 0.2 |
|     |
|     |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%'));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B47_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B47_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B47_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B47_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B47_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B48_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_float) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B48_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col)));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B48_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))), unnest(a_float) AS u(c);
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B48_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_float) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B48_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_float) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+-----+
| c   |
+-----+
| 0.1 |
| 0.2 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c='S2');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c='S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c<>'S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c<>'S2');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<>'S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c<>'S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c<>'S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c>'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c>'S2');
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>'S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c>'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c>'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c>='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c>='S2');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>='S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c>='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c>='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c<'S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c<'S2');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<'S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c<'S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c<'S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c<='S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c<='S2');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<='S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c<='S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c<='S2';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (NOT c<>'S2'
       OR NOT c<>'998')
  AND (NOT c='S1'
       OR NOT c='999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (NOT c<>'S2'
          OR NOT c<>'998')
     AND (NOT c='S1'
          OR NOT c='999'));
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT c<>'S2'
          OR NOT c<>'998')
     AND (NOT c='S1'
          OR NOT c='999')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (NOT c<>'S2'
       OR NOT c<>'998')
  AND (NOT c='S1'
       OR NOT c='999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (NOT c<>'S2'
       OR NOT c<>'998')
  AND (NOT c='S1'
       OR NOT c='999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (c='S2'
       OR c='998')
  AND NOT c='S1'
  AND NOT c='999';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (c='S2'
          OR c='998')
     AND NOT c='S1'
     AND NOT c='999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c='S2'
          OR c='998')
     AND NOT c='S1'
     AND NOT c='999'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (c='S2'
       OR c='998')
  AND NOT c='S1'
  AND NOT c='999';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (c='S2'
       OR c='998')
  AND NOT c='S1'
  AND NOT c='999';
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c IS NULL);
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NULL), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c IS NOT NULL);
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NOT NULL), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
| S2 |
| S2 |
| S2 |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c IN ('S2',
            '998') IS TRUE
  AND c IN ('S1',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c IN ('S2',
               '998') IS TRUE
     AND c IN ('S1',
               '999') IS NOT TRUE);
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN ('S2',
               '998') IS TRUE
     AND c IN ('S1',
               '999') IS NOT TRUE), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c IN ('S2',
            '998') IS TRUE
  AND c IN ('S1',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c IN ('S2',
            '998') IS TRUE
  AND c IN ('S1',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c IN ('S2',
            '998') IS FALSE
  AND c IN ('S1',
            '999') IS NOT FALSE;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c IN ('S2',
               '998') IS FALSE
     AND c IN ('S1',
               '999') IS NOT FALSE);
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN ('S2',
               '998') IS FALSE
     AND c IN ('S1',
               '999') IS NOT FALSE), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c IN ('S2',
            '998') IS FALSE
  AND c IN ('S1',
            '999') IS NOT FALSE;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c IN ('S2',
            '998') IS FALSE
  AND c IN ('S1',
            '999') IS NOT FALSE;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (c BETWEEN 'S2' AND 'S3')
  AND (c NOT BETWEEN 'S4' AND 'S5');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (c BETWEEN 'S2' AND 'S3')
     AND (c NOT BETWEEN 'S4' AND 'S5'));
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c BETWEEN 'S2' AND 'S3')
     AND (c NOT BETWEEN 'S4' AND 'S5')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (c BETWEEN 'S2' AND 'S3')
  AND (c NOT BETWEEN 'S4' AND 'S5');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (c BETWEEN 'S2' AND 'S3')
  AND (c NOT BETWEEN 'S4' AND 'S5');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%'));
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c IN ('S2',
            '998')
  AND c NOT IN ('S1',
                '999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c IN ('S2',
               '998')
     AND c NOT IN ('S1',
                   '999'));
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN ('S2',
               '998')
     AND c NOT IN ('S1',
                   '999')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c IN ('S2',
            '998')
  AND c NOT IN ('S1',
                '999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c IN ('S2',
            '998')
  AND c NOT IN ('S1',
                '999');
+----+
| c  |
+----+
| S2 |
| S2 |
| S2 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES('S2'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S1'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE c IN
       (SELECT col
        FROM (
              VALUES('S2'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S1'),('999')) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN
       (SELECT col
        FROM (
              VALUES('S2'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S1'),('999')) AS t(col))), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE c IN
    (SELECT col
     FROM (
           VALUES('S2'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S1'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES('S2'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S1'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int=1
  AND c='S2';
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int=1
     AND c='S2');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1
     AND c='S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int=1
  AND c='S2';
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int=1
  AND c='S2';
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int<>1
  AND c<>'S2';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int<>1
     AND c<>'S2');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1
     AND c<>'S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int<>1
  AND c<>'S2';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int<>1
  AND c<>'S2';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int>1
  AND c>'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int>1
     AND c>'S2');
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1
     AND c>'S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int>1
  AND c>'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int>1
  AND c>'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int>=1
  AND c>='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int>=1
     AND c>='S2');
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1
     AND c>='S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int>=1
  AND c>='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int>=1
  AND c>='S2';
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int<1
  AND c<'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int<1
     AND c<'S2');
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1
     AND c<'S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int<1
  AND c<'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int<1
  AND c<'S2';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int<=1
  AND c<='S2';
+----+
| c  |
+----+
| S1 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int<=1
     AND c<='S2');
+----+
| c  |
+----+
| S1 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1
     AND c<='S2'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int<=1
  AND c<='S2';
+----+
| c  |
+----+
| S1 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int<=1
  AND c<='S2';
+----+
| c  |
+----+
| S1 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999')
  AND (NOT c<>'S2'
       OR NOT c<>'998')
  AND (NOT c='S1'
       OR NOT c='999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999')
     AND (NOT c<>'S2'
          OR NOT c<>'998')
     AND (NOT c='S1'
          OR NOT c='999'));
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999')
     AND (NOT c<>'S2'
          OR NOT c<>'998')
     AND (NOT c='S1'
          OR NOT c='999')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999')
  AND (NOT c<>'S2'
       OR NOT c<>'998')
  AND (NOT c='S1'
       OR NOT c='999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999')
  AND (NOT c<>'S2'
       OR NOT c<>'998')
  AND (NOT c='S1'
       OR NOT c='999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999'
  AND (c='S2'
       OR c='998')
  AND NOT c='S1'
  AND NOT c='999';
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999'
     AND (c='S2'
          OR c='998')
     AND NOT c='S1'
     AND NOT c='999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999'
     AND (c='S2'
          OR c='998')
     AND NOT c='S1'
     AND NOT c='999'), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999'
  AND (c='S2'
       OR c='998')
  AND NOT c='S1'
  AND NOT c='999';
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999'
  AND (c='S2'
       OR c='998')
  AND NOT c='S1'
  AND NOT c='999';
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IS NULL
     AND c IS NULL);
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL
     AND c IS NULL), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN ('S2',
            '998') IS TRUE
  AND c IN ('S1',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN ('S2',
               '998') IS TRUE
     AND c IN ('S1',
               '999') IS NOT TRUE);
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN ('S2',
               '998') IS TRUE
     AND c IN ('S1',
               '999') IS NOT TRUE), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN ('S2',
            '998') IS TRUE
  AND c IN ('S1',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN ('S2',
            '998') IS TRUE
  AND c IN ('S1',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN ('S2',
            '998') IS FALSE
  AND c IN ('S1',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN ('S2',
               '998') IS FALSE
     AND c IN ('S1',
               '999') IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN ('S2',
               '998') IS FALSE
     AND c IN ('S1',
               '999') IS NOT FALSE), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN ('S2',
            '998') IS FALSE
  AND c IN ('S1',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN ('S2',
            '998') IS FALSE
  AND c IN ('S1',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 'S2' AND 'S3')
  AND (c NOT BETWEEN 'S4' AND 'S5');
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 'S2' AND 'S3')
     AND (c NOT BETWEEN 'S4' AND 'S5'));
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 'S2' AND 'S3')
     AND (c NOT BETWEEN 'S4' AND 'S5')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 'S2' AND 'S3')
  AND (c NOT BETWEEN 'S4' AND 'S5');
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 'S2' AND 'S3')
  AND (c NOT BETWEEN 'S4' AND 'S5');
+----+
| c  |
+----+
| S2 |
| S2 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%'));
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%2%')
     AND (cast(c AS varchar) not like '%3%')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%2%')
  AND (cast(c AS varchar) not like '%3%');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN ('S2',
            '998')
  AND c NOT IN ('S1',
                '999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN ('S2',
               '998')
     AND c NOT IN ('S1',
                   '999'));
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN ('S2',
               '998')
     AND c NOT IN ('S1',
                   '999')), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN ('S2',
            '998')
  AND c NOT IN ('S1',
                '999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN ('S2',
            '998')
  AND c NOT IN ('S1',
                '999');
+----+
| c  |
+----+
| S2 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES('S2'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S1'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES('S2'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S1'),('999')) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES('S2'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S1'),('999')) AS t(col))), unnest(a_str) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES('S2'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S1'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES('S2'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S1'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int=1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int=1);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int=1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int=1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int<>1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int<>1);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int<>1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int<>1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int>1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int>1);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int>1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int>1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int>=1;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int>=1);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int>=1;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int>=1;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int<1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1), unnest(a_str) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int<=1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int<=1);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int<=1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int<=1;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999'));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999')), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999';
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999'), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999';
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999';
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IS NULL;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IS NULL);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IS NULL;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IS NULL;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IS NOT NULL);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IS NOT NULL;
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE), unnest(a_str) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4));
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+----+
| c  |
+----+
| S1 |
| S1 |
| S2 |
| S2 |
|    |
|    |
+----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%'));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B47_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B47_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B47_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B47_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B47_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B48_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_str) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B48_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col)));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B48_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))), unnest(a_str) AS u(c);
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B48_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_str) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B48_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_str) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+----+
| c  |
+----+
| S1 |
| S2 |
|    |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c='S1';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c='S1');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c='S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c='S1';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c='S1';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c<>'S1';
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| true |
| true |
| true |
+------+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c<>'S1');
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| true |
| true |
| true |
+------+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<>'S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c<>'S1';
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| true |
| true |
| true |
+------+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c<>'S1';
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| true |
| true |
| true |
+------+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c>'S1';
+------+
| c    |
+------+
| true |
| true |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c>'S1');
+------+
| c    |
+------+
| true |
| true |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>'S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c>'S1';
+------+
| c    |
+------+
| true |
| true |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c>'S1';
+------+
| c    |
+------+
| true |
| true |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c>='S1';
+------+
| c    |
+------+
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c>='S1');
+------+
| c    |
+------+
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c>='S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c>='S1';
+------+
| c    |
+------+
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c>='S1';
+------+
| c    |
+------+
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c<'S1';
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c<'S1');
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<'S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c<'S1';
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c<'S1';
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c<='S1';
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c<='S1');
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c<='S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c<='S1';
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c<='S1';
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (NOT c<>'S1'
       OR NOT c<>'998')
  AND (NOT c='S2'
       OR NOT c='999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (NOT c<>'S1'
          OR NOT c<>'998')
     AND (NOT c='S2'
          OR NOT c='999'));
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT c<>'S1'
          OR NOT c<>'998')
     AND (NOT c='S2'
          OR NOT c='999')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (NOT c<>'S1'
       OR NOT c<>'998')
  AND (NOT c='S2'
       OR NOT c='999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (NOT c<>'S1'
       OR NOT c<>'998')
  AND (NOT c='S2'
       OR NOT c='999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (c='S1'
       OR c='998')
  AND NOT c='S2'
  AND NOT c='999';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (c='S1'
          OR c='998')
     AND NOT c='S2'
     AND NOT c='999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c='S1'
          OR c='998')
     AND NOT c='S2'
     AND NOT c='999'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (c='S1'
       OR c='998')
  AND NOT c='S2'
  AND NOT c='999';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (c='S1'
       OR c='998')
  AND NOT c='S2'
  AND NOT c='999';
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c IS NULL);
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B9_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NULL), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c IS NULL;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(12 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c IS NOT NULL);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(12 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B10_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IS NOT NULL), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(12 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| 1    |
| S1   |
| S1   |
| S1   |
| true |
| true |
| true |
+------+
(12 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c IN ('S1',
            '998') IS TRUE
  AND c IN ('S2',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c IN ('S1',
               '998') IS TRUE
     AND c IN ('S2',
               '999') IS NOT TRUE);
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B11_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN ('S1',
               '998') IS TRUE
     AND c IN ('S2',
               '999') IS NOT TRUE), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c IN ('S1',
            '998') IS TRUE
  AND c IN ('S2',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c IN ('S1',
            '998') IS TRUE
  AND c IN ('S2',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c IN ('S1',
            '998') IS FALSE
  AND c IN ('S2',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c IN ('S1',
               '998') IS FALSE
     AND c IN ('S2',
               '999') IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B12_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN ('S1',
               '998') IS FALSE
     AND c IN ('S2',
               '999') IS NOT FALSE), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c IN ('S1',
            '998') IS FALSE
  AND c IN ('S2',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c IN ('S1',
            '998') IS FALSE
  AND c IN ('S2',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (c BETWEEN 'S1' AND 'S2')
  AND (c NOT BETWEEN 'S3' AND 'S4');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (c BETWEEN 'S1' AND 'S2')
     AND (c NOT BETWEEN 'S3' AND 'S4'));
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B13_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (c BETWEEN 'S1' AND 'S2')
     AND (c NOT BETWEEN 'S3' AND 'S4')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (c BETWEEN 'S1' AND 'S2')
  AND (c NOT BETWEEN 'S3' AND 'S4');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (c BETWEEN 'S1' AND 'S2')
  AND (c NOT BETWEEN 'S3' AND 'S4');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%2%');
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%2%'));
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B14_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%2%')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%2%');
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%2%');
+-----+
| c   |
+-----+
| 0.1 |
| 0.1 |
| 0.1 |
| 1   |
| 1   |
| 1   |
| S1  |
| S1  |
| S1  |
+-----+
(9 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c IN ('S1',
            '998')
  AND c NOT IN ('S2',
                '999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c IN ('S1',
               '998')
     AND c NOT IN ('S2',
                   '999'));
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B15_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN ('S1',
               '998')
     AND c NOT IN ('S2',
                   '999')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c IN ('S1',
            '998')
  AND c NOT IN ('S2',
                '999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c IN ('S1',
            '998')
  AND c NOT IN ('S2',
                '999');
+----+
| c  |
+----+
| S1 |
| S1 |
| S1 |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B16_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES('S1'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S2'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B16_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE c IN
       (SELECT col
        FROM (
              VALUES('S1'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S2'),('999')) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B16_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE c IN
       (SELECT col
        FROM (
              VALUES('S1'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S2'),('999')) AS t(col))), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B16_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE c IN
    (SELECT col
     FROM (
           VALUES('S1'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S2'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B16_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE c IN
    (SELECT col
     FROM (
           VALUES('S1'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S2'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int=1
  AND c='S1';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int=1
     AND c='S1');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B17_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1
     AND c='S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int=1
  AND c='S1';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int=1
  AND c='S1';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int<>1
  AND c<>'S1';
+------+
| c    |
+------+
| 0.1  |
| 1    |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int<>1
     AND c<>'S1');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1
     AND c<>'S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int<>1
  AND c<>'S1';
+------+
| c    |
+------+
| 0.1  |
| 1    |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int<>1
  AND c<>'S1';
+------+
| c    |
+------+
| 0.1  |
| 1    |
| true |
+------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int>1
  AND c>'S1';
+------+
| c    |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int>1
     AND c>'S1');
+------+
| c    |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B19_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1
     AND c>'S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int>1
  AND c>'S1';
+------+
| c    |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int>1
  AND c>'S1';
+------+
| c    |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int>=1
  AND c>='S1';
+------+
| c    |
+------+
| S1   |
| S1   |
| true |
| true |
+------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int>=1
     AND c>='S1');
+------+
| c    |
+------+
| S1   |
| S1   |
| true |
| true |
+------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B20_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1
     AND c>='S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int>=1
  AND c>='S1';
+------+
| c    |
+------+
| S1   |
| S1   |
| true |
| true |
+------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int>=1
  AND c>='S1';
+------+
| c    |
+------+
| S1   |
| S1   |
| true |
| true |
+------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int<1
  AND c<'S1';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int<1
     AND c<'S1');
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B21_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1
     AND c<'S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int<1
  AND c<'S1';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int<1
  AND c<'S1';
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int<=1
  AND c<='S1';
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int<=1
     AND c<='S1');
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1
     AND c<='S1'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int<=1
  AND c<='S1';
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int<=1
  AND c<='S1';
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999')
  AND (NOT c<>'S1'
       OR NOT c<>'998')
  AND (NOT c='S2'
       OR NOT c='999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999')
     AND (NOT c<>'S1'
          OR NOT c<>'998')
     AND (NOT c='S2'
          OR NOT c='999'));
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B23_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999')
     AND (NOT c<>'S1'
          OR NOT c<>'998')
     AND (NOT c='S2'
          OR NOT c='999')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999')
  AND (NOT c<>'S1'
       OR NOT c<>'998')
  AND (NOT c='S2'
       OR NOT c='999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999')
  AND (NOT c<>'S1'
       OR NOT c<>'998')
  AND (NOT c='S2'
       OR NOT c='999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999'
  AND (c='S1'
       OR c='998')
  AND NOT c='S2'
  AND NOT c='999';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999'
     AND (c='S1'
          OR c='998')
     AND NOT c='S2'
     AND NOT c='999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B24_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999'
     AND (c='S1'
          OR c='998')
     AND NOT c='S2'
     AND NOT c='999'), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999'
  AND (c='S1'
       OR c='998')
  AND NOT c='S2'
  AND NOT c='999';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999'
  AND (c='S1'
       OR c='998')
  AND NOT c='S2'
  AND NOT c='999';
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IS NULL
     AND c IS NULL);
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B25_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL
     AND c IS NULL), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IS NULL
  AND c IS NULL;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B26_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL
     AND c IS NOT NULL), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IS NOT NULL
  AND c IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
+------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN ('S1',
            '998') IS TRUE
  AND c IN ('S2',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN ('S1',
               '998') IS TRUE
     AND c IN ('S2',
               '999') IS NOT TRUE);
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B27_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE
     AND c IN ('S1',
               '998') IS TRUE
     AND c IN ('S2',
               '999') IS NOT TRUE), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN ('S1',
            '998') IS TRUE
  AND c IN ('S2',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE
  AND c IN ('S1',
            '998') IS TRUE
  AND c IN ('S2',
            '999') IS NOT TRUE;
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN ('S1',
            '998') IS FALSE
  AND c IN ('S2',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN ('S1',
               '998') IS FALSE
     AND c IN ('S2',
               '999') IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B28_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE
     AND c IN ('S1',
               '998') IS FALSE
     AND c IN ('S2',
               '999') IS NOT FALSE), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN ('S1',
            '998') IS FALSE
  AND c IN ('S2',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE
  AND c IN ('S1',
            '998') IS FALSE
  AND c IN ('S2',
            '999') IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 'S1' AND 'S2')
  AND (c NOT BETWEEN 'S3' AND 'S4');
+----+
| c  |
+----+
| S1 |
| S1 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 'S1' AND 'S2')
     AND (c NOT BETWEEN 'S3' AND 'S4'));
+----+
| c  |
+----+
| S1 |
| S1 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B29_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)
     AND (c BETWEEN 'S1' AND 'S2')
     AND (c NOT BETWEEN 'S3' AND 'S4')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 'S1' AND 'S2')
  AND (c NOT BETWEEN 'S3' AND 'S4');
+----+
| c  |
+----+
| S1 |
| S1 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4)
  AND (c BETWEEN 'S1' AND 'S2')
  AND (c NOT BETWEEN 'S3' AND 'S4');
+----+
| c  |
+----+
| S1 |
| S1 |
+----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%2%');
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%2%'));
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B30_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')
     AND (cast(c AS varchar) like '%1%')
     AND (cast(c AS varchar) not like '%2%')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%2%');
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%')
  AND (cast(c AS varchar) like '%1%')
  AND (cast(c AS varchar) not like '%2%');
+-----+
| c   |
+-----+
| 0.1 |
| 1   |
| S1  |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN ('S1',
            '998')
  AND c NOT IN ('S2',
                '999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN ('S1',
               '998')
     AND c NOT IN ('S2',
                   '999'));
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B31_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)
     AND c IN ('S1',
               '998')
     AND c NOT IN ('S2',
                   '999')), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN ('S1',
            '998')
  AND c NOT IN ('S2',
                '999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997)
  AND c IN ('S1',
            '998')
  AND c NOT IN ('S2',
                '999');
+----+
| c  |
+----+
| S1 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B32_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES('S1'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S2'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B32_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES('S1'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S2'),('999')) AS t(col)));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B32_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(1),(997)) AS t(col))
     AND c IN
       (SELECT col
        FROM (
              VALUES('S1'),('998')) AS t(col))
     AND c NOT IN
       (SELECT col
        FROM (
              VALUES('S2'),('999')) AS t(col))), unnest(a_mixed) AS u(c);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B32_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES('S1'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S2'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B32_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(1),(997)) AS t(col))
  AND c IN
    (SELECT col
     FROM (
           VALUES('S1'),('998')) AS t(col))
  AND c NOT IN
    (SELECT col
     FROM (
           VALUES('S2'),('999')) AS t(col));
Unhandled Query Planning Failure
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int=1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int=1);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int=1), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int=1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int=1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int<>1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int<>1);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<>1), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int<>1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int<>1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int>1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int>1);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>1), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int>1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int>1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int>=1;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int>=1);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int>=1), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int>=1;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int>=1;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int<1);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<1), unnest(a_mixed) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int<1;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int<=1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int<=1);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int<=1), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int<=1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int<=1;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999'));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (NOT s_int<>1
          OR NOT s_int<>997)
     AND (NOT s_int=0
          OR NOT s_int='999')), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (NOT s_int<>1
       OR NOT s_int<>997)
  AND (NOT s_int=0
       OR NOT s_int='999');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999';
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int=1
          OR s_int=997)
     AND NOT s_int=0
     AND NOT s_int='999'), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999';
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (s_int=1
       OR s_int=997)
  AND NOT s_int=0
  AND NOT s_int='999';
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IS NULL;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IS NULL);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NULL), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IS NULL;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IS NULL;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IS NOT NULL);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IS NOT NULL), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IS NOT NULL;
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS TRUE
     AND s_int IN (0,
                   997) IS NOT TRUE), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS TRUE
  AND s_int IN (0,
                997) IS NOT TRUE;
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996) IS FALSE
     AND s_int IN (0,
                   997) IS NOT FALSE), unnest(a_mixed) AS u(c);
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996) IS FALSE
  AND s_int IN (0,
                997) IS NOT FALSE;
+---+
| c |
+---+
+---+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B45_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B45_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4));
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B45_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (s_int BETWEEN 1 AND 2)
     AND (s_int NOT BETWEEN 3 AND 4)), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B45_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B45_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (s_int BETWEEN 1 AND 2)
  AND (s_int NOT BETWEEN 3 AND 4);
+------+
| c    |
+------+
| 0.1  |
| 0.1  |
| 1    |
| 1    |
| S1   |
| S1   |
| true |
| true |
|      |
|      |
+------+
(10 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B46_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B46_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%'));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B46_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE (cast(s_int AS varchar) like '%1%')
     AND (cast(s_int AS varchar) not like '%3%')), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B46_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B46_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE (cast(s_int AS varchar) like '%1%')
  AND (cast(s_int AS varchar) not like '%3%');
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B47_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B47_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B47_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN (1,
                   996)
     AND s_int NOT IN (0,
                       997)), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B47_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B47_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN (1,
                996)
  AND s_int NOT IN (0,
                    997);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B48_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM test_unnest,
     unnest(a_mixed) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B48_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c)
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col)));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B48_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest
   WHERE s_int IN
       (SELECT col
        FROM (
              VALUES(1),(996)) AS t(col))
     AND s_int NOT IN
       (SELECT col
        FROM (
              VALUES(0),(997)) AS t(col))), unnest(a_mixed) AS u(c);
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B48_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(a_mixed) AS u(c))
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A5_B48_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT *
   FROM test_unnest), unnest(a_mixed) AS u(c)
WHERE s_int IN
    (SELECT col
     FROM (
           VALUES(1),(996)) AS t(col))
  AND s_int NOT IN
    (SELECT col
     FROM (
           VALUES(0),(997)) AS t(col));
+------+
| c    |
+------+
| 0.1  |
| 1    |
| S1   |
| true |
|      |
+------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 1201 Positive tests: 1001 Negative tests: 200
#-------------------------------------------------------------------------
