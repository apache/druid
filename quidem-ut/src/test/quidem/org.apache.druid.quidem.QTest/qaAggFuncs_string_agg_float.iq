!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardComponentSupplier&datasets=sql/src/test/quidem/qatests/qaAggFuncs&numMergeBuffers=3
!set outputformat mysql
SELECT count(*) cnt
FROM test_agg_funcs;
+-----+
| cnt |
+-----+
|  18 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(11.1111111, '|') AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, '|') AS col
   FROM test_agg_funcs)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(tab0f0, '|') AS col
FROM test_agg_funcs
WHERE tab0f0 IS NULL;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, '|') || '-3333333333' AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT '3333333333-' || string_agg(tab0f0, '|') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, ',') || '-' || string_agg(tab0f0, '|') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT concat(string_agg(tab0f0, ','), '-', string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(tab0f0, '|'), '-3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat('3333333333-', string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(tab0f0, ','), string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_format('%s-%s', string_agg(tab0f0, ','), string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT char_length(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lower(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(tab0f0, '|'), 16) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(tab0f0, '|')) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(tab0f0, '|')
                FROM 2) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT regexp_extract(string_agg(tab0f0, '|'), '13\.') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(tab0f0, '|'), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(tab0f0, '|'), '13\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(tab0f0, '|'), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(tab0f0, '|'), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(tab0f0, '|'), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(tab0f0, '|'), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(tab0f0, '|'), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(tab0f0, '|'), '11.', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(tab0f0, '|'), '4444444444', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(tab0f0, '|'), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(tab0f0, '|'), '|4444444444') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(tab0f0, '|'), 1) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(tab0f0, '|'), 4, 100) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(BOTH
               FROM string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(LEADING
               FROM string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(TRAILING
               FROM string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(BOTH '1'
               FROM string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(LEADING '1'
               FROM string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(TRAILING '1'
               FROM string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT btrim(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT btrim(string_agg(tab0f0, '|'), '1') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT ltrim(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT ltrim(string_agg(tab0f0, '|'), '1') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rtrim(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rtrim(string_agg(tab0f0, '|'), '1') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT upper(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT reverse(string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(tab0f0, '|'), -1) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(tab0f0, '|'), 0) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT repeat(string_agg(tab0f0, '|'), 2) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|'), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|'), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|'), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|'), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|'), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|'), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|'), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A58 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|'), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A59 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(t0.tab0f0, '|') AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0f0 IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A60 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(t0.tab0f0, '|')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0f0 IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A61 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(t0.tab0f0, '|') AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0f0;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A62 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(t0.tab0f0, '|')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0f0;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT 11.1111111, '|') AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT tab0f0, '|') AS col
   FROM test_agg_funcs)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(tab0f0, '|') AS col
FROM test_agg_funcs
WHERE tab0f0 IS NULL;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT tab0f0, '|') || '-3333333333' AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT '3333333333-' || string_agg(DISTINCT tab0f0, '|') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT tab0f0, ',') || '-' || string_agg(tab0f0, '|') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT concat(string_agg(tab0f0, ','), '-', string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(DISTINCT tab0f0, '|'), '-3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat('3333333333-', string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(tab0f0, ','), string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_format('%s-%s', string_agg(DISTINCT tab0f0, ','), string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT char_length(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lower(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(DISTINCT tab0f0, '|'), 16) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(DISTINCT tab0f0, '|')) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(DISTINCT tab0f0, '|')
                FROM 2) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT regexp_extract(string_agg(DISTINCT tab0f0, '|'), '13\.') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(DISTINCT tab0f0, '|'), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT tab0f0, '|'), '13\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT tab0f0, '|'), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT tab0f0, '|'), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT tab0f0, '|'), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT tab0f0, '|'), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT tab0f0, '|'), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(DISTINCT tab0f0, '|'), '11.', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(DISTINCT tab0f0, '|'), '4444444444', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT tab0f0, '|'), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT tab0f0, '|'), '4444444444') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(DISTINCT tab0f0, '|'), 1) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(DISTINCT tab0f0, '|'), 1, 100) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(BOTH
               FROM string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(LEADING
               FROM string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(TRAILING
               FROM string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890.'
            FROM string_agg(DISTINCT tab0f0, '|')) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890.'
            FROM string_agg(DISTINCT tab0f0, '|')) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890.'
            FROM string_agg(DISTINCT tab0f0, '|')) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT btrim(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(DISTINCT tab0f0, '|'), '1234567890.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT ltrim(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(DISTINCT tab0f0, '|'), '1234567890.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rtrim(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(DISTINCT tab0f0, '|'), '1234567890.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT upper(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT reverse(string_agg(DISTINCT tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT tab0f0, '|'), -1) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT tab0f0, '|'), 0) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT repeat(string_agg(DISTINCT tab0f0, '|'), 2) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|'), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|'), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|'), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|'), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|'), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|'), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|'), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A58 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|'), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A59 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT t0.tab0f0, '|') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0f0 IS NOT NULL)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A60 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(DISTINCT t0.tab0f0, '|')) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0f0 IS NOT NULL)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A61 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT t0.tab0f0, '|') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0f0)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A62 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(DISTINCT t0.tab0f0, '|')) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0f0)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT 11.1111111, '|', 100000) AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT tab0f0, '|', 100000) AS col
   FROM test_agg_funcs)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(tab0f0, '|', 100000) AS col
FROM test_agg_funcs
WHERE tab0f0 IS NULL;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT tab0f0, '|', 100000) || '-3333333333' AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT '3333333333-' || string_agg(DISTINCT tab0f0, '|', 100000) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT tab0f0, ',', 100000) || '-' || string_agg(tab0f0, '|') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT concat(string_agg(tab0f0, ','), '-', string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(DISTINCT tab0f0, '|', 100000), '-3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat('3333333333-', string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(tab0f0, ','), string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_format('%s-%s', string_agg(DISTINCT tab0f0, ',', 100000), string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT char_length(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lower(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(DISTINCT tab0f0, '|', 100000), 16) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(DISTINCT tab0f0, '|', 100000)) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(DISTINCT tab0f0, '|', 100000)
                FROM 2) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT regexp_extract(string_agg(DISTINCT tab0f0, '|', 100000), '13\.') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(DISTINCT tab0f0, '|', 100000), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT tab0f0, '|', 100000), '13\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT tab0f0, '|', 100000), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT tab0f0, '|', 100000), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT tab0f0, '|', 100000), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT tab0f0, '|', 100000), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT tab0f0, '|', 100000), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(DISTINCT tab0f0, '|', 100000), '11.', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(DISTINCT tab0f0, '|', 100000), '4444444444', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT tab0f0, '|', 100000), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT tab0f0, '|', 100000), '4444444444') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(DISTINCT tab0f0, '|', 100000), 1) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(DISTINCT tab0f0, '|', 100000), 1, 100) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(BOTH
               FROM string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(LEADING
               FROM string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(TRAILING
               FROM string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890.'
            FROM string_agg(DISTINCT tab0f0, '|', 100000)) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890.'
            FROM string_agg(DISTINCT tab0f0, '|', 100000)) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890.'
            FROM string_agg(DISTINCT tab0f0, '|', 100000)) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT btrim(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(DISTINCT tab0f0, '|', 100000), '1234567890.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT ltrim(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(DISTINCT tab0f0, '|', 100000), '1234567890.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rtrim(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(DISTINCT tab0f0, '|', 100000), '1234567890.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT upper(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT reverse(string_agg(DISTINCT tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT tab0f0, '|', 100000), -1) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT tab0f0, '|', 100000), 0) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT repeat(string_agg(DISTINCT tab0f0, '|', 100000), 2) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|', 100000), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|', 100000), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|', 100000), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(DISTINCT tab0f0, '|', 100000), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|', 100000), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT tab0f0, '|', 100000), 4, '3') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|', 100000), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A58 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(DISTINCT tab0f0, '|', 100000), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A59 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT t0.tab0f0, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0f0 IS NOT NULL)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A60 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(DISTINCT t0.tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0f0 IS NOT NULL)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A61 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(DISTINCT t0.tab0f0, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0f0)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A62 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(DISTINCT t0.tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0f0)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(11.1111111, '|', 100000) AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, '|', 100000) AS col
   FROM test_agg_funcs)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, '|', 100000) AS col
   FROM test_agg_funcs
   WHERE tab0f0 IS NULL)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, '|', 100000) || '-3333333333' AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT '3333333333-' || string_agg(tab0f0, '|', 100000) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(tab0f0, ',', 100000) || '-' || string_agg(tab0f0, '|') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT concat(string_agg(tab0f0, ','), '-', string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(tab0f0, '|', 100000), '-3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat('3333333333-', string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT textcat(string_agg(tab0f0, ',', 100000), string_agg(tab0f0, '|')) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_format('%s-%s', string_agg(tab0f0, ','), string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT char_length(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT character_length(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lower(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(tab0f0, '|', 100000), 16) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(tab0f0, '|', 100000)) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1' IN string_agg(tab0f0, '|', 100000)
                FROM 2) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT regexp_extract(string_agg(tab0f0, '|', 100000), '13\.') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(tab0f0, '|', 100000), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(tab0f0, '|', 100000), '13\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(tab0f0, '|', 100000), '14\.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(tab0f0, '|', 100000), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(tab0f0, '|', 100000), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(tab0f0, '|', 100000), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(tab0f0, '|', 100000), '22.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(tab0f0, '|', 100000), '11.', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT replace(string_agg(tab0f0, '|', 100000), '4444444444', '3333333333') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(tab0f0, '|', 100000), '11.') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(tab0f0, '|', 100000), '|4444444444') AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(tab0f0, '|', 100000), 1) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT substring(string_agg(tab0f0, '|', 100000), 4, 100) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(BOTH
               FROM string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(LEADING
               FROM string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(TRAILING
               FROM string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(BOTH '1'
               FROM string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(LEADING '1'
               FROM string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT trim(TRAILING '1'
               FROM string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT btrim(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT btrim(string_agg(tab0f0, '|', 100000), '1') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT ltrim(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT ltrim(string_agg(tab0f0, '|', 100000), '1') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rtrim(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rtrim(string_agg(tab0f0, '|', 100000), '1') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT upper(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT reverse(string_agg(tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(tab0f0, '|', 100000), -1) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(tab0f0, '|', 100000), 0) AS col
FROM test_agg_funcs
WHERE tab0f0>111
  AND tab0f0<222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT repeat(string_agg(tab0f0, '|', 100000), 2) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|', 100000), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|', 100000), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|', 100000), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT lpad(string_agg(tab0f0, '|', 100000), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|', 100000), 4) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|', 100000), 4, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|', 100000), 500) AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A58 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT rpad(string_agg(tab0f0, '|', 100000), 500, '3') AS col
   FROM test_agg_funcs
   WHERE tab0f0>111
     AND tab0f0<222)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A59 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(t0.tab0f0, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0f0 IS NOT NULL)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A60 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(t0.tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0f0 IS NOT NULL)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A61 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT string_agg(t0.tab0f0, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0f0)
WHERE col != 'ABCD'
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A62 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT length(string_agg(t0.tab0f0, '|', 100000)) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0f0)
WHERE col != 99999
  OR col IS NULL;
+-----+
| cnt |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# Total query count 249 Positive tests: 241 Negative tests: 8
#-------------------------------------------------------------------------
