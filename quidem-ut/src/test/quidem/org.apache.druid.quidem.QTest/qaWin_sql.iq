!set useApproximateCountDistinct false
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
SELECT count(*) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+-----+
| cnt |
+-----+
| 768 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_explain_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

{
  "queryType" : "windowOperator",
  "dataSource" : {
    "type" : "query",
    "query" : {
      "queryType" : "groupBy",
      "dataSource" : {
        "type" : "table",
        "name" : "kttm_nested"
      },
      "intervals" : {
        "type" : "intervals",
        "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
      },
      "virtualColumns" : [ {
        "type" : "expression",
        "name" : "v0",
        "expression" : "timestamp_floor(\"__time\",'PT12H',null,'UTC')",
        "outputType" : "LONG"
      } ],
      "filter" : {
        "type" : "inType",
        "column" : "client_ip",
        "matchValueType" : "STRING",
        "sortedValues" : [ "107.13.54.103", "99.9.55.22" ]
      },
      "granularity" : {
        "type" : "all"
      },
      "dimensions" : [ {
        "type" : "default",
        "dimension" : "server_ip",
        "outputName" : "d0",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "client_ip",
        "outputName" : "d1",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "timezone",
        "outputName" : "d2",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "v0",
        "outputName" : "d3",
        "outputType" : "LONG"
      } ],
      "postAggregations" : [ {
        "type" : "expression",
        "name" : "p0",
        "expression" : "timestamp_format(timestamp_floor(\"d3\",'PT12H',null,'UTC'),'yyyy-MM-dd HH:mm:ss','UTC')",
        "outputType" : "STRING"
      }, {
        "type" : "expression",
        "name" : "p1",
        "expression" : "strlen(\"d0\")",
        "outputType" : "LONG"
      }, {
        "type" : "expression",
        "name" : "p2",
        "expression" : "(CAST(strlen(\"d0\"), 'DOUBLE') + 0.123)",
        "outputType" : "DOUBLE"
      } ],
      "limitSpec" : {
        "type" : "NoopLimitSpec"
      }
    }
  },
  "intervals" : {
    "type" : "LegacySegmentSpec",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "outputSignature" : [ {
    "name" : "d0",
    "type" : "STRING"
  }, {
    "name" : "d1",
    "type" : "STRING"
  }, {
    "name" : "d2",
    "type" : "STRING"
  }, {
    "name" : "p0",
    "type" : "STRING"
  }, {
    "name" : "w0",
    "type" : "STRING"
  }, {
    "name" : "w1",
    "type" : "STRING"
  }, {
    "name" : "w2",
    "type" : "LONG"
  } ],
  "operatorDefinition" : [ {
    "type" : "naiveSort",
    "columns" : [ {
      "column" : "d1",
      "direction" : "ASC"
    }, {
      "column" : "d0",
      "direction" : "ASC"
    }, {
      "column" : "p1",
      "direction" : "ASC"
    }, {
      "column" : "p2",
      "direction" : "ASC"
    } ]
  }, {
    "type" : "naivePartition",
    "partitionColumns" : [ "d1" ]
  }, {
    "type" : "window",
    "processor" : {
      "type" : "composing",
      "processors" : [ {
        "type" : "first",
        "inputColumn" : "d2",
        "outputColumn" : "w0"
      }, {
        "type" : "offset",
        "inputColumn" : "d2",
        "outputColumn" : "w1",
        "offset" : 0
      }, {
        "type" : "framedAgg",
        "frame" : {
          "type" : "groups",
          "lowerOffset" : null,
          "upperOffset" : 0,
          "orderByColumns" : [ "d0", "p1", "p2" ]
        },
        "aggregations" : [ {
          "type" : "filtered",
          "aggregator" : {
            "type" : "count",
            "name" : "w2"
          },
          "filter" : {
            "type" : "not",
            "field" : {
              "type" : "null",
              "column" : "d2"
            }
          },
          "name" : "w2"
        } ]
      } ]
    }
  } ],
  "leafOperators" : [ ],
  "granularity" : {
    "type" : "all"
  }
}
!nativePlan

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_explain_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

{
  "queryType" : "windowOperator",
  "dataSource" : {
    "type" : "query",
    "query" : {
      "queryType" : "groupBy",
      "dataSource" : {
        "type" : "table",
        "name" : "kttm_nested"
      },
      "intervals" : {
        "type" : "intervals",
        "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
      },
      "virtualColumns" : [ {
        "type" : "expression",
        "name" : "v0",
        "expression" : "timestamp_floor(\"__time\",'PT12H',null,'UTC')",
        "outputType" : "LONG"
      } ],
      "filter" : {
        "type" : "inType",
        "column" : "client_ip",
        "matchValueType" : "STRING",
        "sortedValues" : [ "107.13.54.103", "99.9.55.22" ]
      },
      "granularity" : {
        "type" : "all"
      },
      "dimensions" : [ {
        "type" : "default",
        "dimension" : "server_ip",
        "outputName" : "d0",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "client_ip",
        "outputName" : "d1",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "timezone",
        "outputName" : "d2",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "v0",
        "outputName" : "d3",
        "outputType" : "LONG"
      } ],
      "postAggregations" : [ {
        "type" : "expression",
        "name" : "p0",
        "expression" : "timestamp_format(timestamp_floor(\"d3\",'PT12H',null,'UTC'),'yyyy-MM-dd HH:mm:ss','UTC')",
        "outputType" : "STRING"
      }, {
        "type" : "expression",
        "name" : "p1",
        "expression" : "strlen(\"d0\")",
        "outputType" : "LONG"
      }, {
        "type" : "expression",
        "name" : "p2",
        "expression" : "(CAST(strlen(\"d0\"), 'DOUBLE') + 0.123)",
        "outputType" : "DOUBLE"
      } ],
      "limitSpec" : {
        "type" : "NoopLimitSpec"
      }
    }
  },
  "intervals" : {
    "type" : "LegacySegmentSpec",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "outputSignature" : [ {
    "name" : "d0",
    "type" : "STRING"
  }, {
    "name" : "d1",
    "type" : "STRING"
  }, {
    "name" : "d2",
    "type" : "STRING"
  }, {
    "name" : "p0",
    "type" : "STRING"
  }, {
    "name" : "w0",
    "type" : "STRING"
  }, {
    "name" : "w1",
    "type" : "STRING"
  }, {
    "name" : "w2",
    "type" : "LONG"
  } ],
  "operatorDefinition" : [ {
    "type" : "naiveSort",
    "columns" : [ {
      "column" : "d1",
      "direction" : "ASC"
    }, {
      "column" : "d0",
      "direction" : "ASC"
    }, {
      "column" : "p1",
      "direction" : "ASC"
    }, {
      "column" : "p2",
      "direction" : "ASC"
    } ]
  }, {
    "type" : "naivePartition",
    "partitionColumns" : [ "d1" ]
  }, {
    "type" : "window",
    "processor" : {
      "type" : "composing",
      "processors" : [ {
        "type" : "first",
        "inputColumn" : "d2",
        "outputColumn" : "w0"
      }, {
        "type" : "offset",
        "inputColumn" : "d2",
        "outputColumn" : "w1",
        "offset" : 0
      }, {
        "type" : "framedAgg",
        "frame" : {
          "type" : "groups",
          "lowerOffset" : null,
          "upperOffset" : 0,
          "orderByColumns" : [ "d0", "p1", "p2" ]
        },
        "aggregations" : [ {
          "type" : "filtered",
          "aggregator" : {
            "type" : "count",
            "name" : "w2"
          },
          "filter" : {
            "type" : "not",
            "field" : {
              "type" : "null",
              "column" : "d2"
            }
          },
          "name" : "w2"
        } ]
      } ]
    }
  } ],
  "leafOperators" : [ ],
  "granularity" : {
    "type" : "all"
  }
}
!nativePlan

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_explain_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

{
  "queryType" : "windowOperator",
  "dataSource" : {
    "type" : "query",
    "query" : {
      "queryType" : "groupBy",
      "dataSource" : {
        "type" : "table",
        "name" : "kttm_nested"
      },
      "intervals" : {
        "type" : "intervals",
        "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
      },
      "virtualColumns" : [ {
        "type" : "expression",
        "name" : "v0",
        "expression" : "timestamp_floor(\"__time\",'PT12H',null,'UTC')",
        "outputType" : "LONG"
      } ],
      "filter" : {
        "type" : "inType",
        "column" : "client_ip",
        "matchValueType" : "STRING",
        "sortedValues" : [ "107.13.54.103", "99.9.55.22" ]
      },
      "granularity" : {
        "type" : "all"
      },
      "dimensions" : [ {
        "type" : "default",
        "dimension" : "server_ip",
        "outputName" : "d0",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "client_ip",
        "outputName" : "d1",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "timezone",
        "outputName" : "d2",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "v0",
        "outputName" : "d3",
        "outputType" : "LONG"
      } ],
      "postAggregations" : [ {
        "type" : "expression",
        "name" : "p0",
        "expression" : "timestamp_format(\"d3\",'yyyy-MM-dd HH:mm:ss','UTC')",
        "outputType" : "STRING"
      }, {
        "type" : "expression",
        "name" : "p1",
        "expression" : "strlen(\"d0\")",
        "outputType" : "LONG"
      }, {
        "type" : "expression",
        "name" : "p2",
        "expression" : "(CAST(strlen(\"d0\"), 'DOUBLE') + 0.123)",
        "outputType" : "DOUBLE"
      } ],
      "limitSpec" : {
        "type" : "NoopLimitSpec"
      }
    }
  },
  "intervals" : {
    "type" : "LegacySegmentSpec",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "outputSignature" : [ {
    "name" : "d0",
    "type" : "STRING"
  }, {
    "name" : "d1",
    "type" : "STRING"
  }, {
    "name" : "d2",
    "type" : "STRING"
  }, {
    "name" : "p0",
    "type" : "STRING"
  }, {
    "name" : "w0",
    "type" : "STRING"
  }, {
    "name" : "w1",
    "type" : "STRING"
  }, {
    "name" : "w2",
    "type" : "LONG"
  } ],
  "operatorDefinition" : [ {
    "type" : "naiveSort",
    "columns" : [ {
      "column" : "d1",
      "direction" : "ASC"
    }, {
      "column" : "d0",
      "direction" : "ASC"
    }, {
      "column" : "p1",
      "direction" : "ASC"
    }, {
      "column" : "p2",
      "direction" : "ASC"
    } ]
  }, {
    "type" : "naivePartition",
    "partitionColumns" : [ "d1" ]
  }, {
    "type" : "window",
    "processor" : {
      "type" : "composing",
      "processors" : [ {
        "type" : "first",
        "inputColumn" : "d2",
        "outputColumn" : "w0"
      }, {
        "type" : "offset",
        "inputColumn" : "d2",
        "outputColumn" : "w1",
        "offset" : 0
      }, {
        "type" : "framedAgg",
        "frame" : {
          "type" : "groups",
          "lowerOffset" : null,
          "upperOffset" : 0,
          "orderByColumns" : [ "d0", "p1", "p2" ]
        },
        "aggregations" : [ {
          "type" : "filtered",
          "aggregator" : {
            "type" : "count",
            "name" : "w2"
          },
          "filter" : {
            "type" : "not",
            "field" : {
              "type" : "null",
              "column" : "d2"
            }
          },
          "name" : "w2"
        } ]
      } ]
    }
  } ],
  "leafOperators" : [ ],
  "granularity" : {
    "type" : "all"
  }
}
!nativePlan

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_explain_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

{
  "queryType" : "windowOperator",
  "dataSource" : {
    "type" : "query",
    "query" : {
      "queryType" : "groupBy",
      "dataSource" : {
        "type" : "table",
        "name" : "kttm_nested"
      },
      "intervals" : {
        "type" : "intervals",
        "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
      },
      "virtualColumns" : [ {
        "type" : "expression",
        "name" : "v0",
        "expression" : "timestamp_floor(\"__time\",'PT12H',null,'UTC')",
        "outputType" : "LONG"
      } ],
      "filter" : {
        "type" : "inType",
        "column" : "client_ip",
        "matchValueType" : "STRING",
        "sortedValues" : [ "107.13.54.103", "99.9.55.22" ]
      },
      "granularity" : {
        "type" : "all"
      },
      "dimensions" : [ {
        "type" : "default",
        "dimension" : "server_ip",
        "outputName" : "d0",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "client_ip",
        "outputName" : "d1",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "timezone",
        "outputName" : "d2",
        "outputType" : "STRING"
      }, {
        "type" : "default",
        "dimension" : "v0",
        "outputName" : "d3",
        "outputType" : "LONG"
      } ],
      "postAggregations" : [ {
        "type" : "expression",
        "name" : "p0",
        "expression" : "timestamp_format(\"d3\",'yyyy-MM-dd HH:mm:ss','UTC')",
        "outputType" : "STRING"
      }, {
        "type" : "expression",
        "name" : "p1",
        "expression" : "strlen(\"d0\")",
        "outputType" : "LONG"
      }, {
        "type" : "expression",
        "name" : "p2",
        "expression" : "(CAST(strlen(\"d0\"), 'DOUBLE') + 0.123)",
        "outputType" : "DOUBLE"
      } ],
      "limitSpec" : {
        "type" : "NoopLimitSpec"
      }
    }
  },
  "intervals" : {
    "type" : "LegacySegmentSpec",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "outputSignature" : [ {
    "name" : "d0",
    "type" : "STRING"
  }, {
    "name" : "d1",
    "type" : "STRING"
  }, {
    "name" : "d2",
    "type" : "STRING"
  }, {
    "name" : "p0",
    "type" : "STRING"
  }, {
    "name" : "w0",
    "type" : "STRING"
  }, {
    "name" : "w1",
    "type" : "STRING"
  }, {
    "name" : "w2",
    "type" : "LONG"
  } ],
  "operatorDefinition" : [ {
    "type" : "naiveSort",
    "columns" : [ {
      "column" : "d1",
      "direction" : "ASC"
    }, {
      "column" : "d0",
      "direction" : "ASC"
    }, {
      "column" : "p1",
      "direction" : "ASC"
    }, {
      "column" : "p2",
      "direction" : "ASC"
    } ]
  }, {
    "type" : "naivePartition",
    "partitionColumns" : [ "d1" ]
  }, {
    "type" : "window",
    "processor" : {
      "type" : "composing",
      "processors" : [ {
        "type" : "first",
        "inputColumn" : "d2",
        "outputColumn" : "w0"
      }, {
        "type" : "offset",
        "inputColumn" : "d2",
        "outputColumn" : "w1",
        "offset" : 0
      }, {
        "type" : "framedAgg",
        "frame" : {
          "type" : "groups",
          "lowerOffset" : null,
          "upperOffset" : 0,
          "orderByColumns" : [ "d0", "p1", "p2" ]
        },
        "aggregations" : [ {
          "type" : "filtered",
          "aggregator" : {
            "type" : "count",
            "name" : "w2"
          },
          "filter" : {
            "type" : "not",
            "field" : {
              "type" : "null",
              "column" : "d2"
            }
          },
          "name" : "w2"
        } ]
      } ]
    }
  } ],
  "leafOperators" : [ ],
  "granularity" : {
    "type" : "all"
  }
}
!nativePlan

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(server_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(server_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(server_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(server_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(client_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(client_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(client_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(client_ip) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(timezone) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(timezone) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(timezone) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(timezone) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(t) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(t) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(t) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(t) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A8_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A8_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A8_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A8_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 8 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A13_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A13_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A13_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A13_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT FIRST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A14_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A14_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A14_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A14_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT LAST) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 2 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A15_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---+
| c |
+---+
| 4 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A15_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 4 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A15_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---+
| c |
+---+
| 4 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_count_A15_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT cnt) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---+
| c |
+---+
| 4 |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT server_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+--------------+
| server_ip    |
+--------------+
| 172.31.11.5  |
| 172.31.57.89 |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT server_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+
| server_ip    |
+--------------+
| 172.31.11.5  |
| 172.31.57.89 |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT server_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+--------------+
| server_ip    |
+--------------+
| 172.31.11.5  |
| 172.31.57.89 |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT server_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+
| server_ip    |
+--------------+
| 172.31.11.5  |
| 172.31.57.89 |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT client_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---------------+
| client_ip     |
+---------------+
| 107.13.54.103 |
| 99.9.55.22    |
+---------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT client_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---------------+
| client_ip     |
+---------------+
| 107.13.54.103 |
| 99.9.55.22    |
+---------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT client_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---------------+
| client_ip     |
+---------------+
| 107.13.54.103 |
| 99.9.55.22    |
+---------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT client_ip
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---------------+
| client_ip     |
+---------------+
| 107.13.54.103 |
| 99.9.55.22    |
+---------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT timezone
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+----------+
| timezone |
+----------+
| EDT      |
| N/A      |
+----------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT timezone
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+----------+
| timezone |
+----------+
| EDT      |
| N/A      |
+----------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT timezone
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+----------+
| timezone |
+----------+
| EDT      |
| N/A      |
+----------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT timezone
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+----------+
| timezone |
+----------+
| EDT      |
| N/A      |
+----------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT t
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+---------------------+
| t                   |
+---------------------+
| 2019-08-25 00:00:00 |
| 2019-08-25 12:00:00 |
+---------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT t
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---------------------+
| t                   |
+---------------------+
| 2019-08-25 00:00:00 |
| 2019-08-25 12:00:00 |
+---------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT t
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+---------------------+
| t                   |
+---------------------+
| 2019-08-25 00:00:00 |
| 2019-08-25 12:00:00 |
+---------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT t
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+---------------------+
| t                   |
+---------------------+
| 2019-08-25 00:00:00 |
| 2019-08-25 12:00:00 |
+---------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT FIRST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+-------+
| FIRST |
+-------+
| EDT   |
| N/A   |
+-------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT FIRST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+-------+
| FIRST |
+-------+
| EDT   |
| N/A   |
+-------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT FIRST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+-------+
| FIRST |
+-------+
| EDT   |
| N/A   |
+-------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT FIRST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+-------+
| FIRST |
+-------+
| EDT   |
| N/A   |
+-------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A6_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT LAST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+------+
| LAST |
+------+
| EDT  |
| N/A  |
+------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A6_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT LAST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+------+
| LAST |
+------+
| EDT  |
| N/A  |
+------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A6_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT LAST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+------+
| LAST |
+------+
| EDT  |
| N/A  |
+------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A6_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT LAST
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+------+
| LAST |
+------+
| EDT  |
| N/A  |
+------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A7_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+-----+
| cnt |
+-----+
|   1 |
|   2 |
|   3 |
|   6 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A7_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+-----+
| cnt |
+-----+
|   1 |
|   2 |
|   3 |
|   6 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A7_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+-----+
| cnt |
+-----+
|   1 |
|   2 |
|   3 |
|   6 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_select_distinct_A7_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+-----+
| cnt |
+-----+
|   1 |
|   2 |
|   3 |
|   6 |
+-----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip ASC,
                                                        length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A4_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'))
SELECT *
FROM t1;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
SELECT *
FROM t1;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A4_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
SELECT *
FROM t1;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
SELECT *
FROM t1;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A5_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'))
SELECT *
FROM t1
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A5_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
SELECT *
FROM t1
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A5_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
SELECT *
FROM t1
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_subquery_with_where_A5_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
SELECT *
FROM t1
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
HAVING client_ip IN ('107.13.54.103',
                     '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
HAVING client_ip IN ('107.13.54.103',
                     '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                ORDER BY server_ip ASC,
                                                         length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A3_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY rollup(server_ip, client_ip, timezone, time_floor(__time, 'PT12H'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      |                     | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      |                     | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 |          |                     | EDT   |      |   5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    |          |                     | N/A   |      |   2 |
| 172.31.11.5  |               |          |                     |       |      |   0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      |                     | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      |                     | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 |          |                     | EDT   |      |  10 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    |          |                     | N/A   |      |   4 |
| 172.31.57.89 |               |          |                     |       |      |   0 |
|              |               |          |                     |       |      |   0 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(21 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A3_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY rollup(server_ip, client_ip, timezone, time_floor(__time, 'PT12H')) WINDOW w AS (PARTITION BY client_ip
                                                                                          ORDER BY server_ip ASC,
                                                                                                   length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      |                     | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      |                     | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 |          |                     | EDT   |      |   5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    |          |                     | N/A   |      |   2 |
| 172.31.11.5  |               |          |                     |       |      |   0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      |                     | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      |                     | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 |          |                     | EDT   |      |  10 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    |          |                     | N/A   |      |   4 |
| 172.31.57.89 |               |          |                     |       |      |   0 |
|              |               |          |                     |       |      |   0 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(21 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A3_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY rollup(server_ip, client_ip, timezone, time_floor(__time, 'PT12H'))
HAVING client_ip IN ('107.13.54.103',
                     '99.9.55.22');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      |                     | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      |                     | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 |          |                     | EDT   |      |   5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    |          |                     | N/A   |      |   2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      |                     | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      |                     | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 |          |                     | EDT   |      |  10 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    |          |                     | N/A   |      |   4 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(18 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_group_by_A3_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY rollup(server_ip, client_ip, timezone, time_floor(__time, 'PT12H'))
HAVING client_ip IN ('107.13.54.103',
                     '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                ORDER BY server_ip ASC,
                                                         length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | EDT      |                     | EDT   | EDT  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 | N/A      |                     | EDT   | N/A  |   5 |
| 172.31.11.5  | 107.13.54.103 |          |                     | EDT   |      |   5 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    |          |                     | N/A   |      |   2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | EDT      |                     | EDT   | EDT  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 | N/A      |                     | EDT   | N/A  |  10 |
| 172.31.57.89 | 107.13.54.103 |          |                     | EDT   |      |  10 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    | N/A      |                     | N/A   | N/A  |   4 |
| 172.31.57.89 | 99.9.55.22    |          |                     | N/A   |      |   4 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(18 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY server_ip ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY server_ip ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY server_ip DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY server_ip DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A3_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY client_ip ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A3_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY client_ip ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A4_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY client_ip DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A4_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY client_ip DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A5_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY timezone ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A5_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY timezone ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A6_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY timezone DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A6_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY timezone DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A7_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY t ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A7_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY t ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A8_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY t DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A8_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY t DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A9_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY FIRST ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A9_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY FIRST ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A10_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY FIRST DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A10_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY FIRST DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A11_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY LAST ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A11_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY LAST ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A12_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY LAST DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A12_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY LAST DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A13_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY cnt ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A13_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY cnt ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A14_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY cnt DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A14_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY cnt DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A15_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY server_ip ASC,
         client_ip ASC,
         timezone ASC,
         t ASC,
         FIRST ASC, LAST ASC, cnt ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A15_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY server_ip ASC,
         client_ip ASC,
         timezone ASC,
         t ASC,
         FIRST ASC, LAST ASC, cnt ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A16_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY server_ip DESC,
         client_ip DESC,
         timezone DESC,
         t DESC,
         FIRST DESC, LAST DESC, cnt DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A16_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY server_ip DESC,
         client_ip DESC,
         timezone DESC,
         t DESC,
         FIRST DESC, LAST DESC, cnt DESC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A17_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H')
ORDER BY server_ip ASC,
         client_ip DESC,
         timezone ASC,
         t DESC,
         FIRST ASC, LAST DESC, cnt ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_order_by_A17_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
ORDER BY server_ip ASC,
         client_ip DESC,
         timezone ASC,
         t DESC,
         FIRST ASC, LAST DESC, cnt ASC;
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A1_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   LIMIT 5);
+--------+
| EXPR$0 |
+--------+
|      5 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
   LIMIT 5);
+--------+
| EXPR$0 |
+--------+
|      5 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')
   LIMIT 5);
+--------+
| EXPR$0 |
+--------+
|      5 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
   LIMIT 5);
+--------+
| EXPR$0 |
+--------+
|      5 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A2_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
     OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
     OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A2_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')
   OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
   OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A3_G1_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   LIMIT 5
   OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
   LIMIT 5
   OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A3_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')
   LIMIT 5
   OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_limit_offset_A3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*)
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)
   LIMIT 5
   OFFSET 5);
+--------+
| EXPR$0 |
+--------+
|      3 |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A1_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
INNER JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A2_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A3_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
LEFT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A4_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
RIGHT JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A5_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
FULL JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2 ON t1.server_ip=t2.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A6_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t1
CROSS JOIN
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2;
+----+
| c  |
+----+
| 64 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H')) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_join_A7_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t2,

  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC)) t3
WHERE t2.server_ip=t3.server_ip;
+----+
| c  |
+----+
| 32 |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G2_Q1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER (PARTITION BY client_ip
                                   ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                               last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                          ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                      count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                            ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
FROM
  (SELECT *
   FROM kttm_nested
   UNION ALL SELECT *
   FROM kttm_nested)
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H');
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       first_value(timezone) OVER w FIRST,
                                    last_value(timezone) OVER w LAST,
                                                                count(timezone) OVER w cnt
FROM
  (SELECT *
   FROM kttm_nested
   UNION ALL SELECT *
   FROM kttm_nested)
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC);
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G1_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G1_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G1_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G1_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM
     (SELECT server_ip,
             client_ip,
             timezone,
             time_floor(__time, 'PT12H') __time
      FROM kttm_nested
      GROUP BY server_ip,
               client_ip,
               timezone,
               time_floor(__time, 'PT12H'))
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip ASC,
                                                           length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G2_Q3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G2_Q4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G2_Q5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER (PARTITION BY client_ip
                                      ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) FIRST,
                                                                                                                                  last_value(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                             ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) LAST,
                                                                                                                                                                                                                                                         count(timezone) OVER (PARTITION BY client_ip
                                                                                                                                                                                                                                                                               ORDER BY server_ip ASC, length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC) cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TEST_ID: test_sql_test_union_all_A1_G2_Q6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT *
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC))
UNION ALL
  (SELECT server_ip,
          client_ip,
          timezone,
          cast(time_floor(__time, 'PT12H') AS char) t,
          first_value(timezone) OVER w FIRST,
                                       last_value(timezone) OVER w LAST,
                                                                   count(timezone) OVER w cnt
   FROM kttm_nested
   WHERE client_ip IN ('107.13.54.103',
                       '99.9.55.22')
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                     ORDER BY server_ip ASC,
                                                              length(server_ip) ASC, cast(length(server_ip) AS DOUBLE)+0.123 ASC));
+--------------+---------------+----------+---------------------+-------+------+-----+
| server_ip    | client_ip     | timezone | t                   | FIRST | LAST | cnt |
+--------------+---------------+----------+---------------------+-------+------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT   | EDT  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT   | N/A  |   6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A   | N/A  |   2 |
+--------------+---------------+----------+---------------------+-------+------+-----+
(16 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 217 Positive tests: 217 Negative tests: 0
#-------------------------------------------------------------------------
