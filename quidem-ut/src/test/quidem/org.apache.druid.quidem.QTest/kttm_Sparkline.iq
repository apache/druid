#started Wed Jul 10 19:15:04 IST 2024
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
# Wed Jul 10 19:16:01 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:34.290 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:16:01 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:34.290 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:16:08 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "session_length" ASC
LIMIT 100;
+----------------+
| session_length |
+----------------+
|           10.0 |
|           20.0 |
|           30.0 |
|           40.0 |
|           50.0 |
|           60.0 |
|           70.0 |
|           80.0 |
|           90.0 |
|          100.0 |
|          110.0 |
|          120.0 |
|          130.0 |
|          140.0 |
|          150.0 |
|          160.0 |
|          170.0 |
|          180.0 |
|          190.0 |
|          200.0 |
|          210.0 |
|          220.0 |
|          230.0 |
|          240.0 |
|          250.0 |
|          260.0 |
|          270.0 |
|          280.0 |
|          290.0 |
|          300.0 |
|          310.0 |
|          320.0 |
|          330.0 |
|          340.0 |
|          350.0 |
|          360.0 |
|          370.0 |
|          380.0 |
|          390.0 |
|          400.0 |
|          410.0 |
|          420.0 |
|          430.0 |
|          440.0 |
|          450.0 |
|          460.0 |
|          470.0 |
|          480.0 |
|          490.0 |
|          500.0 |
|          510.0 |
|          520.0 |
|          530.0 |
|          540.0 |
|          550.0 |
|          560.0 |
|          570.0 |
|          580.0 |
|          600.0 |
|          610.0 |
|          620.0 |
|          630.0 |
|          640.0 |
|          650.0 |
|          660.0 |
|          680.0 |
|          690.0 |
|          700.0 |
|          720.0 |
|          730.0 |
|          740.0 |
|          750.0 |
|          760.0 |
|          770.0 |
|          780.0 |
|          790.0 |
|          810.0 |
|          820.0 |
|          840.0 |
|          850.0 |
|          860.0 |
|          880.0 |
|          890.0 |
|          900.0 |
|          930.0 |
|          960.0 |
|          970.0 |
|          980.0 |
|          990.0 |
|         1040.0 |
|         1080.0 |
|         1100.0 |
|         1140.0 |
|         1150.0 |
|         1180.0 |
|         1190.0 |
|         1230.0 |
|         1240.0 |
|         1250.0 |
|         1260.0 |
+----------------+
(100 rows)

!ok
# Wed Jul 10 19:16:09 IST 2024
SELECT
(COUNT(*)) AS "__VALUE__"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY ();
+-----------+
| __VALUE__ |
+-----------+
|         0 |
+-----------+
(1 row)

!ok
# Wed Jul 10 19:16:13 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00')
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |   127 |
| 2019-08-25 01:00:00.000 |   135 |
| 2019-08-25 02:00:00.000 |   171 |
| 2019-08-25 03:00:00.000 |   133 |
| 2019-08-25 04:00:00.000 |   118 |
| 2019-08-25 05:00:00.000 |    80 |
| 2019-08-25 06:00:00.000 |    68 |
| 2019-08-25 07:00:00.000 |    43 |
| 2019-08-25 08:00:00.000 |    66 |
| 2019-08-25 09:00:00.000 |    53 |
| 2019-08-25 10:00:00.000 |    70 |
| 2019-08-25 11:00:00.000 |    74 |
| 2019-08-25 12:00:00.000 |    77 |
| 2019-08-25 13:00:00.000 |   127 |
| 2019-08-25 14:00:00.000 |   193 |
| 2019-08-25 15:00:00.000 |   124 |
| 2019-08-25 16:00:00.000 |   360 |
| 2019-08-25 17:00:00.000 |   589 |
| 2019-08-25 18:00:00.000 |   472 |
| 2019-08-25 19:00:00.000 |   469 |
| 2019-08-25 20:00:00.000 |   422 |
| 2019-08-25 21:00:00.000 |   287 |
| 2019-08-25 22:00:00.000 |   226 |
+-------------------------+-------+
(23 rows)

!ok
# Wed Jul 10 19:16:13 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:15 IST 2024
SELECT
CAST(t."adblock_list" AS VARCHAR) AS "adblock_list",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+----------------------------+-------+
| adblock_list               | count |
+----------------------------+-------+
| NoAdblock                  |  4239 |
| EasyList                   |   439 |
| EasyList,AntiAdblockKiller |     3 |
+----------------------------+-------+
(3 rows)

!ok
# Wed Jul 10 19:16:16 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 22:00:00') AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |   116 |
| 2019-08-25 01:00:00.000 |   120 |
| 2019-08-25 02:00:00.000 |   156 |
| 2019-08-25 03:00:00.000 |   122 |
| 2019-08-25 04:00:00.000 |   103 |
| 2019-08-25 05:00:00.000 |    73 |
| 2019-08-25 06:00:00.000 |    60 |
| 2019-08-25 07:00:00.000 |    41 |
| 2019-08-25 08:00:00.000 |    58 |
| 2019-08-25 09:00:00.000 |    44 |
| 2019-08-25 10:00:00.000 |    64 |
| 2019-08-25 11:00:00.000 |    62 |
| 2019-08-25 12:00:00.000 |    63 |
| 2019-08-25 13:00:00.000 |   113 |
| 2019-08-25 14:00:00.000 |   176 |
| 2019-08-25 15:00:00.000 |   106 |
| 2019-08-25 16:00:00.000 |   335 |
| 2019-08-25 17:00:00.000 |   546 |
| 2019-08-25 18:00:00.000 |   431 |
| 2019-08-25 19:00:00.000 |   438 |
| 2019-08-25 20:00:00.000 |   388 |
| 2019-08-25 21:00:00.000 |   263 |
+-------------------------+-------+
(22 rows)

!ok
# Wed Jul 10 19:16:16 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 22:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:16 IST 2024
SELECT
(COUNT(*)) AS "v0",
(COUNT(*) FILTER (WHERE (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))) AS "v1"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY ();
+------+----+
| v0   | v1 |
+------+----+
| 4239 |  0 |
+------+----+
(1 row)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00')
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00') AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:25 IST 2024
SELECT
(COUNT(*)) AS "v0",
(COUNT(*) FILTER (WHERE (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))) AS "v1",
(COUNT(*) FILTER (WHERE (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))) AS "v2",
(COUNT(*) FILTER (WHERE ((-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock')))) AS "v3"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00')
GROUP BY ();
+----+----+----+----+
| v0 | v1 | v2 | v3 |
+----+----+----+----+
|  0 |  0 |  0 |  0 |
+----+----+----+----+
(1 row)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 21:00:00')
GROUP BY 1;
+-------------------------+--------------------+
| __time                  | sum_session_length |
+-------------------------+--------------------+
| 2019-08-25 00:00:00.000 |          135979998 |
| 2019-08-25 01:00:00.000 |           13118855 |
| 2019-08-25 02:00:00.000 |           17222198 |
| 2019-08-25 03:00:00.000 |           33910318 |
| 2019-08-25 04:00:00.000 |          194775755 |
| 2019-08-25 05:00:00.000 |          134078908 |
| 2019-08-25 06:00:00.000 |            4689436 |
| 2019-08-25 07:00:00.000 |            3513179 |
| 2019-08-25 08:00:00.000 |            8404765 |
| 2019-08-25 09:00:00.000 |            3960697 |
| 2019-08-25 10:00:00.000 |            5395486 |
| 2019-08-25 11:00:00.000 |            6271638 |
| 2019-08-25 12:00:00.000 |            4838629 |
| 2019-08-25 13:00:00.000 |           82946447 |
| 2019-08-25 14:00:00.000 |           55016342 |
| 2019-08-25 15:00:00.000 |           54245761 |
| 2019-08-25 16:00:00.000 |           31471099 |
| 2019-08-25 17:00:00.000 |           49338285 |
| 2019-08-25 18:00:00.000 |           95113032 |
| 2019-08-25 19:00:00.000 |           45927055 |
| 2019-08-25 20:00:00.000 |           51637132 |
+-------------------------+--------------------+
(21 rows)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00')
GROUP BY 1;
+--------+--------------------+
| __time | sum_session_length |
+--------+--------------------+
+--------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 21:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+--------------------+
| __time | sum_session_length |
+--------+--------------------+
+--------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+--------------------+
| __time | sum_session_length |
+--------+--------------------+
+--------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:29 IST 2024
SELECT
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v1",
(SUM(t."session_length") FILTER (WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)))) AS "v2",
(SUM(t."session_length") FILTER (WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)))) AS "v3"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY ();
+------------+----+----+----+
| v0         | v1 | v2 | v3 |
+------------+----+----+----+
| 1205499001 |    |    |    |
+------------+----+----+----+
(1 row)

!ok
# Wed Jul 10 19:16:34 IST 2024
SELECT
CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR) AS "Layer",
(COUNT(*)) AS "r"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "r" DESC
LIMIT 101;
+-------+------+
| Layer | r    |
+-------+------+
|       | 3487 |
| 6     |  332 |
| 5     |  290 |
| 4     |  210 |
| 3     |  166 |
| 2     |  120 |
| 1     |   47 |
| 0     |   29 |
+-------+------+
(8 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1
ORDER BY "session_length" ASC
LIMIT 100;
+----------------+
| session_length |
+----------------+
|         1040.0 |
|         1140.0 |
|         1180.0 |
|         1240.0 |
|         1290.0 |
|         1300.0 |
|         1310.0 |
|         1340.0 |
|         1360.0 |
|         1380.0 |
|         1400.0 |
|         1410.0 |
|         1420.0 |
|         1440.0 |
|         1450.0 |
|         1460.0 |
|         1470.0 |
|         1490.0 |
|         1510.0 |
|         1530.0 |
|         1560.0 |
|         1580.0 |
|         1590.0 |
|         1600.0 |
|         1620.0 |
|         1640.0 |
|         1660.0 |
|         1670.0 |
|         1680.0 |
|         1690.0 |
|         1700.0 |
|         1720.0 |
|         1730.0 |
|         1760.0 |
|         1790.0 |
|         1820.0 |
|         1830.0 |
|         1860.0 |
|         1870.0 |
|         1880.0 |
|         1900.0 |
|         1910.0 |
|         1920.0 |
|         1940.0 |
|         1970.0 |
|         1980.0 |
|         1990.0 |
|         2000.0 |
|         2010.0 |
|         2030.0 |
|         2060.0 |
|         2100.0 |
|         2140.0 |
|         2150.0 |
|         2160.0 |
|         2170.0 |
|         2190.0 |
|         2200.0 |
|         2240.0 |
|         2250.0 |
|         2260.0 |
|         2280.0 |
|         2300.0 |
|         2310.0 |
|         2320.0 |
|         2340.0 |
|         2350.0 |
|         2360.0 |
|         2380.0 |
|         2410.0 |
|         2440.0 |
|         2460.0 |
|         2490.0 |
|         2510.0 |
|         2550.0 |
|         2580.0 |
|         2590.0 |
|         2600.0 |
|         2670.0 |
|         2690.0 |
|         2710.0 |
|         2750.0 |
|         2760.0 |
|         2820.0 |
|         2830.0 |
|         2870.0 |
|         2880.0 |
|         2920.0 |
|         2940.0 |
|         2950.0 |
|         2960.0 |
|         2970.0 |
|         2990.0 |
|         3000.0 |
|         3100.0 |
|         3110.0 |
|         3160.0 |
|         3190.0 |
|         3200.0 |
|         3250.0 |
+----------------+
(100 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v1",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v2",
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v3"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY ();
+-----+---------+----+----+
| v0  | v1      | v2 | v3 |
+-----+---------+----+----+
| 332 | 3322353 |  0 |    |
+-----+---------+----+----+
(1 row)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
CAST(t."adblock_list" AS VARCHAR) AS "adblock_list",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+--------------+-------+
| adblock_list | count |
+--------------+-------+
| NoAdblock    |   299 |
| EasyList     |    33 |
+--------------+-------+
(2 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
|         1040.0 |     1 |               1049 |
|         1140.0 |     1 |               1141 |
|         1180.0 |     2 |               2360 |
|         1240.0 |     2 |               2494 |
|         1290.0 |     1 |               1296 |
|         1300.0 |     1 |               1309 |
|         1310.0 |     1 |               1316 |
|         1340.0 |     1 |               1346 |
|         1360.0 |     1 |               1361 |
|         1380.0 |     1 |               1385 |
|         1400.0 |     1 |               1405 |
|         1410.0 |     2 |               2831 |
|         1420.0 |     1 |               1426 |
|         1440.0 |     1 |               1446 |
|         1450.0 |     1 |               1456 |
|         1460.0 |     1 |               1466 |
|         1470.0 |     1 |               1472 |
|         1490.0 |     1 |               1496 |
|         1510.0 |     2 |               3032 |
|         1530.0 |     1 |               1533 |
|         1560.0 |     2 |               3131 |
|         1580.0 |     3 |               4743 |
|         1590.0 |     2 |               3188 |
|         1600.0 |     1 |               1606 |
|         1620.0 |     1 |               1622 |
|         1640.0 |     2 |               3295 |
|         1660.0 |     1 |               1667 |
|         1670.0 |     1 |               1678 |
|         1680.0 |     1 |               1683 |
|         1690.0 |     2 |               3388 |
|         1700.0 |     1 |               1704 |
|         1720.0 |     1 |               1720 |
|         1730.0 |     2 |               3475 |
|         1760.0 |     2 |               3535 |
|         1790.0 |     1 |               1799 |
|         1820.0 |     3 |               5465 |
|         1830.0 |     1 |               1833 |
|         1860.0 |     1 |               1862 |
|         1870.0 |     1 |               1879 |
|         1880.0 |     1 |               1885 |
|         1900.0 |     1 |               1905 |
|         1910.0 |     3 |               5744 |
|         1920.0 |     2 |               3849 |
|         1940.0 |     2 |               3888 |
|         1970.0 |     1 |               1975 |
|         1980.0 |     1 |               1987 |
|         1990.0 |     1 |               1993 |
|         2000.0 |     1 |               2004 |
|         2010.0 |     1 |               2016 |
|         2030.0 |     1 |               2030 |
+----------------+-------+--------------------+
(50 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 22:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 03:00:00.000 |         1990.0 |     1 |               1993 |
| 2019-08-25 05:00:00.000 |         1180.0 |     1 |               1180 |
| 2019-08-25 17:00:00.000 |         1040.0 |     1 |               1049 |
| 2019-08-25 00:00:00.000 |         1820.0 |     1 |               1822 |
| 2019-08-25 00:00:00.000 |         1940.0 |     1 |               1943 |
| 2019-08-25 01:00:00.000 |         1440.0 |     1 |               1446 |
| 2019-08-25 01:00:00.000 |         1760.0 |     1 |               1768 |
| 2019-08-25 03:00:00.000 |         1590.0 |     2 |               3188 |
| 2019-08-25 03:00:00.000 |         1820.0 |     1 |               1821 |
| 2019-08-25 04:00:00.000 |         1530.0 |     1 |               1533 |
| 2019-08-25 04:00:00.000 |         1640.0 |     1 |               1648 |
| 2019-08-25 05:00:00.000 |         1400.0 |     1 |               1405 |
| 2019-08-25 13:00:00.000 |         1240.0 |     1 |               1247 |
| 2019-08-25 13:00:00.000 |         1470.0 |     1 |               1472 |
| 2019-08-25 14:00:00.000 |         1730.0 |     1 |               1739 |
| 2019-08-25 14:00:00.000 |         1910.0 |     1 |               1916 |
| 2019-08-25 15:00:00.000 |         1310.0 |     1 |               1316 |
| 2019-08-25 15:00:00.000 |         1410.0 |     1 |               1418 |
| 2019-08-25 15:00:00.000 |         1580.0 |     1 |               1581 |
| 2019-08-25 16:00:00.000 |         1290.0 |     1 |               1296 |
| 2019-08-25 16:00:00.000 |         1640.0 |     1 |               1647 |
| 2019-08-25 16:00:00.000 |         1660.0 |     1 |               1667 |
| 2019-08-25 16:00:00.000 |         1690.0 |     1 |               1691 |
| 2019-08-25 16:00:00.000 |         2000.0 |     1 |               2004 |
| 2019-08-25 17:00:00.000 |         1180.0 |     1 |               1180 |
| 2019-08-25 17:00:00.000 |         1450.0 |     1 |               1456 |
| 2019-08-25 17:00:00.000 |         1560.0 |     1 |               1568 |
| 2019-08-25 17:00:00.000 |         1580.0 |     2 |               3162 |
| 2019-08-25 17:00:00.000 |         1700.0 |     1 |               1704 |
| 2019-08-25 17:00:00.000 |         1760.0 |     1 |               1767 |
| 2019-08-25 17:00:00.000 |         1830.0 |     1 |               1833 |
| 2019-08-25 17:00:00.000 |         1970.0 |     1 |               1975 |
| 2019-08-25 18:00:00.000 |         1300.0 |     1 |               1309 |
| 2019-08-25 18:00:00.000 |         1360.0 |     1 |               1361 |
| 2019-08-25 18:00:00.000 |         1560.0 |     1 |               1563 |
| 2019-08-25 18:00:00.000 |         1820.0 |     1 |               1822 |
| 2019-08-25 18:00:00.000 |         1860.0 |     1 |               1862 |
| 2019-08-25 18:00:00.000 |         1880.0 |     1 |               1885 |
| 2019-08-25 18:00:00.000 |         1900.0 |     1 |               1905 |
| 2019-08-25 18:00:00.000 |         1910.0 |     2 |               3828 |
| 2019-08-25 18:00:00.000 |         1980.0 |     1 |               1987 |
| 2019-08-25 19:00:00.000 |         1510.0 |     1 |               1518 |
| 2019-08-25 19:00:00.000 |         1920.0 |     2 |               3849 |
| 2019-08-25 19:00:00.000 |         1940.0 |     1 |               1945 |
| 2019-08-25 19:00:00.000 |         2010.0 |     1 |               2016 |
| 2019-08-25 20:00:00.000 |         1340.0 |     1 |               1346 |
| 2019-08-25 20:00:00.000 |         1380.0 |     1 |               1385 |
| 2019-08-25 20:00:00.000 |         1410.0 |     1 |               1413 |
| 2019-08-25 20:00:00.000 |         1420.0 |     1 |               1426 |
| 2019-08-25 20:00:00.000 |         1680.0 |     1 |               1683 |
| 2019-08-25 20:00:00.000 |         1720.0 |     1 |               1720 |
| 2019-08-25 21:00:00.000 |         1490.0 |     1 |               1496 |
| 2019-08-25 21:00:00.000 |         1510.0 |     1 |               1514 |
| 2019-08-25 21:00:00.000 |         1670.0 |     1 |               1678 |
| 2019-08-25 21:00:00.000 |         1790.0 |     1 |               1799 |
+-------------------------+----------------+-------+--------------------+
(55 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 21:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 00:00:00.000 |     6 |              75091 |
| 2019-08-25 01:00:00.000 |     8 |              88048 |
| 2019-08-25 02:00:00.000 |     8 |              39412 |
| 2019-08-25 03:00:00.000 |     9 |              33819 |
| 2019-08-25 04:00:00.000 |    14 |             911652 |
| 2019-08-25 05:00:00.000 |     6 |              26264 |
| 2019-08-25 06:00:00.000 |     4 |              43225 |
| 2019-08-25 07:00:00.000 |     3 |              14919 |
| 2019-08-25 08:00:00.000 |     2 |              11783 |
| 2019-08-25 09:00:00.000 |     1 |               3841 |
| 2019-08-25 10:00:00.000 |     3 |              19613 |
| 2019-08-25 11:00:00.000 |     6 |              35423 |
| 2019-08-25 12:00:00.000 |     7 |              58277 |
| 2019-08-25 13:00:00.000 |    12 |              87344 |
| 2019-08-25 14:00:00.000 |    10 |             105767 |
| 2019-08-25 15:00:00.000 |    13 |              94549 |
| 2019-08-25 16:00:00.000 |    30 |             229800 |
| 2019-08-25 17:00:00.000 |    40 |             271939 |
| 2019-08-25 18:00:00.000 |    28 |             388065 |
| 2019-08-25 19:00:00.000 |    38 |             223852 |
| 2019-08-25 20:00:00.000 |    29 |             185857 |
+-------------------------+-------+--------------------+
(21 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:44 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1
ORDER BY "session_length" ASC
LIMIT 5000;
+----------------+
| session_length |
+----------------+
|         1040.0 |
|         1140.0 |
|         1180.0 |
|         1240.0 |
|         1290.0 |
|         1300.0 |
|         1310.0 |
|         1340.0 |
|         1360.0 |
|         1380.0 |
|         1400.0 |
|         1410.0 |
|         1420.0 |
|         1440.0 |
|         1450.0 |
|         1460.0 |
|         1470.0 |
|         1490.0 |
|         1510.0 |
|         1530.0 |
|         1560.0 |
|         1580.0 |
|         1590.0 |
|         1600.0 |
|         1620.0 |
|         1640.0 |
|         1660.0 |
|         1670.0 |
|         1680.0 |
|         1690.0 |
|         1700.0 |
|         1720.0 |
|         1730.0 |
|         1760.0 |
|         1790.0 |
|         1820.0 |
|         1830.0 |
|         1860.0 |
|         1870.0 |
|         1880.0 |
|         1900.0 |
|         1910.0 |
|         1920.0 |
|         1940.0 |
|         1970.0 |
|         1980.0 |
|         1990.0 |
|         2000.0 |
|         2010.0 |
|         2030.0 |
|         2060.0 |
|         2100.0 |
|         2140.0 |
|         2150.0 |
|         2160.0 |
|         2170.0 |
|         2190.0 |
|         2200.0 |
|         2240.0 |
|         2250.0 |
|         2260.0 |
|         2280.0 |
|         2300.0 |
|         2310.0 |
|         2320.0 |
|         2340.0 |
|         2350.0 |
|         2360.0 |
|         2380.0 |
|         2410.0 |
|         2440.0 |
|         2460.0 |
|         2490.0 |
|         2510.0 |
|         2550.0 |
|         2580.0 |
|         2590.0 |
|         2600.0 |
|         2670.0 |
|         2690.0 |
|         2710.0 |
|         2750.0 |
|         2760.0 |
|         2820.0 |
|         2830.0 |
|         2870.0 |
|         2880.0 |
|         2920.0 |
|         2940.0 |
|         2950.0 |
|         2960.0 |
|         2970.0 |
|         2990.0 |
|         3000.0 |
|         3100.0 |
|         3110.0 |
|         3160.0 |
|         3190.0 |
|         3200.0 |
|         3250.0 |
|         3270.0 |
|         3280.0 |
|         3330.0 |
|         3380.0 |
|         3400.0 |
|         3420.0 |
|         3440.0 |
|         3450.0 |
|         3470.0 |
|         3510.0 |
|         3550.0 |
|         3560.0 |
|         3580.0 |
|         3630.0 |
|         3650.0 |
|         3660.0 |
|         3710.0 |
|         3830.0 |
|         3840.0 |
|         3860.0 |
|         3870.0 |
|         3890.0 |
|         3930.0 |
|         3960.0 |
|         3970.0 |
|         4000.0 |
|         4040.0 |
|         4050.0 |
|         4060.0 |
|         4140.0 |
|         4170.0 |
|         4210.0 |
|         4230.0 |
|         4250.0 |
|         4280.0 |
|         4290.0 |
|         4340.0 |
|         4400.0 |
|         4460.0 |
|         4580.0 |
|         4590.0 |
|         4610.0 |
|         4630.0 |
|         4670.0 |
|         4690.0 |
|         4730.0 |
|         4750.0 |
|         4770.0 |
|         5000.0 |
|         5050.0 |
|         5090.0 |
|         5130.0 |
|         5170.0 |
|         5210.0 |
|         5260.0 |
|         5330.0 |
|         5380.0 |
|         5440.0 |
|         5450.0 |
|         5500.0 |
|         5540.0 |
|         5550.0 |
|         5590.0 |
|         5620.0 |
|         5670.0 |
|         5720.0 |
|         5750.0 |
|         5760.0 |
|         5880.0 |
|         5890.0 |
|         5900.0 |
|         5940.0 |
|         5970.0 |
|         6080.0 |
|         6150.0 |
|         6330.0 |
|         6420.0 |
|         6460.0 |
|         6490.0 |
|         6500.0 |
|         6510.0 |
|         6530.0 |
|         6540.0 |
|         6660.0 |
|         6740.0 |
|         6790.0 |
|         6840.0 |
|         7040.0 |
|         7070.0 |
|         7080.0 |
|         7240.0 |
|         7430.0 |
|         7460.0 |
|         7470.0 |
|         7480.0 |
|         7500.0 |
|         7540.0 |
|         7620.0 |
|         7670.0 |
|         7700.0 |
|         7730.0 |
|         7860.0 |
|         7980.0 |
|         8040.0 |
|         8050.0 |
|         8070.0 |
|         8120.0 |
|         8190.0 |
|         8220.0 |
|         8280.0 |
|         8330.0 |
|         8350.0 |
|         8370.0 |
|         8420.0 |
|         8430.0 |
|         8520.0 |
|         8870.0 |
|         9170.0 |
|         9180.0 |
|         9230.0 |
|         9350.0 |
|         9440.0 |
|         9460.0 |
|         9670.0 |
|         9680.0 |
|         9760.0 |
|         9770.0 |
|         9970.0 |
|         9990.0 |
|        10000.0 |
|        10260.0 |
|        10320.0 |
|        10870.0 |
|        10920.0 |
|        11040.0 |
|        12350.0 |
|        12790.0 |
|        13170.0 |
|        13320.0 |
|        13460.0 |
|        13920.0 |
|        14090.0 |
|        14290.0 |
|        14360.0 |
|        14380.0 |
|        14990.0 |
|        15490.0 |
|        16280.0 |
|        16890.0 |
|        18820.0 |
|        19800.0 |
|        20490.0 |
|        21810.0 |
|        22500.0 |
|        23510.0 |
|        23750.0 |
|        24340.0 |
|        27110.0 |
|        30560.0 |
|        31060.0 |
|        36240.0 |
|        36350.0 |
|        40490.0 |
|        42720.0 |
|        49400.0 |
|        50650.0 |
|        52120.0 |
|        56370.0 |
|        56520.0 |
|        60270.0 |
|        62210.0 |
|        80860.0 |
|       139900.0 |
|       192630.0 |
|       682130.0 |
+----------------+
(275 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 05:00:00.000 |         1180.0 |     1 |               1180 |
| 2019-08-25 17:00:00.000 |         1040.0 |     1 |               1049 |
| 2019-08-25 13:00:00.000 |         1240.0 |     1 |               1247 |
| 2019-08-25 17:00:00.000 |         1180.0 |     1 |               1180 |
| 2019-08-25 23:00:00.000 |         1140.0 |     1 |               1141 |
| 2019-08-25 23:00:00.000 |         1240.0 |     1 |               1247 |
+-------------------------+----------------+-------+--------------------+
(6 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 00:00:00.000 |     6 |              75091 |
| 2019-08-25 01:00:00.000 |     8 |              88048 |
| 2019-08-25 02:00:00.000 |     8 |              39412 |
| 2019-08-25 03:00:00.000 |     9 |              33819 |
| 2019-08-25 04:00:00.000 |    14 |             911652 |
| 2019-08-25 05:00:00.000 |     6 |              26264 |
| 2019-08-25 06:00:00.000 |     4 |              43225 |
| 2019-08-25 07:00:00.000 |     3 |              14919 |
| 2019-08-25 08:00:00.000 |     2 |              11783 |
| 2019-08-25 09:00:00.000 |     1 |               3841 |
| 2019-08-25 10:00:00.000 |     3 |              19613 |
| 2019-08-25 11:00:00.000 |     6 |              35423 |
| 2019-08-25 12:00:00.000 |     7 |              58277 |
| 2019-08-25 13:00:00.000 |    12 |              87344 |
| 2019-08-25 14:00:00.000 |    10 |             105767 |
| 2019-08-25 15:00:00.000 |    13 |              94549 |
| 2019-08-25 16:00:00.000 |    30 |             229800 |
| 2019-08-25 17:00:00.000 |    40 |             271939 |
| 2019-08-25 18:00:00.000 |    28 |             388065 |
| 2019-08-25 19:00:00.000 |    38 |             223852 |
| 2019-08-25 20:00:00.000 |    29 |             185857 |
| 2019-08-25 21:00:00.000 |    17 |              81554 |
| 2019-08-25 22:00:00.000 |    17 |              77385 |
| 2019-08-25 23:00:00.000 |    21 |             214874 |
+-------------------------+-------+--------------------+
(24 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
|         1040.0 |     1 |               1049 |
|         1140.0 |     1 |               1141 |
|         1180.0 |     2 |               2360 |
|         1240.0 |     2 |               2494 |
+----------------+-------+--------------------+
(4 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------+-------+
| Browser         | count |
+-----------------+-------+
| Chrome          |   121 |
| Mobile Safari   |    85 |
| Chrome Mobile   |    55 |
| Safari          |    27 |
| Mozilla         |     3 |
| Yandex.Browser  |     3 |
| Firefox         |     2 |
| Android browser |     1 |
| Mobile Firefox  |     1 |
| Opera           |     1 |
+-----------------+-------+
(10 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 05:00:00.000 |         1180.0 |     1 |               1180 |
| 2019-08-25 17:00:00.000 |         1040.0 |     1 |               1049 |
| 2019-08-25 13:00:00.000 |         1240.0 |     1 |               1247 |
| 2019-08-25 17:00:00.000 |         1180.0 |     1 |               1180 |
| 2019-08-25 23:00:00.000 |         1140.0 |     1 |               1141 |
| 2019-08-25 23:00:00.000 |         1240.0 |     1 |               1247 |
+-------------------------+----------------+-------+--------------------+
(6 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1240)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 00:00:00.000 |     6 |              75091 |
| 2019-08-25 01:00:00.000 |     8 |              88048 |
| 2019-08-25 02:00:00.000 |     8 |              39412 |
| 2019-08-25 03:00:00.000 |     8 |              31508 |
| 2019-08-25 04:00:00.000 |    12 |             902541 |
| 2019-08-25 05:00:00.000 |     5 |              23324 |
| 2019-08-25 06:00:00.000 |     4 |              43225 |
| 2019-08-25 07:00:00.000 |     3 |              14919 |
| 2019-08-25 08:00:00.000 |     1 |               3656 |
| 2019-08-25 10:00:00.000 |     3 |              19613 |
| 2019-08-25 11:00:00.000 |     5 |              32549 |
| 2019-08-25 12:00:00.000 |     6 |              55859 |
| 2019-08-25 13:00:00.000 |     9 |              72874 |
| 2019-08-25 14:00:00.000 |    10 |             105767 |
| 2019-08-25 15:00:00.000 |    11 |              91550 |
| 2019-08-25 16:00:00.000 |    26 |             219982 |
| 2019-08-25 17:00:00.000 |    36 |             241317 |
| 2019-08-25 18:00:00.000 |    25 |             368602 |
| 2019-08-25 19:00:00.000 |    38 |             223852 |
| 2019-08-25 20:00:00.000 |    27 |             178709 |
| 2019-08-25 21:00:00.000 |    16 |              79447 |
| 2019-08-25 22:00:00.000 |    14 |              59811 |
| 2019-08-25 23:00:00.000 |    18 |             201662 |
+-------------------------+-------+--------------------+
(23 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1240<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1280)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1380))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 15:00:00.000 |         1310.0 |     1 |               1316 |
| 2019-08-25 16:00:00.000 |         1290.0 |     1 |               1296 |
| 2019-08-25 18:00:00.000 |         1300.0 |     1 |               1309 |
| 2019-08-25 18:00:00.000 |         1360.0 |     1 |               1361 |
| 2019-08-25 20:00:00.000 |         1340.0 |     1 |               1346 |
+-------------------------+----------------+-------+--------------------+
(5 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1420))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1460)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 01:00:00.000 |         1440.0 |     1 |               1446 |
| 2019-08-25 05:00:00.000 |         1400.0 |     1 |               1405 |
| 2019-08-25 15:00:00.000 |         1310.0 |     1 |               1316 |
| 2019-08-25 17:00:00.000 |         1450.0 |     1 |               1456 |
| 2019-08-25 18:00:00.000 |         1300.0 |     1 |               1309 |
| 2019-08-25 18:00:00.000 |         1360.0 |     1 |               1361 |
| 2019-08-25 20:00:00.000 |         1340.0 |     1 |               1346 |
| 2019-08-25 20:00:00.000 |         1380.0 |     1 |               1385 |
| 2019-08-25 20:00:00.000 |         1410.0 |     1 |               1413 |
+-------------------------+----------------+-------+--------------------+
(9 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1280<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1490)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1380<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1490))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 01:00:00.000 |         1440.0 |     1 |               1446 |
| 2019-08-25 05:00:00.000 |         1400.0 |     1 |               1405 |
| 2019-08-25 13:00:00.000 |         1470.0 |     1 |               1472 |
| 2019-08-25 15:00:00.000 |         1410.0 |     1 |               1418 |
| 2019-08-25 17:00:00.000 |         1450.0 |     1 |               1456 |
| 2019-08-25 20:00:00.000 |         1380.0 |     1 |               1385 |
| 2019-08-25 20:00:00.000 |         1410.0 |     1 |               1413 |
| 2019-08-25 20:00:00.000 |         1420.0 |     1 |               1426 |
| 2019-08-25 23:00:00.000 |         1460.0 |     1 |               1466 |
+-------------------------+----------------+-------+--------------------+
(9 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1420<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1480))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1460<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1470)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 23:00:00.000 |     1 |               1466 |
+-------------------------+-------+--------------------+
(1 row)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1450))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
|         1290.0 |     1 |               1296 |
|         1300.0 |     1 |               1309 |
|         1310.0 |     1 |               1316 |
|         1340.0 |     1 |               1346 |
|         1360.0 |     1 |               1361 |
|         1380.0 |     1 |               1385 |
|         1400.0 |     1 |               1405 |
|         1410.0 |     2 |               2831 |
|         1420.0 |     1 |               1426 |
|         1440.0 |     1 |               1446 |
+----------------+-------+--------------------+
(10 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1440))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
+----------------+-------+--------------------+
(0 rows)

!ok
