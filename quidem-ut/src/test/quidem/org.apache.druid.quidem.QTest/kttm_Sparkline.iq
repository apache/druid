#started Wed Jul 10 19:15:04 IST 2024
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
# Wed Jul 10 19:16:01 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:58.044 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:16:01 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:58.044 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:16:08 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "session_length" ASC
LIMIT 100;
+----------------+
| session_length |
+----------------+
|        -2020.0 |
|           10.0 |
|           20.0 |
|           30.0 |
|           40.0 |
|           50.0 |
|           60.0 |
|           70.0 |
|           80.0 |
|           90.0 |
|          100.0 |
|          110.0 |
|          120.0 |
|          130.0 |
|          140.0 |
|          150.0 |
|          160.0 |
|          170.0 |
|          180.0 |
|          190.0 |
|          200.0 |
|          210.0 |
|          220.0 |
|          230.0 |
|          240.0 |
|          250.0 |
|          260.0 |
|          270.0 |
|          280.0 |
|          290.0 |
|          300.0 |
|          310.0 |
|          320.0 |
|          330.0 |
|          340.0 |
|          350.0 |
|          360.0 |
|          370.0 |
|          380.0 |
|          390.0 |
|          400.0 |
|          410.0 |
|          420.0 |
|          430.0 |
|          440.0 |
|          450.0 |
|          460.0 |
|          470.0 |
|          480.0 |
|          490.0 |
|          500.0 |
|          510.0 |
|          520.0 |
|          530.0 |
|          540.0 |
|          550.0 |
|          560.0 |
|          570.0 |
|          580.0 |
|          590.0 |
|          610.0 |
|          620.0 |
|          630.0 |
|          640.0 |
|          650.0 |
|          670.0 |
|          690.0 |
|          700.0 |
|          710.0 |
|          720.0 |
|          730.0 |
|          740.0 |
|          750.0 |
|          760.0 |
|          770.0 |
|          780.0 |
|          790.0 |
|          810.0 |
|          830.0 |
|          840.0 |
|          850.0 |
|          880.0 |
|          890.0 |
|          900.0 |
|          960.0 |
|          980.0 |
|         1000.0 |
|         1050.0 |
|         1140.0 |
|         1150.0 |
|         1160.0 |
|         1170.0 |
|         1190.0 |
|         1210.0 |
|         1220.0 |
|         1230.0 |
|         1240.0 |
|         1250.0 |
|         1260.0 |
|         1270.0 |
+----------------+
(100 rows)

!ok
# Wed Jul 10 19:16:09 IST 2024
SELECT
(COUNT(*)) AS "__VALUE__"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY ();
+-----------+
| __VALUE__ |
+-----------+
|         0 |
+-----------+
(1 row)

!ok
# Wed Jul 10 19:16:13 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00')
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 06:00:00.000 |    68 |
| 2019-08-25 15:00:00.000 |   124 |
| 2019-08-25 00:00:00.000 |   145 |
| 2019-08-25 01:00:00.000 |   112 |
| 2019-08-25 02:00:00.000 |   154 |
| 2019-08-25 03:00:00.000 |   112 |
| 2019-08-25 04:00:00.000 |    71 |
| 2019-08-25 05:00:00.000 |    87 |
| 2019-08-25 07:00:00.000 |    60 |
| 2019-08-25 08:00:00.000 |    55 |
| 2019-08-25 09:00:00.000 |    61 |
| 2019-08-25 10:00:00.000 |    53 |
| 2019-08-25 11:00:00.000 |    69 |
| 2019-08-25 12:00:00.000 |    89 |
| 2019-08-25 13:00:00.000 |   139 |
| 2019-08-25 14:00:00.000 |   181 |
| 2019-08-25 16:00:00.000 |   356 |
| 2019-08-25 17:00:00.000 |   556 |
| 2019-08-25 18:00:00.000 |   485 |
| 2019-08-25 19:00:00.000 |   491 |
| 2019-08-25 20:00:00.000 |   392 |
| 2019-08-25 21:00:00.000 |   263 |
| 2019-08-25 22:00:00.000 |   213 |
+-------------------------+-------+
(23 rows)

!ok
# Wed Jul 10 19:16:13 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:15 IST 2024
SELECT
CAST(t."adblock_list" AS VARCHAR) AS "adblock_list",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+----------------------------+-------+
| adblock_list               | count |
+----------------------------+-------+
| NoAdblock                  |  4123 |
| EasyList                   |   394 |
| AntiAdblockKiller          |     1 |
| EasyList,AntiAdblockKiller |     1 |
+----------------------------+-------+
(4 rows)

!ok
# Wed Jul 10 19:16:16 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 22:00:00') AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |   133 |
| 2019-08-25 01:00:00.000 |    97 |
| 2019-08-25 02:00:00.000 |   138 |
| 2019-08-25 03:00:00.000 |   100 |
| 2019-08-25 04:00:00.000 |    65 |
| 2019-08-25 05:00:00.000 |    77 |
| 2019-08-25 06:00:00.000 |    59 |
| 2019-08-25 07:00:00.000 |    56 |
| 2019-08-25 08:00:00.000 |    49 |
| 2019-08-25 09:00:00.000 |    54 |
| 2019-08-25 10:00:00.000 |    47 |
| 2019-08-25 11:00:00.000 |    63 |
| 2019-08-25 12:00:00.000 |    74 |
| 2019-08-25 13:00:00.000 |   131 |
| 2019-08-25 14:00:00.000 |   164 |
| 2019-08-25 15:00:00.000 |   103 |
| 2019-08-25 16:00:00.000 |   334 |
| 2019-08-25 17:00:00.000 |   522 |
| 2019-08-25 18:00:00.000 |   445 |
| 2019-08-25 19:00:00.000 |   456 |
| 2019-08-25 20:00:00.000 |   349 |
| 2019-08-25 21:00:00.000 |   243 |
+-------------------------+-------+
(22 rows)

!ok
# Wed Jul 10 19:16:16 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 22:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:16 IST 2024
SELECT
(COUNT(*)) AS "v0",
(COUNT(*) FILTER (WHERE (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))) AS "v1"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY ();
+------+----+
| v0   | v1 |
+------+----+
| 4123 |  0 |
+------+----+
(1 row)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00')
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00') AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:24 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 22:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+
| __time | count |
+--------+-------+
+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:16:25 IST 2024
SELECT
(COUNT(*)) AS "v0",
(COUNT(*) FILTER (WHERE (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))) AS "v1",
(COUNT(*) FILTER (WHERE (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))) AS "v2",
(COUNT(*) FILTER (WHERE ((-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock')))) AS "v3"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00')
GROUP BY ();
+----+----+----+----+
| v0 | v1 | v2 | v3 |
+----+----+----+----+
|  0 |  0 |  0 |  0 |
+----+----+----+----+
(1 row)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 21:00:00')
GROUP BY 1;
+-------------------------+--------------------+
| __time                  | sum_session_length |
+-------------------------+--------------------+
| 2019-08-25 00:00:00.000 |          174452963 |
| 2019-08-25 01:00:00.000 |            9615661 |
| 2019-08-25 02:00:00.000 |           11818762 |
| 2019-08-25 03:00:00.000 |           38429361 |
| 2019-08-25 04:00:00.000 |            4244542 |
| 2019-08-25 05:00:00.000 |            8006793 |
| 2019-08-25 06:00:00.000 |           24173220 |
| 2019-08-25 07:00:00.000 |            3467120 |
| 2019-08-25 08:00:00.000 |            4601268 |
| 2019-08-25 09:00:00.000 |            5685654 |
| 2019-08-25 10:00:00.000 |            5751737 |
| 2019-08-25 11:00:00.000 |            7009518 |
| 2019-08-25 12:00:00.000 |          329473265 |
| 2019-08-25 13:00:00.000 |           83036590 |
| 2019-08-25 14:00:00.000 |           34337617 |
| 2019-08-25 15:00:00.000 |          259467812 |
| 2019-08-25 16:00:00.000 |           84262697 |
| 2019-08-25 17:00:00.000 |           44555446 |
| 2019-08-25 18:00:00.000 |           97884685 |
| 2019-08-25 19:00:00.000 |           72625670 |
| 2019-08-25 20:00:00.000 |          467085634 |
+-------------------------+--------------------+
(21 rows)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00')
GROUP BY 1;
+--------+--------------------+
| __time | sum_session_length |
+--------+--------------------+
+--------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 21:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+--------------------+
| __time | sum_session_length |
+--------+--------------------+
+--------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:28 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260))
GROUP BY 1;
+--------+--------------------+
| __time | sum_session_length |
+--------+--------------------+
+--------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:29 IST 2024
SELECT
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v1",
(SUM(t."session_length") FILTER (WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)))) AS "v2",
(SUM(t."session_length") FILTER (WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (-26270<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<-26260)))) AS "v3"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY ();
+------------+----+----+----+
| v0         | v1 | v2 | v3 |
+------------+----+----+----+
| 2047513237 |    |    |    |
+------------+----+----+----+
(1 row)

!ok
# Wed Jul 10 19:16:34 IST 2024
SELECT
CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR) AS "Layer",
(COUNT(*)) AS "r"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "r" DESC
LIMIT 101;
+-------+------+
| Layer | r    |
+-------+------+
|       | 3349 |
| 6     |  314 |
| 5     |  286 |
| 4     |  245 |
| 3     |  141 |
| 2     |  103 |
| 1     |   53 |
| 0     |   28 |
+-------+------+
(8 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1
ORDER BY "session_length" ASC
LIMIT 100;
+----------------+
| session_length |
+----------------+
|         1160.0 |
|         1170.0 |
|         1210.0 |
|         1230.0 |
|         1240.0 |
|         1250.0 |
|         1270.0 |
|         1330.0 |
|         1350.0 |
|         1360.0 |
|         1370.0 |
|         1380.0 |
|         1440.0 |
|         1450.0 |
|         1480.0 |
|         1520.0 |
|         1530.0 |
|         1560.0 |
|         1570.0 |
|         1580.0 |
|         1590.0 |
|         1600.0 |
|         1610.0 |
|         1630.0 |
|         1670.0 |
|         1680.0 |
|         1690.0 |
|         1700.0 |
|         1710.0 |
|         1730.0 |
|         1740.0 |
|         1750.0 |
|         1760.0 |
|         1770.0 |
|         1780.0 |
|         1790.0 |
|         1800.0 |
|         1810.0 |
|         1860.0 |
|         1870.0 |
|         1880.0 |
|         1890.0 |
|         1900.0 |
|         1920.0 |
|         1940.0 |
|         1960.0 |
|         1970.0 |
|         1980.0 |
|         1990.0 |
|         2030.0 |
|         2040.0 |
|         2050.0 |
|         2060.0 |
|         2090.0 |
|         2100.0 |
|         2110.0 |
|         2170.0 |
|         2180.0 |
|         2190.0 |
|         2220.0 |
|         2230.0 |
|         2240.0 |
|         2250.0 |
|         2260.0 |
|         2290.0 |
|         2300.0 |
|         2310.0 |
|         2330.0 |
|         2340.0 |
|         2380.0 |
|         2400.0 |
|         2440.0 |
|         2450.0 |
|         2470.0 |
|         2490.0 |
|         2500.0 |
|         2510.0 |
|         2530.0 |
|         2540.0 |
|         2570.0 |
|         2580.0 |
|         2590.0 |
|         2600.0 |
|         2620.0 |
|         2640.0 |
|         2680.0 |
|         2690.0 |
|         2720.0 |
|         2740.0 |
|         2750.0 |
|         2800.0 |
|         2840.0 |
|         2860.0 |
|         2870.0 |
|         2880.0 |
|         2890.0 |
|         2910.0 |
|         2940.0 |
|         2960.0 |
|         2980.0 |
+----------------+
(100 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v1",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v2",
(SUM(t."session_length") FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v3"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY ();
+-----+---------+----+----+
| v0  | v1      | v2 | v3 |
+-----+---------+----+----+
| 314 | 2179264 |  0 |    |
+-----+---------+----+----+
(1 row)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
CAST(t."adblock_list" AS VARCHAR) AS "adblock_list",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+--------------+-------+
| adblock_list | count |
+--------------+-------+
| NoAdblock    |   278 |
| EasyList     |    36 |
+--------------+-------+
(2 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
|         1900.0 |     1 |               1905 |
|         1160.0 |     1 |               1160 |
|         1170.0 |     2 |               2348 |
|         1210.0 |     1 |               1216 |
|         1230.0 |     1 |               1235 |
|         1240.0 |     1 |               1244 |
|         1250.0 |     1 |               1251 |
|         1270.0 |     1 |               1271 |
|         1330.0 |     1 |               1331 |
|         1350.0 |     2 |               2711 |
|         1360.0 |     1 |               1368 |
|         1370.0 |     1 |               1378 |
|         1380.0 |     1 |               1380 |
|         1440.0 |     1 |               1441 |
|         1450.0 |     1 |               1459 |
|         1480.0 |     2 |               2967 |
|         1520.0 |     1 |               1527 |
|         1530.0 |     2 |               3070 |
|         1560.0 |     1 |               1568 |
|         1570.0 |     2 |               3150 |
|         1580.0 |     3 |               4753 |
|         1590.0 |     1 |               1592 |
|         1600.0 |     2 |               3208 |
|         1610.0 |     2 |               3229 |
|         1630.0 |     2 |               3268 |
|         1670.0 |     1 |               1673 |
|         1680.0 |     1 |               1681 |
|         1690.0 |     1 |               1695 |
|         1700.0 |     1 |               1705 |
|         1710.0 |     1 |               1714 |
|         1730.0 |     1 |               1733 |
|         1740.0 |     3 |               5227 |
|         1750.0 |     1 |               1757 |
|         1760.0 |     1 |               1765 |
|         1770.0 |     2 |               3542 |
|         1780.0 |     1 |               1780 |
|         1790.0 |     1 |               1795 |
|         1800.0 |     1 |               1806 |
|         1810.0 |     1 |               1813 |
|         1860.0 |     1 |               1864 |
|         1870.0 |     1 |               1875 |
|         1880.0 |     1 |               1889 |
|         1890.0 |     2 |               3788 |
|         1920.0 |     1 |               1925 |
|         1940.0 |     1 |               1948 |
|         1960.0 |     2 |               3928 |
|         1970.0 |     2 |               3946 |
|         1980.0 |     1 |               1983 |
|         1990.0 |     1 |               1991 |
|         2030.0 |     1 |               2035 |
+----------------+-------+--------------------+
(50 rows)

!ok
# Wed Jul 10 19:16:37 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 22:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 17:00:00.000 |         1560.0 |     1 |               1568 |
| 2019-08-25 01:00:00.000 |         1960.0 |     1 |               1963 |
| 2019-08-25 02:00:00.000 |         1800.0 |     1 |               1806 |
| 2019-08-25 02:00:00.000 |         1940.0 |     1 |               1948 |
| 2019-08-25 02:00:00.000 |         1960.0 |     1 |               1965 |
| 2019-08-25 03:00:00.000 |         1750.0 |     1 |               1757 |
| 2019-08-25 04:00:00.000 |         1680.0 |     1 |               1681 |
| 2019-08-25 05:00:00.000 |         1740.0 |     1 |               1744 |
| 2019-08-25 08:00:00.000 |         1580.0 |     1 |               1581 |
| 2019-08-25 08:00:00.000 |         1740.0 |     1 |               1743 |
| 2019-08-25 09:00:00.000 |         1970.0 |     1 |               1974 |
| 2019-08-25 13:00:00.000 |         1970.0 |     1 |               1972 |
| 2019-08-25 14:00:00.000 |         1700.0 |     1 |               1705 |
| 2019-08-25 14:00:00.000 |         1710.0 |     1 |               1714 |
| 2019-08-25 14:00:00.000 |         1770.0 |     2 |               3542 |
| 2019-08-25 14:00:00.000 |         1870.0 |     1 |               1875 |
| 2019-08-25 14:00:00.000 |         1890.0 |     1 |               1895 |
| 2019-08-25 15:00:00.000 |         1580.0 |     1 |               1589 |
| 2019-08-25 15:00:00.000 |         1630.0 |     1 |               1637 |
| 2019-08-25 15:00:00.000 |         1890.0 |     1 |               1893 |
| 2019-08-25 16:00:00.000 |         1270.0 |     1 |               1271 |
| 2019-08-25 16:00:00.000 |         1360.0 |     1 |               1368 |
| 2019-08-25 16:00:00.000 |         1440.0 |     1 |               1441 |
| 2019-08-25 16:00:00.000 |         1530.0 |     2 |               3070 |
| 2019-08-25 16:00:00.000 |         1600.0 |     1 |               1603 |
| 2019-08-25 17:00:00.000 |         1160.0 |     1 |               1160 |
| 2019-08-25 17:00:00.000 |         1170.0 |     1 |               1174 |
| 2019-08-25 17:00:00.000 |         1380.0 |     1 |               1380 |
| 2019-08-25 17:00:00.000 |         1480.0 |     1 |               1483 |
| 2019-08-25 17:00:00.000 |         1580.0 |     1 |               1583 |
| 2019-08-25 17:00:00.000 |         1730.0 |     1 |               1733 |
| 2019-08-25 17:00:00.000 |         1780.0 |     1 |               1780 |
| 2019-08-25 18:00:00.000 |         1250.0 |     1 |               1251 |
| 2019-08-25 18:00:00.000 |         1570.0 |     1 |               1576 |
| 2019-08-25 18:00:00.000 |         1690.0 |     1 |               1695 |
| 2019-08-25 18:00:00.000 |         1860.0 |     1 |               1864 |
| 2019-08-25 18:00:00.000 |         1980.0 |     1 |               1983 |
| 2019-08-25 19:00:00.000 |         1230.0 |     1 |               1235 |
| 2019-08-25 19:00:00.000 |         1590.0 |     1 |               1592 |
| 2019-08-25 19:00:00.000 |         1610.0 |     1 |               1611 |
| 2019-08-25 19:00:00.000 |         1920.0 |     1 |               1925 |
| 2019-08-25 19:00:00.000 |         2030.0 |     1 |               2035 |
| 2019-08-25 20:00:00.000 |         1210.0 |     1 |               1216 |
| 2019-08-25 20:00:00.000 |         1350.0 |     1 |               1353 |
| 2019-08-25 20:00:00.000 |         1450.0 |     1 |               1459 |
| 2019-08-25 20:00:00.000 |         1520.0 |     1 |               1527 |
| 2019-08-25 20:00:00.000 |         1570.0 |     1 |               1574 |
| 2019-08-25 20:00:00.000 |         1600.0 |     1 |               1605 |
| 2019-08-25 20:00:00.000 |         1610.0 |     1 |               1618 |
| 2019-08-25 20:00:00.000 |         1630.0 |     1 |               1631 |
| 2019-08-25 20:00:00.000 |         1900.0 |     1 |               1905 |
| 2019-08-25 20:00:00.000 |         1990.0 |     1 |               1991 |
| 2019-08-25 21:00:00.000 |         1170.0 |     1 |               1174 |
| 2019-08-25 21:00:00.000 |         1240.0 |     1 |               1244 |
| 2019-08-25 21:00:00.000 |         1760.0 |     1 |               1765 |
| 2019-08-25 21:00:00.000 |         1790.0 |     1 |               1795 |
+-------------------------+----------------+-------+--------------------+
(56 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<2040))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 21:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 00:00:00.000 |     5 |             118466 |
| 2019-08-25 01:00:00.000 |     8 |              26194 |
| 2019-08-25 02:00:00.000 |    13 |              63514 |
| 2019-08-25 03:00:00.000 |     5 |              23665 |
| 2019-08-25 04:00:00.000 |     2 |               5968 |
| 2019-08-25 05:00:00.000 |    11 |             195024 |
| 2019-08-25 06:00:00.000 |     4 |              21096 |
| 2019-08-25 07:00:00.000 |     1 |               4056 |
| 2019-08-25 08:00:00.000 |     4 |              10649 |
| 2019-08-25 09:00:00.000 |     5 |              67912 |
| 2019-08-25 10:00:00.000 |     6 |              65230 |
| 2019-08-25 11:00:00.000 |     6 |              28056 |
| 2019-08-25 12:00:00.000 |     6 |              39194 |
| 2019-08-25 13:00:00.000 |     8 |              34774 |
| 2019-08-25 14:00:00.000 |    18 |              79708 |
| 2019-08-25 15:00:00.000 |     5 |              15131 |
| 2019-08-25 16:00:00.000 |    28 |             189821 |
| 2019-08-25 17:00:00.000 |    36 |             183717 |
| 2019-08-25 18:00:00.000 |    33 |             273980 |
| 2019-08-25 19:00:00.000 |    28 |             246277 |
| 2019-08-25 20:00:00.000 |    31 |             141172 |
+-------------------------+-------+--------------------+
(21 rows)

!ok
# Wed Jul 10 19:16:38 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 21:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:44 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1
ORDER BY "session_length" ASC
LIMIT 5000;
+----------------+
| session_length |
+----------------+
|         1160.0 |
|         1170.0 |
|         1210.0 |
|         1230.0 |
|         1240.0 |
|         1250.0 |
|         1270.0 |
|         1330.0 |
|         1350.0 |
|         1360.0 |
|         1370.0 |
|         1380.0 |
|         1440.0 |
|         1450.0 |
|         1480.0 |
|         1520.0 |
|         1530.0 |
|         1560.0 |
|         1570.0 |
|         1580.0 |
|         1590.0 |
|         1600.0 |
|         1610.0 |
|         1630.0 |
|         1670.0 |
|         1680.0 |
|         1690.0 |
|         1700.0 |
|         1710.0 |
|         1730.0 |
|         1740.0 |
|         1750.0 |
|         1760.0 |
|         1770.0 |
|         1780.0 |
|         1790.0 |
|         1800.0 |
|         1810.0 |
|         1860.0 |
|         1870.0 |
|         1880.0 |
|         1890.0 |
|         1900.0 |
|         1920.0 |
|         1940.0 |
|         1960.0 |
|         1970.0 |
|         1980.0 |
|         1990.0 |
|         2030.0 |
|         2040.0 |
|         2050.0 |
|         2060.0 |
|         2090.0 |
|         2100.0 |
|         2110.0 |
|         2170.0 |
|         2180.0 |
|         2190.0 |
|         2220.0 |
|         2230.0 |
|         2240.0 |
|         2250.0 |
|         2260.0 |
|         2290.0 |
|         2300.0 |
|         2310.0 |
|         2330.0 |
|         2340.0 |
|         2380.0 |
|         2400.0 |
|         2440.0 |
|         2450.0 |
|         2470.0 |
|         2490.0 |
|         2500.0 |
|         2510.0 |
|         2530.0 |
|         2540.0 |
|         2570.0 |
|         2580.0 |
|         2590.0 |
|         2600.0 |
|         2620.0 |
|         2640.0 |
|         2680.0 |
|         2690.0 |
|         2720.0 |
|         2740.0 |
|         2750.0 |
|         2800.0 |
|         2840.0 |
|         2860.0 |
|         2870.0 |
|         2880.0 |
|         2890.0 |
|         2910.0 |
|         2940.0 |
|         2960.0 |
|         2980.0 |
|         2990.0 |
|         3020.0 |
|         3040.0 |
|         3060.0 |
|         3070.0 |
|         3090.0 |
|         3100.0 |
|         3180.0 |
|         3190.0 |
|         3210.0 |
|         3240.0 |
|         3260.0 |
|         3320.0 |
|         3350.0 |
|         3370.0 |
|         3400.0 |
|         3410.0 |
|         3430.0 |
|         3440.0 |
|         3480.0 |
|         3490.0 |
|         3600.0 |
|         3610.0 |
|         3680.0 |
|         3710.0 |
|         3740.0 |
|         3780.0 |
|         3790.0 |
|         3800.0 |
|         3840.0 |
|         3880.0 |
|         3900.0 |
|         3910.0 |
|         3930.0 |
|         3970.0 |
|         4040.0 |
|         4050.0 |
|         4070.0 |
|         4080.0 |
|         4100.0 |
|         4110.0 |
|         4190.0 |
|         4200.0 |
|         4210.0 |
|         4220.0 |
|         4260.0 |
|         4280.0 |
|         4290.0 |
|         4310.0 |
|         4370.0 |
|         4380.0 |
|         4420.0 |
|         4460.0 |
|         4520.0 |
|         4570.0 |
|         4740.0 |
|         4760.0 |
|         4800.0 |
|         4830.0 |
|         4880.0 |
|         4910.0 |
|         4950.0 |
|         5010.0 |
|         5030.0 |
|         5070.0 |
|         5120.0 |
|         5130.0 |
|         5160.0 |
|         5190.0 |
|         5250.0 |
|         5450.0 |
|         5530.0 |
|         5600.0 |
|         5610.0 |
|         5630.0 |
|         5690.0 |
|         5780.0 |
|         5970.0 |
|         6010.0 |
|         6160.0 |
|         6220.0 |
|         6310.0 |
|         6400.0 |
|         6460.0 |
|         6480.0 |
|         6520.0 |
|         6550.0 |
|         6560.0 |
|         6600.0 |
|         6630.0 |
|         6640.0 |
|         6710.0 |
|         6750.0 |
|         6760.0 |
|         6990.0 |
|         7010.0 |
|         7060.0 |
|         7090.0 |
|         7140.0 |
|         7150.0 |
|         7240.0 |
|         7280.0 |
|         7380.0 |
|         7430.0 |
|         7520.0 |
|         7540.0 |
|         7680.0 |
|         7900.0 |
|         7940.0 |
|         8480.0 |
|         8690.0 |
|         8730.0 |
|         8870.0 |
|         9250.0 |
|         9490.0 |
|         9870.0 |
|         9950.0 |
|        10000.0 |
|        10140.0 |
|        10280.0 |
|        10580.0 |
|        10590.0 |
|        10710.0 |
|        10780.0 |
|        10820.0 |
|        10890.0 |
|        10940.0 |
|        11120.0 |
|        11300.0 |
|        11340.0 |
|        11490.0 |
|        11770.0 |
|        11910.0 |
|        12370.0 |
|        12460.0 |
|        12670.0 |
|        12810.0 |
|        14350.0 |
|        14400.0 |
|        14630.0 |
|        15310.0 |
|        15990.0 |
|        16410.0 |
|        16440.0 |
|        16770.0 |
|        17570.0 |
|        17630.0 |
|        20490.0 |
|        20810.0 |
|        21180.0 |
|        21970.0 |
|        23030.0 |
|        24170.0 |
|        24510.0 |
|        26880.0 |
|        27730.0 |
|        29400.0 |
|        29720.0 |
|        36200.0 |
|        38240.0 |
|        46630.0 |
|        49400.0 |
|        54620.0 |
|        68490.0 |
|        75740.0 |
|        99310.0 |
|       111220.0 |
+----------------+
(267 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 17:00:00.000 |         1160.0 |     1 |               1160 |
| 2019-08-25 17:00:00.000 |         1170.0 |     1 |               1174 |
| 2019-08-25 19:00:00.000 |         1230.0 |     1 |               1235 |
| 2019-08-25 20:00:00.000 |         1210.0 |     1 |               1216 |
| 2019-08-25 21:00:00.000 |         1170.0 |     1 |               1174 |
| 2019-08-25 21:00:00.000 |         1240.0 |     1 |               1244 |
+-------------------------+----------------+-------+--------------------+
(6 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 00:00:00.000 |     5 |             118466 |
| 2019-08-25 01:00:00.000 |     8 |              26194 |
| 2019-08-25 02:00:00.000 |    13 |              63514 |
| 2019-08-25 03:00:00.000 |     5 |              23665 |
| 2019-08-25 04:00:00.000 |     2 |               5968 |
| 2019-08-25 05:00:00.000 |    11 |             195024 |
| 2019-08-25 06:00:00.000 |     4 |              21096 |
| 2019-08-25 07:00:00.000 |     1 |               4056 |
| 2019-08-25 08:00:00.000 |     4 |              10649 |
| 2019-08-25 09:00:00.000 |     5 |              67912 |
| 2019-08-25 10:00:00.000 |     6 |              65230 |
| 2019-08-25 11:00:00.000 |     6 |              28056 |
| 2019-08-25 12:00:00.000 |     6 |              39194 |
| 2019-08-25 13:00:00.000 |     8 |              34774 |
| 2019-08-25 14:00:00.000 |    18 |              79708 |
| 2019-08-25 15:00:00.000 |     5 |              15131 |
| 2019-08-25 16:00:00.000 |    28 |             189821 |
| 2019-08-25 17:00:00.000 |    36 |             183717 |
| 2019-08-25 18:00:00.000 |    33 |             273980 |
| 2019-08-25 19:00:00.000 |    28 |             246277 |
| 2019-08-25 20:00:00.000 |    31 |             141172 |
| 2019-08-25 21:00:00.000 |    23 |             220476 |
| 2019-08-25 22:00:00.000 |    13 |              66321 |
| 2019-08-25 23:00:00.000 |    15 |              58863 |
+-------------------------+-------+--------------------+
(24 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
|         1160.0 |     1 |               1160 |
|         1170.0 |     2 |               2348 |
|         1210.0 |     1 |               1216 |
|         1230.0 |     1 |               1235 |
|         1240.0 |     1 |               1244 |
+----------------+-------+--------------------+
(5 rows)

!ok
# Wed Jul 10 19:16:53 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------------+-------+
| Browser               | count |
+-----------------------+-------+
| Chrome                |   101 |
| Mobile Safari         |    77 |
| Chrome Mobile         |    64 |
| Safari                |    24 |
| Firefox               |     4 |
| Yandex.Browser        |     3 |
| IE                    |     1 |
| Mozilla               |     1 |
| Opera                 |     1 |
| Silk                  |     1 |
| Yandex.Browser mobile |     1 |
+-----------------------+-------+
(11 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1250)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 17:00:00.000 |         1160.0 |     1 |               1160 |
| 2019-08-25 17:00:00.000 |         1170.0 |     1 |               1174 |
| 2019-08-25 19:00:00.000 |         1230.0 |     1 |               1235 |
| 2019-08-25 20:00:00.000 |         1210.0 |     1 |               1216 |
| 2019-08-25 21:00:00.000 |         1170.0 |     1 |               1174 |
| 2019-08-25 21:00:00.000 |         1240.0 |     1 |               1244 |
+-------------------------+----------------+-------+--------------------+
(6 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1040<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1240)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+-------------------------+-------+--------------------+
| __time                  | count | sum_session_length |
+-------------------------+-------+--------------------+
| 2019-08-25 00:00:00.000 |     4 |             115954 |
| 2019-08-25 01:00:00.000 |     7 |              21158 |
| 2019-08-25 02:00:00.000 |    12 |              60597 |
| 2019-08-25 03:00:00.000 |     5 |              23665 |
| 2019-08-25 04:00:00.000 |     2 |               5968 |
| 2019-08-25 05:00:00.000 |    10 |             192084 |
| 2019-08-25 06:00:00.000 |     4 |              21096 |
| 2019-08-25 07:00:00.000 |     1 |               4056 |
| 2019-08-25 08:00:00.000 |     4 |              10649 |
| 2019-08-25 09:00:00.000 |     5 |              67912 |
| 2019-08-25 10:00:00.000 |     5 |              57546 |
| 2019-08-25 11:00:00.000 |     5 |              25182 |
| 2019-08-25 12:00:00.000 |     6 |              39194 |
| 2019-08-25 13:00:00.000 |     8 |              34774 |
| 2019-08-25 14:00:00.000 |    16 |              76232 |
| 2019-08-25 15:00:00.000 |     4 |              13238 |
| 2019-08-25 16:00:00.000 |    24 |             178745 |
| 2019-08-25 17:00:00.000 |    31 |             152698 |
| 2019-08-25 18:00:00.000 |    31 |             267910 |
| 2019-08-25 19:00:00.000 |    26 |             168925 |
| 2019-08-25 20:00:00.000 |    26 |             126561 |
| 2019-08-25 21:00:00.000 |    21 |             210985 |
| 2019-08-25 22:00:00.000 |    10 |              55030 |
| 2019-08-25 23:00:00.000 |    11 |              34527 |
+-------------------------+-------+--------------------+
(24 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1240<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1280)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1380))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 16:00:00.000 |         1270.0 |     1 |               1271 |
| 2019-08-25 16:00:00.000 |         1360.0 |     1 |               1368 |
| 2019-08-25 18:00:00.000 |         1250.0 |     1 |               1251 |
| 2019-08-25 20:00:00.000 |         1350.0 |     1 |               1353 |
| 2019-08-25 23:00:00.000 |         1330.0 |     1 |               1331 |
| 2019-08-25 23:00:00.000 |         1350.0 |     1 |               1358 |
| 2019-08-25 23:00:00.000 |         1370.0 |     1 |               1378 |
+-------------------------+----------------+-------+--------------------+
(7 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1420))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1460)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 16:00:00.000 |         1270.0 |     1 |               1271 |
| 2019-08-25 16:00:00.000 |         1360.0 |     1 |               1368 |
| 2019-08-25 17:00:00.000 |         1380.0 |     1 |               1380 |
| 2019-08-25 18:00:00.000 |         1250.0 |     1 |               1251 |
| 2019-08-25 20:00:00.000 |         1350.0 |     1 |               1353 |
| 2019-08-25 20:00:00.000 |         1450.0 |     1 |               1459 |
| 2019-08-25 23:00:00.000 |         1330.0 |     1 |               1331 |
| 2019-08-25 23:00:00.000 |         1350.0 |     1 |               1358 |
| 2019-08-25 23:00:00.000 |         1370.0 |     1 |               1378 |
+-------------------------+----------------+-------+--------------------+
(9 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1280<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1490)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1380<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1490))
GROUP BY 1,2;
+-------------------------+----------------+-------+--------------------+
| __time                  | session_length | count | sum_session_length |
+-------------------------+----------------+-------+--------------------+
| 2019-08-25 16:00:00.000 |         1440.0 |     1 |               1441 |
| 2019-08-25 17:00:00.000 |         1380.0 |     1 |               1380 |
| 2019-08-25 17:00:00.000 |         1480.0 |     1 |               1483 |
| 2019-08-25 20:00:00.000 |         1450.0 |     1 |               1459 |
| 2019-08-25 23:00:00.000 |         1480.0 |     1 |               1484 |
+-------------------------+----------------+-------+--------------------+
(5 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1420<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1480))
GROUP BY 1,2;
+--------+----------------+-------+--------------------+
| __time | session_length | count | sum_session_length |
+--------+----------------+-------+--------------------+
+--------+----------------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE ((((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1460<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1470)) AND (CAST(t."adblock_list" AS VARCHAR)='NoAdblock'))
GROUP BY 1;
+--------+-------+--------------------+
| __time | count | sum_session_length |
+--------+-------+--------------------+
+--------+-------+--------------------+
(0 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1450))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
|         1250.0 |     1 |               1251 |
|         1270.0 |     1 |               1271 |
|         1330.0 |     1 |               1331 |
|         1350.0 |     2 |               2711 |
|         1360.0 |     1 |               1368 |
|         1370.0 |     1 |               1378 |
|         1380.0 |     1 |               1380 |
|         1440.0 |     1 |               1441 |
+----------------+-------+--------------------+
(8 rows)

!ok
# Wed Jul 10 19:17:03 IST 2024
SELECT
FLOOR(CAST(t."session_length" AS DOUBLE) / 10) * 10 AS "session_length",
(COUNT(*)) AS "count",
(SUM(t."session_length")) AS "sum_session_length"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND (CAST(JSON_VALUE("t"."event",'$.layer') AS VARCHAR)='6')) AND (1250<=CAST(t."session_length" AS DOUBLE) AND CAST(t."session_length" AS DOUBLE)<1440))
GROUP BY 1;
+----------------+-------+--------------------+
| session_length | count | sum_session_length |
+----------------+-------+--------------------+
+----------------+-------+--------------------+
(0 rows)

!ok
