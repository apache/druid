!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardComponentSupplier&datasets=sql/src/test/quidem/qatests/qaAggFuncs&numMergeBuffers=3
!set outputformat mysql
SELECT count(*) cnt
FROM test_agg_funcs;
+-----+
| cnt |
+-----+
|  18 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(timestamp '2020-01-01 01:01:01.000', '|') AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(__time, '|') AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(__time, '|') || '-1583024461000' AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000-1583024461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT '1583024461000-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(__time, ',') || '-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT concat(string_agg(__time, ','), '-', string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, '|'), '-1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000-1583024461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat('1583024461000-', string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, ','), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,15778404610001577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_format('%s-%s', string_agg(__time, ','), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT char_length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(__time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lower(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(__time, '|'), 16) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(__time, '|')
                FROM 20) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|  29 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(__time, '|'), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(__time, '|'), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(__time, '|'), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(__time, '|'), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(__time, '|'), '1577840461000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(__time, '|'), '1580518861000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(__time, '|'), '1577840461000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(__time, '|'), '1580518861000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(__time, '|'), '1577840461000', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(__time, '|'), '4444444444', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(__time, '|'), '|1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|  14 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(__time, '|'), '|4444444444') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(__time, '|'), 15) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------+
| col                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(__time, '|'), 15, 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890'
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------+
| col                                                                                                 |
+-----------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+-----------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890'
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890'
            FROM string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(__time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------+
| col                                                                                                 |
+-----------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+-----------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(__time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(__time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT upper(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT reverse(string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|'), -1) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|'), 0) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|'), 2) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|15778404610001577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|'), 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|'), 14, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|'), 135) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
|           1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|'), 135, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
| AAAAAAAAAA1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|'), 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|'), 14, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|'), 135) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000           |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|'), 135, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000AAAAAAAAAA |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A58 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(t0.__time, '|') AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.__time IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A59 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(t0.__time, '|')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.__time IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A60 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(t0.__time, '|') AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.__time;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A61 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(t0.__time, '|')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.__time;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT timestamp '2020-01-01 01:01:01.000', '|') AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(DISTINCT __time, '|') AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT __time, '|') || '-1583024461000' AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1577840461000-1583024461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT '1583024461000-' || string_agg(DISTINCT __time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1583024461000-1577840461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT __time, ',') || '-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT concat(string_agg(__time, ','), '-', string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(DISTINCT __time, '|'), '-1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1577840461000-1583024461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat('1583024461000-', string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1583024461000-1577840461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, ','), string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+--------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                        |
+--------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,15778404610001577840461000 |
+--------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_format('%s-%s', string_agg(DISTINCT __time, ','), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT char_length(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lower(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(DISTINCT __time, '|'), 16) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------+
| col             |
+-----------------+
| 377648962736128 |
+-----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(DISTINCT __time, '|')
                FROM 15) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(DISTINCT __time, '|'), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(DISTINCT __time, '|'), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT __time, '|'), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT __time, '|'), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT __time, '|'), '1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT __time, '|'), '1580518861000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT __time, '|'), '1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT __time, '|'), '1580518861000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(DISTINCT __time, '|'), '1577840461000', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1583024461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(DISTINCT __time, '|'), '4444444444', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT __time, '|'), '1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT __time, '|'), '4444444444') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(DISTINCT __time, '|'), 13) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
| 0   |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(DISTINCT __time, '|'), 13, 100) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
| 0   |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH
            FROM string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING
            FROM string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING
            FROM string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890'
            FROM string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890'
            FROM string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890'
            FROM string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(DISTINCT __time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(DISTINCT __time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(DISTINCT __time, '|'), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT upper(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT reverse(string_agg(DISTINCT __time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 0001640487751 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT __time, '|'), -1) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT __time, '|'), 0) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT __time, '|'), 2) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------------------+
| col                        |
+----------------------------+
| 15778404610001577840461000 |
+----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|'), 5) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|'), 5, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|'), 23) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
|           1577840461000 |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|'), 23, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
| AAAAAAAAAA1577840461000 |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|'), 5) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|'), 5, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|'), 23) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
| 1577840461000           |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|'), 23, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
| 1577840461000AAAAAAAAAA |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A58 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(DISTINCT t0.__time, '|') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.__time IS NOT NULL);
+-----+
| LEN |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A59 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(DISTINCT t0.__time, '|')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.__time IS NOT NULL;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A60 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(DISTINCT t0.__time, '|') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.__time);
+-----+
| LEN |
+-----+
|  13 |
|  13 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A61 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(DISTINCT t0.__time, '|')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.__time;
+-----+
| col |
+-----+
|  13 |
|  13 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT timestamp '2020-01-01 01:01:01.000', '|', 100000) AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(DISTINCT __time, '|', 100000) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT __time, '|', 100000) || '-1583024461000' AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1577840461000-1583024461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT '1583024461000-' || string_agg(DISTINCT __time, '|', 100000) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1583024461000-1577840461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(DISTINCT __time, ',', 100000) || '-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT concat(string_agg(__time, ','), '-', string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(DISTINCT __time, '|', 100000), '-1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1577840461000-1583024461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat('1583024461000-', string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------+
| col                         |
+-----------------------------+
| 1583024461000-1577840461000 |
+-----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, ','), string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+--------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                        |
+--------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,15778404610001577840461000 |
+--------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_format('%s-%s', string_agg(DISTINCT __time, ',', 100000), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT char_length(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lower(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(DISTINCT __time, '|', 100000), 16) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------+
| col             |
+-----------------+
| 377648962736128 |
+-----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(DISTINCT __time, '|', 100000)
                FROM 15) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(DISTINCT __time, '|', 100000), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(DISTINCT __time, '|', 100000), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT __time, '|', 100000), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(DISTINCT __time, '|', 100000), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT __time, '|', 100000), '1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(DISTINCT __time, '|', 100000), '1580518861000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT __time, '|', 100000), '1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(DISTINCT __time, '|', 100000), '1580518861000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(DISTINCT __time, '|', 100000), '1577840461000', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1583024461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(DISTINCT __time, '|', 100000), '4444444444', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT __time, '|', 100000), '1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(DISTINCT __time, '|', 100000), '4444444444') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(DISTINCT __time, '|', 100000), 13) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
| 0   |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(DISTINCT __time, '|', 100000), 13, 100) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
| 0   |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH
            FROM string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING
            FROM string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING
            FROM string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890'
            FROM string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890'
            FROM string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890'
            FROM string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(DISTINCT __time, '|', 100000), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(DISTINCT __time, '|', 100000), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(DISTINCT __time, '|', 100000), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT upper(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 1577840461000 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT reverse(string_agg(DISTINCT __time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------+
| col           |
+---------------+
| 0001640487751 |
+---------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT __time, '|', 100000), -1) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT __time, '|', 100000), 0) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(DISTINCT __time, '|', 100000), 2) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------------------+
| col                        |
+----------------------------+
| 15778404610001577840461000 |
+----------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|', 100000), 5) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|', 100000), 5, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|', 100000), 23) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
|           1577840461000 |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(DISTINCT __time, '|', 100000), 23, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
| AAAAAAAAAA1577840461000 |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|', 100000), 5) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|', 100000), 5, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| 15778 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|', 100000), 23) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
| 1577840461000           |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(DISTINCT __time, '|', 100000), 23, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------+
| col                     |
+-------------------------+
| 1577840461000AAAAAAAAAA |
+-------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A58 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(DISTINCT t0.__time, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.__time IS NOT NULL);
+-----+
| LEN |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A59 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(DISTINCT t0.__time, '|', 100000)) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.__time IS NOT NULL;
+-----+
| col |
+-----+
|  27 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A60 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(DISTINCT t0.__time, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.__time);
+-----+
| LEN |
+-----+
|  13 |
|  13 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A61 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(DISTINCT t0.__time, '|', 100000)) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.__time;
+-----+
| col |
+-----+
|  13 |
|  13 |
+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A01 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(timestamp '2020-01-01 01:01:01.000', '|', 100000) AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(__time, '|', 100000) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(__time, '|', 100000) || '-1583024461000' AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000-1583024461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT '1583024461000-' || string_agg(__time, '|', 100000) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_agg(__time, ',', 100000) || '-' || string_agg(__time, '|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT concat(string_agg(__time, ','), '-', string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, '|', 100000), '-1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000-1583024461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat('1583024461000-', string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+---------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+---------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT textcat(string_agg(__time, ',', 100000), string_agg(__time, '|')) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,15778404610001577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT string_format('%s-%s', string_agg(__time, ','), string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000,1577840461000-1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT char_length(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT character_length(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 251 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lower(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT parse_long(string_agg(__time, '|', 100000), 16) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT position('1577840461000' IN string_agg(__time, '|', 100000)
                FROM 20) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|  29 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(__time, '|', 100000), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_extract(string_agg(__time, '|', 100000), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(__time, '|', 100000), '15778404610001') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT regexp_like(string_agg(__time, '|', 100000), '15778404610002') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(__time, '|', 100000), '1577840461000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(string_agg(__time, '|', 100000), '1580518861000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(__time, '|', 100000), '1577840461000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT icontains_string(string_agg(__time, '|', 100000), '1580518861000|') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(__time, '|', 100000), '1577840461000', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000|1583024461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT replace(string_agg(__time, '|', 100000), '4444444444', '1583024461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(__time, '|', 100000), '|1577840461000') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|  14 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strpos(string_agg(__time, '|', 100000), '|4444444444') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(__time, '|', 100000), 15) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------+
| col                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT substring(string_agg(__time, '|', 100000), 15, 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH
            FROM string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING
            FROM string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING
            FROM string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A36 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(BOTH '1234567890'
            FROM string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------+
| col                                                                                                 |
+-----------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+-----------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A37 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(LEADING '1234567890'
            FROM string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A38 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT trim(TRAILING '1234567890'
            FROM string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A39 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A40 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT btrim(string_agg(__time, '|', 100000), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------+
| col                                                                                                 |
+-----------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+-----------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A41 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A42 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT ltrim(string_agg(__time, '|', 100000), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| |1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A43 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A44 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rtrim(string_agg(__time, '|', 100000), '1234567890') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------+
| col                                                                                                              |
+------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000| |
+------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A45 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT upper(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A46 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT reverse(string_agg(__time, '|', 100000)) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------+
| 0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751|0001640487751 |
+-------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A47 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|', 100000), -1) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A48 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|', 100000), 0) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A49 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT repeat(string_agg(__time, '|', 100000), 2) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|15778404610001577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A50 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|', 100000), 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A51 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|', 100000), 14, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A52 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|', 100000), 135) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
|           1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A53 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT lpad(string_agg(__time, '|', 100000), 135, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
| AAAAAAAAAA1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000 |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A54 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|', 100000), 14) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A55 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|', 100000), 14, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+----------------+
| col            |
+----------------+
| 1577840461000| |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A56 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|', 100000), 135) AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000           |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A57 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT rpad(string_agg(__time, '|', 100000), 135, 'A') AS col
FROM test_agg_funcs
WHERE __time=timestamp '2020-01-01 01:01:01.000';
+-----------------------------------------------------------------------------------------------------------------------------------------+
| col                                                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------------------+
| 1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000|1577840461000AAAAAAAAAA |
+-----------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A58 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(t0.__time, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.__time IS NOT NULL);
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A59 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(t0.__time, '|', 100000)) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.__time IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A60 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) LEN
FROM
  (SELECT string_agg(t0.__time, '|', 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.__time);
+-------+
| LEN   |
+-------+
| 40823 |
| 40823 |
+-------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A61 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(string_agg(t0.__time, '|', 100000)) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.__time;
+-------+
| col   |
+-------+
| 40823 |
| 40823 |
+-------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 245 Positive tests: 235 Negative tests: 10
#-------------------------------------------------------------------------
