#started Wed Jul 10 19:12:59 IST 2024
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
# Wed Jul 10 19:13:46 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:58.044 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:13:46 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:58.044 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:13:46 IST 2024
SELECT
(COUNT(*)) AS "__VALUE__"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY ();
+-----------+
| __VALUE__ |
+-----------+
|      4519 |
+-----------+
(1 row)

!ok
# Wed Jul 10 19:14:06 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 01:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 01:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 02:00:00'))) AS "v1"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 02:00:00')
GROUP BY ();
+-----+-----+
| v0  | v1  |
+-----+-----+
| 145 | 112 |
+-----+-----+
(1 row)

!ok
# Wed Jul 10 19:14:06 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 02:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 06:00:00.000 |    68 |
| 2019-08-25 15:00:00.000 |   124 |
| 2019-08-25 02:00:00.000 |   154 |
| 2019-08-25 03:00:00.000 |   112 |
| 2019-08-25 04:00:00.000 |    71 |
| 2019-08-25 05:00:00.000 |    87 |
| 2019-08-25 07:00:00.000 |    60 |
| 2019-08-25 08:00:00.000 |    55 |
| 2019-08-25 09:00:00.000 |    61 |
| 2019-08-25 10:00:00.000 |    53 |
| 2019-08-25 11:00:00.000 |    69 |
| 2019-08-25 12:00:00.000 |    89 |
| 2019-08-25 13:00:00.000 |   139 |
| 2019-08-25 14:00:00.000 |   181 |
| 2019-08-25 16:00:00.000 |   356 |
| 2019-08-25 17:00:00.000 |   556 |
| 2019-08-25 18:00:00.000 |   485 |
| 2019-08-25 19:00:00.000 |   491 |
| 2019-08-25 20:00:00.000 |   392 |
| 2019-08-25 21:00:00.000 |   263 |
| 2019-08-25 22:00:00.000 |   213 |
| 2019-08-25 23:00:00.000 |   183 |
+-------------------------+-------+
(22 rows)

!ok
# Wed Jul 10 19:14:18 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 10;
+----------+-------+
| timezone | count |
+----------+-------+
| N/A      |  3035 |
| EDT      |   580 |
| CDT      |   349 |
| PDT      |   155 |
| CEST     |   113 |
| BST      |    87 |
| MDT      |    59 |
| MST      |    27 |
| MSK      |    24 |
| AEST     |    15 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:18 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 00:00:00.000 | MSK      |     1 |
| 2019-08-25 00:00:00.000 | PDT      |     6 |
| 2019-08-25 03:00:00.000 | MST      |     3 |
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 08:00:00.000 | BST      |     2 |
| 2019-08-25 08:00:00.000 | CEST     |     2 |
| 2019-08-25 09:00:00.000 | EDT      |     1 |
| 2019-08-25 09:00:00.000 | MSK      |     1 |
| 2019-08-25 10:00:00.000 | MSK      |     1 |
| 2019-08-25 11:00:00.000 | EEST     |     1 |
| 2019-08-25 12:00:00.000 | EEST     |     1 |
| 2019-08-25 13:00:00.000 | CDT      |     3 |
| 2019-08-25 14:00:00.000 | PDT      |     2 |
| 2019-08-25 17:00:00.000 | EEST     |     1 |
| 2019-08-25 18:00:00.000 | EEST     |     1 |
| 2019-08-25 19:00:00.000 | MSK      |     2 |
| 2019-08-25 20:00:00.000 | CEST     |    19 |
| 2019-08-25 20:00:00.000 | MST      |     1 |
| 2019-08-25 21:00:00.000 | MSK      |     2 |
| 2019-08-25 22:00:00.000 | MSK      |     1 |
| 2019-08-25 23:00:00.000 | CEST     |     3 |
| 2019-08-25 23:00:00.000 | MDT      |     1 |
| 2019-08-25 00:00:00.000 | CDT      |     3 |
| 2019-08-25 00:00:00.000 | CEST     |     2 |
| 2019-08-25 00:00:00.000 | EDT      |    17 |
| 2019-08-25 00:00:00.000 | MDT      |     4 |
| 2019-08-25 00:00:00.000 | N/A      |   109 |
| 2019-08-25 01:00:00.000 | CDT      |     7 |
| 2019-08-25 01:00:00.000 | EDT      |    15 |
| 2019-08-25 01:00:00.000 | MDT      |     2 |
| 2019-08-25 01:00:00.000 | N/A      |    82 |
| 2019-08-25 01:00:00.000 | PDT      |     4 |
| 2019-08-25 02:00:00.000 | CDT      |    16 |
| 2019-08-25 02:00:00.000 | EDT      |    17 |
| 2019-08-25 02:00:00.000 | MDT      |     1 |
| 2019-08-25 02:00:00.000 | MST      |     4 |
| 2019-08-25 02:00:00.000 | N/A      |   111 |
| 2019-08-25 02:00:00.000 | PDT      |     4 |
| 2019-08-25 03:00:00.000 | CDT      |    13 |
| 2019-08-25 03:00:00.000 | EDT      |     5 |
| 2019-08-25 03:00:00.000 | MDT      |     2 |
| 2019-08-25 03:00:00.000 | N/A      |    80 |
| 2019-08-25 03:00:00.000 | PDT      |     4 |
| 2019-08-25 04:00:00.000 | CDT      |    10 |
| 2019-08-25 04:00:00.000 | EDT      |     8 |
| 2019-08-25 04:00:00.000 | MDT      |     3 |
| 2019-08-25 04:00:00.000 | N/A      |    45 |
| 2019-08-25 04:00:00.000 | PDT      |     4 |
| 2019-08-25 05:00:00.000 | CDT      |     5 |
| 2019-08-25 05:00:00.000 | EDT      |    10 |
| 2019-08-25 05:00:00.000 | EEST     |     2 |
| 2019-08-25 05:00:00.000 | MDT      |     1 |
| 2019-08-25 05:00:00.000 | MST      |     4 |
| 2019-08-25 05:00:00.000 | N/A      |    59 |
| 2019-08-25 05:00:00.000 | PDT      |     6 |
| 2019-08-25 06:00:00.000 | CDT      |     2 |
| 2019-08-25 06:00:00.000 | EDT      |     2 |
| 2019-08-25 06:00:00.000 | MSK      |     2 |
| 2019-08-25 06:00:00.000 | N/A      |    59 |
| 2019-08-25 07:00:00.000 | EDT      |     3 |
| 2019-08-25 07:00:00.000 | MDT      |     1 |
| 2019-08-25 07:00:00.000 | MSK      |     5 |
| 2019-08-25 07:00:00.000 | N/A      |    47 |
| 2019-08-25 08:00:00.000 | MSK      |     1 |
| 2019-08-25 08:00:00.000 | N/A      |    48 |
| 2019-08-25 08:00:00.000 | PDT      |     1 |
| 2019-08-25 09:00:00.000 | BST      |     4 |
| 2019-08-25 09:00:00.000 | CEST     |     4 |
| 2019-08-25 09:00:00.000 | N/A      |    45 |
| 2019-08-25 10:00:00.000 | BST      |     1 |
| 2019-08-25 10:00:00.000 | N/A      |    51 |
| 2019-08-25 11:00:00.000 | BST      |     1 |
| 2019-08-25 11:00:00.000 | CDT      |     2 |
| 2019-08-25 11:00:00.000 | CEST     |     8 |
| 2019-08-25 11:00:00.000 | EDT      |     1 |
| 2019-08-25 11:00:00.000 | N/A      |    55 |
| 2019-08-25 12:00:00.000 | CEST     |     5 |
| 2019-08-25 12:00:00.000 | EDT      |     2 |
| 2019-08-25 12:00:00.000 | MSK      |     4 |
| 2019-08-25 12:00:00.000 | N/A      |    76 |
| 2019-08-25 13:00:00.000 | BST      |     2 |
| 2019-08-25 13:00:00.000 | CEST     |    11 |
| 2019-08-25 13:00:00.000 | EDT      |    15 |
| 2019-08-25 13:00:00.000 | N/A      |   101 |
| 2019-08-25 14:00:00.000 | BST      |    10 |
| 2019-08-25 14:00:00.000 | CDT      |     5 |
| 2019-08-25 14:00:00.000 | CEST     |     3 |
| 2019-08-25 14:00:00.000 | EDT      |    27 |
| 2019-08-25 14:00:00.000 | EEST     |     4 |
| 2019-08-25 14:00:00.000 | MSK      |     2 |
| 2019-08-25 14:00:00.000 | N/A      |   122 |
| 2019-08-25 15:00:00.000 | BST      |     2 |
| 2019-08-25 15:00:00.000 | CDT      |     8 |
| 2019-08-25 15:00:00.000 | CEST     |     3 |
| 2019-08-25 15:00:00.000 | EDT      |     4 |
| 2019-08-25 15:00:00.000 | MDT      |     3 |
| 2019-08-25 15:00:00.000 | N/A      |    98 |
| 2019-08-25 15:00:00.000 | PDT      |     4 |
| 2019-08-25 16:00:00.000 | BST      |     7 |
| 2019-08-25 16:00:00.000 | CDT      |    38 |
| 2019-08-25 16:00:00.000 | CEST     |     6 |
| 2019-08-25 16:00:00.000 | EDT      |    67 |
| 2019-08-25 16:00:00.000 | MDT      |    10 |
| 2019-08-25 16:00:00.000 | N/A      |   218 |
| 2019-08-25 16:00:00.000 | PDT      |     8 |
| 2019-08-25 17:00:00.000 | BST      |    23 |
| 2019-08-25 17:00:00.000 | CDT      |    64 |
| 2019-08-25 17:00:00.000 | CEST     |    13 |
| 2019-08-25 17:00:00.000 | EDT      |   103 |
| 2019-08-25 17:00:00.000 | MDT      |    12 |
| 2019-08-25 17:00:00.000 | MST      |     2 |
| 2019-08-25 17:00:00.000 | N/A      |   304 |
| 2019-08-25 17:00:00.000 | PDT      |    31 |
| 2019-08-25 18:00:00.000 | BST      |     7 |
| 2019-08-25 18:00:00.000 | CDT      |    49 |
| 2019-08-25 18:00:00.000 | CEST     |    11 |
| 2019-08-25 18:00:00.000 | EDT      |    72 |
| 2019-08-25 18:00:00.000 | MDT      |     8 |
| 2019-08-25 18:00:00.000 | MST      |     5 |
| 2019-08-25 18:00:00.000 | N/A      |   310 |
| 2019-08-25 18:00:00.000 | PDT      |    18 |
| 2019-08-25 19:00:00.000 | BST      |    12 |
| 2019-08-25 19:00:00.000 | CDT      |    47 |
| 2019-08-25 19:00:00.000 | CEST     |    14 |
| 2019-08-25 19:00:00.000 | EDT      |    81 |
| 2019-08-25 19:00:00.000 | EEST     |     1 |
| 2019-08-25 19:00:00.000 | MDT      |     3 |
| 2019-08-25 19:00:00.000 | MST      |     4 |
| 2019-08-25 19:00:00.000 | N/A      |   303 |
| 2019-08-25 19:00:00.000 | PDT      |    18 |
| 2019-08-25 20:00:00.000 | BST      |     6 |
| 2019-08-25 20:00:00.000 | CDT      |    33 |
| 2019-08-25 20:00:00.000 | EDT      |    41 |
| 2019-08-25 20:00:00.000 | EEST     |     2 |
| 2019-08-25 20:00:00.000 | MDT      |     3 |
| 2019-08-25 20:00:00.000 | MSK      |     2 |
| 2019-08-25 20:00:00.000 | N/A      |   261 |
| 2019-08-25 20:00:00.000 | PDT      |    18 |
| 2019-08-25 21:00:00.000 | BST      |     6 |
| 2019-08-25 21:00:00.000 | CDT      |    18 |
| 2019-08-25 21:00:00.000 | CEST     |     6 |
| 2019-08-25 21:00:00.000 | EDT      |    27 |
| 2019-08-25 21:00:00.000 | MDT      |     4 |
| 2019-08-25 21:00:00.000 | MST      |     1 |
| 2019-08-25 21:00:00.000 | N/A      |   181 |
| 2019-08-25 21:00:00.000 | PDT      |    11 |
| 2019-08-25 22:00:00.000 | BST      |     2 |
| 2019-08-25 22:00:00.000 | CDT      |    16 |
| 2019-08-25 22:00:00.000 | CEST     |     3 |
| 2019-08-25 22:00:00.000 | EDT      |    33 |
| 2019-08-25 22:00:00.000 | EEST     |     1 |
| 2019-08-25 22:00:00.000 | MDT      |     1 |
| 2019-08-25 22:00:00.000 | MST      |     1 |
| 2019-08-25 22:00:00.000 | N/A      |   146 |
| 2019-08-25 22:00:00.000 | PDT      |     8 |
| 2019-08-25 23:00:00.000 | BST      |     2 |
| 2019-08-25 23:00:00.000 | CDT      |     9 |
| 2019-08-25 23:00:00.000 | EDT      |    29 |
| 2019-08-25 23:00:00.000 | MST      |     2 |
| 2019-08-25 23:00:00.000 | N/A      |   124 |
| 2019-08-25 23:00:00.000 | PDT      |     8 |
+-------------------------+----------+-------+
(161 rows)

!ok
# Wed Jul 10 19:14:18 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1;
+----------+-------+
| timezone | count |
+----------+-------+
| EEST     |    14 |
| MSK      |    24 |
| BST      |    87 |
| CDT      |   349 |
| CEST     |   113 |
| EDT      |   580 |
| MDT      |    59 |
| MST      |    27 |
| N/A      |  3035 |
| PDT      |   155 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:22 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------------+-------+
| Browser               | count |
+-----------------------+-------+
| Chrome                |  2313 |
| Mobile Safari         |  1052 |
| Chrome Mobile         |   589 |
| Safari                |   386 |
| Firefox               |    72 |
| Yandex.Browser        |    39 |
| Opera                 |    22 |
| Mozilla               |    15 |
| IE                    |    10 |
| Silk                  |     9 |
| Yandex.Browser mobile |     8 |
| PS4 Web browser       |     2 |
| Mobile Firefox        |     1 |
| Puffin                |     1 |
+-----------------------+-------+
(14 rows)

!ok
# Wed Jul 10 19:14:22 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Chrome'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 16:00:00.000 | BST      |     1 |
| 2019-08-25 20:00:00.000 | PDT      |     1 |
| 2019-08-25 00:00:00.000 | EDT      |     1 |
| 2019-08-25 00:00:00.000 | N/A      |    90 |
| 2019-08-25 01:00:00.000 | N/A      |    62 |
| 2019-08-25 01:00:00.000 | PDT      |     2 |
| 2019-08-25 02:00:00.000 | N/A      |    89 |
| 2019-08-25 03:00:00.000 | N/A      |    59 |
| 2019-08-25 03:00:00.000 | PDT      |     1 |
| 2019-08-25 04:00:00.000 | EDT      |     2 |
| 2019-08-25 04:00:00.000 | N/A      |    39 |
| 2019-08-25 05:00:00.000 | N/A      |    45 |
| 2019-08-25 06:00:00.000 | N/A      |    39 |
| 2019-08-25 07:00:00.000 | N/A      |    31 |
| 2019-08-25 08:00:00.000 | N/A      |    28 |
| 2019-08-25 09:00:00.000 | N/A      |    30 |
| 2019-08-25 10:00:00.000 | N/A      |    36 |
| 2019-08-25 11:00:00.000 | CEST     |     1 |
| 2019-08-25 11:00:00.000 | N/A      |    32 |
| 2019-08-25 12:00:00.000 | N/A      |    50 |
| 2019-08-25 13:00:00.000 | EDT      |     2 |
| 2019-08-25 13:00:00.000 | N/A      |    69 |
| 2019-08-25 14:00:00.000 | N/A      |    85 |
| 2019-08-25 15:00:00.000 | CEST     |     1 |
| 2019-08-25 15:00:00.000 | N/A      |    79 |
| 2019-08-25 16:00:00.000 | EDT      |     2 |
| 2019-08-25 16:00:00.000 | N/A      |   174 |
| 2019-08-25 17:00:00.000 | EDT      |     2 |
| 2019-08-25 17:00:00.000 | N/A      |   220 |
| 2019-08-25 17:00:00.000 | PDT      |     1 |
| 2019-08-25 18:00:00.000 | EDT      |     2 |
| 2019-08-25 18:00:00.000 | N/A      |   232 |
| 2019-08-25 19:00:00.000 | N/A      |   230 |
| 2019-08-25 20:00:00.000 | CEST     |     1 |
| 2019-08-25 20:00:00.000 | EDT      |     2 |
| 2019-08-25 20:00:00.000 | EEST     |     1 |
| 2019-08-25 20:00:00.000 | N/A      |   201 |
| 2019-08-25 21:00:00.000 | N/A      |   140 |
| 2019-08-25 22:00:00.000 | N/A      |   117 |
| 2019-08-25 23:00:00.000 | EDT      |     1 |
| 2019-08-25 23:00:00.000 | N/A      |   105 |
+-------------------------+----------+-------+
(42 rows)

!ok
# Wed Jul 10 19:14:23 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome Mobile','Safari'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 03:00:00.000 | MST      |     2 |
| Safari        | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 09:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 18:00:00.000 | BST      |     2 |
| Safari        | 2019-08-25 18:00:00.000 | EDT      |    13 |
| Safari        | 2019-08-25 19:00:00.000 | BST      |     6 |
| Safari        | 2019-08-25 19:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 20:00:00.000 | CDT      |     7 |
| Safari        | 2019-08-25 23:00:00.000 | CDT      |     4 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    15 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 00:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 00:00:00.000 | MDT      |     3 |
| Safari        | 2019-08-25 00:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | PDT      |     5 |
| Safari        | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 01:00:00.000 | EDT      |     5 |
| Safari        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 02:00:00.000 | CDT      |     2 |
| Safari        | 2019-08-25 02:00:00.000 | EDT      |     5 |
| Safari        | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 03:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Safari        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 04:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 05:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 07:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 07:00:00.000 | MSK      |     2 |
| Safari        | 2019-08-25 08:00:00.000 | MSK      |     1 |
| Safari        | 2019-08-25 09:00:00.000 | BST      |     3 |
| Safari        | 2019-08-25 11:00:00.000 | CEST     |     2 |
| Safari        | 2019-08-25 11:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 12:00:00.000 | CEST     |     5 |
| Safari        | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 13:00:00.000 | CEST     |     5 |
| Safari        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 14:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Safari        | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 15:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 15:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 16:00:00.000 | CDT      |    10 |
| Safari        | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Safari        | 2019-08-25 16:00:00.000 | EDT      |    21 |
| Safari        | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Safari        | 2019-08-25 16:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 17:00:00.000 | CDT      |    22 |
| Safari        | 2019-08-25 17:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 17:00:00.000 | EDT      |    25 |
| Safari        | 2019-08-25 17:00:00.000 | MDT      |     5 |
| Safari        | 2019-08-25 17:00:00.000 | PDT      |     8 |
| Safari        | 2019-08-25 18:00:00.000 | CDT      |    14 |
| Safari        | 2019-08-25 18:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 18:00:00.000 | MDT      |     2 |
| Safari        | 2019-08-25 18:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 18:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 19:00:00.000 | CDT      |    11 |
| Safari        | 2019-08-25 19:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 19:00:00.000 | EDT      |    24 |
| Safari        | 2019-08-25 19:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 20:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 20:00:00.000 | EDT      |     9 |
| Safari        | 2019-08-25 20:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 20:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 21:00:00.000 | CDT      |     5 |
| Safari        | 2019-08-25 21:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 21:00:00.000 | PDT      |     4 |
| Safari        | 2019-08-25 22:00:00.000 | CDT      |     7 |
| Safari        | 2019-08-25 22:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Safari        | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 22:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 23:00:00.000 | EDT      |    13 |
| Safari        | 2019-08-25 23:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 23:00:00.000 | PDT      |     2 |
+---------------+-------------------------+----------+-------+
(271 rows)

!ok
# Wed Jul 10 19:14:23 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Safari        | CEST     |    26 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | EDT      |    14 |
| Chrome        | N/A      |  2282 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | EDT      |    14 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | N/A      |   558 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    73 |
| Mobile Safari | CDT      |   247 |
| Mobile Safari | CEST     |    80 |
| Mobile Safari | EDT      |   395 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | N/A      |    22 |
| Mobile Safari | PDT      |   102 |
| Safari        | BST      |    13 |
| Safari        | CDT      |    97 |
| Safari        | EDT      |   155 |
| Safari        | EEST     |     1 |
| Safari        | MDT      |    17 |
| Safari        | MSK      |     4 |
| Safari        | MST      |     6 |
| Safari        | N/A      |     3 |
| Safari        | PDT      |    45 |
+---------------+----------+-------+
(35 rows)

!ok
# Wed Jul 10 19:14:25 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Chrome Mobile','Mobile Safari','Safari'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 00:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 03:00:00.000 | MST      |     2 |
| Safari        | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 09:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 18:00:00.000 | BST      |     2 |
| Safari        | 2019-08-25 18:00:00.000 | EDT      |    13 |
| Safari        | 2019-08-25 19:00:00.000 | BST      |     6 |
| Safari        | 2019-08-25 19:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 20:00:00.000 | CDT      |     7 |
| Chrome        | 2019-08-25 00:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    90 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    62 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    89 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    59 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    45 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    31 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    28 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    30 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    32 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    50 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    69 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    85 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 16:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   174 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   220 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   232 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   230 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   201 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   140 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   117 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 00:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 00:00:00.000 | MDT      |     3 |
| Safari        | 2019-08-25 00:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | PDT      |     5 |
| Safari        | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 01:00:00.000 | EDT      |     5 |
| Safari        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 02:00:00.000 | CDT      |     2 |
| Safari        | 2019-08-25 02:00:00.000 | EDT      |     5 |
| Safari        | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 03:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Safari        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 04:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 05:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 07:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 07:00:00.000 | MSK      |     2 |
| Safari        | 2019-08-25 08:00:00.000 | MSK      |     1 |
| Safari        | 2019-08-25 09:00:00.000 | BST      |     3 |
| Safari        | 2019-08-25 11:00:00.000 | CEST     |     2 |
| Safari        | 2019-08-25 11:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 12:00:00.000 | CEST     |     5 |
| Safari        | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 13:00:00.000 | CEST     |     5 |
| Safari        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 14:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Safari        | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 15:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 15:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 16:00:00.000 | CDT      |    10 |
| Safari        | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Safari        | 2019-08-25 16:00:00.000 | EDT      |    21 |
| Safari        | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Safari        | 2019-08-25 16:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 17:00:00.000 | CDT      |    22 |
| Safari        | 2019-08-25 17:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 17:00:00.000 | EDT      |    25 |
| Safari        | 2019-08-25 17:00:00.000 | MDT      |     5 |
| Safari        | 2019-08-25 17:00:00.000 | PDT      |     8 |
| Safari        | 2019-08-25 18:00:00.000 | CDT      |    14 |
| Safari        | 2019-08-25 18:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 18:00:00.000 | MDT      |     2 |
| Safari        | 2019-08-25 18:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 18:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 19:00:00.000 | CDT      |    11 |
| Safari        | 2019-08-25 19:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 19:00:00.000 | EDT      |    24 |
| Safari        | 2019-08-25 19:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 20:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 20:00:00.000 | EDT      |     9 |
| Safari        | 2019-08-25 20:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 20:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 21:00:00.000 | CDT      |     5 |
| Safari        | 2019-08-25 21:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 21:00:00.000 | PDT      |     4 |
| Safari        | 2019-08-25 22:00:00.000 | CDT      |     7 |
| Safari        | 2019-08-25 22:00:00.000 | EDT      |     3 |
| Safari        | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Safari        | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Safari        | 2019-08-25 22:00:00.000 | PDT      |     2 |
+---------------+-------------------------+----------+-------+
(297 rows)

!ok
# Wed Jul 10 19:14:26 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Chrome Mobile','Mobile Safari','Safari'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Safari        | CEST     |    26 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | EDT      |    13 |
| Chrome        | N/A      |  2177 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | EDT      |    12 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | N/A      |   543 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    71 |
| Mobile Safari | CDT      |   242 |
| Mobile Safari | CEST     |    77 |
| Mobile Safari | EDT      |   382 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    20 |
| Mobile Safari | N/A      |    21 |
| Mobile Safari | PDT      |    96 |
| Safari        | BST      |    13 |
| Safari        | CDT      |    93 |
| Safari        | EDT      |   142 |
| Safari        | EEST     |     1 |
| Safari        | MDT      |    17 |
| Safari        | MSK      |     4 |
| Safari        | MST      |     5 |
| Safari        | N/A      |     3 |
| Safari        | PDT      |    43 |
+---------------+----------+-------+
(35 rows)

!ok
# Wed Jul 10 19:14:32 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "r"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "r" DESC
LIMIT 101;
+-----------------------+------+
| Browser               | r    |
+-----------------------+------+
| Chrome                | 2313 |
| Mobile Safari         | 1052 |
| Chrome Mobile         |  589 |
| Safari                |  386 |
| Firefox               |   72 |
| Yandex.Browser        |   39 |
| Opera                 |   22 |
| Mozilla               |   15 |
| IE                    |   10 |
| Silk                  |    9 |
| Yandex.Browser mobile |    8 |
| PS4 Web browser       |    2 |
| Mobile Firefox        |    1 |
| Puffin                |    1 |
+-----------------------+------+
(14 rows)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 10;
+----------+-------+
| timezone | count |
+----------+-------+
| N/A      |  2862 |
| EDT      |   423 |
| CDT      |   252 |
| PDT      |   110 |
| CEST     |    86 |
| BST      |    74 |
| MDT      |    42 |
| MST      |    21 |
| MSK      |    18 |
| EEST     |    13 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00'))) AS "v1",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 01:00:00'))) AS "v2",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v3",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 01:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 02:00:00'))) AS "v4",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 01:00:00'))) AS "v5"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY ();
+------+------+-----+----+----+-----+
| v0   | v1   | v2  | v3 | v4 | v5  |
+------+------+-----+----+----+-----+
| 3954 | 3796 | 124 |  0 | 97 | 124 |
+------+------+-----+----+----+-----+
(1 row)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+---------------+-------+
| Browser       | count |
+---------------+-------+
| Chrome        |  2313 |
| Mobile Safari |  1052 |
| Chrome Mobile |   589 |
+---------------+-------+
(3 rows)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 00:00:00.000 | MDT      |     1 |
| 2019-08-25 00:00:00.000 | MSK      |     1 |
| 2019-08-25 03:00:00.000 | MST      |     1 |
| 2019-08-25 03:00:00.000 | PDT      |     3 |
| 2019-08-25 05:00:00.000 | CDT      |     4 |
| 2019-08-25 05:00:00.000 | MDT      |     1 |
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 08:00:00.000 | CEST     |     2 |
| 2019-08-25 09:00:00.000 | BST      |     1 |
| 2019-08-25 09:00:00.000 | MSK      |     1 |
| 2019-08-25 09:00:00.000 | N/A      |    40 |
| 2019-08-25 10:00:00.000 | MSK      |     1 |
| 2019-08-25 11:00:00.000 | CEST     |     6 |
| 2019-08-25 11:00:00.000 | EEST     |     1 |
| 2019-08-25 12:00:00.000 | EEST     |     1 |
| 2019-08-25 13:00:00.000 | CDT      |     3 |
| 2019-08-25 15:00:00.000 | CDT      |     5 |
| 2019-08-25 19:00:00.000 | CEST     |    11 |
| 2019-08-25 19:00:00.000 | MSK      |     2 |
| 2019-08-25 20:00:00.000 | MSK      |     2 |
| 2019-08-25 21:00:00.000 | PDT      |     7 |
| 2019-08-25 22:00:00.000 | PDT      |     6 |
| 2019-08-25 23:00:00.000 | CEST     |     3 |
| 2019-08-25 23:00:00.000 | MDT      |     1 |
| 2019-08-25 00:00:00.000 | CDT      |     2 |
| 2019-08-25 00:00:00.000 | CEST     |     1 |
| 2019-08-25 00:00:00.000 | EDT      |    14 |
| 2019-08-25 00:00:00.000 | N/A      |   101 |
| 2019-08-25 00:00:00.000 | PDT      |     1 |
| 2019-08-25 01:00:00.000 | CDT      |     6 |
| 2019-08-25 01:00:00.000 | EDT      |    10 |
| 2019-08-25 01:00:00.000 | MDT      |     1 |
| 2019-08-25 01:00:00.000 | N/A      |    76 |
| 2019-08-25 01:00:00.000 | PDT      |     2 |
| 2019-08-25 02:00:00.000 | CDT      |    14 |
| 2019-08-25 02:00:00.000 | EDT      |    12 |
| 2019-08-25 02:00:00.000 | MDT      |     1 |
| 2019-08-25 02:00:00.000 | MST      |     3 |
| 2019-08-25 02:00:00.000 | N/A      |   105 |
| 2019-08-25 02:00:00.000 | PDT      |     2 |
| 2019-08-25 03:00:00.000 | CDT      |    10 |
| 2019-08-25 03:00:00.000 | EDT      |     2 |
| 2019-08-25 03:00:00.000 | MDT      |     2 |
| 2019-08-25 03:00:00.000 | N/A      |    70 |
| 2019-08-25 04:00:00.000 | CDT      |     5 |
| 2019-08-25 04:00:00.000 | EDT      |     6 |
| 2019-08-25 04:00:00.000 | MDT      |     2 |
| 2019-08-25 04:00:00.000 | N/A      |    45 |
| 2019-08-25 04:00:00.000 | PDT      |     2 |
| 2019-08-25 05:00:00.000 | EDT      |     8 |
| 2019-08-25 05:00:00.000 | EEST     |     2 |
| 2019-08-25 05:00:00.000 | MST      |     3 |
| 2019-08-25 05:00:00.000 | N/A      |    57 |
| 2019-08-25 05:00:00.000 | PDT      |     5 |
| 2019-08-25 06:00:00.000 | CDT      |     1 |
| 2019-08-25 06:00:00.000 | EDT      |     2 |
| 2019-08-25 06:00:00.000 | MSK      |     2 |
| 2019-08-25 06:00:00.000 | N/A      |    53 |
| 2019-08-25 07:00:00.000 | MDT      |     1 |
| 2019-08-25 07:00:00.000 | MSK      |     3 |
| 2019-08-25 07:00:00.000 | N/A      |    43 |
| 2019-08-25 08:00:00.000 | BST      |     2 |
| 2019-08-25 08:00:00.000 | N/A      |    45 |
| 2019-08-25 08:00:00.000 | PDT      |     1 |
| 2019-08-25 09:00:00.000 | CEST     |     4 |
| 2019-08-25 10:00:00.000 | BST      |     1 |
| 2019-08-25 10:00:00.000 | N/A      |    42 |
| 2019-08-25 11:00:00.000 | BST      |     1 |
| 2019-08-25 11:00:00.000 | CDT      |     2 |
| 2019-08-25 11:00:00.000 | N/A      |    44 |
| 2019-08-25 12:00:00.000 | EDT      |     1 |
| 2019-08-25 12:00:00.000 | MSK      |     3 |
| 2019-08-25 12:00:00.000 | N/A      |    70 |
| 2019-08-25 13:00:00.000 | BST      |     2 |
| 2019-08-25 13:00:00.000 | CEST     |     6 |
| 2019-08-25 13:00:00.000 | EDT      |    12 |
| 2019-08-25 13:00:00.000 | N/A      |    91 |
| 2019-08-25 14:00:00.000 | BST      |    10 |
| 2019-08-25 14:00:00.000 | CDT      |     5 |
| 2019-08-25 14:00:00.000 | CEST     |     2 |
| 2019-08-25 14:00:00.000 | EDT      |    16 |
| 2019-08-25 14:00:00.000 | EEST     |     4 |
| 2019-08-25 14:00:00.000 | MSK      |     1 |
| 2019-08-25 14:00:00.000 | N/A      |   111 |
| 2019-08-25 14:00:00.000 | PDT      |     1 |
| 2019-08-25 15:00:00.000 | BST      |     1 |
| 2019-08-25 15:00:00.000 | CEST     |     2 |
| 2019-08-25 15:00:00.000 | EDT      |     3 |
| 2019-08-25 15:00:00.000 | MDT      |     3 |
| 2019-08-25 15:00:00.000 | N/A      |    97 |
| 2019-08-25 15:00:00.000 | PDT      |     4 |
| 2019-08-25 16:00:00.000 | BST      |     7 |
| 2019-08-25 16:00:00.000 | CDT      |    28 |
| 2019-08-25 16:00:00.000 | CEST     |     4 |
| 2019-08-25 16:00:00.000 | EDT      |    46 |
| 2019-08-25 16:00:00.000 | MDT      |     6 |
| 2019-08-25 16:00:00.000 | N/A      |   208 |
| 2019-08-25 16:00:00.000 | PDT      |     5 |
| 2019-08-25 17:00:00.000 | BST      |    23 |
| 2019-08-25 17:00:00.000 | CDT      |    42 |
| 2019-08-25 17:00:00.000 | CEST     |    12 |
| 2019-08-25 17:00:00.000 | EDT      |    78 |
| 2019-08-25 17:00:00.000 | EEST     |     1 |
| 2019-08-25 17:00:00.000 | MDT      |     7 |
| 2019-08-25 17:00:00.000 | MST      |     2 |
| 2019-08-25 17:00:00.000 | N/A      |   296 |
| 2019-08-25 17:00:00.000 | PDT      |    23 |
| 2019-08-25 18:00:00.000 | BST      |     5 |
| 2019-08-25 18:00:00.000 | CDT      |    35 |
| 2019-08-25 18:00:00.000 | CEST     |     7 |
| 2019-08-25 18:00:00.000 | EDT      |    57 |
| 2019-08-25 18:00:00.000 | EEST     |     1 |
| 2019-08-25 18:00:00.000 | MDT      |     6 |
| 2019-08-25 18:00:00.000 | MST      |     4 |
| 2019-08-25 18:00:00.000 | N/A      |   294 |
| 2019-08-25 18:00:00.000 | PDT      |    12 |
| 2019-08-25 19:00:00.000 | BST      |     6 |
| 2019-08-25 19:00:00.000 | CDT      |    36 |
| 2019-08-25 19:00:00.000 | EDT      |    57 |
| 2019-08-25 19:00:00.000 | MDT      |     3 |
| 2019-08-25 19:00:00.000 | MST      |     4 |
| 2019-08-25 19:00:00.000 | N/A      |   290 |
| 2019-08-25 19:00:00.000 | PDT      |    15 |
| 2019-08-25 20:00:00.000 | BST      |     5 |
| 2019-08-25 20:00:00.000 | CDT      |    26 |
| 2019-08-25 20:00:00.000 | CEST     |    17 |
| 2019-08-25 20:00:00.000 | EDT      |    32 |
| 2019-08-25 20:00:00.000 | EEST     |     2 |
| 2019-08-25 20:00:00.000 | MDT      |     2 |
| 2019-08-25 20:00:00.000 | MST      |     1 |
| 2019-08-25 20:00:00.000 | N/A      |   251 |
| 2019-08-25 20:00:00.000 | PDT      |    15 |
| 2019-08-25 21:00:00.000 | BST      |     6 |
| 2019-08-25 21:00:00.000 | CDT      |    13 |
| 2019-08-25 21:00:00.000 | CEST     |     6 |
| 2019-08-25 21:00:00.000 | EDT      |    21 |
| 2019-08-25 21:00:00.000 | MDT      |     4 |
| 2019-08-25 21:00:00.000 | MSK      |     2 |
| 2019-08-25 21:00:00.000 | MST      |     1 |
| 2019-08-25 21:00:00.000 | N/A      |   174 |
| 2019-08-25 22:00:00.000 | BST      |     2 |
| 2019-08-25 22:00:00.000 | CDT      |     9 |
| 2019-08-25 22:00:00.000 | CEST     |     3 |
| 2019-08-25 22:00:00.000 | EDT      |    30 |
| 2019-08-25 22:00:00.000 | EEST     |     1 |
| 2019-08-25 22:00:00.000 | MDT      |     1 |
| 2019-08-25 22:00:00.000 | MST      |     1 |
| 2019-08-25 22:00:00.000 | N/A      |   138 |
| 2019-08-25 23:00:00.000 | BST      |     2 |
| 2019-08-25 23:00:00.000 | CDT      |     5 |
| 2019-08-25 23:00:00.000 | EDT      |    16 |
| 2019-08-25 23:00:00.000 | MST      |     1 |
| 2019-08-25 23:00:00.000 | N/A      |   121 |
| 2019-08-25 23:00:00.000 | PDT      |     6 |
+-------------------------+----------+-------+
(154 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Chrome')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 16:00:00.000 | BST      |     1 |
| 2019-08-25 20:00:00.000 | PDT      |     1 |
| 2019-08-25 00:00:00.000 | EDT      |     1 |
| 2019-08-25 00:00:00.000 | N/A      |    90 |
| 2019-08-25 01:00:00.000 | N/A      |    62 |
| 2019-08-25 01:00:00.000 | PDT      |     2 |
| 2019-08-25 02:00:00.000 | N/A      |    89 |
| 2019-08-25 03:00:00.000 | N/A      |    59 |
| 2019-08-25 03:00:00.000 | PDT      |     1 |
| 2019-08-25 04:00:00.000 | EDT      |     2 |
| 2019-08-25 04:00:00.000 | N/A      |    39 |
| 2019-08-25 05:00:00.000 | N/A      |    45 |
| 2019-08-25 06:00:00.000 | N/A      |    39 |
| 2019-08-25 07:00:00.000 | N/A      |    31 |
| 2019-08-25 08:00:00.000 | N/A      |    28 |
| 2019-08-25 09:00:00.000 | N/A      |    30 |
| 2019-08-25 10:00:00.000 | N/A      |    36 |
| 2019-08-25 11:00:00.000 | CEST     |     1 |
| 2019-08-25 11:00:00.000 | N/A      |    32 |
| 2019-08-25 12:00:00.000 | N/A      |    50 |
| 2019-08-25 13:00:00.000 | EDT      |     2 |
| 2019-08-25 13:00:00.000 | N/A      |    69 |
| 2019-08-25 14:00:00.000 | N/A      |    85 |
| 2019-08-25 15:00:00.000 | CEST     |     1 |
| 2019-08-25 15:00:00.000 | N/A      |    79 |
| 2019-08-25 16:00:00.000 | EDT      |     2 |
| 2019-08-25 16:00:00.000 | N/A      |   174 |
| 2019-08-25 17:00:00.000 | EDT      |     2 |
| 2019-08-25 17:00:00.000 | N/A      |   220 |
| 2019-08-25 17:00:00.000 | PDT      |     1 |
| 2019-08-25 18:00:00.000 | EDT      |     2 |
| 2019-08-25 18:00:00.000 | N/A      |   232 |
| 2019-08-25 19:00:00.000 | N/A      |   230 |
| 2019-08-25 20:00:00.000 | CEST     |     1 |
| 2019-08-25 20:00:00.000 | EDT      |     2 |
| 2019-08-25 20:00:00.000 | EEST     |     1 |
| 2019-08-25 20:00:00.000 | N/A      |   201 |
| 2019-08-25 21:00:00.000 | N/A      |   140 |
| 2019-08-25 22:00:00.000 | N/A      |   117 |
| 2019-08-25 23:00:00.000 | EDT      |     1 |
| 2019-08-25 23:00:00.000 | N/A      |   105 |
+-------------------------+----------+-------+
(42 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Chrome        | 2019-08-25 00:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    90 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    62 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    89 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    59 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    45 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    31 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    28 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    30 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    32 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    50 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    69 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    85 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 16:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   174 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   220 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   232 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   230 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   201 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   140 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   117 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
+---------------+-------------------------+----------+-------+
(214 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    15 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(184 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | EDT      |    14 |
| Chrome        | N/A      |  2282 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | EDT      |    14 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | N/A      |   558 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    73 |
| Mobile Safari | CDT      |   247 |
| Mobile Safari | CEST     |    80 |
| Mobile Safari | EDT      |   395 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | N/A      |    22 |
| Mobile Safari | PDT      |   102 |
+---------------+----------+-------+
(25 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | EDT      |    13 |
| Chrome        | N/A      |  2177 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | EDT      |    12 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | N/A      |   543 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    71 |
| Mobile Safari | CDT      |   242 |
| Mobile Safari | CEST     |    77 |
| Mobile Safari | EDT      |   382 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    20 |
| Mobile Safari | N/A      |    21 |
| Mobile Safari | PDT      |    96 |
+---------------+----------+-------+
(25 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 23:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(165 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Chrome        | 2019-08-25 00:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
+---------------+-------------------------+----------+-------+
(156 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | EDT      |    14 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | EDT      |    14 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    73 |
| Mobile Safari | CDT      |   247 |
| Mobile Safari | CEST     |    80 |
| Mobile Safari | EDT      |   395 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | PDT      |   102 |
+---------------+----------+-------+
(22 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | EDT      |    13 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | EDT      |    12 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    71 |
| Mobile Safari | CDT      |   242 |
| Mobile Safari | CEST     |    77 |
| Mobile Safari | EDT      |   382 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    20 |
| Mobile Safari | PDT      |    96 |
+---------------+----------+-------+
(22 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(132 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
+---------------+-------------------------+----------+-------+
(126 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    73 |
| Mobile Safari | CDT      |   247 |
| Mobile Safari | CEST     |    80 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | PDT      |   102 |
+---------------+----------+-------+
(19 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    71 |
| Mobile Safari | CDT      |   242 |
| Mobile Safari | CEST     |    77 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    20 |
| Mobile Safari | PDT      |    96 |
+---------------+----------+-------+
(19 rows)

!ok
# Wed Jul 10 19:14:43 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    90 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    62 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    89 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    59 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    45 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    31 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    28 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    30 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    32 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    50 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    69 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    85 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   174 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   220 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   232 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   230 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   201 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   140 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   117 |
| Chrome        | 2019-08-25 23:00:00.000 | N/A      |   105 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    15 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(193 rows)

!ok
# Wed Jul 10 19:14:43 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    90 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    62 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    89 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    59 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    45 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    31 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    28 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    30 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    32 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    50 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    69 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    85 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   174 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   220 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   232 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   230 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   201 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   140 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   117 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
+---------------+-------------------------+----------+-------+
(184 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | N/A      |  2282 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | N/A      |   558 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    73 |
| Mobile Safari | CDT      |   247 |
| Mobile Safari | CEST     |    80 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | N/A      |    22 |
| Mobile Safari | PDT      |   102 |
+---------------+----------+-------+
(22 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | EEST     |     1 |
| Chrome Mobile | EEST     |     1 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Chrome        | CDT      |     1 |
| Chrome        | CEST     |     3 |
| Chrome        | N/A      |  2177 |
| Chrome        | PDT      |     5 |
| Chrome Mobile | CDT      |     4 |
| Chrome Mobile | CEST     |     3 |
| Chrome Mobile | MDT      |     2 |
| Chrome Mobile | MSK      |     3 |
| Chrome Mobile | N/A      |   543 |
| Chrome Mobile | PDT      |     3 |
| Mobile Safari | BST      |    71 |
| Mobile Safari | CDT      |   242 |
| Mobile Safari | CEST     |    77 |
| Mobile Safari | EEST     |    11 |
| Mobile Safari | MST      |    20 |
| Mobile Safari | N/A      |    21 |
| Mobile Safari | PDT      |    96 |
+---------------+----------+-------+
(22 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY 1,2;
+---------------+-------------------------+-------+
| Browser       | __time                  | count |
+---------------+-------------------------+-------+
| Chrome        | 2019-08-25 22:00:00.000 |   117 |
| Chrome Mobile | 2019-08-25 12:00:00.000 |    16 |
| Mobile Safari | 2019-08-25 12:00:00.000 |     9 |
| Chrome        | 2019-08-25 00:00:00.000 |    91 |
| Chrome        | 2019-08-25 01:00:00.000 |    64 |
| Chrome        | 2019-08-25 02:00:00.000 |    89 |
| Chrome        | 2019-08-25 03:00:00.000 |    60 |
| Chrome        | 2019-08-25 04:00:00.000 |    41 |
| Chrome        | 2019-08-25 05:00:00.000 |    45 |
| Chrome        | 2019-08-25 06:00:00.000 |    39 |
| Chrome        | 2019-08-25 07:00:00.000 |    32 |
| Chrome        | 2019-08-25 08:00:00.000 |    28 |
| Chrome        | 2019-08-25 09:00:00.000 |    30 |
| Chrome        | 2019-08-25 10:00:00.000 |    36 |
| Chrome        | 2019-08-25 11:00:00.000 |    33 |
| Chrome        | 2019-08-25 12:00:00.000 |    51 |
| Chrome        | 2019-08-25 13:00:00.000 |    71 |
| Chrome        | 2019-08-25 14:00:00.000 |    85 |
| Chrome        | 2019-08-25 15:00:00.000 |    80 |
| Chrome        | 2019-08-25 16:00:00.000 |   177 |
| Chrome        | 2019-08-25 17:00:00.000 |   223 |
| Chrome        | 2019-08-25 18:00:00.000 |   235 |
| Chrome        | 2019-08-25 19:00:00.000 |   232 |
| Chrome        | 2019-08-25 20:00:00.000 |   208 |
| Chrome        | 2019-08-25 21:00:00.000 |   140 |
| Chrome        | 2019-08-25 23:00:00.000 |   106 |
| Chrome Mobile | 2019-08-25 00:00:00.000 |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 |    16 |
| Chrome Mobile | 2019-08-25 02:00:00.000 |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 |    13 |
| Chrome Mobile | 2019-08-25 04:00:00.000 |     6 |
| Chrome Mobile | 2019-08-25 05:00:00.000 |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 |    16 |
| Chrome Mobile | 2019-08-25 07:00:00.000 |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 |    13 |
| Chrome Mobile | 2019-08-25 13:00:00.000 |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 |    27 |
| Chrome Mobile | 2019-08-25 15:00:00.000 |    20 |
| Chrome Mobile | 2019-08-25 16:00:00.000 |    35 |
| Chrome Mobile | 2019-08-25 17:00:00.000 |    75 |
| Chrome Mobile | 2019-08-25 18:00:00.000 |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 |    64 |
| Chrome Mobile | 2019-08-25 20:00:00.000 |    57 |
| Chrome Mobile | 2019-08-25 21:00:00.000 |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 |    20 |
| Chrome Mobile | 2019-08-25 23:00:00.000 |    17 |
| Mobile Safari | 2019-08-25 00:00:00.000 |    22 |
| Mobile Safari | 2019-08-25 01:00:00.000 |    17 |
| Mobile Safari | 2019-08-25 02:00:00.000 |    33 |
| Mobile Safari | 2019-08-25 03:00:00.000 |    18 |
| Mobile Safari | 2019-08-25 04:00:00.000 |    13 |
| Mobile Safari | 2019-08-25 05:00:00.000 |    24 |
| Mobile Safari | 2019-08-25 06:00:00.000 |     6 |
| Mobile Safari | 2019-08-25 07:00:00.000 |     7 |
| Mobile Safari | 2019-08-25 08:00:00.000 |     6 |
| Mobile Safari | 2019-08-25 09:00:00.000 |    10 |
| Mobile Safari | 2019-08-25 10:00:00.000 |     3 |
| Mobile Safari | 2019-08-25 11:00:00.000 |     9 |
| Mobile Safari | 2019-08-25 13:00:00.000 |    30 |
| Mobile Safari | 2019-08-25 14:00:00.000 |    43 |
| Mobile Safari | 2019-08-25 15:00:00.000 |    15 |
| Mobile Safari | 2019-08-25 16:00:00.000 |    94 |
| Mobile Safari | 2019-08-25 17:00:00.000 |   188 |
| Mobile Safari | 2019-08-25 18:00:00.000 |   128 |
| Mobile Safari | 2019-08-25 19:00:00.000 |   132 |
| Mobile Safari | 2019-08-25 20:00:00.000 |    91 |
| Mobile Safari | 2019-08-25 21:00:00.000 |    64 |
| Mobile Safari | 2019-08-25 22:00:00.000 |    55 |
| Mobile Safari | 2019-08-25 23:00:00.000 |    35 |
+---------------+-------------------------+-------+
(72 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    90 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    62 |
| Chrome        | 2019-08-25 01:00:00.000 | PDT      |     2 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    89 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    59 |
| Chrome        | 2019-08-25 03:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 04:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    45 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    31 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    28 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    30 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    32 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    50 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    69 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    85 |
| Chrome        | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 16:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   174 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   220 |
| Chrome        | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   232 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   230 |
| Chrome        | 2019-08-25 20:00:00.000 | CEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | EDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   201 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   140 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   117 |
| Chrome        | 2019-08-25 23:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 23:00:00.000 | N/A      |   105 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    14 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    19 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    26 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    18 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    61 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    58 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | EDT      |     3 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    50 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    34 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    20 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    15 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |     6 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |     9 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    14 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    12 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |    10 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     2 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 07:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CDT      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     5 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EEST     |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    44 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     5 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    23 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    42 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    12 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    76 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    21 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    12 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    35 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    54 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     4 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    25 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    14 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    27 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    13 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    21 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    13 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(226 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 10;
+----------+-------+
| timezone | count |
+----------+-------+
| EDT      |   120 |
| CDT      |    69 |
| BST      |    29 |
| PDT      |    26 |
| CEST     |    16 |
| MDT      |    12 |
| IST      |     3 |
| N/A      |     3 |
| MST      |     2 |
| AKDT     |     1 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00'))) AS "v1",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:01:00'))) AS "v2",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 16:01:00'))) AS "v3",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 17:01:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:02:00'))) AS "v4",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 16:01:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 16:02:00'))) AS "v5"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari'))
GROUP BY ();
+-----+----+----+----+----+----+
| v0  | v1 | v2 | v3 | v4 | v5 |
+-----+----+----+----+----+----+
| 188 | 94 |  2 |  2 |  3 |  1 |
+-----+----+----+----+----+----+
(1 row)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+---------------+-------+
| Browser       | count |
+---------------+-------+
| Mobile Safari |   282 |
+---------------+-------+
(1 row)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1M', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 17:00:00.000 | BST      |     1 |
| 2019-08-25 17:00:00.000 | EDT      |     1 |
| 2019-08-25 17:02:00.000 | BST      |     1 |
| 2019-08-25 17:04:00.000 | CDT      |     1 |
| 2019-08-25 17:04:00.000 | EDT      |     1 |
| 2019-08-25 17:05:00.000 | CDT      |     1 |
| 2019-08-25 17:09:00.000 | CDT      |     1 |
| 2019-08-25 17:09:00.000 | EDT      |     1 |
| 2019-08-25 17:13:00.000 | PDT      |     1 |
| 2019-08-25 17:16:00.000 | PDT      |     1 |
| 2019-08-25 17:17:00.000 | EDT      |     1 |
| 2019-08-25 17:18:00.000 | CEST     |     1 |
| 2019-08-25 17:19:00.000 | CEST     |     1 |
| 2019-08-25 17:20:00.000 | CDT      |     1 |
| 2019-08-25 17:20:00.000 | EDT      |     2 |
| 2019-08-25 17:21:00.000 | PDT      |     1 |
| 2019-08-25 17:26:00.000 | BST      |     1 |
| 2019-08-25 17:27:00.000 | PDT      |     1 |
| 2019-08-25 17:28:00.000 | CDT      |     1 |
| 2019-08-25 17:29:00.000 | CDT      |     1 |
| 2019-08-25 17:31:00.000 | EDT      |     2 |
| 2019-08-25 17:34:00.000 | BST      |     1 |
| 2019-08-25 17:35:00.000 | BST      |     1 |
| 2019-08-25 17:42:00.000 | CDT      |     2 |
| 2019-08-25 17:43:00.000 | EDT      |     1 |
| 2019-08-25 17:45:00.000 | CDT      |     1 |
| 2019-08-25 17:45:00.000 | EDT      |     3 |
| 2019-08-25 17:46:00.000 | BST      |     1 |
| 2019-08-25 17:46:00.000 | CEST     |     1 |
| 2019-08-25 17:48:00.000 | EDT      |     1 |
| 2019-08-25 17:50:00.000 | CDT      |     1 |
| 2019-08-25 17:51:00.000 | BST      |     1 |
| 2019-08-25 17:55:00.000 | EDT      |     1 |
| 2019-08-25 17:57:00.000 | CEST     |     1 |
| 2019-08-25 17:57:00.000 | EDT      |     1 |
| 2019-08-25 17:59:00.000 | BST      |     1 |
| 2019-08-25 17:59:00.000 | EDT      |     2 |
| 2019-08-25 17:01:00.000 | CDT      |     2 |
| 2019-08-25 17:01:00.000 | EDT      |     1 |
| 2019-08-25 17:05:00.000 | EDT      |     1 |
| 2019-08-25 17:06:00.000 | BST      |     1 |
| 2019-08-25 17:06:00.000 | CDT      |     1 |
| 2019-08-25 17:06:00.000 | EDT      |     1 |
| 2019-08-25 17:06:00.000 | IST      |     1 |
| 2019-08-25 17:07:00.000 | CDT      |     1 |
| 2019-08-25 17:07:00.000 | EDT      |     2 |
| 2019-08-25 17:08:00.000 | CDT      |     3 |
| 2019-08-25 17:08:00.000 | EDT      |     1 |
| 2019-08-25 17:08:00.000 | MDT      |     1 |
| 2019-08-25 17:10:00.000 | EDT      |     3 |
| 2019-08-25 17:12:00.000 | CDT      |     3 |
| 2019-08-25 17:13:00.000 | CDT      |     1 |
| 2019-08-25 17:13:00.000 | EDT      |     4 |
| 2019-08-25 17:14:00.000 | EDT      |     1 |
| 2019-08-25 17:14:00.000 | PDT      |     1 |
| 2019-08-25 17:15:00.000 | BST      |     1 |
| 2019-08-25 17:15:00.000 | PDT      |     1 |
| 2019-08-25 17:16:00.000 | BST      |     1 |
| 2019-08-25 17:16:00.000 | CDT      |     1 |
| 2019-08-25 17:17:00.000 | BST      |     1 |
| 2019-08-25 17:18:00.000 | BST      |     1 |
| 2019-08-25 17:18:00.000 | EDT      |     3 |
| 2019-08-25 17:18:00.000 | PDT      |     1 |
| 2019-08-25 17:21:00.000 | CDT      |     1 |
| 2019-08-25 17:21:00.000 | EDT      |     1 |
| 2019-08-25 17:22:00.000 | CDT      |     2 |
| 2019-08-25 17:22:00.000 | EDT      |     1 |
| 2019-08-25 17:22:00.000 | PDT      |     1 |
| 2019-08-25 17:23:00.000 | EDT      |     1 |
| 2019-08-25 17:23:00.000 | EEST     |     1 |
| 2019-08-25 17:23:00.000 | N/A      |     1 |
| 2019-08-25 17:24:00.000 | CDT      |     1 |
| 2019-08-25 17:24:00.000 | EDT      |     3 |
| 2019-08-25 17:24:00.000 | MDT      |     1 |
| 2019-08-25 17:24:00.000 | PDT      |     1 |
| 2019-08-25 17:25:00.000 | CDT      |     3 |
| 2019-08-25 17:25:00.000 | CEST     |     1 |
| 2019-08-25 17:25:00.000 | EDT      |     1 |
| 2019-08-25 17:25:00.000 | MST      |     1 |
| 2019-08-25 17:26:00.000 | CDT      |     1 |
| 2019-08-25 17:26:00.000 | EDT      |     1 |
| 2019-08-25 17:27:00.000 | CDT      |     2 |
| 2019-08-25 17:27:00.000 | EDT      |     1 |
| 2019-08-25 17:28:00.000 | EDT      |     1 |
| 2019-08-25 17:28:00.000 | PDT      |     1 |
| 2019-08-25 17:30:00.000 | EDT      |     1 |
| 2019-08-25 17:30:00.000 | PDT      |     1 |
| 2019-08-25 17:32:00.000 | EDT      |     1 |
| 2019-08-25 17:34:00.000 | CDT      |     1 |
| 2019-08-25 17:34:00.000 | EDT      |     2 |
| 2019-08-25 17:35:00.000 | EDT      |     2 |
| 2019-08-25 17:35:00.000 | MDT      |     1 |
| 2019-08-25 17:36:00.000 | EDT      |     1 |
| 2019-08-25 17:36:00.000 | PDT      |     2 |
| 2019-08-25 17:37:00.000 | BST      |     1 |
| 2019-08-25 17:37:00.000 | N/A      |     1 |
| 2019-08-25 17:37:00.000 | PDT      |     2 |
| 2019-08-25 17:38:00.000 | CDT      |     1 |
| 2019-08-25 17:39:00.000 | EDT      |     2 |
| 2019-08-25 17:39:00.000 | MDT      |     1 |
| 2019-08-25 17:39:00.000 | PDT      |     1 |
| 2019-08-25 17:41:00.000 | BST      |     3 |
| 2019-08-25 17:41:00.000 | CDT      |     1 |
| 2019-08-25 17:41:00.000 | CEST     |     1 |
| 2019-08-25 17:41:00.000 | EDT      |     4 |
| 2019-08-25 17:42:00.000 | EDT      |     2 |
| 2019-08-25 17:43:00.000 | CDT      |     2 |
| 2019-08-25 17:43:00.000 | PDT      |     2 |
| 2019-08-25 17:44:00.000 | BST      |     3 |
| 2019-08-25 17:44:00.000 | CEST     |     2 |
| 2019-08-25 17:44:00.000 | EDT      |     1 |
| 2019-08-25 17:45:00.000 | MST      |     1 |
| 2019-08-25 17:46:00.000 | CDT      |     1 |
| 2019-08-25 17:47:00.000 | BST      |     1 |
| 2019-08-25 17:47:00.000 | CDT      |     1 |
| 2019-08-25 17:47:00.000 | EDT      |     3 |
| 2019-08-25 17:49:00.000 | CDT      |     2 |
| 2019-08-25 17:49:00.000 | EDT      |     1 |
| 2019-08-25 17:50:00.000 | CEST     |     1 |
| 2019-08-25 17:50:00.000 | EDT      |     3 |
| 2019-08-25 17:50:00.000 | N/A      |     1 |
| 2019-08-25 17:50:00.000 | PDT      |     1 |
| 2019-08-25 17:52:00.000 | CEST     |     1 |
| 2019-08-25 17:52:00.000 | MDT      |     1 |
| 2019-08-25 17:53:00.000 | BST      |     2 |
| 2019-08-25 17:53:00.000 | CDT      |     1 |
| 2019-08-25 17:53:00.000 | EDT      |     2 |
| 2019-08-25 17:53:00.000 | PDT      |     1 |
| 2019-08-25 17:54:00.000 | EDT      |     2 |
| 2019-08-25 17:54:00.000 | PDT      |     1 |
| 2019-08-25 17:55:00.000 | CEST     |     2 |
| 2019-08-25 17:55:00.000 | MDT      |     1 |
| 2019-08-25 17:56:00.000 | EDT      |     3 |
| 2019-08-25 17:58:00.000 | EDT      |     2 |
+-------------------------+----------+-------+
(134 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1M', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 16:16:00.000 | CDT      |     1 |
| 2019-08-25 16:19:00.000 | EDT      |     1 |
| 2019-08-25 16:20:00.000 | EDT      |     2 |
| 2019-08-25 16:22:00.000 | EDT      |     1 |
| 2019-08-25 16:27:00.000 | CDT      |     1 |
| 2019-08-25 16:30:00.000 | CDT      |     1 |
| 2019-08-25 16:35:00.000 | CDT      |     1 |
| 2019-08-25 16:36:00.000 | EDT      |     1 |
| 2019-08-25 16:38:00.000 | EDT      |     1 |
| 2019-08-25 16:43:00.000 | EDT      |     1 |
| 2019-08-25 16:46:00.000 | EDT      |     2 |
| 2019-08-25 16:50:00.000 | CDT      |     1 |
| 2019-08-25 16:52:00.000 | MDT      |     1 |
| 2019-08-25 16:59:00.000 | CDT      |     2 |
| 2019-08-25 16:00:00.000 | CDT      |     1 |
| 2019-08-25 16:00:00.000 | EDT      |     1 |
| 2019-08-25 16:01:00.000 | CDT      |     1 |
| 2019-08-25 16:04:00.000 | CDT      |     1 |
| 2019-08-25 16:07:00.000 | CDT      |     2 |
| 2019-08-25 16:09:00.000 | EDT      |     1 |
| 2019-08-25 16:11:00.000 | EDT      |     2 |
| 2019-08-25 16:12:00.000 | EDT      |     1 |
| 2019-08-25 16:13:00.000 | EDT      |     2 |
| 2019-08-25 16:13:00.000 | MDT      |     2 |
| 2019-08-25 16:14:00.000 | CDT      |     1 |
| 2019-08-25 16:16:00.000 | EDT      |     1 |
| 2019-08-25 16:18:00.000 | CDT      |     1 |
| 2019-08-25 16:20:00.000 | CDT      |     1 |
| 2019-08-25 16:21:00.000 | CDT      |     1 |
| 2019-08-25 16:21:00.000 | EDT      |     1 |
| 2019-08-25 16:24:00.000 | EDT      |     2 |
| 2019-08-25 16:27:00.000 | EDT      |     1 |
| 2019-08-25 16:29:00.000 | CDT      |     1 |
| 2019-08-25 16:29:00.000 | EDT      |     1 |
| 2019-08-25 16:31:00.000 | CDT      |     2 |
| 2019-08-25 16:31:00.000 | EDT      |     1 |
| 2019-08-25 16:33:00.000 | CDT      |     1 |
| 2019-08-25 16:33:00.000 | EDT      |     1 |
| 2019-08-25 16:34:00.000 | EDT      |     2 |
| 2019-08-25 16:35:00.000 | BST      |     1 |
| 2019-08-25 16:35:00.000 | EDT      |     2 |
| 2019-08-25 16:35:00.000 | MDT      |     1 |
| 2019-08-25 16:37:00.000 | EDT      |     1 |
| 2019-08-25 16:38:00.000 | CDT      |     1 |
| 2019-08-25 16:38:00.000 | CEST     |     1 |
| 2019-08-25 16:39:00.000 | BST      |     1 |
| 2019-08-25 16:39:00.000 | EDT      |     1 |
| 2019-08-25 16:40:00.000 | PDT      |     1 |
| 2019-08-25 16:41:00.000 | EDT      |     2 |
| 2019-08-25 16:41:00.000 | IST      |     1 |
| 2019-08-25 16:41:00.000 | PDT      |     2 |
| 2019-08-25 16:42:00.000 | CDT      |     1 |
| 2019-08-25 16:42:00.000 | EDT      |     1 |
| 2019-08-25 16:43:00.000 | PDT      |     1 |
| 2019-08-25 16:44:00.000 | CDT      |     1 |
| 2019-08-25 16:44:00.000 | EDT      |     1 |
| 2019-08-25 16:44:00.000 | IST      |     1 |
| 2019-08-25 16:45:00.000 | BST      |     2 |
| 2019-08-25 16:45:00.000 | EDT      |     1 |
| 2019-08-25 16:46:00.000 | CDT      |     1 |
| 2019-08-25 16:46:00.000 | CEST     |     1 |
| 2019-08-25 16:47:00.000 | CEST     |     1 |
| 2019-08-25 16:48:00.000 | EDT      |     2 |
| 2019-08-25 16:49:00.000 | EDT      |     1 |
| 2019-08-25 16:51:00.000 | EDT      |     1 |
| 2019-08-25 16:52:00.000 | CDT      |     1 |
| 2019-08-25 16:52:00.000 | EDT      |     1 |
| 2019-08-25 16:52:00.000 | PDT      |     1 |
| 2019-08-25 16:53:00.000 | BST      |     2 |
| 2019-08-25 16:53:00.000 | EDT      |     1 |
| 2019-08-25 16:53:00.000 | MDT      |     1 |
| 2019-08-25 16:54:00.000 | CDT      |     1 |
| 2019-08-25 16:54:00.000 | EDT      |     1 |
| 2019-08-25 16:56:00.000 | CDT      |     1 |
| 2019-08-25 16:57:00.000 | EDT      |     1 |
| 2019-08-25 16:58:00.000 | EDT      |     1 |
| 2019-08-25 16:59:00.000 | CEST     |     1 |
| 2019-08-25 16:59:00.000 | MDT      |     1 |
+-------------------------+----------+-------+
(78 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1;
+----------+-------+
| timezone | count |
+----------+-------+
| N/A      |     3 |
| BST      |    23 |
| CDT      |    42 |
| CEST     |    12 |
| EDT      |    76 |
| EEST     |     1 |
| IST      |     1 |
| MDT      |     6 |
| MST      |     2 |
| PDT      |    21 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1;
+----------+-------+
| timezone | count |
+----------+-------+
| BST      |     6 |
| CDT      |    27 |
| CEST     |     4 |
| EDT      |    44 |
| IST      |     2 |
| MDT      |     6 |
| PDT      |     5 |
+----------+-------+
(7 rows)

!ok
