#started Wed Jul 10 19:12:59 IST 2024
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
# Wed Jul 10 19:13:46 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:34.290 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:13:46 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:34.290 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:13:46 IST 2024
SELECT
(COUNT(*)) AS "__VALUE__"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY ();
+-----------+
| __VALUE__ |
+-----------+
|      4681 |
+-----------+
(1 row)

!ok
# Wed Jul 10 19:14:06 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 01:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 01:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 02:00:00'))) AS "v1"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 02:00:00')
GROUP BY ();
+-----+-----+
| v0  | v1  |
+-----+-----+
| 127 | 135 |
+-----+-----+
(1 row)

!ok
# Wed Jul 10 19:14:06 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 02:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 02:00:00.000 |   171 |
| 2019-08-25 03:00:00.000 |   133 |
| 2019-08-25 04:00:00.000 |   118 |
| 2019-08-25 05:00:00.000 |    80 |
| 2019-08-25 06:00:00.000 |    68 |
| 2019-08-25 07:00:00.000 |    43 |
| 2019-08-25 08:00:00.000 |    66 |
| 2019-08-25 09:00:00.000 |    53 |
| 2019-08-25 10:00:00.000 |    70 |
| 2019-08-25 11:00:00.000 |    74 |
| 2019-08-25 12:00:00.000 |    77 |
| 2019-08-25 13:00:00.000 |   127 |
| 2019-08-25 14:00:00.000 |   193 |
| 2019-08-25 15:00:00.000 |   124 |
| 2019-08-25 16:00:00.000 |   360 |
| 2019-08-25 17:00:00.000 |   589 |
| 2019-08-25 18:00:00.000 |   472 |
| 2019-08-25 19:00:00.000 |   469 |
| 2019-08-25 20:00:00.000 |   422 |
| 2019-08-25 21:00:00.000 |   287 |
| 2019-08-25 22:00:00.000 |   226 |
| 2019-08-25 23:00:00.000 |   197 |
+-------------------------+-------+
(22 rows)

!ok
# Wed Jul 10 19:14:18 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 10;
+----------+-------+
| timezone | count |
+----------+-------+
| N/A      |  3135 |
| EDT      |   599 |
| CDT      |   361 |
| PDT      |   168 |
| CEST     |   125 |
| BST      |    96 |
| MDT      |    46 |
| MST      |    33 |
| MSK      |    24 |
| EEST     |    14 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:18 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 00:00:00.000 | CDT      |     9 |
| 2019-08-25 00:00:00.000 | EDT      |     8 |
| 2019-08-25 00:00:00.000 | MDT      |     2 |
| 2019-08-25 00:00:00.000 | MSK      |     1 |
| 2019-08-25 00:00:00.000 | N/A      |    97 |
| 2019-08-25 00:00:00.000 | PDT      |     6 |
| 2019-08-25 01:00:00.000 | BST      |     2 |
| 2019-08-25 01:00:00.000 | CDT      |    16 |
| 2019-08-25 01:00:00.000 | EDT      |    18 |
| 2019-08-25 01:00:00.000 | MDT      |     1 |
| 2019-08-25 01:00:00.000 | N/A      |    93 |
| 2019-08-25 01:00:00.000 | PDT      |     1 |
| 2019-08-25 02:00:00.000 | CDT      |    14 |
| 2019-08-25 02:00:00.000 | CEST     |     1 |
| 2019-08-25 02:00:00.000 | EDT      |    25 |
| 2019-08-25 02:00:00.000 | MDT      |     4 |
| 2019-08-25 02:00:00.000 | MST      |     1 |
| 2019-08-25 02:00:00.000 | N/A      |   120 |
| 2019-08-25 02:00:00.000 | PDT      |     5 |
| 2019-08-25 03:00:00.000 | CDT      |     8 |
| 2019-08-25 03:00:00.000 | EDT      |    10 |
| 2019-08-25 03:00:00.000 | MST      |     3 |
| 2019-08-25 03:00:00.000 | N/A      |   104 |
| 2019-08-25 03:00:00.000 | PDT      |     7 |
| 2019-08-25 04:00:00.000 | CDT      |     4 |
| 2019-08-25 04:00:00.000 | EDT      |    13 |
| 2019-08-25 04:00:00.000 | N/A      |    93 |
| 2019-08-25 04:00:00.000 | PDT      |     5 |
| 2019-08-25 05:00:00.000 | CDT      |     4 |
| 2019-08-25 05:00:00.000 | EDT      |     5 |
| 2019-08-25 05:00:00.000 | MDT      |     2 |
| 2019-08-25 05:00:00.000 | MST      |     3 |
| 2019-08-25 05:00:00.000 | N/A      |    58 |
| 2019-08-25 05:00:00.000 | PDT      |     5 |
| 2019-08-25 06:00:00.000 | CDT      |     4 |
| 2019-08-25 06:00:00.000 | CEST     |     2 |
| 2019-08-25 06:00:00.000 | EDT      |     4 |
| 2019-08-25 06:00:00.000 | EEST     |     1 |
| 2019-08-25 06:00:00.000 | MDT      |     1 |
| 2019-08-25 06:00:00.000 | MSK      |     1 |
| 2019-08-25 06:00:00.000 | N/A      |    50 |
| 2019-08-25 06:00:00.000 | PDT      |     1 |
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 07:00:00.000 | CEST     |     1 |
| 2019-08-25 07:00:00.000 | MSK      |     1 |
| 2019-08-25 07:00:00.000 | N/A      |    35 |
| 2019-08-25 08:00:00.000 | BST      |     2 |
| 2019-08-25 08:00:00.000 | CEST     |     2 |
| 2019-08-25 08:00:00.000 | EDT      |     1 |
| 2019-08-25 08:00:00.000 | EEST     |     1 |
| 2019-08-25 08:00:00.000 | MDT      |     1 |
| 2019-08-25 08:00:00.000 | MSK      |     3 |
| 2019-08-25 08:00:00.000 | N/A      |    53 |
| 2019-08-25 09:00:00.000 | BST      |     1 |
| 2019-08-25 09:00:00.000 | CEST     |     7 |
| 2019-08-25 09:00:00.000 | EDT      |     1 |
| 2019-08-25 09:00:00.000 | MSK      |     1 |
| 2019-08-25 09:00:00.000 | N/A      |    42 |
| 2019-08-25 09:00:00.000 | PDT      |     1 |
| 2019-08-25 10:00:00.000 | BST      |     3 |
| 2019-08-25 10:00:00.000 | CEST     |     2 |
| 2019-08-25 10:00:00.000 | EDT      |     2 |
| 2019-08-25 10:00:00.000 | MSK      |     1 |
| 2019-08-25 10:00:00.000 | N/A      |    60 |
| 2019-08-25 10:00:00.000 | PDT      |     1 |
| 2019-08-25 11:00:00.000 | BST      |     2 |
| 2019-08-25 11:00:00.000 | CEST     |     6 |
| 2019-08-25 11:00:00.000 | EEST     |     1 |
| 2019-08-25 11:00:00.000 | MSK      |     2 |
| 2019-08-25 11:00:00.000 | N/A      |    63 |
| 2019-08-25 12:00:00.000 | CEST     |     4 |
| 2019-08-25 12:00:00.000 | EDT      |     6 |
| 2019-08-25 12:00:00.000 | EEST     |     1 |
| 2019-08-25 12:00:00.000 | MSK      |     1 |
| 2019-08-25 12:00:00.000 | N/A      |    63 |
| 2019-08-25 13:00:00.000 | BST      |     3 |
| 2019-08-25 13:00:00.000 | CDT      |     3 |
| 2019-08-25 13:00:00.000 | CEST     |     8 |
| 2019-08-25 13:00:00.000 | EDT      |    17 |
| 2019-08-25 13:00:00.000 | EEST     |     1 |
| 2019-08-25 13:00:00.000 | MDT      |     1 |
| 2019-08-25 13:00:00.000 | MSK      |     2 |
| 2019-08-25 13:00:00.000 | N/A      |    88 |
| 2019-08-25 14:00:00.000 | BST      |     4 |
| 2019-08-25 14:00:00.000 | CDT      |    12 |
| 2019-08-25 14:00:00.000 | CEST     |     9 |
| 2019-08-25 14:00:00.000 | EDT      |    15 |
| 2019-08-25 14:00:00.000 | EEST     |     1 |
| 2019-08-25 14:00:00.000 | MDT      |     1 |
| 2019-08-25 14:00:00.000 | N/A      |   141 |
| 2019-08-25 14:00:00.000 | PDT      |     2 |
| 2019-08-25 15:00:00.000 | CDT      |     5 |
| 2019-08-25 15:00:00.000 | EDT      |    14 |
| 2019-08-25 15:00:00.000 | MDT      |     2 |
| 2019-08-25 15:00:00.000 | MSK      |     2 |
| 2019-08-25 15:00:00.000 | MST      |     1 |
| 2019-08-25 15:00:00.000 | N/A      |    95 |
| 2019-08-25 15:00:00.000 | PDT      |     1 |
| 2019-08-25 16:00:00.000 | BST      |     6 |
| 2019-08-25 16:00:00.000 | CDT      |    40 |
| 2019-08-25 16:00:00.000 | CEST     |     2 |
| 2019-08-25 16:00:00.000 | EDT      |    81 |
| 2019-08-25 16:00:00.000 | MDT      |     5 |
| 2019-08-25 16:00:00.000 | MST      |     4 |
| 2019-08-25 16:00:00.000 | N/A      |   211 |
| 2019-08-25 16:00:00.000 | PDT      |     9 |
| 2019-08-25 17:00:00.000 | BST      |    21 |
| 2019-08-25 17:00:00.000 | CDT      |    59 |
| 2019-08-25 17:00:00.000 | CEST     |    19 |
| 2019-08-25 17:00:00.000 | EDT      |   111 |
| 2019-08-25 17:00:00.000 | EEST     |     1 |
| 2019-08-25 17:00:00.000 | MDT      |     3 |
| 2019-08-25 17:00:00.000 | MST      |     7 |
| 2019-08-25 17:00:00.000 | N/A      |   342 |
| 2019-08-25 17:00:00.000 | PDT      |    25 |
| 2019-08-25 18:00:00.000 | BST      |    15 |
| 2019-08-25 18:00:00.000 | CDT      |    51 |
| 2019-08-25 18:00:00.000 | CEST     |    16 |
| 2019-08-25 18:00:00.000 | EDT      |    66 |
| 2019-08-25 18:00:00.000 | EEST     |     1 |
| 2019-08-25 18:00:00.000 | MDT      |     4 |
| 2019-08-25 18:00:00.000 | MSK      |     1 |
| 2019-08-25 18:00:00.000 | MST      |     3 |
| 2019-08-25 18:00:00.000 | N/A      |   292 |
| 2019-08-25 18:00:00.000 | PDT      |    17 |
| 2019-08-25 19:00:00.000 | BST      |    13 |
| 2019-08-25 19:00:00.000 | CDT      |    31 |
| 2019-08-25 19:00:00.000 | CEST     |    15 |
| 2019-08-25 19:00:00.000 | EDT      |    63 |
| 2019-08-25 19:00:00.000 | EEST     |     3 |
| 2019-08-25 19:00:00.000 | MDT      |     2 |
| 2019-08-25 19:00:00.000 | MSK      |     2 |
| 2019-08-25 19:00:00.000 | MST      |     1 |
| 2019-08-25 19:00:00.000 | N/A      |   307 |
| 2019-08-25 19:00:00.000 | PDT      |    23 |
| 2019-08-25 20:00:00.000 | BST      |    11 |
| 2019-08-25 20:00:00.000 | CDT      |    38 |
| 2019-08-25 20:00:00.000 | CEST     |    19 |
| 2019-08-25 20:00:00.000 | EDT      |    55 |
| 2019-08-25 20:00:00.000 | EEST     |     3 |
| 2019-08-25 20:00:00.000 | MDT      |     4 |
| 2019-08-25 20:00:00.000 | MSK      |     3 |
| 2019-08-25 20:00:00.000 | MST      |     1 |
| 2019-08-25 20:00:00.000 | N/A      |   258 |
| 2019-08-25 20:00:00.000 | PDT      |    25 |
| 2019-08-25 21:00:00.000 | BST      |     2 |
| 2019-08-25 21:00:00.000 | CDT      |    24 |
| 2019-08-25 21:00:00.000 | CEST     |     7 |
| 2019-08-25 21:00:00.000 | EDT      |    39 |
| 2019-08-25 21:00:00.000 | MDT      |     6 |
| 2019-08-25 21:00:00.000 | MSK      |     2 |
| 2019-08-25 21:00:00.000 | MST      |     3 |
| 2019-08-25 21:00:00.000 | N/A      |   193 |
| 2019-08-25 21:00:00.000 | PDT      |    10 |
| 2019-08-25 22:00:00.000 | BST      |     6 |
| 2019-08-25 22:00:00.000 | CDT      |    25 |
| 2019-08-25 22:00:00.000 | CEST     |     2 |
| 2019-08-25 22:00:00.000 | EDT      |    24 |
| 2019-08-25 22:00:00.000 | MDT      |     6 |
| 2019-08-25 22:00:00.000 | MSK      |     1 |
| 2019-08-25 22:00:00.000 | MST      |     3 |
| 2019-08-25 22:00:00.000 | N/A      |   141 |
| 2019-08-25 22:00:00.000 | PDT      |    11 |
| 2019-08-25 23:00:00.000 | BST      |     5 |
| 2019-08-25 23:00:00.000 | CDT      |    13 |
| 2019-08-25 23:00:00.000 | CEST     |     3 |
| 2019-08-25 23:00:00.000 | EDT      |    21 |
| 2019-08-25 23:00:00.000 | MDT      |     1 |
| 2019-08-25 23:00:00.000 | MST      |     3 |
| 2019-08-25 23:00:00.000 | N/A      |   136 |
| 2019-08-25 23:00:00.000 | PDT      |    13 |
+-------------------------+----------+-------+
(171 rows)

!ok
# Wed Jul 10 19:14:18 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1;
+----------+-------+
| timezone | count |
+----------+-------+
| BST      |    96 |
| CDT      |   361 |
| CEST     |   125 |
| EDT      |   599 |
| EEST     |    14 |
| MDT      |    46 |
| MSK      |    24 |
| MST      |    33 |
| N/A      |  3135 |
| PDT      |   168 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:22 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------------+-------+
| Browser               | count |
+-----------------------+-------+
| Chrome                |  2395 |
| Mobile Safari         |  1129 |
| Chrome Mobile         |   597 |
| Safari                |   376 |
| Firefox               |    76 |
| Yandex.Browser        |    38 |
| Opera                 |    28 |
| Mozilla               |    11 |
| Silk                  |    11 |
| IE                    |     8 |
| Yandex.Browser mobile |     4 |
| Mobile Firefox        |     3 |
| Puffin                |     2 |
| Android browser       |     1 |
| Chromium              |     1 |
| PS4 Web browser       |     1 |
+-----------------------+-------+
(16 rows)

!ok
# Wed Jul 10 19:14:22 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Chrome'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 00:00:00.000 | N/A      |    86 |
| 2019-08-25 01:00:00.000 | N/A      |    84 |
| 2019-08-25 02:00:00.000 | EDT      |     1 |
| 2019-08-25 02:00:00.000 | N/A      |    93 |
| 2019-08-25 03:00:00.000 | N/A      |    92 |
| 2019-08-25 04:00:00.000 | N/A      |    79 |
| 2019-08-25 05:00:00.000 | N/A      |    39 |
| 2019-08-25 06:00:00.000 | N/A      |    38 |
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 07:00:00.000 | N/A      |    21 |
| 2019-08-25 08:00:00.000 | N/A      |    34 |
| 2019-08-25 09:00:00.000 | N/A      |    26 |
| 2019-08-25 10:00:00.000 | N/A      |    40 |
| 2019-08-25 11:00:00.000 | N/A      |    43 |
| 2019-08-25 12:00:00.000 | EEST     |     1 |
| 2019-08-25 12:00:00.000 | N/A      |    36 |
| 2019-08-25 13:00:00.000 | EDT      |     3 |
| 2019-08-25 13:00:00.000 | N/A      |    64 |
| 2019-08-25 14:00:00.000 | N/A      |    98 |
| 2019-08-25 15:00:00.000 | N/A      |    71 |
| 2019-08-25 16:00:00.000 | BST      |     1 |
| 2019-08-25 16:00:00.000 | N/A      |   167 |
| 2019-08-25 17:00:00.000 | EDT      |     1 |
| 2019-08-25 17:00:00.000 | N/A      |   262 |
| 2019-08-25 18:00:00.000 | EDT      |     1 |
| 2019-08-25 18:00:00.000 | N/A      |   228 |
| 2019-08-25 19:00:00.000 | CDT      |     2 |
| 2019-08-25 19:00:00.000 | N/A      |   212 |
| 2019-08-25 20:00:00.000 | N/A      |   192 |
| 2019-08-25 20:00:00.000 | PDT      |     1 |
| 2019-08-25 21:00:00.000 | EDT      |     1 |
| 2019-08-25 21:00:00.000 | N/A      |   146 |
| 2019-08-25 22:00:00.000 | CDT      |     1 |
| 2019-08-25 22:00:00.000 | N/A      |   114 |
| 2019-08-25 23:00:00.000 | N/A      |   106 |
+-------------------------+----------+-------+
(35 rows)

!ok
# Wed Jul 10 19:14:23 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome Mobile','Safari'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    22 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     5 |
| Safari        | 2019-08-25 00:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 01:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 01:00:00.000 | CDT      |     4 |
| Safari        | 2019-08-25 01:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 02:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 03:00:00.000 | CDT      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | MST      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | PDT      |     4 |
| Safari        | 2019-08-25 04:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | MST      |     3 |
| Safari        | 2019-08-25 05:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 08:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 08:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 09:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 10:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 12:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 12:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 13:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 13:00:00.000 | EDT      |     9 |
| Safari        | 2019-08-25 14:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 14:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 14:00:00.000 | EDT      |     4 |
| Safari        | 2019-08-25 14:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 15:00:00.000 | EDT      |     5 |
| Safari        | 2019-08-25 15:00:00.000 | N/A      |     2 |
| Safari        | 2019-08-25 16:00:00.000 | CDT      |     8 |
| Safari        | 2019-08-25 16:00:00.000 | EDT      |    26 |
| Safari        | 2019-08-25 16:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 16:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 17:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 17:00:00.000 | CDT      |    18 |
| Safari        | 2019-08-25 17:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 17:00:00.000 | EDT      |    26 |
| Safari        | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 18:00:00.000 | BST      |     2 |
| Safari        | 2019-08-25 18:00:00.000 | CDT      |    15 |
| Safari        | 2019-08-25 18:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 18:00:00.000 | EDT      |    13 |
| Safari        | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 18:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 19:00:00.000 | BST      |     6 |
| Safari        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Safari        | 2019-08-25 19:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 19:00:00.000 | EDT      |    14 |
| Safari        | 2019-08-25 19:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 19:00:00.000 | PDT      |     4 |
| Safari        | 2019-08-25 20:00:00.000 | CDT      |     7 |
| Safari        | 2019-08-25 20:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 20:00:00.000 | EDT      |    12 |
| Safari        | 2019-08-25 20:00:00.000 | MSK      |     1 |
| Safari        | 2019-08-25 20:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 21:00:00.000 | CDT      |     6 |
| Safari        | 2019-08-25 21:00:00.000 | EDT      |     8 |
| Safari        | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Safari        | 2019-08-25 21:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 21:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 22:00:00.000 | CDT      |     8 |
| Safari        | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 22:00:00.000 | EDT      |     8 |
| Safari        | 2019-08-25 22:00:00.000 | N/A      |     2 |
| Safari        | 2019-08-25 22:00:00.000 | PDT      |     5 |
| Safari        | 2019-08-25 23:00:00.000 | CDT      |     4 |
| Safari        | 2019-08-25 23:00:00.000 | EDT      |    11 |
| Safari        | 2019-08-25 23:00:00.000 | PDT      |     8 |
+---------------+-------------------------+----------+-------+
(273 rows)

!ok
# Wed Jul 10 19:14:23 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EDT      |     7 |
| Chrome        | EEST     |     1 |
| Chrome        | N/A      |  2371 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EDT      |     7 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | N/A      |   561 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    81 |
| Mobile Safari | CDT      |   265 |
| Mobile Safari | CEST     |    94 |
| Mobile Safari | EDT      |   416 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    24 |
| Mobile Safari | N/A      |    23 |
| Mobile Safari | PDT      |   115 |
| Safari        | BST      |    11 |
| Safari        | CDT      |    84 |
| Safari        | CEST     |    26 |
| Safari        | EDT      |   164 |
| Safari        | EEST     |     3 |
| Safari        | MDT      |     6 |
| Safari        | MSK      |     3 |
| Safari        | MST      |     8 |
| Safari        | N/A      |     4 |
| Safari        | PDT      |    46 |
+---------------+----------+-------+
(34 rows)

!ok
# Wed Jul 10 19:14:25 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Chrome Mobile','Mobile Safari','Safari'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    86 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    84 |
| Chrome        | 2019-08-25 02:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    93 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    92 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    38 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    21 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    34 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    26 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    40 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    43 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    64 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    98 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    71 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   167 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   262 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   228 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   212 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   192 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   146 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   114 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 00:00:00.000 | CDT      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 00:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 01:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 01:00:00.000 | CDT      |     4 |
| Safari        | 2019-08-25 01:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 01:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 02:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 02:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 02:00:00.000 | PDT      |     1 |
| Safari        | 2019-08-25 03:00:00.000 | CDT      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | MST      |     2 |
| Safari        | 2019-08-25 03:00:00.000 | PDT      |     4 |
| Safari        | 2019-08-25 04:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Safari        | 2019-08-25 04:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 05:00:00.000 | MST      |     3 |
| Safari        | 2019-08-25 05:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 08:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 08:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 09:00:00.000 | EDT      |     1 |
| Safari        | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 10:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 12:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 12:00:00.000 | EDT      |     2 |
| Safari        | 2019-08-25 13:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 13:00:00.000 | EDT      |     9 |
| Safari        | 2019-08-25 14:00:00.000 | CDT      |     3 |
| Safari        | 2019-08-25 14:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 14:00:00.000 | EDT      |     4 |
| Safari        | 2019-08-25 14:00:00.000 | PDT      |     2 |
| Safari        | 2019-08-25 15:00:00.000 | EDT      |     5 |
| Safari        | 2019-08-25 15:00:00.000 | N/A      |     2 |
| Safari        | 2019-08-25 16:00:00.000 | CDT      |     8 |
| Safari        | 2019-08-25 16:00:00.000 | EDT      |    26 |
| Safari        | 2019-08-25 16:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 16:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 17:00:00.000 | BST      |     1 |
| Safari        | 2019-08-25 17:00:00.000 | CDT      |    18 |
| Safari        | 2019-08-25 17:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 17:00:00.000 | EDT      |    26 |
| Safari        | 2019-08-25 17:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 17:00:00.000 | MDT      |     1 |
| Safari        | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 18:00:00.000 | BST      |     2 |
| Safari        | 2019-08-25 18:00:00.000 | CDT      |    15 |
| Safari        | 2019-08-25 18:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 18:00:00.000 | EDT      |    13 |
| Safari        | 2019-08-25 18:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 18:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 19:00:00.000 | BST      |     6 |
| Safari        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Safari        | 2019-08-25 19:00:00.000 | CEST     |     4 |
| Safari        | 2019-08-25 19:00:00.000 | EDT      |    14 |
| Safari        | 2019-08-25 19:00:00.000 | EEST     |     1 |
| Safari        | 2019-08-25 19:00:00.000 | PDT      |     4 |
| Safari        | 2019-08-25 20:00:00.000 | CDT      |     7 |
| Safari        | 2019-08-25 20:00:00.000 | CEST     |     3 |
| Safari        | 2019-08-25 20:00:00.000 | EDT      |    12 |
| Safari        | 2019-08-25 20:00:00.000 | MSK      |     1 |
| Safari        | 2019-08-25 20:00:00.000 | PDT      |     6 |
| Safari        | 2019-08-25 21:00:00.000 | CDT      |     6 |
| Safari        | 2019-08-25 21:00:00.000 | EDT      |     8 |
| Safari        | 2019-08-25 21:00:00.000 | MSK      |     2 |
| Safari        | 2019-08-25 21:00:00.000 | MST      |     1 |
| Safari        | 2019-08-25 21:00:00.000 | PDT      |     3 |
| Safari        | 2019-08-25 22:00:00.000 | CDT      |     8 |
| Safari        | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Safari        | 2019-08-25 22:00:00.000 | EDT      |     8 |
| Safari        | 2019-08-25 22:00:00.000 | N/A      |     2 |
| Safari        | 2019-08-25 22:00:00.000 | PDT      |     5 |
+---------------+-------------------------+----------+-------+
(296 rows)

!ok
# Wed Jul 10 19:14:26 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Chrome Mobile','Mobile Safari','Safari'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EDT      |     7 |
| Chrome        | EEST     |     1 |
| Chrome        | N/A      |  2265 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EDT      |     7 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | N/A      |   539 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    76 |
| Mobile Safari | CDT      |   256 |
| Mobile Safari | CEST     |    91 |
| Mobile Safari | EDT      |   406 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | N/A      |    23 |
| Mobile Safari | PDT      |   110 |
| Safari        | BST      |    11 |
| Safari        | CDT      |    80 |
| Safari        | CEST     |    26 |
| Safari        | EDT      |   153 |
| Safari        | EEST     |     3 |
| Safari        | MDT      |     6 |
| Safari        | MSK      |     3 |
| Safari        | MST      |     8 |
| Safari        | N/A      |     4 |
| Safari        | PDT      |    38 |
+---------------+----------+-------+
(34 rows)

!ok
# Wed Jul 10 19:14:32 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "r"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "r" DESC
LIMIT 101;
+-----------------------+------+
| Browser               | r    |
+-----------------------+------+
| Chrome                | 2395 |
| Mobile Safari         | 1129 |
| Chrome Mobile         |  597 |
| Safari                |  376 |
| Firefox               |   76 |
| Yandex.Browser        |   38 |
| Opera                 |   28 |
| Mozilla               |   11 |
| Silk                  |   11 |
| IE                    |    8 |
| Yandex.Browser mobile |    4 |
| Mobile Firefox        |    3 |
| Puffin                |    2 |
| Android browser       |    1 |
| Chromium              |    1 |
| PS4 Web browser       |    1 |
+-----------------------+------+
(16 rows)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 10;
+----------+-------+
| timezone | count |
+----------+-------+
| N/A      |  2955 |
| EDT      |   430 |
| CDT      |   277 |
| PDT      |   122 |
| CEST     |    98 |
| BST      |    85 |
| MDT      |    40 |
| MST      |    24 |
| MSK      |    21 |
| EEST     |    11 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00'))) AS "v1",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 01:00:00'))) AS "v2",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v3",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 01:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 02:00:00'))) AS "v4",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 01:00:00'))) AS "v5"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY ();
+------+------+-----+----+-----+-----+
| v0   | v1   | v2  | v3 | v4  | v5  |
+------+------+-----+----+-----+-----+
| 4121 | 3955 | 115 |  0 | 121 | 115 |
+------+------+-----+----+-----+-----+
(1 row)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+---------------+-------+
| Browser       | count |
+---------------+-------+
| Chrome        |  2395 |
| Mobile Safari |  1129 |
| Chrome Mobile |   597 |
+---------------+-------+
(3 rows)

!ok
# Wed Jul 10 19:14:35 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 00:00:00.000 | CDT      |     8 |
| 2019-08-25 00:00:00.000 | EDT      |     6 |
| 2019-08-25 00:00:00.000 | MDT      |     1 |
| 2019-08-25 00:00:00.000 | MSK      |     1 |
| 2019-08-25 00:00:00.000 | N/A      |    91 |
| 2019-08-25 00:00:00.000 | PDT      |     4 |
| 2019-08-25 01:00:00.000 | BST      |     1 |
| 2019-08-25 01:00:00.000 | CDT      |    12 |
| 2019-08-25 01:00:00.000 | EDT      |    12 |
| 2019-08-25 01:00:00.000 | N/A      |    92 |
| 2019-08-25 01:00:00.000 | PDT      |     1 |
| 2019-08-25 02:00:00.000 | CDT      |    11 |
| 2019-08-25 02:00:00.000 | CEST     |     1 |
| 2019-08-25 02:00:00.000 | EDT      |    19 |
| 2019-08-25 02:00:00.000 | MDT      |     3 |
| 2019-08-25 02:00:00.000 | N/A      |   114 |
| 2019-08-25 02:00:00.000 | PDT      |     4 |
| 2019-08-25 03:00:00.000 | CDT      |     6 |
| 2019-08-25 03:00:00.000 | EDT      |     8 |
| 2019-08-25 03:00:00.000 | MST      |     1 |
| 2019-08-25 03:00:00.000 | N/A      |   102 |
| 2019-08-25 03:00:00.000 | PDT      |     3 |
| 2019-08-25 04:00:00.000 | CDT      |     1 |
| 2019-08-25 04:00:00.000 | EDT      |     7 |
| 2019-08-25 04:00:00.000 | N/A      |    89 |
| 2019-08-25 04:00:00.000 | PDT      |     3 |
| 2019-08-25 05:00:00.000 | CDT      |     4 |
| 2019-08-25 05:00:00.000 | EDT      |     5 |
| 2019-08-25 05:00:00.000 | MDT      |     1 |
| 2019-08-25 05:00:00.000 | N/A      |    52 |
| 2019-08-25 05:00:00.000 | PDT      |     2 |
| 2019-08-25 06:00:00.000 | CDT      |     4 |
| 2019-08-25 06:00:00.000 | CEST     |     2 |
| 2019-08-25 06:00:00.000 | EDT      |     4 |
| 2019-08-25 06:00:00.000 | EEST     |     1 |
| 2019-08-25 06:00:00.000 | MDT      |     1 |
| 2019-08-25 06:00:00.000 | MSK      |     1 |
| 2019-08-25 06:00:00.000 | N/A      |    48 |
| 2019-08-25 06:00:00.000 | PDT      |     1 |
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 07:00:00.000 | CEST     |     1 |
| 2019-08-25 07:00:00.000 | MSK      |     1 |
| 2019-08-25 07:00:00.000 | N/A      |    28 |
| 2019-08-25 08:00:00.000 | BST      |     1 |
| 2019-08-25 08:00:00.000 | CEST     |     2 |
| 2019-08-25 08:00:00.000 | EEST     |     1 |
| 2019-08-25 08:00:00.000 | MDT      |     1 |
| 2019-08-25 08:00:00.000 | MSK      |     3 |
| 2019-08-25 08:00:00.000 | N/A      |    49 |
| 2019-08-25 09:00:00.000 | BST      |     1 |
| 2019-08-25 09:00:00.000 | CEST     |     6 |
| 2019-08-25 09:00:00.000 | MSK      |     1 |
| 2019-08-25 09:00:00.000 | N/A      |    40 |
| 2019-08-25 09:00:00.000 | PDT      |     1 |
| 2019-08-25 10:00:00.000 | BST      |     3 |
| 2019-08-25 10:00:00.000 | CEST     |     1 |
| 2019-08-25 10:00:00.000 | MSK      |     1 |
| 2019-08-25 10:00:00.000 | N/A      |    53 |
| 2019-08-25 10:00:00.000 | PDT      |     1 |
| 2019-08-25 11:00:00.000 | BST      |     2 |
| 2019-08-25 11:00:00.000 | CEST     |     6 |
| 2019-08-25 11:00:00.000 | EEST     |     1 |
| 2019-08-25 11:00:00.000 | MSK      |     2 |
| 2019-08-25 11:00:00.000 | N/A      |    54 |
| 2019-08-25 12:00:00.000 | CEST     |     1 |
| 2019-08-25 12:00:00.000 | EDT      |     4 |
| 2019-08-25 12:00:00.000 | EEST     |     1 |
| 2019-08-25 12:00:00.000 | MSK      |     1 |
| 2019-08-25 12:00:00.000 | N/A      |    55 |
| 2019-08-25 13:00:00.000 | BST      |     3 |
| 2019-08-25 13:00:00.000 | CDT      |     3 |
| 2019-08-25 13:00:00.000 | CEST     |     4 |
| 2019-08-25 13:00:00.000 | EDT      |     7 |
| 2019-08-25 13:00:00.000 | EEST     |     1 |
| 2019-08-25 13:00:00.000 | MDT      |     1 |
| 2019-08-25 13:00:00.000 | MSK      |     2 |
| 2019-08-25 13:00:00.000 | N/A      |    79 |
| 2019-08-25 14:00:00.000 | BST      |     4 |
| 2019-08-25 14:00:00.000 | CDT      |     9 |
| 2019-08-25 14:00:00.000 | CEST     |     5 |
| 2019-08-25 14:00:00.000 | EDT      |    11 |
| 2019-08-25 14:00:00.000 | EEST     |     1 |
| 2019-08-25 14:00:00.000 | MDT      |     1 |
| 2019-08-25 14:00:00.000 | N/A      |   132 |
| 2019-08-25 15:00:00.000 | CDT      |     5 |
| 2019-08-25 15:00:00.000 | EDT      |     9 |
| 2019-08-25 15:00:00.000 | MDT      |     2 |
| 2019-08-25 15:00:00.000 | MSK      |     2 |
| 2019-08-25 15:00:00.000 | MST      |     1 |
| 2019-08-25 15:00:00.000 | N/A      |    83 |
| 2019-08-25 15:00:00.000 | PDT      |     1 |
| 2019-08-25 16:00:00.000 | BST      |     6 |
| 2019-08-25 16:00:00.000 | CDT      |    32 |
| 2019-08-25 16:00:00.000 | CEST     |     2 |
| 2019-08-25 16:00:00.000 | EDT      |    55 |
| 2019-08-25 16:00:00.000 | MDT      |     4 |
| 2019-08-25 16:00:00.000 | MST      |     3 |
| 2019-08-25 16:00:00.000 | N/A      |   196 |
| 2019-08-25 16:00:00.000 | PDT      |     9 |
| 2019-08-25 17:00:00.000 | BST      |    20 |
| 2019-08-25 17:00:00.000 | CDT      |    41 |
| 2019-08-25 17:00:00.000 | CEST     |    16 |
| 2019-08-25 17:00:00.000 | EDT      |    85 |
| 2019-08-25 17:00:00.000 | MDT      |     2 |
| 2019-08-25 17:00:00.000 | MST      |     7 |
| 2019-08-25 17:00:00.000 | N/A      |   331 |
| 2019-08-25 17:00:00.000 | PDT      |    22 |
| 2019-08-25 18:00:00.000 | BST      |    13 |
| 2019-08-25 18:00:00.000 | CDT      |    36 |
| 2019-08-25 18:00:00.000 | CEST     |    13 |
| 2019-08-25 18:00:00.000 | EDT      |    49 |
| 2019-08-25 18:00:00.000 | MDT      |     4 |
| 2019-08-25 18:00:00.000 | MSK      |     1 |
| 2019-08-25 18:00:00.000 | MST      |     3 |
| 2019-08-25 18:00:00.000 | N/A      |   279 |
| 2019-08-25 18:00:00.000 | PDT      |    14 |
| 2019-08-25 19:00:00.000 | BST      |     7 |
| 2019-08-25 19:00:00.000 | CDT      |    29 |
| 2019-08-25 19:00:00.000 | CEST     |    11 |
| 2019-08-25 19:00:00.000 | EDT      |    49 |
| 2019-08-25 19:00:00.000 | EEST     |     2 |
| 2019-08-25 19:00:00.000 | MDT      |     2 |
| 2019-08-25 19:00:00.000 | MSK      |     2 |
| 2019-08-25 19:00:00.000 | MST      |     1 |
| 2019-08-25 19:00:00.000 | N/A      |   287 |
| 2019-08-25 19:00:00.000 | PDT      |    19 |
| 2019-08-25 20:00:00.000 | BST      |    11 |
| 2019-08-25 20:00:00.000 | CDT      |    31 |
| 2019-08-25 20:00:00.000 | CEST     |    16 |
| 2019-08-25 20:00:00.000 | EDT      |    43 |
| 2019-08-25 20:00:00.000 | EEST     |     3 |
| 2019-08-25 20:00:00.000 | MDT      |     4 |
| 2019-08-25 20:00:00.000 | MSK      |     2 |
| 2019-08-25 20:00:00.000 | N/A      |   249 |
| 2019-08-25 20:00:00.000 | PDT      |    19 |
| 2019-08-25 21:00:00.000 | BST      |     2 |
| 2019-08-25 21:00:00.000 | CDT      |    18 |
| 2019-08-25 21:00:00.000 | CEST     |     7 |
| 2019-08-25 21:00:00.000 | EDT      |    31 |
| 2019-08-25 21:00:00.000 | MDT      |     6 |
| 2019-08-25 21:00:00.000 | MST      |     2 |
| 2019-08-25 21:00:00.000 | N/A      |   187 |
| 2019-08-25 21:00:00.000 | PDT      |     7 |
| 2019-08-25 22:00:00.000 | BST      |     6 |
| 2019-08-25 22:00:00.000 | CDT      |    17 |
| 2019-08-25 22:00:00.000 | CEST     |     1 |
| 2019-08-25 22:00:00.000 | EDT      |    16 |
| 2019-08-25 22:00:00.000 | MDT      |     6 |
| 2019-08-25 22:00:00.000 | MSK      |     1 |
| 2019-08-25 22:00:00.000 | MST      |     3 |
| 2019-08-25 22:00:00.000 | N/A      |   137 |
| 2019-08-25 22:00:00.000 | PDT      |     6 |
| 2019-08-25 23:00:00.000 | BST      |     5 |
| 2019-08-25 23:00:00.000 | CDT      |     9 |
| 2019-08-25 23:00:00.000 | CEST     |     3 |
| 2019-08-25 23:00:00.000 | EDT      |    10 |
| 2019-08-25 23:00:00.000 | MDT      |     1 |
| 2019-08-25 23:00:00.000 | MST      |     3 |
| 2019-08-25 23:00:00.000 | N/A      |   128 |
| 2019-08-25 23:00:00.000 | PDT      |     5 |
+-------------------------+----------+-------+
(160 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Chrome')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 00:00:00.000 | N/A      |    86 |
| 2019-08-25 01:00:00.000 | N/A      |    84 |
| 2019-08-25 02:00:00.000 | EDT      |     1 |
| 2019-08-25 02:00:00.000 | N/A      |    93 |
| 2019-08-25 03:00:00.000 | N/A      |    92 |
| 2019-08-25 04:00:00.000 | N/A      |    79 |
| 2019-08-25 05:00:00.000 | N/A      |    39 |
| 2019-08-25 06:00:00.000 | N/A      |    38 |
| 2019-08-25 07:00:00.000 | CDT      |     1 |
| 2019-08-25 07:00:00.000 | N/A      |    21 |
| 2019-08-25 08:00:00.000 | N/A      |    34 |
| 2019-08-25 09:00:00.000 | N/A      |    26 |
| 2019-08-25 10:00:00.000 | N/A      |    40 |
| 2019-08-25 11:00:00.000 | N/A      |    43 |
| 2019-08-25 12:00:00.000 | EEST     |     1 |
| 2019-08-25 12:00:00.000 | N/A      |    36 |
| 2019-08-25 13:00:00.000 | EDT      |     3 |
| 2019-08-25 13:00:00.000 | N/A      |    64 |
| 2019-08-25 14:00:00.000 | N/A      |    98 |
| 2019-08-25 15:00:00.000 | N/A      |    71 |
| 2019-08-25 16:00:00.000 | BST      |     1 |
| 2019-08-25 16:00:00.000 | N/A      |   167 |
| 2019-08-25 17:00:00.000 | EDT      |     1 |
| 2019-08-25 17:00:00.000 | N/A      |   262 |
| 2019-08-25 18:00:00.000 | EDT      |     1 |
| 2019-08-25 18:00:00.000 | N/A      |   228 |
| 2019-08-25 19:00:00.000 | CDT      |     2 |
| 2019-08-25 19:00:00.000 | N/A      |   212 |
| 2019-08-25 20:00:00.000 | N/A      |   192 |
| 2019-08-25 20:00:00.000 | PDT      |     1 |
| 2019-08-25 21:00:00.000 | EDT      |     1 |
| 2019-08-25 21:00:00.000 | N/A      |   146 |
| 2019-08-25 22:00:00.000 | CDT      |     1 |
| 2019-08-25 22:00:00.000 | N/A      |   114 |
| 2019-08-25 23:00:00.000 | N/A      |   106 |
+-------------------------+----------+-------+
(35 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    86 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    84 |
| Chrome        | 2019-08-25 02:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    93 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    92 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    38 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    21 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    34 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    26 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    40 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    43 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    64 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    98 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    71 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   167 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   262 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   228 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   212 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   192 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   146 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   114 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(220 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    22 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     5 |
+---------------+-------------------------+----------+-------+
(194 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EDT      |     7 |
| Chrome        | EEST     |     1 |
| Chrome        | N/A      |  2371 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EDT      |     7 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | N/A      |   561 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    81 |
| Mobile Safari | CDT      |   265 |
| Mobile Safari | CEST     |    94 |
| Mobile Safari | EDT      |   416 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    24 |
| Mobile Safari | N/A      |    23 |
| Mobile Safari | PDT      |   115 |
+---------------+----------+-------+
(24 rows)

!ok
# Wed Jul 10 19:14:36 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EDT      |     7 |
| Chrome        | EEST     |     1 |
| Chrome        | N/A      |  2265 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EDT      |     7 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | N/A      |   539 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    76 |
| Mobile Safari | CDT      |   256 |
| Mobile Safari | CEST     |    91 |
| Mobile Safari | EDT      |   406 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | N/A      |    23 |
| Mobile Safari | PDT      |   110 |
+---------------+----------+-------+
(24 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 02:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     5 |
+---------------+-------------------------+----------+-------+
(169 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 02:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(162 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EDT      |     7 |
| Chrome        | EEST     |     1 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EDT      |     7 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    81 |
| Mobile Safari | CDT      |   265 |
| Mobile Safari | CEST     |    94 |
| Mobile Safari | EDT      |   416 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    24 |
| Mobile Safari | PDT      |   115 |
+---------------+----------+-------+
(21 rows)

!ok
# Wed Jul 10 19:14:40 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EDT      |     7 |
| Chrome        | EEST     |     1 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EDT      |     7 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    76 |
| Mobile Safari | CDT      |   256 |
| Mobile Safari | CEST     |    91 |
| Mobile Safari | EDT      |   406 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | PDT      |   110 |
+---------------+----------+-------+
(21 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     5 |
+---------------+-------------------------+----------+-------+
(139 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(133 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EEST     |     1 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    81 |
| Mobile Safari | CDT      |   265 |
| Mobile Safari | CEST     |    94 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    24 |
| Mobile Safari | PDT      |   115 |
+---------------+----------+-------+
(18 rows)

!ok
# Wed Jul 10 19:14:42 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EEST     |     1 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    76 |
| Mobile Safari | CDT      |   256 |
| Mobile Safari | CEST     |    91 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | PDT      |   110 |
+---------------+----------+-------+
(18 rows)

!ok
# Wed Jul 10 19:14:43 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    86 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    84 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    93 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    92 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    38 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    21 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    34 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    26 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    40 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    43 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    64 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    98 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    71 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   167 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   262 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   228 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   212 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   192 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   146 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   114 |
| Chrome        | 2019-08-25 23:00:00.000 | N/A      |   106 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    22 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     5 |
+---------------+-------------------------+----------+-------+
(199 rows)

!ok
# Wed Jul 10 19:14:43 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    86 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    84 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    93 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    92 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    38 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    21 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    34 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    26 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    40 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    43 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    64 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    98 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    71 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   167 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   262 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   228 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   212 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   192 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   146 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   114 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
+---------------+-------------------------+----------+-------+
(191 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EEST     |     1 |
| Chrome        | N/A      |  2371 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | N/A      |   561 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    81 |
| Mobile Safari | CDT      |   265 |
| Mobile Safari | CEST     |    94 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    40 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    24 |
| Mobile Safari | N/A      |    23 |
| Mobile Safari | PDT      |   115 |
+---------------+----------+-------+
(21 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 23:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 23:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2;
+---------------+----------+-------+
| Browser       | timezone | count |
+---------------+----------+-------+
| Chrome        | BST      |     1 |
| Chrome        | CDT      |     4 |
| Chrome        | EEST     |     1 |
| Chrome        | N/A      |  2265 |
| Chrome        | PDT      |     1 |
| Chrome Mobile | BST      |     3 |
| Chrome Mobile | CDT      |     8 |
| Chrome Mobile | CEST     |     4 |
| Chrome Mobile | EEST     |     1 |
| Chrome Mobile | MSK      |     6 |
| Chrome Mobile | N/A      |   539 |
| Chrome Mobile | PDT      |     6 |
| Mobile Safari | BST      |    76 |
| Mobile Safari | CDT      |   256 |
| Mobile Safari | CEST     |    91 |
| Mobile Safari | EEST     |     9 |
| Mobile Safari | MDT      |    39 |
| Mobile Safari | MSK      |    15 |
| Mobile Safari | MST      |    21 |
| Mobile Safari | N/A      |    23 |
| Mobile Safari | PDT      |   110 |
+---------------+----------+-------+
(21 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile'))
GROUP BY 1,2;
+---------------+-------------------------+-------+
| Browser       | __time                  | count |
+---------------+-------------------------+-------+
| Chrome        | 2019-08-25 00:00:00.000 |    86 |
| Chrome        | 2019-08-25 01:00:00.000 |    84 |
| Chrome        | 2019-08-25 02:00:00.000 |    94 |
| Chrome        | 2019-08-25 03:00:00.000 |    92 |
| Chrome        | 2019-08-25 04:00:00.000 |    79 |
| Chrome        | 2019-08-25 05:00:00.000 |    39 |
| Chrome        | 2019-08-25 06:00:00.000 |    38 |
| Chrome        | 2019-08-25 07:00:00.000 |    22 |
| Chrome        | 2019-08-25 08:00:00.000 |    34 |
| Chrome        | 2019-08-25 09:00:00.000 |    26 |
| Chrome        | 2019-08-25 10:00:00.000 |    41 |
| Chrome        | 2019-08-25 11:00:00.000 |    43 |
| Chrome        | 2019-08-25 12:00:00.000 |    38 |
| Chrome        | 2019-08-25 13:00:00.000 |    67 |
| Chrome        | 2019-08-25 14:00:00.000 |    99 |
| Chrome        | 2019-08-25 15:00:00.000 |    71 |
| Chrome        | 2019-08-25 16:00:00.000 |   168 |
| Chrome        | 2019-08-25 17:00:00.000 |   263 |
| Chrome        | 2019-08-25 18:00:00.000 |   231 |
| Chrome        | 2019-08-25 19:00:00.000 |   214 |
| Chrome        | 2019-08-25 20:00:00.000 |   195 |
| Chrome        | 2019-08-25 21:00:00.000 |   147 |
| Chrome        | 2019-08-25 22:00:00.000 |   117 |
| Chrome        | 2019-08-25 23:00:00.000 |   107 |
| Chrome Mobile | 2019-08-25 00:00:00.000 |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 |    10 |
| Chrome Mobile | 2019-08-25 02:00:00.000 |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 |    12 |
| Chrome Mobile | 2019-08-25 04:00:00.000 |    10 |
| Chrome Mobile | 2019-08-25 05:00:00.000 |    14 |
| Chrome Mobile | 2019-08-25 06:00:00.000 |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 |    15 |
| Chrome Mobile | 2019-08-25 10:00:00.000 |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 |    11 |
| Chrome Mobile | 2019-08-25 12:00:00.000 |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 |    16 |
| Chrome Mobile | 2019-08-25 14:00:00.000 |    33 |
| Chrome Mobile | 2019-08-25 15:00:00.000 |    14 |
| Chrome Mobile | 2019-08-25 16:00:00.000 |    31 |
| Chrome Mobile | 2019-08-25 17:00:00.000 |    72 |
| Chrome Mobile | 2019-08-25 18:00:00.000 |    52 |
| Chrome Mobile | 2019-08-25 19:00:00.000 |    75 |
| Chrome Mobile | 2019-08-25 20:00:00.000 |    58 |
| Chrome Mobile | 2019-08-25 21:00:00.000 |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 |    25 |
| Chrome Mobile | 2019-08-25 23:00:00.000 |    22 |
| Mobile Safari | 2019-08-25 00:00:00.000 |    24 |
| Mobile Safari | 2019-08-25 01:00:00.000 |    27 |
| Mobile Safari | 2019-08-25 02:00:00.000 |    38 |
| Mobile Safari | 2019-08-25 03:00:00.000 |    17 |
| Mobile Safari | 2019-08-25 04:00:00.000 |    14 |
| Mobile Safari | 2019-08-25 05:00:00.000 |    13 |
| Mobile Safari | 2019-08-25 06:00:00.000 |    15 |
| Mobile Safari | 2019-08-25 07:00:00.000 |     3 |
| Mobile Safari | 2019-08-25 08:00:00.000 |     9 |
| Mobile Safari | 2019-08-25 09:00:00.000 |     8 |
| Mobile Safari | 2019-08-25 10:00:00.000 |     7 |
| Mobile Safari | 2019-08-25 11:00:00.000 |    11 |
| Mobile Safari | 2019-08-25 12:00:00.000 |     9 |
| Mobile Safari | 2019-08-25 13:00:00.000 |    21 |
| Mobile Safari | 2019-08-25 14:00:00.000 |    37 |
| Mobile Safari | 2019-08-25 15:00:00.000 |    19 |
| Mobile Safari | 2019-08-25 16:00:00.000 |   110 |
| Mobile Safari | 2019-08-25 17:00:00.000 |   189 |
| Mobile Safari | 2019-08-25 18:00:00.000 |   134 |
| Mobile Safari | 2019-08-25 19:00:00.000 |   128 |
| Mobile Safari | 2019-08-25 20:00:00.000 |   128 |
| Mobile Safari | 2019-08-25 21:00:00.000 |    73 |
| Mobile Safari | 2019-08-25 22:00:00.000 |    58 |
| Mobile Safari | 2019-08-25 23:00:00.000 |    37 |
+---------------+-------------------------+-------+
(72 rows)

!ok
# Wed Jul 10 19:14:44 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome','Chrome Mobile')) AND CAST(t."timezone" AS VARCHAR) IN ('N/A','EDT','CDT','PDT','CEST','BST','MDT','MST','MSK','EEST'))
GROUP BY 1,2,3;
+---------------+-------------------------+----------+-------+
| Browser       | __time                  | timezone | count |
+---------------+-------------------------+----------+-------+
| Chrome Mobile | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 00:00:00.000 | N/A      |    86 |
| Chrome        | 2019-08-25 01:00:00.000 | N/A      |    84 |
| Chrome        | 2019-08-25 02:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 02:00:00.000 | N/A      |    93 |
| Chrome        | 2019-08-25 03:00:00.000 | N/A      |    92 |
| Chrome        | 2019-08-25 04:00:00.000 | N/A      |    79 |
| Chrome        | 2019-08-25 05:00:00.000 | N/A      |    39 |
| Chrome        | 2019-08-25 06:00:00.000 | N/A      |    38 |
| Chrome        | 2019-08-25 07:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 07:00:00.000 | N/A      |    21 |
| Chrome        | 2019-08-25 08:00:00.000 | N/A      |    34 |
| Chrome        | 2019-08-25 09:00:00.000 | N/A      |    26 |
| Chrome        | 2019-08-25 10:00:00.000 | N/A      |    40 |
| Chrome        | 2019-08-25 11:00:00.000 | N/A      |    43 |
| Chrome        | 2019-08-25 12:00:00.000 | EEST     |     1 |
| Chrome        | 2019-08-25 12:00:00.000 | N/A      |    36 |
| Chrome        | 2019-08-25 13:00:00.000 | EDT      |     3 |
| Chrome        | 2019-08-25 13:00:00.000 | N/A      |    64 |
| Chrome        | 2019-08-25 14:00:00.000 | N/A      |    98 |
| Chrome        | 2019-08-25 15:00:00.000 | N/A      |    71 |
| Chrome        | 2019-08-25 16:00:00.000 | BST      |     1 |
| Chrome        | 2019-08-25 16:00:00.000 | N/A      |   167 |
| Chrome        | 2019-08-25 17:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 17:00:00.000 | N/A      |   262 |
| Chrome        | 2019-08-25 18:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 18:00:00.000 | N/A      |   228 |
| Chrome        | 2019-08-25 19:00:00.000 | CDT      |     2 |
| Chrome        | 2019-08-25 19:00:00.000 | N/A      |   212 |
| Chrome        | 2019-08-25 20:00:00.000 | N/A      |   192 |
| Chrome        | 2019-08-25 20:00:00.000 | PDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | EDT      |     1 |
| Chrome        | 2019-08-25 21:00:00.000 | N/A      |   146 |
| Chrome        | 2019-08-25 22:00:00.000 | CDT      |     1 |
| Chrome        | 2019-08-25 22:00:00.000 | N/A      |   114 |
| Chrome        | 2019-08-25 23:00:00.000 | N/A      |   106 |
| Chrome Mobile | 2019-08-25 00:00:00.000 | N/A      |     5 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 01:00:00.000 | N/A      |     8 |
| Chrome Mobile | 2019-08-25 02:00:00.000 | N/A      |    21 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 | N/A      |     9 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 06:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 07:00:00.000 | N/A      |     7 |
| Chrome Mobile | 2019-08-25 08:00:00.000 | N/A      |    15 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 09:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 10:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 11:00:00.000 | N/A      |    10 |
| Chrome Mobile | 2019-08-25 12:00:00.000 | N/A      |    16 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | CEST     |     1 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | MSK      |     2 |
| Chrome Mobile | 2019-08-25 13:00:00.000 | N/A      |    13 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | EEST     |     1 |
| Chrome Mobile | 2019-08-25 14:00:00.000 | N/A      |    32 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 15:00:00.000 | N/A      |    12 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | N/A      |    27 |
| Chrome Mobile | 2019-08-25 16:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | EDT      |     2 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | N/A      |    66 |
| Chrome Mobile | 2019-08-25 17:00:00.000 | PDT      |     3 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CDT      |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | CEST     |     2 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | N/A      |    47 |
| Chrome Mobile | 2019-08-25 18:00:00.000 | PDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | EDT      |     1 |
| Chrome Mobile | 2019-08-25 19:00:00.000 | N/A      |    73 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | CDT      |     1 |
| Chrome Mobile | 2019-08-25 20:00:00.000 | N/A      |    56 |
| Chrome Mobile | 2019-08-25 21:00:00.000 | N/A      |    41 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | BST      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | MSK      |     1 |
| Chrome Mobile | 2019-08-25 22:00:00.000 | N/A      |    23 |
| Chrome Mobile | 2019-08-25 23:00:00.000 | N/A      |    22 |
| Mobile Safari | 2019-08-25 00:00:00.000 | CDT      |     8 |
| Mobile Safari | 2019-08-25 00:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 01:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 01:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 01:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CDT      |    11 |
| Mobile Safari | 2019-08-25 02:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 02:00:00.000 | EDT      |    18 |
| Mobile Safari | 2019-08-25 02:00:00.000 | MDT      |     3 |
| Mobile Safari | 2019-08-25 02:00:00.000 | PDT      |     4 |
| Mobile Safari | 2019-08-25 03:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 03:00:00.000 | EDT      |     7 |
| Mobile Safari | 2019-08-25 03:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 03:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 04:00:00.000 | CDT      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | EDT      |     6 |
| Mobile Safari | 2019-08-25 04:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 04:00:00.000 | PDT      |     3 |
| Mobile Safari | 2019-08-25 05:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 05:00:00.000 | EDT      |     5 |
| Mobile Safari | 2019-08-25 05:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 06:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 07:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 08:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 | MSK      |     3 |
| Mobile Safari | 2019-08-25 09:00:00.000 | BST      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 09:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 10:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 11:00:00.000 | CEST     |     6 |
| Mobile Safari | 2019-08-25 11:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 12:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 12:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | BST      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CDT      |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EDT      |     4 |
| Mobile Safari | 2019-08-25 13:00:00.000 | EEST     |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 14:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 14:00:00.000 | CEST     |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 | EDT      |    11 |
| Mobile Safari | 2019-08-25 14:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 14:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | CDT      |     5 |
| Mobile Safari | 2019-08-25 15:00:00.000 | EDT      |     8 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 15:00:00.000 | PDT      |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 | BST      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 16:00:00.000 | CEST     |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | EDT      |    55 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 16:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 16:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 16:00:00.000 | PDT      |     8 |
| Mobile Safari | 2019-08-25 17:00:00.000 | BST      |    20 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CDT      |    40 |
| Mobile Safari | 2019-08-25 17:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 17:00:00.000 | EDT      |    82 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 17:00:00.000 | MST      |     7 |
| Mobile Safari | 2019-08-25 17:00:00.000 | N/A      |     3 |
| Mobile Safari | 2019-08-25 17:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 18:00:00.000 | BST      |    13 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CDT      |    34 |
| Mobile Safari | 2019-08-25 18:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 18:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MSK      |     1 |
| Mobile Safari | 2019-08-25 18:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 18:00:00.000 | N/A      |     4 |
| Mobile Safari | 2019-08-25 18:00:00.000 | PDT      |    13 |
| Mobile Safari | 2019-08-25 19:00:00.000 | BST      |     7 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CDT      |    27 |
| Mobile Safari | 2019-08-25 19:00:00.000 | CEST     |    11 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EDT      |    48 |
| Mobile Safari | 2019-08-25 19:00:00.000 | EEST     |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MDT      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | MST      |     1 |
| Mobile Safari | 2019-08-25 19:00:00.000 | N/A      |     2 |
| Mobile Safari | 2019-08-25 19:00:00.000 | PDT      |    19 |
| Mobile Safari | 2019-08-25 20:00:00.000 | BST      |    10 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CDT      |    30 |
| Mobile Safari | 2019-08-25 20:00:00.000 | CEST     |    16 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EDT      |    43 |
| Mobile Safari | 2019-08-25 20:00:00.000 | EEST     |     3 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MDT      |     4 |
| Mobile Safari | 2019-08-25 20:00:00.000 | MSK      |     2 |
| Mobile Safari | 2019-08-25 20:00:00.000 | N/A      |     1 |
| Mobile Safari | 2019-08-25 20:00:00.000 | PDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | BST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CDT      |    18 |
| Mobile Safari | 2019-08-25 21:00:00.000 | CEST     |     7 |
| Mobile Safari | 2019-08-25 21:00:00.000 | EDT      |    30 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 21:00:00.000 | MST      |     2 |
| Mobile Safari | 2019-08-25 21:00:00.000 | PDT      |     7 |
| Mobile Safari | 2019-08-25 22:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | CEST     |     1 |
| Mobile Safari | 2019-08-25 22:00:00.000 | EDT      |    16 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MDT      |     6 |
| Mobile Safari | 2019-08-25 22:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 22:00:00.000 | PDT      |     6 |
| Mobile Safari | 2019-08-25 23:00:00.000 | BST      |     5 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CDT      |     9 |
| Mobile Safari | 2019-08-25 23:00:00.000 | CEST     |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | EDT      |    10 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MDT      |     1 |
| Mobile Safari | 2019-08-25 23:00:00.000 | MST      |     3 |
| Mobile Safari | 2019-08-25 23:00:00.000 | PDT      |     5 |
+---------------+-------------------------+----------+-------+
(229 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 10;
+----------+-------+
| timezone | count |
+----------+-------+
| EDT      |   137 |
| CDT      |    70 |
| PDT      |    27 |
| BST      |    24 |
| CEST     |    18 |
| MST      |    10 |
| MDT      |     6 |
| N/A      |     5 |
| ADT      |     1 |
| IST      |     1 |
+----------+-------+
(10 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00'))) AS "v1",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:01:00'))) AS "v2",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 16:01:00'))) AS "v3",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 17:01:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:02:00'))) AS "v4",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 16:01:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 16:02:00'))) AS "v5"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari'))
GROUP BY ();
+-----+-----+----+----+----+----+
| v0  | v1  | v2 | v3 | v4 | v5 |
+-----+-----+----+----+----+----+
| 189 | 110 |  2 |  0 |  1 |  0 |
+-----+-----+----+----+----+----+
(1 row)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+---------------+-------+
| Browser       | count |
+---------------+-------+
| Mobile Safari |   299 |
+---------------+-------+
(1 row)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1M', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 17:00:00.000 | BST      |     1 |
| 2019-08-25 17:00:00.000 | EDT      |     1 |
| 2019-08-25 17:01:00.000 | BST      |     1 |
| 2019-08-25 17:02:00.000 | BST      |     1 |
| 2019-08-25 17:02:00.000 | EDT      |     4 |
| 2019-08-25 17:04:00.000 | CDT      |     1 |
| 2019-08-25 17:04:00.000 | EDT      |     1 |
| 2019-08-25 17:05:00.000 | CDT      |     1 |
| 2019-08-25 17:07:00.000 | EDT      |     1 |
| 2019-08-25 17:07:00.000 | PDT      |     1 |
| 2019-08-25 17:08:00.000 | EDT      |     2 |
| 2019-08-25 17:08:00.000 | PDT      |     1 |
| 2019-08-25 17:09:00.000 | CDT      |     1 |
| 2019-08-25 17:09:00.000 | EDT      |     1 |
| 2019-08-25 17:10:00.000 | EDT      |     2 |
| 2019-08-25 17:11:00.000 | BST      |     1 |
| 2019-08-25 17:11:00.000 | PDT      |     1 |
| 2019-08-25 17:12:00.000 | BST      |     1 |
| 2019-08-25 17:12:00.000 | CDT      |     1 |
| 2019-08-25 17:13:00.000 | EDT      |     1 |
| 2019-08-25 17:13:00.000 | MDT      |     1 |
| 2019-08-25 17:13:00.000 | PDT      |     1 |
| 2019-08-25 17:14:00.000 | BST      |     1 |
| 2019-08-25 17:14:00.000 | CDT      |     1 |
| 2019-08-25 17:15:00.000 | CEST     |     1 |
| 2019-08-25 17:15:00.000 | EDT      |     3 |
| 2019-08-25 17:16:00.000 | EDT      |     1 |
| 2019-08-25 17:16:00.000 | MST      |     1 |
| 2019-08-25 17:16:00.000 | PDT      |     1 |
| 2019-08-25 17:17:00.000 | CDT      |     1 |
| 2019-08-25 17:17:00.000 | CEST     |     2 |
| 2019-08-25 17:17:00.000 | EDT      |     1 |
| 2019-08-25 17:17:00.000 | MST      |     1 |
| 2019-08-25 17:18:00.000 | CDT      |     1 |
| 2019-08-25 17:18:00.000 | CEST     |     1 |
| 2019-08-25 17:18:00.000 | EDT      |     1 |
| 2019-08-25 17:18:00.000 | MST      |     1 |
| 2019-08-25 17:19:00.000 | CEST     |     1 |
| 2019-08-25 17:19:00.000 | EDT      |     2 |
| 2019-08-25 17:19:00.000 | N/A      |     1 |
| 2019-08-25 17:20:00.000 | BST      |     1 |
| 2019-08-25 17:20:00.000 | CDT      |     1 |
| 2019-08-25 17:20:00.000 | EDT      |     2 |
| 2019-08-25 17:20:00.000 | MDT      |     1 |
| 2019-08-25 17:21:00.000 | BST      |     1 |
| 2019-08-25 17:21:00.000 | EDT      |     3 |
| 2019-08-25 17:21:00.000 | PDT      |     1 |
| 2019-08-25 17:22:00.000 | BST      |     1 |
| 2019-08-25 17:22:00.000 | CDT      |     1 |
| 2019-08-25 17:23:00.000 | CDT      |     1 |
| 2019-08-25 17:23:00.000 | MST      |     1 |
| 2019-08-25 17:24:00.000 | BST      |     1 |
| 2019-08-25 17:24:00.000 | EDT      |     2 |
| 2019-08-25 17:24:00.000 | N/A      |     1 |
| 2019-08-25 17:25:00.000 | CEST     |     2 |
| 2019-08-25 17:26:00.000 | BST      |     1 |
| 2019-08-25 17:26:00.000 | CEST     |     2 |
| 2019-08-25 17:26:00.000 | EDT      |     3 |
| 2019-08-25 17:26:00.000 | MST      |     1 |
| 2019-08-25 17:26:00.000 | PDT      |     2 |
| 2019-08-25 17:27:00.000 | CDT      |     1 |
| 2019-08-25 17:27:00.000 | EDT      |     3 |
| 2019-08-25 17:27:00.000 | PDT      |     1 |
| 2019-08-25 17:28:00.000 | CDT      |     1 |
| 2019-08-25 17:28:00.000 | CEST     |     2 |
| 2019-08-25 17:28:00.000 | EDT      |     2 |
| 2019-08-25 17:29:00.000 | CDT      |     1 |
| 2019-08-25 17:29:00.000 | EDT      |     1 |
| 2019-08-25 17:30:00.000 | CDT      |     1 |
| 2019-08-25 17:30:00.000 | EDT      |     3 |
| 2019-08-25 17:31:00.000 | CDT      |     1 |
| 2019-08-25 17:31:00.000 | EDT      |     2 |
| 2019-08-25 17:32:00.000 | CDT      |     3 |
| 2019-08-25 17:33:00.000 | CDT      |     2 |
| 2019-08-25 17:33:00.000 | EDT      |     2 |
| 2019-08-25 17:33:00.000 | PDT      |     1 |
| 2019-08-25 17:34:00.000 | BST      |     1 |
| 2019-08-25 17:34:00.000 | EDT      |     1 |
| 2019-08-25 17:35:00.000 | BST      |     1 |
| 2019-08-25 17:35:00.000 | CDT      |     1 |
| 2019-08-25 17:35:00.000 | CEST     |     1 |
| 2019-08-25 17:35:00.000 | MST      |     1 |
| 2019-08-25 17:36:00.000 | EDT      |     3 |
| 2019-08-25 17:37:00.000 | BST      |     2 |
| 2019-08-25 17:37:00.000 | PDT      |     1 |
| 2019-08-25 17:38:00.000 | CDT      |     2 |
| 2019-08-25 17:38:00.000 | EDT      |     1 |
| 2019-08-25 17:38:00.000 | PDT      |     1 |
| 2019-08-25 17:40:00.000 | BST      |     1 |
| 2019-08-25 17:40:00.000 | CDT      |     1 |
| 2019-08-25 17:41:00.000 | EDT      |     2 |
| 2019-08-25 17:42:00.000 | CDT      |     2 |
| 2019-08-25 17:42:00.000 | CEST     |     1 |
| 2019-08-25 17:42:00.000 | EDT      |     5 |
| 2019-08-25 17:43:00.000 | BST      |     1 |
| 2019-08-25 17:43:00.000 | CDT      |     1 |
| 2019-08-25 17:43:00.000 | EDT      |     1 |
| 2019-08-25 17:44:00.000 | CDT      |     3 |
| 2019-08-25 17:44:00.000 | EDT      |     3 |
| 2019-08-25 17:44:00.000 | PDT      |     1 |
| 2019-08-25 17:45:00.000 | CDT      |     1 |
| 2019-08-25 17:45:00.000 | EDT      |     3 |
| 2019-08-25 17:46:00.000 | BST      |     1 |
| 2019-08-25 17:46:00.000 | CEST     |     1 |
| 2019-08-25 17:46:00.000 | EDT      |     1 |
| 2019-08-25 17:48:00.000 | CDT      |     2 |
| 2019-08-25 17:48:00.000 | EDT      |     1 |
| 2019-08-25 17:49:00.000 | EDT      |     3 |
| 2019-08-25 17:49:00.000 | N/A      |     1 |
| 2019-08-25 17:49:00.000 | PDT      |     1 |
| 2019-08-25 17:50:00.000 | CDT      |     1 |
| 2019-08-25 17:51:00.000 | BST      |     1 |
| 2019-08-25 17:51:00.000 | PDT      |     1 |
| 2019-08-25 17:52:00.000 | CDT      |     1 |
| 2019-08-25 17:52:00.000 | PDT      |     1 |
| 2019-08-25 17:53:00.000 | CEST     |     1 |
| 2019-08-25 17:53:00.000 | EDT      |     3 |
| 2019-08-25 17:54:00.000 | EDT      |     4 |
| 2019-08-25 17:54:00.000 | PDT      |     2 |
| 2019-08-25 17:55:00.000 | EDT      |     1 |
| 2019-08-25 17:56:00.000 | CDT      |     2 |
| 2019-08-25 17:56:00.000 | EDT      |     2 |
| 2019-08-25 17:56:00.000 | MST      |     1 |
| 2019-08-25 17:57:00.000 | CDT      |     2 |
| 2019-08-25 17:57:00.000 | CEST     |     1 |
| 2019-08-25 17:57:00.000 | EDT      |     1 |
| 2019-08-25 17:58:00.000 | EDT      |     1 |
| 2019-08-25 17:59:00.000 | BST      |     1 |
| 2019-08-25 17:59:00.000 | CDT      |     1 |
| 2019-08-25 17:59:00.000 | EDT      |     2 |
| 2019-08-25 17:59:00.000 | PDT      |     1 |
+-------------------------+----------+-------+
(131 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1M', NULL, 'Etc/UTC') AS "__time",
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1,2;
+-------------------------+----------+-------+
| __time                  | timezone | count |
+-------------------------+----------+-------+
| 2019-08-25 16:02:00.000 | EDT      |     1 |
| 2019-08-25 16:02:00.000 | MDT      |     1 |
| 2019-08-25 16:03:00.000 | EDT      |     1 |
| 2019-08-25 16:04:00.000 | EDT      |     1 |
| 2019-08-25 16:06:00.000 | CDT      |     1 |
| 2019-08-25 16:06:00.000 | EDT      |     1 |
| 2019-08-25 16:07:00.000 | MDT      |     1 |
| 2019-08-25 16:08:00.000 | EDT      |     1 |
| 2019-08-25 16:09:00.000 | CDT      |     1 |
| 2019-08-25 16:11:00.000 | CEST     |     1 |
| 2019-08-25 16:11:00.000 | EDT      |     1 |
| 2019-08-25 16:13:00.000 | N/A      |     1 |
| 2019-08-25 16:13:00.000 | PDT      |     1 |
| 2019-08-25 16:15:00.000 | CDT      |     1 |
| 2019-08-25 16:16:00.000 | CDT      |     1 |
| 2019-08-25 16:16:00.000 | EDT      |     2 |
| 2019-08-25 16:17:00.000 | CDT      |     1 |
| 2019-08-25 16:17:00.000 | EDT      |     1 |
| 2019-08-25 16:18:00.000 | EDT      |     1 |
| 2019-08-25 16:18:00.000 | N/A      |     1 |
| 2019-08-25 16:18:00.000 | PDT      |     1 |
| 2019-08-25 16:19:00.000 | EDT      |     1 |
| 2019-08-25 16:20:00.000 | CDT      |     2 |
| 2019-08-25 16:20:00.000 | EDT      |     2 |
| 2019-08-25 16:22:00.000 | CDT      |     1 |
| 2019-08-25 16:22:00.000 | EDT      |     1 |
| 2019-08-25 16:23:00.000 | EDT      |     1 |
| 2019-08-25 16:26:00.000 | CDT      |     1 |
| 2019-08-25 16:27:00.000 | CDT      |     1 |
| 2019-08-25 16:29:00.000 | PDT      |     1 |
| 2019-08-25 16:30:00.000 | CDT      |     1 |
| 2019-08-25 16:30:00.000 | EDT      |     2 |
| 2019-08-25 16:31:00.000 | CDT      |     3 |
| 2019-08-25 16:31:00.000 | EDT      |     3 |
| 2019-08-25 16:32:00.000 | EDT      |     1 |
| 2019-08-25 16:33:00.000 | EDT      |     2 |
| 2019-08-25 16:34:00.000 | EDT      |     1 |
| 2019-08-25 16:35:00.000 | CDT      |     1 |
| 2019-08-25 16:35:00.000 | EDT      |     1 |
| 2019-08-25 16:36:00.000 | CEST     |     1 |
| 2019-08-25 16:36:00.000 | EDT      |     1 |
| 2019-08-25 16:36:00.000 | PDT      |     1 |
| 2019-08-25 16:38:00.000 | EDT      |     1 |
| 2019-08-25 16:38:00.000 | PDT      |     1 |
| 2019-08-25 16:39:00.000 | EDT      |     2 |
| 2019-08-25 16:39:00.000 | MST      |     1 |
| 2019-08-25 16:41:00.000 | EDT      |     1 |
| 2019-08-25 16:42:00.000 | CDT      |     2 |
| 2019-08-25 16:43:00.000 | CDT      |     1 |
| 2019-08-25 16:43:00.000 | EDT      |     1 |
| 2019-08-25 16:45:00.000 | CDT      |     3 |
| 2019-08-25 16:45:00.000 | EDT      |     3 |
| 2019-08-25 16:45:00.000 | MST      |     1 |
| 2019-08-25 16:46:00.000 | EDT      |     2 |
| 2019-08-25 16:46:00.000 | IST      |     1 |
| 2019-08-25 16:46:00.000 | PDT      |     1 |
| 2019-08-25 16:47:00.000 | EDT      |     1 |
| 2019-08-25 16:48:00.000 | BST      |     1 |
| 2019-08-25 16:48:00.000 | EDT      |     1 |
| 2019-08-25 16:49:00.000 | EDT      |     2 |
| 2019-08-25 16:50:00.000 | BST      |     1 |
| 2019-08-25 16:50:00.000 | CDT      |     1 |
| 2019-08-25 16:50:00.000 | EDT      |     4 |
| 2019-08-25 16:50:00.000 | MDT      |     1 |
| 2019-08-25 16:51:00.000 | CDT      |     3 |
| 2019-08-25 16:51:00.000 | EDT      |     2 |
| 2019-08-25 16:52:00.000 | MDT      |     1 |
| 2019-08-25 16:52:00.000 | MST      |     1 |
| 2019-08-25 16:53:00.000 | BST      |     1 |
| 2019-08-25 16:53:00.000 | EDT      |     2 |
| 2019-08-25 16:55:00.000 | CDT      |     2 |
| 2019-08-25 16:55:00.000 | EDT      |     1 |
| 2019-08-25 16:55:00.000 | PDT      |     2 |
| 2019-08-25 16:57:00.000 | EDT      |     4 |
| 2019-08-25 16:58:00.000 | BST      |     1 |
| 2019-08-25 16:58:00.000 | CDT      |     1 |
| 2019-08-25 16:59:00.000 | CDT      |     2 |
| 2019-08-25 16:59:00.000 | EDT      |     2 |
+-------------------------+----------+-------+
(78 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 17:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 18:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1;
+----------+-------+
| timezone | count |
+----------+-------+
| BST      |    20 |
| CDT      |    40 |
| CEST     |    16 |
| EDT      |    82 |
| MDT      |     2 |
| MST      |     7 |
| N/A      |     3 |
| PDT      |    19 |
+----------+-------+
(8 rows)

!ok
# Wed Jul 10 19:14:49 IST 2024
SELECT
CAST(t."timezone" AS VARCHAR) AS "timezone",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 16:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR)='Mobile Safari')) AND CAST(t."timezone" AS VARCHAR) IN ('EDT','CDT','PDT','BST','CEST','MDT','MST','N/A','IST','EEST'))
GROUP BY 1;
+----------+-------+
| timezone | count |
+----------+-------+
| BST      |     4 |
| CDT      |    30 |
| CEST     |     2 |
| EDT      |    55 |
| IST      |     1 |
| MDT      |     4 |
| MST      |     3 |
| N/A      |     2 |
| PDT      |     8 |
+----------+-------+
(9 rows)

!ok
