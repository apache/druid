!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardComponentSupplier&datasets=sql/src/test/quidem/qatests/qaAggFuncs&numMergeBuffers=3
!set outputformat mysql
SELECT count(*) cnt
FROM test_agg_funcs;
+-----+
| cnt |
+-----+
|  18 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A01 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array[1111111111,
             2222222222] AS col;
+--------------------------+
| col                      |
+--------------------------+
| [1111111111, 2222222222] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_agg(1111111111) AS col;
+--------------+
| col          |
+--------------+
| [1111111111] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(tab0l0) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 161 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_agg(tab0l0)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  18 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset(array_agg(tab0l0), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal(array_agg(tab0l0), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=2222222222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0), 1111111111) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0), array[1111111111, 2222222222]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0), 3333333333) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(tab0l0), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(tab0l0), array[3333333333, 4444444444]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(tab0l0), array_agg(DISTINCT tab0l0)) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(tab0l0), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(tab0l0), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(tab0l0), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(tab0l0), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(array_agg(tab0l0), '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
| 161 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(array_to_string(array_agg(tab0l0), '|'), '1111111111')
AND contains_string(array_to_string(array_agg(DISTINCT tab0l0), '|'), '|') AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_prepend(3333333333, array_agg(tab0l0)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 172 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_prepend(3333333333, array_agg(tab0l0))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  19 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_append(array_agg(tab0l0), 3333333333) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 172 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_append(array_agg(tab0l0), 3333333333)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  19 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(tab0l0), array[3333333333]) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 172 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(tab0l0), array[3333333333])) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  19 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(tab0l0), array_agg(tab0l0)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 323 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(tab0l0), array_agg(tab0l0))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  36 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(tab0l0), 0, 1) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+--------------+
| col          |
+--------------+
| [1111111111] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(tab0l0), 100, 101) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A30 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT array_agg(t0.tab0l0) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0l0 IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A31 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT array_to_string(array_agg(t0.tab0l0), '') AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0l0 IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A32 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(t0.tab0l0), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0l0 IS NOT NULL;
size
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A33 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT array_agg(t0.tab0l0) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0l0;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A34 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT array_to_string(array_agg(t0.tab0l0), '') AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0l0;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test001 TEST_ID: A35 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(t0.tab0l0), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0l0;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A01 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array[1111111111,
             2222222222] AS col;
+--------------------------+
| col                      |
+--------------------------+
| [1111111111, 2222222222] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A02 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_agg(DISTINCT 1111111111) AS col;
+--------------+
| col          |
+--------------+
| [1111111111] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(DISTINCT tab0l0) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  26 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_agg(DISTINCT tab0l0)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset(array_agg(DISTINCT tab0l0), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal(array_agg(DISTINCT tab0l0), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=2222222222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0), 1111111111) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0), array[1111111111, 2222222222]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0), 3333333333) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(DISTINCT tab0l0), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(DISTINCT tab0l0), array[3333333333, 4444444444]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(DISTINCT tab0l0), array_agg(DISTINCT tab0l0)) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(DISTINCT tab0l0), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(DISTINCT tab0l0), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(DISTINCT tab0l0), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(DISTINCT tab0l0), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(array_agg(DISTINCT tab0l0), '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  26 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(array_to_string(array_agg(DISTINCT tab0l0), '|'), '1111111111')
AND contains_string(array_to_string(array_agg(DISTINCT tab0l0), '|'), '|') AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_prepend(3333333333, array_agg(DISTINCT tab0l0)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  37 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_prepend(3333333333, array_agg(DISTINCT tab0l0))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_append(array_agg(DISTINCT tab0l0), 3333333333) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  37 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_append(array_agg(DISTINCT tab0l0), 3333333333)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(DISTINCT tab0l0), array[3333333333]) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  37 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(DISTINCT tab0l0), array[3333333333])) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(DISTINCT tab0l0), array_agg(DISTINCT tab0l0)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  53 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(DISTINCT tab0l0), array_agg(DISTINCT tab0l0))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   6 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(DISTINCT tab0l0), 0, 1) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+--------------+
| col          |
+--------------+
| [1111111111] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(DISTINCT tab0l0), 100, 101) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(DISTINCT t0.tab0l0) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0l0 IS NOT NULL);
+-----+
| LEN |
+-----+
|  21 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) AS LEN
FROM
  (SELECT array_to_string(array_agg(DISTINCT t0.tab0l0), '') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0l0 IS NOT NULL);
+-----+
| LEN |
+-----+
|  20 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(DISTINCT t0.tab0l0), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0l0 IS NOT NULL;
+-----+
| col |
+-----+
|  20 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(DISTINCT t0.tab0l0) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0l0);
+-----+
| LEN |
+-----+
|  10 |
|  10 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) AS LEN
FROM
  (SELECT array_to_string(array_agg(DISTINCT t0.tab0l0), '') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0l0);
+-----+
| LEN |
+-----+
|  10 |
|  10 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test002 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(DISTINCT t0.tab0l0), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0l0;
+-----+
| col |
+-----+
|  10 |
|  10 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A01 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array[1111111111,
             2222222222] AS col;
+--------------------------+
| col                      |
+--------------------------+
| [1111111111, 2222222222] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A02 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT array_agg(DISTINCT 1111111111, 100000) AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(DISTINCT tab0l0, 100000) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  26 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_agg(DISTINCT tab0l0, 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   3 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset(array_agg(DISTINCT tab0l0, 100000), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal(array_agg(DISTINCT tab0l0, 100000), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=2222222222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0, 100000), 1111111111) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0, 100000), array[1111111111, 2222222222]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0, 100000), 3333333333) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(DISTINCT tab0l0, 100000), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(DISTINCT tab0l0, 100000), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(DISTINCT tab0l0, 100000), array[3333333333, 4444444444]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(DISTINCT tab0l0, 100000), array_agg(DISTINCT tab0l0, 100000)) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(DISTINCT tab0l0, 100000), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(DISTINCT tab0l0, 100000), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(DISTINCT tab0l0, 100000), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(DISTINCT tab0l0, 100000), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(array_agg(DISTINCT tab0l0, 100000), '|')) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  26 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(array_to_string(array_agg(DISTINCT tab0l0, 100000), '|'), '1111111111')
AND contains_string(array_to_string(array_agg(DISTINCT tab0l0, 100000), '|'), '|') AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_prepend(3333333333, array_agg(DISTINCT tab0l0, 100000)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  37 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_prepend(3333333333, array_agg(DISTINCT tab0l0, 100000))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_append(array_agg(DISTINCT tab0l0, 100000), 3333333333) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  37 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_append(array_agg(DISTINCT tab0l0, 100000), 3333333333)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(DISTINCT tab0l0, 100000), array[3333333333]) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  37 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(DISTINCT tab0l0, 100000), array[3333333333])) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(DISTINCT tab0l0, 100000), array_agg(DISTINCT tab0l0, 100000)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
|  53 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(DISTINCT tab0l0, 100000), array_agg(DISTINCT tab0l0, 100000))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|   6 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(DISTINCT tab0l0, 100000), 0, 1) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+--------------+
| col          |
+--------------+
| [1111111111] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(DISTINCT tab0l0, 100000), 100, 101) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(DISTINCT t0.tab0l0, 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0l0 IS NOT NULL);
+-----+
| LEN |
+-----+
|  21 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) AS LEN
FROM
  (SELECT array_to_string(array_agg(DISTINCT t0.tab0l0, 100000), '') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0l0 IS NOT NULL);
+-----+
| LEN |
+-----+
|  20 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(DISTINCT t0.tab0l0, 100000), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0l0 IS NOT NULL;
+-----+
| col |
+-----+
|  20 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(DISTINCT t0.tab0l0, 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0l0);
+-----+
| LEN |
+-----+
|  10 |
|  10 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) AS LEN
FROM
  (SELECT array_to_string(array_agg(DISTINCT t0.tab0l0, 100000), '') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0l0);
+-----+
| LEN |
+-----+
|  10 |
|  10 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test003 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(DISTINCT t0.tab0l0, 100000), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0l0;
+-----+
| col |
+-----+
|  10 |
|  10 |
|     |
+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A01 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array[1111111111,
             2222222222] AS col;
+--------------------------+
| col                      |
+--------------------------+
| [1111111111, 2222222222] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A02 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT array_agg(1111111111, 100000) AS col;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A03 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(tab0l0, 100000) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 161 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A04 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_agg(tab0l0, 100000)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  18 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A05 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset(array_agg(tab0l0, 100000), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A06 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal(array_agg(tab0l0, 100000), 100) AS col
FROM test_agg_funcs
WHERE tab0l0=2222222222;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A07 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0, 100000), 1111111111) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A08 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0, 100000), array[1111111111, 2222222222]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A09 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0, 100000), 3333333333) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_contains(array_agg(tab0l0, 100000), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(tab0l0, 100000), array[1111111111, 3333333333]) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A12 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(tab0l0, 100000), array[3333333333, 4444444444]) AS col
FROM test_agg_funcs;
+-------+
| col   |
+-------+
| false |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A13 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_overlap(array_agg(tab0l0, 100000), array_agg(tab0l0, 100000)) AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A14 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(tab0l0, 100000), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   0 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A15 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_offset_of(array_agg(tab0l0, 100000), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A16 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(tab0l0, 100000), 1111111111) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A17 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_ordinal_of(array_agg(tab0l0, 100000), 3333333333) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A18 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_to_string(array_agg(tab0l0, 100000), '|') AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 161 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A19 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT contains_string(array_to_string(array_agg(tab0l0, 100000), '|'), '1111111111')
AND contains_string(array_to_string(array_agg(tab0l0, 100000), '|'), '|') AS col
FROM test_agg_funcs;
+------+
| col  |
+------+
| true |
+------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_prepend(3333333333, array_agg(tab0l0, 100000)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 172 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_prepend(3333333333, array_agg(tab0l0, 100000))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  19 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_append(array_agg(tab0l0, 100000), 3333333333) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 172 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_append(array_agg(tab0l0, 100000), 3333333333)) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  19 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(tab0l0, 100000), array[3333333333]) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 172 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(tab0l0, 100000), array[3333333333])) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  19 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_concat(array_agg(tab0l0, 100000), array_agg(tab0l0, 100000)) AS col
   FROM test_agg_funcs);
+-----+
| LEN |
+-----+
| 323 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_length(array_concat(array_agg(tab0l0, 100000), array_agg(tab0l0, 100000))) AS col
FROM test_agg_funcs;
+-----+
| col |
+-----+
|  36 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(tab0l0, 100000), 0, 1) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+--------------+
| col          |
+--------------+
| [1111111111] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT array_slice(array_agg(tab0l0, 100000), 100, 101) AS col
FROM test_agg_funcs
WHERE tab0l0=1111111111;
+-----+
| col |
+-----+
|     |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(t0.tab0l0, 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0l0 IS NOT NULL);
+-------+
| LEN   |
+-------+
| 42767 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) AS LEN
FROM
  (SELECT array_to_string(array_agg(t0.tab0l0, 100000), '') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   WHERE t0.tab0l0 IS NOT NULL);
+-------+
| LEN   |
+-------+
| 38880 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A32 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(t0.tab0l0, 100000), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
WHERE t0.tab0l0 IS NOT NULL;
+-------+
| col   |
+-------+
| 38880 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A33 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(array_to_string(col, '|')) AS LEN
FROM
  (SELECT array_agg(t0.tab0l0, 100000) AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0l0);
+-------+
| LEN   |
+-------+
| 21383 |
| 21383 |
|  9719 |
+-------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A34 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT strlen(col) AS LEN
FROM
  (SELECT array_to_string(array_agg(t0.tab0l0, 100000), '') AS col
   FROM test_agg_funcs t0,
        test_agg_funcs t1,
        test_agg_funcs t2
   GROUP BY t0.tab0l0);
+-------+
| LEN   |
+-------+
| 19440 |
| 19440 |
|  7776 |
+-------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test004 TEST_ID: A35 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT length(array_to_string(array_agg(t0.tab0l0, 100000), '')) AS col
FROM test_agg_funcs t0,
     test_agg_funcs t1,
     test_agg_funcs t2
GROUP BY t0.tab0l0;
+-------+
| col   |
+-------+
| 19440 |
| 19440 |
|  7776 |
+-------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 141 Positive tests: 133 Negative tests: 8
#-------------------------------------------------------------------------
