#started Wed Jul 10 19:26:55 IST 2024
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
# Wed Jul 10 19:27:27 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:34.290 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:27:27 IST 2024
SELECT
MAX(CAST(t."__time" AS TIMESTAMP)) AS "__VALUE__"
FROM "kttm_nested" AS t
GROUP BY ();
+-------------------------+
| __VALUE__               |
+-------------------------+
| 2019-08-25 23:59:34.290 |
+-------------------------+
(1 row)

!ok
# Wed Jul 10 19:27:46 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari','Firefox','Yandex.Browser','Opera','IE','Mozilla','Silk','Yandex.Browser mobile'))
GROUP BY 1,2;
+-----------------------+-------------------------+-------+
| Browser               | __time                  | count |
+-----------------------+-------------------------+-------+
| Chrome                | 2019-08-25 00:00:00.000 |    86 |
| Chrome                | 2019-08-25 01:00:00.000 |    84 |
| Chrome                | 2019-08-25 02:00:00.000 |    94 |
| Chrome                | 2019-08-25 03:00:00.000 |    92 |
| Chrome                | 2019-08-25 04:00:00.000 |    79 |
| Chrome                | 2019-08-25 05:00:00.000 |    39 |
| Chrome                | 2019-08-25 06:00:00.000 |    38 |
| Chrome                | 2019-08-25 07:00:00.000 |    22 |
| Chrome                | 2019-08-25 08:00:00.000 |    34 |
| Chrome                | 2019-08-25 09:00:00.000 |    26 |
| Chrome                | 2019-08-25 10:00:00.000 |    41 |
| Chrome                | 2019-08-25 11:00:00.000 |    43 |
| Chrome                | 2019-08-25 12:00:00.000 |    38 |
| Chrome                | 2019-08-25 13:00:00.000 |    67 |
| Chrome                | 2019-08-25 14:00:00.000 |    99 |
| Chrome                | 2019-08-25 15:00:00.000 |    71 |
| Chrome                | 2019-08-25 16:00:00.000 |   168 |
| Chrome Mobile         | 2019-08-25 00:00:00.000 |     5 |
| Chrome Mobile         | 2019-08-25 01:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 02:00:00.000 |    21 |
| Chrome Mobile         | 2019-08-25 03:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 04:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 05:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 06:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 07:00:00.000 |     7 |
| Chrome Mobile         | 2019-08-25 08:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 09:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 10:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 11:00:00.000 |    11 |
| Chrome Mobile         | 2019-08-25 12:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 13:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 14:00:00.000 |    33 |
| Chrome Mobile         | 2019-08-25 15:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 16:00:00.000 |    31 |
| Firefox               | 2019-08-25 00:00:00.000 |     2 |
| Firefox               | 2019-08-25 02:00:00.000 |     4 |
| Firefox               | 2019-08-25 03:00:00.000 |     2 |
| Firefox               | 2019-08-25 04:00:00.000 |     1 |
| Firefox               | 2019-08-25 05:00:00.000 |     3 |
| Firefox               | 2019-08-25 06:00:00.000 |     2 |
| Firefox               | 2019-08-25 07:00:00.000 |     1 |
| Firefox               | 2019-08-25 08:00:00.000 |     2 |
| Firefox               | 2019-08-25 09:00:00.000 |     2 |
| Firefox               | 2019-08-25 10:00:00.000 |     1 |
| Firefox               | 2019-08-25 11:00:00.000 |     1 |
| Firefox               | 2019-08-25 12:00:00.000 |     4 |
| Firefox               | 2019-08-25 13:00:00.000 |     1 |
| Firefox               | 2019-08-25 14:00:00.000 |     4 |
| Firefox               | 2019-08-25 15:00:00.000 |     7 |
| Firefox               | 2019-08-25 16:00:00.000 |     5 |
| IE                    | 2019-08-25 01:00:00.000 |     1 |
| Mobile Safari         | 2019-08-25 00:00:00.000 |    24 |
| Mobile Safari         | 2019-08-25 01:00:00.000 |    27 |
| Mobile Safari         | 2019-08-25 02:00:00.000 |    38 |
| Mobile Safari         | 2019-08-25 03:00:00.000 |    17 |
| Mobile Safari         | 2019-08-25 04:00:00.000 |    14 |
| Mobile Safari         | 2019-08-25 05:00:00.000 |    13 |
| Mobile Safari         | 2019-08-25 06:00:00.000 |    15 |
| Mobile Safari         | 2019-08-25 07:00:00.000 |     3 |
| Mobile Safari         | 2019-08-25 08:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 09:00:00.000 |     8 |
| Mobile Safari         | 2019-08-25 10:00:00.000 |     7 |
| Mobile Safari         | 2019-08-25 11:00:00.000 |    11 |
| Mobile Safari         | 2019-08-25 12:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 13:00:00.000 |    21 |
| Mobile Safari         | 2019-08-25 14:00:00.000 |    37 |
| Mobile Safari         | 2019-08-25 15:00:00.000 |    19 |
| Mobile Safari         | 2019-08-25 16:00:00.000 |   110 |
| Mozilla               | 2019-08-25 02:00:00.000 |     2 |
| Mozilla               | 2019-08-25 04:00:00.000 |     2 |
| Mozilla               | 2019-08-25 12:00:00.000 |     1 |
| Mozilla               | 2019-08-25 14:00:00.000 |     1 |
| Mozilla               | 2019-08-25 16:00:00.000 |     2 |
| Opera                 | 2019-08-25 00:00:00.000 |     1 |
| Opera                 | 2019-08-25 05:00:00.000 |     3 |
| Opera                 | 2019-08-25 08:00:00.000 |     1 |
| Opera                 | 2019-08-25 10:00:00.000 |     2 |
| Opera                 | 2019-08-25 11:00:00.000 |     2 |
| Opera                 | 2019-08-25 12:00:00.000 |     1 |
| Opera                 | 2019-08-25 13:00:00.000 |     2 |
| Opera                 | 2019-08-25 14:00:00.000 |     2 |
| Opera                 | 2019-08-25 16:00:00.000 |     4 |
| Safari                | 2019-08-25 00:00:00.000 |     6 |
| Safari                | 2019-08-25 01:00:00.000 |    13 |
| Safari                | 2019-08-25 02:00:00.000 |    12 |
| Safari                | 2019-08-25 03:00:00.000 |    10 |
| Safari                | 2019-08-25 04:00:00.000 |    11 |
| Safari                | 2019-08-25 05:00:00.000 |     8 |
| Safari                | 2019-08-25 06:00:00.000 |     3 |
| Safari                | 2019-08-25 07:00:00.000 |     4 |
| Safari                | 2019-08-25 08:00:00.000 |     4 |
| Safari                | 2019-08-25 09:00:00.000 |     1 |
| Safari                | 2019-08-25 10:00:00.000 |     3 |
| Safari                | 2019-08-25 12:00:00.000 |     6 |
| Safari                | 2019-08-25 13:00:00.000 |    13 |
| Safari                | 2019-08-25 14:00:00.000 |    15 |
| Safari                | 2019-08-25 15:00:00.000 |    10 |
| Safari                | 2019-08-25 16:00:00.000 |    36 |
| Silk                  | 2019-08-25 00:00:00.000 |     1 |
| Silk                  | 2019-08-25 04:00:00.000 |     1 |
| Silk                  | 2019-08-25 11:00:00.000 |     2 |
| Silk                  | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 00:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 07:00:00.000 |     5 |
| Yandex.Browser        | 2019-08-25 08:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 09:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 10:00:00.000 |     4 |
| Yandex.Browser        | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 12:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 13:00:00.000 |     6 |
| Yandex.Browser        | 2019-08-25 14:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 15:00:00.000 |     3 |
| Yandex.Browser        | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser mobile | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser mobile | 2019-08-25 12:00:00.000 |     1 |
+-----------------------+-------------------------+-------+
(115 rows)

!ok
# Wed Jul 10 19:27:48 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari','Firefox','Yandex.Browser','Opera','IE','Mozilla','Silk','Yandex.Browser mobile'))
GROUP BY 1,2;
+---------+--------+-------+
| Browser | __time | count |
+---------+--------+-------+
+---------+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:27:52 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) AS "Category",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00')
GROUP BY 1
ORDER BY "count" DESC
LIMIT 101;
+-------------------+-------+
| Category          | count |
+-------------------+-------+
| Personal computer |  2933 |
| Smartphone        |  1619 |
| Tablet            |   128 |
| Game console      |     1 |
+-------------------+-------+
(4 rows)

!ok
# Wed Jul 10 19:27:52 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) AS "Category",
(COUNT(*)) AS "_cmp_count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Personal computer','Smartphone','Tablet','Game console','Smart TV',''))
GROUP BY 1
ORDER BY "_cmp_count" DESC
LIMIT 101;
+----------+------------+
| Category | _cmp_count |
+----------+------------+
+----------+------------+
(0 rows)

!ok
# Wed Jul 10 19:27:55 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR)='Tablet'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+---------------+-------+
| Browser       | count |
+---------------+-------+
| Mobile Safari |   107 |
| Silk          |    11 |
| Chrome Mobile |     9 |
| Puffin        |     1 |
+---------------+-------+
(4 rows)

!ok
# Wed Jul 10 19:27:55 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v1"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR)='Tablet'))
GROUP BY ();
+-----+----+
| v0  | v1 |
+-----+----+
| 128 |  0 |
+-----+----+
(1 row)

!ok
# Wed Jul 10 19:27:55 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR)='Tablet'))
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |     8 |
| 2019-08-25 01:00:00.000 |     1 |
| 2019-08-25 02:00:00.000 |     4 |
| 2019-08-25 03:00:00.000 |     1 |
| 2019-08-25 04:00:00.000 |     3 |
| 2019-08-25 05:00:00.000 |     1 |
| 2019-08-25 06:00:00.000 |     1 |
| 2019-08-25 08:00:00.000 |     1 |
| 2019-08-25 09:00:00.000 |     1 |
| 2019-08-25 10:00:00.000 |     1 |
| 2019-08-25 11:00:00.000 |     4 |
| 2019-08-25 12:00:00.000 |     1 |
| 2019-08-25 13:00:00.000 |     5 |
| 2019-08-25 14:00:00.000 |     2 |
| 2019-08-25 15:00:00.000 |     1 |
| 2019-08-25 16:00:00.000 |    13 |
+-------------------------+-------+
(16 rows)

!ok
# Wed Jul 10 19:27:55 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR)='Tablet')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Silk','Chrome Mobile','Puffin','Yandex.Browser mobile'))
GROUP BY 1,2;
+---------------+-------------------------+-------+
| Browser       | __time                  | count |
+---------------+-------------------------+-------+
| Chrome Mobile | 2019-08-25 01:00:00.000 |     1 |
| Chrome Mobile | 2019-08-25 03:00:00.000 |     1 |
| Chrome Mobile | 2019-08-25 04:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 00:00:00.000 |     7 |
| Mobile Safari | 2019-08-25 02:00:00.000 |     4 |
| Mobile Safari | 2019-08-25 04:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 05:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 06:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 08:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 09:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 10:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 11:00:00.000 |     2 |
| Mobile Safari | 2019-08-25 12:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 13:00:00.000 |     5 |
| Mobile Safari | 2019-08-25 14:00:00.000 |     2 |
| Mobile Safari | 2019-08-25 15:00:00.000 |     1 |
| Mobile Safari | 2019-08-25 16:00:00.000 |    11 |
| Silk          | 2019-08-25 00:00:00.000 |     1 |
| Silk          | 2019-08-25 04:00:00.000 |     1 |
| Silk          | 2019-08-25 11:00:00.000 |     2 |
| Silk          | 2019-08-25 16:00:00.000 |     2 |
+---------------+-------------------------+-------+
(21 rows)

!ok
# Wed Jul 10 19:27:55 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 17:00:00') AND (CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR)='Tablet')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Silk','Chrome Mobile','Puffin','Yandex.Browser mobile'))
GROUP BY 1,2;
+---------+--------+-------+
| Browser | __time | count |
+---------+--------+-------+
+---------+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:27:57 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------------+-------+
| Browser               | count |
+-----------------------+-------+
| Mobile Safari         |  1129 |
| Chrome Mobile         |   597 |
| Silk                  |    11 |
| Yandex.Browser mobile |     4 |
| Mobile Firefox        |     3 |
| Puffin                |     2 |
| Android browser       |     1 |
+-----------------------+-------+
(7 rows)

!ok
# Wed Jul 10 19:27:57 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v1"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone'))
GROUP BY ();
+------+----+
| v0   | v1 |
+------+----+
| 1747 |  0 |
+------+----+
(1 row)

!ok
# Wed Jul 10 19:27:57 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone'))
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |    30 |
| 2019-08-25 01:00:00.000 |    37 |
| 2019-08-25 02:00:00.000 |    59 |
| 2019-08-25 03:00:00.000 |    29 |
| 2019-08-25 04:00:00.000 |    25 |
| 2019-08-25 05:00:00.000 |    27 |
| 2019-08-25 06:00:00.000 |    25 |
| 2019-08-25 07:00:00.000 |    11 |
| 2019-08-25 08:00:00.000 |    24 |
| 2019-08-25 09:00:00.000 |    23 |
| 2019-08-25 10:00:00.000 |    19 |
| 2019-08-25 11:00:00.000 |    27 |
| 2019-08-25 12:00:00.000 |    26 |
| 2019-08-25 13:00:00.000 |    37 |
| 2019-08-25 14:00:00.000 |    70 |
| 2019-08-25 15:00:00.000 |    33 |
| 2019-08-25 16:00:00.000 |   143 |
+-------------------------+-------+
(17 rows)

!ok
# Wed Jul 10 19:27:57 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome Mobile','Silk','Yandex.Browser mobile','Mobile Firefox','Puffin','Opera Mobile','Android browser','IE Mobile'))
GROUP BY 1,2;
+-----------------------+-------------------------+-------+
| Browser               | __time                  | count |
+-----------------------+-------------------------+-------+
| Chrome Mobile         | 2019-08-25 00:00:00.000 |     5 |
| Chrome Mobile         | 2019-08-25 01:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 02:00:00.000 |    21 |
| Chrome Mobile         | 2019-08-25 03:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 04:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 05:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 06:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 07:00:00.000 |     7 |
| Chrome Mobile         | 2019-08-25 08:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 09:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 10:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 11:00:00.000 |    11 |
| Chrome Mobile         | 2019-08-25 12:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 13:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 14:00:00.000 |    33 |
| Chrome Mobile         | 2019-08-25 15:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 16:00:00.000 |    31 |
| Mobile Firefox        | 2019-08-25 07:00:00.000 |     1 |
| Mobile Firefox        | 2019-08-25 11:00:00.000 |     2 |
| Mobile Safari         | 2019-08-25 00:00:00.000 |    24 |
| Mobile Safari         | 2019-08-25 01:00:00.000 |    27 |
| Mobile Safari         | 2019-08-25 02:00:00.000 |    38 |
| Mobile Safari         | 2019-08-25 03:00:00.000 |    17 |
| Mobile Safari         | 2019-08-25 04:00:00.000 |    14 |
| Mobile Safari         | 2019-08-25 05:00:00.000 |    13 |
| Mobile Safari         | 2019-08-25 06:00:00.000 |    15 |
| Mobile Safari         | 2019-08-25 07:00:00.000 |     3 |
| Mobile Safari         | 2019-08-25 08:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 09:00:00.000 |     8 |
| Mobile Safari         | 2019-08-25 10:00:00.000 |     7 |
| Mobile Safari         | 2019-08-25 11:00:00.000 |    11 |
| Mobile Safari         | 2019-08-25 12:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 13:00:00.000 |    21 |
| Mobile Safari         | 2019-08-25 14:00:00.000 |    37 |
| Mobile Safari         | 2019-08-25 15:00:00.000 |    19 |
| Mobile Safari         | 2019-08-25 16:00:00.000 |   110 |
| Silk                  | 2019-08-25 00:00:00.000 |     1 |
| Silk                  | 2019-08-25 04:00:00.000 |     1 |
| Silk                  | 2019-08-25 11:00:00.000 |     2 |
| Silk                  | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser mobile | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser mobile | 2019-08-25 12:00:00.000 |     1 |
+-----------------------+-------------------------+-------+
(42 rows)

!ok
# Wed Jul 10 19:27:57 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Mobile Safari','Chrome Mobile','Silk','Yandex.Browser mobile','Mobile Firefox','Puffin','Opera Mobile','Android browser','IE Mobile'))
GROUP BY 1,2;
+---------+--------+-------+
| Browser | __time | count |
+---------+--------+-------+
+---------+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:27:58 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------------+-------+
| Browser               | count |
+-----------------------+-------+
| Chrome                |  2395 |
| Mobile Safari         |  1129 |
| Chrome Mobile         |   597 |
| Safari                |   376 |
| Firefox               |    76 |
| Yandex.Browser        |    38 |
| Opera                 |    28 |
| Mozilla               |    11 |
| Silk                  |    11 |
| IE                    |     8 |
| Yandex.Browser mobile |     4 |
| Mobile Firefox        |     3 |
| Puffin                |     2 |
| Android browser       |     1 |
| Chromium              |     1 |
+-----------------------+-------+
(15 rows)

!ok
# Wed Jul 10 19:27:58 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v1"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer'))
GROUP BY ();
+------+----+
| v0   | v1 |
+------+----+
| 4680 |  0 |
+------+----+
(1 row)

!ok
# Wed Jul 10 19:27:58 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer'))
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |   127 |
| 2019-08-25 01:00:00.000 |   135 |
| 2019-08-25 02:00:00.000 |   171 |
| 2019-08-25 03:00:00.000 |   133 |
| 2019-08-25 04:00:00.000 |   118 |
| 2019-08-25 05:00:00.000 |    80 |
| 2019-08-25 06:00:00.000 |    68 |
| 2019-08-25 07:00:00.000 |    43 |
| 2019-08-25 08:00:00.000 |    66 |
| 2019-08-25 09:00:00.000 |    53 |
| 2019-08-25 10:00:00.000 |    70 |
| 2019-08-25 11:00:00.000 |    74 |
| 2019-08-25 12:00:00.000 |    77 |
| 2019-08-25 13:00:00.000 |   127 |
| 2019-08-25 14:00:00.000 |   193 |
| 2019-08-25 15:00:00.000 |   124 |
| 2019-08-25 16:00:00.000 |   360 |
+-------------------------+-------+
(17 rows)

!ok
# Wed Jul 10 19:27:58 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari','Firefox','Yandex.Browser','Opera','IE','Mozilla','Silk','Yandex.Browser mobile'))
GROUP BY 1,2;
+-----------------------+-------------------------+-------+
| Browser               | __time                  | count |
+-----------------------+-------------------------+-------+
| Chrome                | 2019-08-25 00:00:00.000 |    86 |
| Chrome                | 2019-08-25 01:00:00.000 |    84 |
| Chrome                | 2019-08-25 02:00:00.000 |    94 |
| Chrome                | 2019-08-25 03:00:00.000 |    92 |
| Chrome                | 2019-08-25 04:00:00.000 |    79 |
| Chrome                | 2019-08-25 05:00:00.000 |    39 |
| Chrome                | 2019-08-25 06:00:00.000 |    38 |
| Chrome                | 2019-08-25 07:00:00.000 |    22 |
| Chrome                | 2019-08-25 08:00:00.000 |    34 |
| Chrome                | 2019-08-25 09:00:00.000 |    26 |
| Chrome                | 2019-08-25 10:00:00.000 |    41 |
| Chrome                | 2019-08-25 11:00:00.000 |    43 |
| Chrome                | 2019-08-25 12:00:00.000 |    38 |
| Chrome                | 2019-08-25 13:00:00.000 |    67 |
| Chrome                | 2019-08-25 14:00:00.000 |    99 |
| Chrome                | 2019-08-25 15:00:00.000 |    71 |
| Chrome                | 2019-08-25 16:00:00.000 |   168 |
| Chrome Mobile         | 2019-08-25 00:00:00.000 |     5 |
| Chrome Mobile         | 2019-08-25 01:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 02:00:00.000 |    21 |
| Chrome Mobile         | 2019-08-25 03:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 04:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 05:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 06:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 07:00:00.000 |     7 |
| Chrome Mobile         | 2019-08-25 08:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 09:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 10:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 11:00:00.000 |    11 |
| Chrome Mobile         | 2019-08-25 12:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 13:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 14:00:00.000 |    33 |
| Chrome Mobile         | 2019-08-25 15:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 16:00:00.000 |    31 |
| Firefox               | 2019-08-25 00:00:00.000 |     2 |
| Firefox               | 2019-08-25 02:00:00.000 |     4 |
| Firefox               | 2019-08-25 03:00:00.000 |     2 |
| Firefox               | 2019-08-25 04:00:00.000 |     1 |
| Firefox               | 2019-08-25 05:00:00.000 |     3 |
| Firefox               | 2019-08-25 06:00:00.000 |     2 |
| Firefox               | 2019-08-25 07:00:00.000 |     1 |
| Firefox               | 2019-08-25 08:00:00.000 |     2 |
| Firefox               | 2019-08-25 09:00:00.000 |     2 |
| Firefox               | 2019-08-25 10:00:00.000 |     1 |
| Firefox               | 2019-08-25 11:00:00.000 |     1 |
| Firefox               | 2019-08-25 12:00:00.000 |     4 |
| Firefox               | 2019-08-25 13:00:00.000 |     1 |
| Firefox               | 2019-08-25 14:00:00.000 |     4 |
| Firefox               | 2019-08-25 15:00:00.000 |     7 |
| Firefox               | 2019-08-25 16:00:00.000 |     5 |
| IE                    | 2019-08-25 01:00:00.000 |     1 |
| Mobile Safari         | 2019-08-25 00:00:00.000 |    24 |
| Mobile Safari         | 2019-08-25 01:00:00.000 |    27 |
| Mobile Safari         | 2019-08-25 02:00:00.000 |    38 |
| Mobile Safari         | 2019-08-25 03:00:00.000 |    17 |
| Mobile Safari         | 2019-08-25 04:00:00.000 |    14 |
| Mobile Safari         | 2019-08-25 05:00:00.000 |    13 |
| Mobile Safari         | 2019-08-25 06:00:00.000 |    15 |
| Mobile Safari         | 2019-08-25 07:00:00.000 |     3 |
| Mobile Safari         | 2019-08-25 08:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 09:00:00.000 |     8 |
| Mobile Safari         | 2019-08-25 10:00:00.000 |     7 |
| Mobile Safari         | 2019-08-25 11:00:00.000 |    11 |
| Mobile Safari         | 2019-08-25 12:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 13:00:00.000 |    21 |
| Mobile Safari         | 2019-08-25 14:00:00.000 |    37 |
| Mobile Safari         | 2019-08-25 15:00:00.000 |    19 |
| Mobile Safari         | 2019-08-25 16:00:00.000 |   110 |
| Mozilla               | 2019-08-25 02:00:00.000 |     2 |
| Mozilla               | 2019-08-25 04:00:00.000 |     2 |
| Mozilla               | 2019-08-25 12:00:00.000 |     1 |
| Mozilla               | 2019-08-25 14:00:00.000 |     1 |
| Mozilla               | 2019-08-25 16:00:00.000 |     2 |
| Opera                 | 2019-08-25 00:00:00.000 |     1 |
| Opera                 | 2019-08-25 05:00:00.000 |     3 |
| Opera                 | 2019-08-25 08:00:00.000 |     1 |
| Opera                 | 2019-08-25 10:00:00.000 |     2 |
| Opera                 | 2019-08-25 11:00:00.000 |     2 |
| Opera                 | 2019-08-25 12:00:00.000 |     1 |
| Opera                 | 2019-08-25 13:00:00.000 |     2 |
| Opera                 | 2019-08-25 14:00:00.000 |     2 |
| Opera                 | 2019-08-25 16:00:00.000 |     4 |
| Safari                | 2019-08-25 00:00:00.000 |     6 |
| Safari                | 2019-08-25 01:00:00.000 |    13 |
| Safari                | 2019-08-25 02:00:00.000 |    12 |
| Safari                | 2019-08-25 03:00:00.000 |    10 |
| Safari                | 2019-08-25 04:00:00.000 |    11 |
| Safari                | 2019-08-25 05:00:00.000 |     8 |
| Safari                | 2019-08-25 06:00:00.000 |     3 |
| Safari                | 2019-08-25 07:00:00.000 |     4 |
| Safari                | 2019-08-25 08:00:00.000 |     4 |
| Safari                | 2019-08-25 09:00:00.000 |     1 |
| Safari                | 2019-08-25 10:00:00.000 |     3 |
| Safari                | 2019-08-25 12:00:00.000 |     6 |
| Safari                | 2019-08-25 13:00:00.000 |    13 |
| Safari                | 2019-08-25 14:00:00.000 |    15 |
| Safari                | 2019-08-25 15:00:00.000 |    10 |
| Safari                | 2019-08-25 16:00:00.000 |    36 |
| Silk                  | 2019-08-25 00:00:00.000 |     1 |
| Silk                  | 2019-08-25 04:00:00.000 |     1 |
| Silk                  | 2019-08-25 11:00:00.000 |     2 |
| Silk                  | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 00:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 07:00:00.000 |     5 |
| Yandex.Browser        | 2019-08-25 08:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 09:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 10:00:00.000 |     4 |
| Yandex.Browser        | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 12:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 13:00:00.000 |     6 |
| Yandex.Browser        | 2019-08-25 14:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 15:00:00.000 |     3 |
| Yandex.Browser        | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser mobile | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser mobile | 2019-08-25 12:00:00.000 |     1 |
+-----------------------+-------------------------+-------+
(115 rows)

!ok
# Wed Jul 10 19:27:59 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari','Firefox','Yandex.Browser','Opera','IE','Mozilla','Silk','Yandex.Browser mobile'))
GROUP BY 1,2;
+---------+--------+-------+
| Browser | __time | count |
+---------+--------+-------+
+---------+--------+-------+
(0 rows)

!ok
# Wed Jul 10 19:28:02 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer','Game console'))
GROUP BY 1
ORDER BY "count" DESC
LIMIT 1000;
+-----------------------+-------+
| Browser               | count |
+-----------------------+-------+
| Chrome                |  2395 |
| Mobile Safari         |  1129 |
| Chrome Mobile         |   597 |
| Safari                |   376 |
| Firefox               |    76 |
| Yandex.Browser        |    38 |
| Opera                 |    28 |
| Mozilla               |    11 |
| Silk                  |    11 |
| IE                    |     8 |
| Yandex.Browser mobile |     4 |
| Mobile Firefox        |     3 |
| Puffin                |     2 |
| Android browser       |     1 |
| Chromium              |     1 |
| PS4 Web browser       |     1 |
+-----------------------+-------+
(16 rows)

!ok
# Wed Jul 10 19:28:02 IST 2024
SELECT
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00'))) AS "v0",
(COUNT(*) FILTER (WHERE (TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 00:00:00'))) AS "v1"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-26 00:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer','Game console'))
GROUP BY ();
+------+----+
| v0   | v1 |
+------+----+
| 4681 |  0 |
+------+----+
(1 row)

!ok
# Wed Jul 10 19:28:02 IST 2024
SELECT
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE ((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer','Game console'))
GROUP BY 1;
+-------------------------+-------+
| __time                  | count |
+-------------------------+-------+
| 2019-08-25 00:00:00.000 |   127 |
| 2019-08-25 01:00:00.000 |   135 |
| 2019-08-25 02:00:00.000 |   171 |
| 2019-08-25 03:00:00.000 |   133 |
| 2019-08-25 04:00:00.000 |   118 |
| 2019-08-25 05:00:00.000 |    80 |
| 2019-08-25 06:00:00.000 |    68 |
| 2019-08-25 07:00:00.000 |    43 |
| 2019-08-25 08:00:00.000 |    66 |
| 2019-08-25 09:00:00.000 |    53 |
| 2019-08-25 10:00:00.000 |    70 |
| 2019-08-25 11:00:00.000 |    74 |
| 2019-08-25 12:00:00.000 |    77 |
| 2019-08-25 13:00:00.000 |   127 |
| 2019-08-25 14:00:00.000 |   193 |
| 2019-08-25 15:00:00.000 |   124 |
| 2019-08-25 16:00:00.000 |   360 |
+-------------------------+-------+
(17 rows)

!ok
# Wed Jul 10 19:28:02 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-25 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-25 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer','Game console')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari','Firefox','Yandex.Browser','Opera','IE','Mozilla','Silk','Yandex.Browser mobile'))
GROUP BY 1,2;
+-----------------------+-------------------------+-------+
| Browser               | __time                  | count |
+-----------------------+-------------------------+-------+
| Chrome                | 2019-08-25 00:00:00.000 |    86 |
| Chrome                | 2019-08-25 01:00:00.000 |    84 |
| Chrome                | 2019-08-25 02:00:00.000 |    94 |
| Chrome                | 2019-08-25 03:00:00.000 |    92 |
| Chrome                | 2019-08-25 04:00:00.000 |    79 |
| Chrome                | 2019-08-25 05:00:00.000 |    39 |
| Chrome                | 2019-08-25 06:00:00.000 |    38 |
| Chrome                | 2019-08-25 07:00:00.000 |    22 |
| Chrome                | 2019-08-25 08:00:00.000 |    34 |
| Chrome                | 2019-08-25 09:00:00.000 |    26 |
| Chrome                | 2019-08-25 10:00:00.000 |    41 |
| Chrome                | 2019-08-25 11:00:00.000 |    43 |
| Chrome                | 2019-08-25 12:00:00.000 |    38 |
| Chrome                | 2019-08-25 13:00:00.000 |    67 |
| Chrome                | 2019-08-25 14:00:00.000 |    99 |
| Chrome                | 2019-08-25 15:00:00.000 |    71 |
| Chrome                | 2019-08-25 16:00:00.000 |   168 |
| Chrome Mobile         | 2019-08-25 00:00:00.000 |     5 |
| Chrome Mobile         | 2019-08-25 01:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 02:00:00.000 |    21 |
| Chrome Mobile         | 2019-08-25 03:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 04:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 05:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 06:00:00.000 |    10 |
| Chrome Mobile         | 2019-08-25 07:00:00.000 |     7 |
| Chrome Mobile         | 2019-08-25 08:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 09:00:00.000 |    15 |
| Chrome Mobile         | 2019-08-25 10:00:00.000 |    12 |
| Chrome Mobile         | 2019-08-25 11:00:00.000 |    11 |
| Chrome Mobile         | 2019-08-25 12:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 13:00:00.000 |    16 |
| Chrome Mobile         | 2019-08-25 14:00:00.000 |    33 |
| Chrome Mobile         | 2019-08-25 15:00:00.000 |    14 |
| Chrome Mobile         | 2019-08-25 16:00:00.000 |    31 |
| Firefox               | 2019-08-25 00:00:00.000 |     2 |
| Firefox               | 2019-08-25 02:00:00.000 |     4 |
| Firefox               | 2019-08-25 03:00:00.000 |     2 |
| Firefox               | 2019-08-25 04:00:00.000 |     1 |
| Firefox               | 2019-08-25 05:00:00.000 |     3 |
| Firefox               | 2019-08-25 06:00:00.000 |     2 |
| Firefox               | 2019-08-25 07:00:00.000 |     1 |
| Firefox               | 2019-08-25 08:00:00.000 |     2 |
| Firefox               | 2019-08-25 09:00:00.000 |     2 |
| Firefox               | 2019-08-25 10:00:00.000 |     1 |
| Firefox               | 2019-08-25 11:00:00.000 |     1 |
| Firefox               | 2019-08-25 12:00:00.000 |     4 |
| Firefox               | 2019-08-25 13:00:00.000 |     1 |
| Firefox               | 2019-08-25 14:00:00.000 |     4 |
| Firefox               | 2019-08-25 15:00:00.000 |     7 |
| Firefox               | 2019-08-25 16:00:00.000 |     5 |
| IE                    | 2019-08-25 01:00:00.000 |     1 |
| Mobile Safari         | 2019-08-25 00:00:00.000 |    24 |
| Mobile Safari         | 2019-08-25 01:00:00.000 |    27 |
| Mobile Safari         | 2019-08-25 02:00:00.000 |    38 |
| Mobile Safari         | 2019-08-25 03:00:00.000 |    17 |
| Mobile Safari         | 2019-08-25 04:00:00.000 |    14 |
| Mobile Safari         | 2019-08-25 05:00:00.000 |    13 |
| Mobile Safari         | 2019-08-25 06:00:00.000 |    15 |
| Mobile Safari         | 2019-08-25 07:00:00.000 |     3 |
| Mobile Safari         | 2019-08-25 08:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 09:00:00.000 |     8 |
| Mobile Safari         | 2019-08-25 10:00:00.000 |     7 |
| Mobile Safari         | 2019-08-25 11:00:00.000 |    11 |
| Mobile Safari         | 2019-08-25 12:00:00.000 |     9 |
| Mobile Safari         | 2019-08-25 13:00:00.000 |    21 |
| Mobile Safari         | 2019-08-25 14:00:00.000 |    37 |
| Mobile Safari         | 2019-08-25 15:00:00.000 |    19 |
| Mobile Safari         | 2019-08-25 16:00:00.000 |   110 |
| Mozilla               | 2019-08-25 02:00:00.000 |     2 |
| Mozilla               | 2019-08-25 04:00:00.000 |     2 |
| Mozilla               | 2019-08-25 12:00:00.000 |     1 |
| Mozilla               | 2019-08-25 14:00:00.000 |     1 |
| Mozilla               | 2019-08-25 16:00:00.000 |     2 |
| Opera                 | 2019-08-25 00:00:00.000 |     1 |
| Opera                 | 2019-08-25 05:00:00.000 |     3 |
| Opera                 | 2019-08-25 08:00:00.000 |     1 |
| Opera                 | 2019-08-25 10:00:00.000 |     2 |
| Opera                 | 2019-08-25 11:00:00.000 |     2 |
| Opera                 | 2019-08-25 12:00:00.000 |     1 |
| Opera                 | 2019-08-25 13:00:00.000 |     2 |
| Opera                 | 2019-08-25 14:00:00.000 |     2 |
| Opera                 | 2019-08-25 16:00:00.000 |     4 |
| Safari                | 2019-08-25 00:00:00.000 |     6 |
| Safari                | 2019-08-25 01:00:00.000 |    13 |
| Safari                | 2019-08-25 02:00:00.000 |    12 |
| Safari                | 2019-08-25 03:00:00.000 |    10 |
| Safari                | 2019-08-25 04:00:00.000 |    11 |
| Safari                | 2019-08-25 05:00:00.000 |     8 |
| Safari                | 2019-08-25 06:00:00.000 |     3 |
| Safari                | 2019-08-25 07:00:00.000 |     4 |
| Safari                | 2019-08-25 08:00:00.000 |     4 |
| Safari                | 2019-08-25 09:00:00.000 |     1 |
| Safari                | 2019-08-25 10:00:00.000 |     3 |
| Safari                | 2019-08-25 12:00:00.000 |     6 |
| Safari                | 2019-08-25 13:00:00.000 |    13 |
| Safari                | 2019-08-25 14:00:00.000 |    15 |
| Safari                | 2019-08-25 15:00:00.000 |    10 |
| Safari                | 2019-08-25 16:00:00.000 |    36 |
| Silk                  | 2019-08-25 00:00:00.000 |     1 |
| Silk                  | 2019-08-25 04:00:00.000 |     1 |
| Silk                  | 2019-08-25 11:00:00.000 |     2 |
| Silk                  | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 00:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 07:00:00.000 |     5 |
| Yandex.Browser        | 2019-08-25 08:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 09:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 10:00:00.000 |     4 |
| Yandex.Browser        | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 12:00:00.000 |     1 |
| Yandex.Browser        | 2019-08-25 13:00:00.000 |     6 |
| Yandex.Browser        | 2019-08-25 14:00:00.000 |     2 |
| Yandex.Browser        | 2019-08-25 15:00:00.000 |     3 |
| Yandex.Browser        | 2019-08-25 16:00:00.000 |     2 |
| Yandex.Browser mobile | 2019-08-25 11:00:00.000 |     1 |
| Yandex.Browser mobile | 2019-08-25 12:00:00.000 |     1 |
+-----------------------+-------------------------+-------+
(115 rows)

!ok
# Wed Jul 10 19:28:02 IST 2024
SELECT
CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) AS "Browser",
TIME_FLOOR(CAST(t."__time" AS TIMESTAMP), 'PT1H', NULL, 'Etc/UTC') AS "__time",
(COUNT(*)) AS "count"
FROM "kttm_nested" AS t
WHERE (((TIMESTAMP '2019-08-24 00:00:00'<=CAST(t."__time" AS TIMESTAMP) AND CAST(t."__time" AS TIMESTAMP)<TIMESTAMP '2019-08-24 17:00:00') AND CAST(JSON_VALUE("t"."agent",'$.category') AS VARCHAR) IN ('Tablet','Smartphone','Personal computer','Game console')) AND CAST(JSON_VALUE("t"."agent",'$.browser') AS VARCHAR) IN ('Chrome','Mobile Safari','Chrome Mobile','Safari','Firefox','Yandex.Browser','Opera','IE','Mozilla','Silk','Yandex.Browser mobile'))
GROUP BY 1,2;
+---------+--------+-------+
| Browser | __time | count |
+---------+--------+-------+
+---------+--------+-------+
(0 rows)

!ok
