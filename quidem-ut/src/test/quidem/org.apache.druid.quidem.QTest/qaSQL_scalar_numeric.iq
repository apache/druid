!set useApproximateCountDistinct false
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00';
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1: plain_value_numeric
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (session_length IS NULL
       OR (session_length = session_length
           AND session_length IS NOT DISTINCT
           FROM session_length
           AND session_length <> session_length-1
           AND (session_length IS DISTINCT
                FROM session_length-1)
           AND session_length > session_length-1
           AND session_length >= session_length-1
           AND session_length < session_length+1
           AND session_length <= session_length+1
           AND (session_length <> session_length-1) IS TRUE
           AND (session_length = session_length-1) IS NOT TRUE
           AND (session_length = session_length-1) IS FALSE
           AND (session_length <> session_length-1) IS NOT FALSE
           AND session_length BETWEEN session_length-1 AND session_length+1
           AND session_length NOT BETWEEN session_length AND session_length-1
           AND session_length like '%'
           AND session_length not like '__DOES_NOT_EXIST__%'
           AND session_length IN (session_length-1,
                                                session_length,
                                                session_length+1)
           AND session_length NOT IN (session_length-1,
                                                    session_length+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (session_length IS NULL
       OR session_length IN
         (SELECT session_length
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (session_length IS NULL
                 OR (session_length = session_length
                     AND session_length IS NOT DISTINCT
                     FROM session_length
                     AND session_length <> session_length-1
                     AND (session_length IS DISTINCT
                          FROM session_length-1)
                     AND session_length > session_length-1
                     AND session_length >= session_length-1
                     AND session_length < session_length+1
                     AND session_length <= session_length+1
                     AND (session_length <> session_length-1) IS TRUE
                     AND (session_length = session_length-1) IS NOT TRUE
                     AND (session_length = session_length-1) IS FALSE
                     AND (session_length <> session_length-1) IS NOT FALSE
                     AND session_length BETWEEN session_length-1 AND session_length+1
                     AND session_length NOT BETWEEN session_length AND session_length-1
                     AND session_length like '%'
                     AND session_length not like '__DOES_NOT_EXIST__%'
                     AND session_length IN (session_length-1,
                                                          session_length,
                                                          session_length+1)
                     AND session_length NOT IN (session_length-1,
                                                              session_length+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          session_length,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (session_length IS NULL
          OR (session_length = session_length
              AND session_length IS NOT DISTINCT
              FROM session_length
              AND session_length <> session_length-1
              AND (session_length IS DISTINCT
                   FROM session_length-1)
              AND session_length > session_length-1
              AND session_length >= session_length-1
              AND session_length < session_length+1
              AND session_length <= session_length+1
              AND (session_length <> session_length-1) IS TRUE
              AND (session_length = session_length-1) IS NOT TRUE
              AND (session_length = session_length-1) IS FALSE
              AND (session_length <> session_length-1) IS NOT FALSE
              AND session_length BETWEEN session_length-1 AND session_length+1
              AND session_length NOT BETWEEN session_length AND session_length-1
              AND session_length like '%'
              AND session_length not like '__DOES_NOT_EXIST__%'
              AND session_length IN (session_length-1,
                                                   session_length,
                                                   session_length+1)
              AND session_length NOT IN (session_length-1,
                                                       session_length+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A2: pi
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (pi IS NULL
       OR (pi = pi+0
           AND pi IS NOT DISTINCT
           FROM pi+0
           AND pi <> pi-1
           AND (pi IS DISTINCT
                FROM pi-1)
           AND pi > pi-1
           AND pi >= pi-1
           AND pi < pi+1
           AND pi <= pi+1
           AND (pi <> pi-1) IS TRUE
           AND (pi = pi-1) IS NOT TRUE
           AND (pi = pi-1) IS FALSE
           AND (pi <> pi-1) IS NOT FALSE
           AND pi BETWEEN pi-1 AND pi+1
           AND pi NOT BETWEEN pi AND pi-1
           AND pi like '%'
           AND pi not like '__DOES_NOT_EXIST__%'
           AND pi IN (pi-1,
                        pi+0,
                        pi+1)
           AND pi NOT IN (pi-1,
                            pi+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (pi IS NULL
       OR pi IN
         (SELECT pi
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (pi IS NULL
                 OR (pi = pi+0
                     AND pi IS NOT DISTINCT
                     FROM pi+0
                     AND pi <> pi-1
                     AND (pi IS DISTINCT
                          FROM pi-1)
                     AND pi > pi-1
                     AND pi >= pi-1
                     AND pi < pi+1
                     AND pi <= pi+1
                     AND (pi <> pi-1) IS TRUE
                     AND (pi = pi-1) IS NOT TRUE
                     AND (pi = pi-1) IS FALSE
                     AND (pi <> pi-1) IS NOT FALSE
                     AND pi BETWEEN pi-1 AND pi+1
                     AND pi NOT BETWEEN pi AND pi-1
                     AND pi like '%'
                     AND pi not like '__DOES_NOT_EXIST__%'
                     AND pi IN (pi-1,
                                  pi+0,
                                  pi+1)
                     AND pi NOT IN (pi-1,
                                      pi+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          pi,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (pi IS NULL
          OR (pi = pi+0
              AND pi IS NOT DISTINCT
              FROM pi+0
              AND pi <> pi-1
              AND (pi IS DISTINCT
                   FROM pi-1)
              AND pi > pi-1
              AND pi >= pi-1
              AND pi < pi+1
              AND pi <= pi+1
              AND (pi <> pi-1) IS TRUE
              AND (pi = pi-1) IS NOT TRUE
              AND (pi = pi-1) IS FALSE
              AND (pi <> pi-1) IS NOT FALSE
              AND pi BETWEEN pi-1 AND pi+1
              AND pi NOT BETWEEN pi AND pi-1
              AND pi like '%'
              AND pi not like '__DOES_NOT_EXIST__%'
              AND pi IN (pi-1,
                           pi+0,
                           pi+1)
              AND pi NOT IN (pi-1,
                               pi+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A3: abs
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (abs(session_length) IS NULL
       OR (abs(session_length) = abs(session_length)+0
           AND abs(session_length) IS NOT DISTINCT
           FROM abs(session_length)+0
           AND abs(session_length) <> abs(session_length)-1
           AND (abs(session_length) IS DISTINCT
                FROM abs(session_length)-1)
           AND abs(session_length) > abs(session_length)-1
           AND abs(session_length) >= abs(session_length)-1
           AND abs(session_length) < abs(session_length)+1
           AND abs(session_length) <= abs(session_length)+1
           AND (abs(session_length) <> abs(session_length)-1) IS TRUE
           AND (abs(session_length) = abs(session_length)-1) IS NOT TRUE
           AND (abs(session_length) = abs(session_length)-1) IS FALSE
           AND (abs(session_length) <> abs(session_length)-1) IS NOT FALSE
           AND abs(session_length) BETWEEN abs(session_length)-1 AND abs(session_length)+1
           AND abs(session_length) NOT BETWEEN abs(session_length) AND abs(session_length)-1
           AND abs(session_length) like '%'
           AND abs(session_length) not like '__DOES_NOT_EXIST__%'
           AND abs(session_length) IN (abs(session_length)-1,
                                                          abs(session_length)+0,
                                                          abs(session_length)+1)
           AND abs(session_length) NOT IN (abs(session_length)-1,
                                                              abs(session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (abs(session_length) IS NULL
       OR abs(session_length) IN
         (SELECT abs(session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (abs(session_length) IS NULL
                 OR (abs(session_length) = abs(session_length)+0
                     AND abs(session_length) IS NOT DISTINCT
                     FROM abs(session_length)+0
                     AND abs(session_length) <> abs(session_length)-1
                     AND (abs(session_length) IS DISTINCT
                          FROM abs(session_length)-1)
                     AND abs(session_length) > abs(session_length)-1
                     AND abs(session_length) >= abs(session_length)-1
                     AND abs(session_length) < abs(session_length)+1
                     AND abs(session_length) <= abs(session_length)+1
                     AND (abs(session_length) <> abs(session_length)-1) IS TRUE
                     AND (abs(session_length) = abs(session_length)-1) IS NOT TRUE
                     AND (abs(session_length) = abs(session_length)-1) IS FALSE
                     AND (abs(session_length) <> abs(session_length)-1) IS NOT FALSE
                     AND abs(session_length) BETWEEN abs(session_length)-1 AND abs(session_length)+1
                     AND abs(session_length) NOT BETWEEN abs(session_length) AND abs(session_length)-1
                     AND abs(session_length) like '%'
                     AND abs(session_length) not like '__DOES_NOT_EXIST__%'
                     AND abs(session_length) IN (abs(session_length)-1,
                                                                    abs(session_length)+0,
                                                                    abs(session_length)+1)
                     AND abs(session_length) NOT IN (abs(session_length)-1,
                                                                        abs(session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          abs(session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (abs(session_length) IS NULL
          OR (abs(session_length) = abs(session_length)+0
              AND abs(session_length) IS NOT DISTINCT
              FROM abs(session_length)+0
              AND abs(session_length) <> abs(session_length)-1
              AND (abs(session_length) IS DISTINCT
                   FROM abs(session_length)-1)
              AND abs(session_length) > abs(session_length)-1
              AND abs(session_length) >= abs(session_length)-1
              AND abs(session_length) < abs(session_length)+1
              AND abs(session_length) <= abs(session_length)+1
              AND (abs(session_length) <> abs(session_length)-1) IS TRUE
              AND (abs(session_length) = abs(session_length)-1) IS NOT TRUE
              AND (abs(session_length) = abs(session_length)-1) IS FALSE
              AND (abs(session_length) <> abs(session_length)-1) IS NOT FALSE
              AND abs(session_length) BETWEEN abs(session_length)-1 AND abs(session_length)+1
              AND abs(session_length) NOT BETWEEN abs(session_length) AND abs(session_length)-1
              AND abs(session_length) like '%'
              AND abs(session_length) not like '__DOES_NOT_EXIST__%'
              AND abs(session_length) IN (abs(session_length)-1,
                                                             abs(session_length)+0,
                                                             abs(session_length)+1)
              AND abs(session_length) NOT IN (abs(session_length)-1,
                                                                 abs(session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A4: ceil
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (ceil(session_length) IS NULL
       OR (ceil(session_length) = ceil(session_length)+0
           AND ceil(session_length) IS NOT DISTINCT
           FROM ceil(session_length)+0
           AND ceil(session_length) <> ceil(session_length)-1
           AND (ceil(session_length) IS DISTINCT
                FROM ceil(session_length)-1)
           AND ceil(session_length) > ceil(session_length)-1
           AND ceil(session_length) >= ceil(session_length)-1
           AND ceil(session_length) < ceil(session_length)+1
           AND ceil(session_length) <= ceil(session_length)+1
           AND (ceil(session_length) <> ceil(session_length)-1) IS TRUE
           AND (ceil(session_length) = ceil(session_length)-1) IS NOT TRUE
           AND (ceil(session_length) = ceil(session_length)-1) IS FALSE
           AND (ceil(session_length) <> ceil(session_length)-1) IS NOT FALSE
           AND ceil(session_length) BETWEEN ceil(session_length)-1 AND ceil(session_length)+1
           AND ceil(session_length) NOT BETWEEN ceil(session_length) AND ceil(session_length)-1
           AND ceil(session_length) like '%'
           AND ceil(session_length) not like '__DOES_NOT_EXIST__%'
           AND ceil(session_length) IN (ceil(session_length)-1,
                                                            ceil(session_length)+0,
                                                            ceil(session_length)+1)
           AND ceil(session_length) NOT IN (ceil(session_length)-1,
                                                                ceil(session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (ceil(session_length) IS NULL
       OR ceil(session_length) IN
         (SELECT ceil(session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (ceil(session_length) IS NULL
                 OR (ceil(session_length) = ceil(session_length)+0
                     AND ceil(session_length) IS NOT DISTINCT
                     FROM ceil(session_length)+0
                     AND ceil(session_length) <> ceil(session_length)-1
                     AND (ceil(session_length) IS DISTINCT
                          FROM ceil(session_length)-1)
                     AND ceil(session_length) > ceil(session_length)-1
                     AND ceil(session_length) >= ceil(session_length)-1
                     AND ceil(session_length) < ceil(session_length)+1
                     AND ceil(session_length) <= ceil(session_length)+1
                     AND (ceil(session_length) <> ceil(session_length)-1) IS TRUE
                     AND (ceil(session_length) = ceil(session_length)-1) IS NOT TRUE
                     AND (ceil(session_length) = ceil(session_length)-1) IS FALSE
                     AND (ceil(session_length) <> ceil(session_length)-1) IS NOT FALSE
                     AND ceil(session_length) BETWEEN ceil(session_length)-1 AND ceil(session_length)+1
                     AND ceil(session_length) NOT BETWEEN ceil(session_length) AND ceil(session_length)-1
                     AND ceil(session_length) like '%'
                     AND ceil(session_length) not like '__DOES_NOT_EXIST__%'
                     AND ceil(session_length) IN (ceil(session_length)-1,
                                                                      ceil(session_length)+0,
                                                                      ceil(session_length)+1)
                     AND ceil(session_length) NOT IN (ceil(session_length)-1,
                                                                          ceil(session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          ceil(session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (ceil(session_length) IS NULL
          OR (ceil(session_length) = ceil(session_length)+0
              AND ceil(session_length) IS NOT DISTINCT
              FROM ceil(session_length)+0
              AND ceil(session_length) <> ceil(session_length)-1
              AND (ceil(session_length) IS DISTINCT
                   FROM ceil(session_length)-1)
              AND ceil(session_length) > ceil(session_length)-1
              AND ceil(session_length) >= ceil(session_length)-1
              AND ceil(session_length) < ceil(session_length)+1
              AND ceil(session_length) <= ceil(session_length)+1
              AND (ceil(session_length) <> ceil(session_length)-1) IS TRUE
              AND (ceil(session_length) = ceil(session_length)-1) IS NOT TRUE
              AND (ceil(session_length) = ceil(session_length)-1) IS FALSE
              AND (ceil(session_length) <> ceil(session_length)-1) IS NOT FALSE
              AND ceil(session_length) BETWEEN ceil(session_length)-1 AND ceil(session_length)+1
              AND ceil(session_length) NOT BETWEEN ceil(session_length) AND ceil(session_length)-1
              AND ceil(session_length) like '%'
              AND ceil(session_length) not like '__DOES_NOT_EXIST__%'
              AND ceil(session_length) IN (ceil(session_length)-1,
                                                               ceil(session_length)+0,
                                                               ceil(session_length)+1)
              AND ceil(session_length) NOT IN (ceil(session_length)-1,
                                                                   ceil(session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5: exp
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(exp(least(session_length, 10))) IS NULL
       OR (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))+0
           AND floor(exp(least(session_length, 10))) IS NOT DISTINCT
           FROM floor(exp(least(session_length, 10)))+0
           AND floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1
           AND (floor(exp(least(session_length, 10))) IS DISTINCT
                FROM floor(exp(least(session_length, 10)))-1)
           AND floor(exp(least(session_length, 10))) > floor(exp(least(session_length, 10)))-1
           AND floor(exp(least(session_length, 10))) >= floor(exp(least(session_length, 10)))-1
           AND floor(exp(least(session_length, 10))) < floor(exp(least(session_length, 10)))+1
           AND floor(exp(least(session_length, 10))) <= floor(exp(least(session_length, 10)))+1
           AND (floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1) IS TRUE
           AND (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))-1) IS NOT TRUE
           AND (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))-1) IS FALSE
           AND (floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1) IS NOT FALSE
           AND floor(exp(least(session_length, 10))) BETWEEN floor(exp(least(session_length, 10)))-1 AND floor(exp(least(session_length, 10)))+1
           AND floor(exp(least(session_length, 10))) NOT BETWEEN floor(exp(least(session_length, 10))) AND floor(exp(least(session_length, 10)))-1
           AND floor(exp(least(session_length, 10))) like '%'
           AND floor(exp(least(session_length, 10))) not like '__DOES_NOT_EXIST__%'
           AND floor(exp(least(session_length, 10))) IN (floor(exp(least(session_length, 10)))-1,
                                                                                              floor(exp(least(session_length, 10)))+0,
                                                                                              floor(exp(least(session_length, 10)))+1)
           AND floor(exp(least(session_length, 10))) NOT IN (floor(exp(least(session_length, 10)))-1,
                                                                                                  floor(exp(least(session_length, 10)))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(exp(least(session_length, 10))) IS NULL
       OR floor(exp(least(session_length, 10))) IN
         (SELECT floor(exp(least(session_length, 10)))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(exp(least(session_length, 10))) IS NULL
                 OR (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))+0
                     AND floor(exp(least(session_length, 10))) IS NOT DISTINCT
                     FROM floor(exp(least(session_length, 10)))+0
                     AND floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1
                     AND (floor(exp(least(session_length, 10))) IS DISTINCT
                          FROM floor(exp(least(session_length, 10)))-1)
                     AND floor(exp(least(session_length, 10))) > floor(exp(least(session_length, 10)))-1
                     AND floor(exp(least(session_length, 10))) >= floor(exp(least(session_length, 10)))-1
                     AND floor(exp(least(session_length, 10))) < floor(exp(least(session_length, 10)))+1
                     AND floor(exp(least(session_length, 10))) <= floor(exp(least(session_length, 10)))+1
                     AND (floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1) IS TRUE
                     AND (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))-1) IS NOT TRUE
                     AND (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))-1) IS FALSE
                     AND (floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1) IS NOT FALSE
                     AND floor(exp(least(session_length, 10))) BETWEEN floor(exp(least(session_length, 10)))-1 AND floor(exp(least(session_length, 10)))+1
                     AND floor(exp(least(session_length, 10))) NOT BETWEEN floor(exp(least(session_length, 10))) AND floor(exp(least(session_length, 10)))-1
                     AND floor(exp(least(session_length, 10))) like '%'
                     AND floor(exp(least(session_length, 10))) not like '__DOES_NOT_EXIST__%'
                     AND floor(exp(least(session_length, 10))) IN (floor(exp(least(session_length, 10)))-1,
                                                                                                        floor(exp(least(session_length, 10)))+0,
                                                                                                        floor(exp(least(session_length, 10)))+1)
                     AND floor(exp(least(session_length, 10))) NOT IN (floor(exp(least(session_length, 10)))-1,
                                                                                                            floor(exp(least(session_length, 10)))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(exp(least(session_length, 10))),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(exp(least(session_length, 10))) IS NULL
          OR (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))+0
              AND floor(exp(least(session_length, 10))) IS NOT DISTINCT
              FROM floor(exp(least(session_length, 10)))+0
              AND floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1
              AND (floor(exp(least(session_length, 10))) IS DISTINCT
                   FROM floor(exp(least(session_length, 10)))-1)
              AND floor(exp(least(session_length, 10))) > floor(exp(least(session_length, 10)))-1
              AND floor(exp(least(session_length, 10))) >= floor(exp(least(session_length, 10)))-1
              AND floor(exp(least(session_length, 10))) < floor(exp(least(session_length, 10)))+1
              AND floor(exp(least(session_length, 10))) <= floor(exp(least(session_length, 10)))+1
              AND (floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1) IS TRUE
              AND (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))-1) IS NOT TRUE
              AND (floor(exp(least(session_length, 10))) = floor(exp(least(session_length, 10)))-1) IS FALSE
              AND (floor(exp(least(session_length, 10))) <> floor(exp(least(session_length, 10)))-1) IS NOT FALSE
              AND floor(exp(least(session_length, 10))) BETWEEN floor(exp(least(session_length, 10)))-1 AND floor(exp(least(session_length, 10)))+1
              AND floor(exp(least(session_length, 10))) NOT BETWEEN floor(exp(least(session_length, 10))) AND floor(exp(least(session_length, 10)))-1
              AND floor(exp(least(session_length, 10))) like '%'
              AND floor(exp(least(session_length, 10))) not like '__DOES_NOT_EXIST__%'
              AND floor(exp(least(session_length, 10))) IN (floor(exp(least(session_length, 10)))-1,
                                                                                                 floor(exp(least(session_length, 10)))+0,
                                                                                                 floor(exp(least(session_length, 10)))+1)
              AND floor(exp(least(session_length, 10))) NOT IN (floor(exp(least(session_length, 10)))-1,
                                                                                                     floor(exp(least(session_length, 10)))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A6: floor
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(session_length) IS NULL
       OR (floor(session_length) = floor(session_length)+0
           AND floor(session_length) IS NOT DISTINCT
           FROM floor(session_length)+0
           AND floor(session_length) <> floor(session_length)-1
           AND (floor(session_length) IS DISTINCT
                FROM floor(session_length)-1)
           AND floor(session_length) > floor(session_length)-1
           AND floor(session_length) >= floor(session_length)-1
           AND floor(session_length) < floor(session_length)+1
           AND floor(session_length) <= floor(session_length)+1
           AND (floor(session_length) <> floor(session_length)-1) IS TRUE
           AND (floor(session_length) = floor(session_length)-1) IS NOT TRUE
           AND (floor(session_length) = floor(session_length)-1) IS FALSE
           AND (floor(session_length) <> floor(session_length)-1) IS NOT FALSE
           AND floor(session_length) BETWEEN floor(session_length)-1 AND floor(session_length)+1
           AND floor(session_length) NOT BETWEEN floor(session_length) AND floor(session_length)-1
           AND floor(session_length) like '%'
           AND floor(session_length) not like '__DOES_NOT_EXIST__%'
           AND floor(session_length) IN (floor(session_length)-1,
                                                              floor(session_length)+0,
                                                              floor(session_length)+1)
           AND floor(session_length) NOT IN (floor(session_length)-1,
                                                                  floor(session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(session_length) IS NULL
       OR floor(session_length) IN
         (SELECT floor(session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(session_length) IS NULL
                 OR (floor(session_length) = floor(session_length)+0
                     AND floor(session_length) IS NOT DISTINCT
                     FROM floor(session_length)+0
                     AND floor(session_length) <> floor(session_length)-1
                     AND (floor(session_length) IS DISTINCT
                          FROM floor(session_length)-1)
                     AND floor(session_length) > floor(session_length)-1
                     AND floor(session_length) >= floor(session_length)-1
                     AND floor(session_length) < floor(session_length)+1
                     AND floor(session_length) <= floor(session_length)+1
                     AND (floor(session_length) <> floor(session_length)-1) IS TRUE
                     AND (floor(session_length) = floor(session_length)-1) IS NOT TRUE
                     AND (floor(session_length) = floor(session_length)-1) IS FALSE
                     AND (floor(session_length) <> floor(session_length)-1) IS NOT FALSE
                     AND floor(session_length) BETWEEN floor(session_length)-1 AND floor(session_length)+1
                     AND floor(session_length) NOT BETWEEN floor(session_length) AND floor(session_length)-1
                     AND floor(session_length) like '%'
                     AND floor(session_length) not like '__DOES_NOT_EXIST__%'
                     AND floor(session_length) IN (floor(session_length)-1,
                                                                        floor(session_length)+0,
                                                                        floor(session_length)+1)
                     AND floor(session_length) NOT IN (floor(session_length)-1,
                                                                            floor(session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(session_length) IS NULL
          OR (floor(session_length) = floor(session_length)+0
              AND floor(session_length) IS NOT DISTINCT
              FROM floor(session_length)+0
              AND floor(session_length) <> floor(session_length)-1
              AND (floor(session_length) IS DISTINCT
                   FROM floor(session_length)-1)
              AND floor(session_length) > floor(session_length)-1
              AND floor(session_length) >= floor(session_length)-1
              AND floor(session_length) < floor(session_length)+1
              AND floor(session_length) <= floor(session_length)+1
              AND (floor(session_length) <> floor(session_length)-1) IS TRUE
              AND (floor(session_length) = floor(session_length)-1) IS NOT TRUE
              AND (floor(session_length) = floor(session_length)-1) IS FALSE
              AND (floor(session_length) <> floor(session_length)-1) IS NOT FALSE
              AND floor(session_length) BETWEEN floor(session_length)-1 AND floor(session_length)+1
              AND floor(session_length) NOT BETWEEN floor(session_length) AND floor(session_length)-1
              AND floor(session_length) like '%'
              AND floor(session_length) not like '__DOES_NOT_EXIST__%'
              AND floor(session_length) IN (floor(session_length)-1,
                                                                 floor(session_length)+0,
                                                                 floor(session_length)+1)
              AND floor(session_length) NOT IN (floor(session_length)-1,
                                                                     floor(session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A7: ln
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(ln(greatest(least(session_length, 100), 1))) IS NULL
       OR (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))+0
           AND floor(ln(greatest(least(session_length, 100), 1))) IS NOT DISTINCT
           FROM floor(ln(greatest(least(session_length, 100), 1)))+0
           AND floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1
           AND (floor(ln(greatest(least(session_length, 100), 1))) IS DISTINCT
                FROM floor(ln(greatest(least(session_length, 100), 1)))-1)
           AND floor(ln(greatest(least(session_length, 100), 1))) > floor(ln(greatest(least(session_length, 100), 1)))-1
           AND floor(ln(greatest(least(session_length, 100), 1))) >= floor(ln(greatest(least(session_length, 100), 1)))-1
           AND floor(ln(greatest(least(session_length, 100), 1))) < floor(ln(greatest(least(session_length, 100), 1)))+1
           AND floor(ln(greatest(least(session_length, 100), 1))) <= floor(ln(greatest(least(session_length, 100), 1)))+1
           AND (floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1) IS TRUE
           AND (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))-1) IS NOT TRUE
           AND (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))-1) IS FALSE
           AND (floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1) IS NOT FALSE
           AND floor(ln(greatest(least(session_length, 100), 1))) BETWEEN floor(ln(greatest(least(session_length, 100), 1)))-1 AND floor(ln(greatest(least(session_length, 100), 1)))+1
           AND floor(ln(greatest(least(session_length, 100), 1))) NOT BETWEEN floor(ln(greatest(least(session_length, 100), 1))) AND floor(ln(greatest(least(session_length, 100), 1)))-1
           AND floor(ln(greatest(least(session_length, 100), 1))) like '%'
           AND floor(ln(greatest(least(session_length, 100), 1))) not like '__DOES_NOT_EXIST__%'
           AND floor(ln(greatest(least(session_length, 100), 1))) IN (floor(ln(greatest(least(session_length, 100), 1)))-1,
                                                                                                                        floor(ln(greatest(least(session_length, 100), 1)))+0,
                                                                                                                        floor(ln(greatest(least(session_length, 100), 1)))+1)
           AND floor(ln(greatest(least(session_length, 100), 1))) NOT IN (floor(ln(greatest(least(session_length, 100), 1)))-1,
                                                                                                                            floor(ln(greatest(least(session_length, 100), 1)))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(ln(greatest(least(session_length, 100), 1))) IS NULL
       OR floor(ln(greatest(least(session_length, 100), 1))) IN
         (SELECT floor(ln(greatest(least(session_length, 100), 1)))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(ln(greatest(least(session_length, 100), 1))) IS NULL
                 OR (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))+0
                     AND floor(ln(greatest(least(session_length, 100), 1))) IS NOT DISTINCT
                     FROM floor(ln(greatest(least(session_length, 100), 1)))+0
                     AND floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1
                     AND (floor(ln(greatest(least(session_length, 100), 1))) IS DISTINCT
                          FROM floor(ln(greatest(least(session_length, 100), 1)))-1)
                     AND floor(ln(greatest(least(session_length, 100), 1))) > floor(ln(greatest(least(session_length, 100), 1)))-1
                     AND floor(ln(greatest(least(session_length, 100), 1))) >= floor(ln(greatest(least(session_length, 100), 1)))-1
                     AND floor(ln(greatest(least(session_length, 100), 1))) < floor(ln(greatest(least(session_length, 100), 1)))+1
                     AND floor(ln(greatest(least(session_length, 100), 1))) <= floor(ln(greatest(least(session_length, 100), 1)))+1
                     AND (floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1) IS TRUE
                     AND (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))-1) IS NOT TRUE
                     AND (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))-1) IS FALSE
                     AND (floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1) IS NOT FALSE
                     AND floor(ln(greatest(least(session_length, 100), 1))) BETWEEN floor(ln(greatest(least(session_length, 100), 1)))-1 AND floor(ln(greatest(least(session_length, 100), 1)))+1
                     AND floor(ln(greatest(least(session_length, 100), 1))) NOT BETWEEN floor(ln(greatest(least(session_length, 100), 1))) AND floor(ln(greatest(least(session_length, 100), 1)))-1
                     AND floor(ln(greatest(least(session_length, 100), 1))) like '%'
                     AND floor(ln(greatest(least(session_length, 100), 1))) not like '__DOES_NOT_EXIST__%'
                     AND floor(ln(greatest(least(session_length, 100), 1))) IN (floor(ln(greatest(least(session_length, 100), 1)))-1,
                                                                                                                                  floor(ln(greatest(least(session_length, 100), 1)))+0,
                                                                                                                                  floor(ln(greatest(least(session_length, 100), 1)))+1)
                     AND floor(ln(greatest(least(session_length, 100), 1))) NOT IN (floor(ln(greatest(least(session_length, 100), 1)))-1,
                                                                                                                                      floor(ln(greatest(least(session_length, 100), 1)))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(ln(greatest(least(session_length, 100), 1))),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(ln(greatest(least(session_length, 100), 1))) IS NULL
          OR (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))+0
              AND floor(ln(greatest(least(session_length, 100), 1))) IS NOT DISTINCT
              FROM floor(ln(greatest(least(session_length, 100), 1)))+0
              AND floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1
              AND (floor(ln(greatest(least(session_length, 100), 1))) IS DISTINCT
                   FROM floor(ln(greatest(least(session_length, 100), 1)))-1)
              AND floor(ln(greatest(least(session_length, 100), 1))) > floor(ln(greatest(least(session_length, 100), 1)))-1
              AND floor(ln(greatest(least(session_length, 100), 1))) >= floor(ln(greatest(least(session_length, 100), 1)))-1
              AND floor(ln(greatest(least(session_length, 100), 1))) < floor(ln(greatest(least(session_length, 100), 1)))+1
              AND floor(ln(greatest(least(session_length, 100), 1))) <= floor(ln(greatest(least(session_length, 100), 1)))+1
              AND (floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1) IS TRUE
              AND (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))-1) IS NOT TRUE
              AND (floor(ln(greatest(least(session_length, 100), 1))) = floor(ln(greatest(least(session_length, 100), 1)))-1) IS FALSE
              AND (floor(ln(greatest(least(session_length, 100), 1))) <> floor(ln(greatest(least(session_length, 100), 1)))-1) IS NOT FALSE
              AND floor(ln(greatest(least(session_length, 100), 1))) BETWEEN floor(ln(greatest(least(session_length, 100), 1)))-1 AND floor(ln(greatest(least(session_length, 100), 1)))+1
              AND floor(ln(greatest(least(session_length, 100), 1))) NOT BETWEEN floor(ln(greatest(least(session_length, 100), 1))) AND floor(ln(greatest(least(session_length, 100), 1)))-1
              AND floor(ln(greatest(least(session_length, 100), 1))) like '%'
              AND floor(ln(greatest(least(session_length, 100), 1))) not like '__DOES_NOT_EXIST__%'
              AND floor(ln(greatest(least(session_length, 100), 1))) IN (floor(ln(greatest(least(session_length, 100), 1)))-1,
                                                                                                                           floor(ln(greatest(least(session_length, 100), 1)))+0,
                                                                                                                           floor(ln(greatest(least(session_length, 100), 1)))+1)
              AND floor(ln(greatest(least(session_length, 100), 1))) NOT IN (floor(ln(greatest(least(session_length, 100), 1)))-1,
                                                                                                                               floor(ln(greatest(least(session_length, 100), 1)))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8: log10
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(log10(greatest(session_length, 1))) IS NULL
       OR (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))+0
           AND floor(log10(greatest(session_length, 1))) IS NOT DISTINCT
           FROM floor(log10(greatest(session_length, 1)))+0
           AND floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1
           AND (floor(log10(greatest(session_length, 1))) IS DISTINCT
                FROM floor(log10(greatest(session_length, 1)))-1)
           AND floor(log10(greatest(session_length, 1))) > floor(log10(greatest(session_length, 1)))-1
           AND floor(log10(greatest(session_length, 1))) >= floor(log10(greatest(session_length, 1)))-1
           AND floor(log10(greatest(session_length, 1))) < floor(log10(greatest(session_length, 1)))+1
           AND floor(log10(greatest(session_length, 1))) <= floor(log10(greatest(session_length, 1)))+1
           AND (floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1) IS TRUE
           AND (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))-1) IS NOT TRUE
           AND (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))-1) IS FALSE
           AND (floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1) IS NOT FALSE
           AND floor(log10(greatest(session_length, 1))) BETWEEN floor(log10(greatest(session_length, 1)))-1 AND floor(log10(greatest(session_length, 1)))+1
           AND floor(log10(greatest(session_length, 1))) NOT BETWEEN floor(log10(greatest(session_length, 1))) AND floor(log10(greatest(session_length, 1)))-1
           AND floor(log10(greatest(session_length, 1))) like '%'
           AND floor(log10(greatest(session_length, 1))) not like '__DOES_NOT_EXIST__%'
           AND floor(log10(greatest(session_length, 1))) IN (floor(log10(greatest(session_length, 1)))-1,
                                                                                                      floor(log10(greatest(session_length, 1)))+0,
                                                                                                      floor(log10(greatest(session_length, 1)))+1)
           AND floor(log10(greatest(session_length, 1))) NOT IN (floor(log10(greatest(session_length, 1)))-1,
                                                                                                          floor(log10(greatest(session_length, 1)))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(log10(greatest(session_length, 1))) IS NULL
       OR floor(log10(greatest(session_length, 1))) IN
         (SELECT floor(log10(greatest(session_length, 1)))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(log10(greatest(session_length, 1))) IS NULL
                 OR (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))+0
                     AND floor(log10(greatest(session_length, 1))) IS NOT DISTINCT
                     FROM floor(log10(greatest(session_length, 1)))+0
                     AND floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1
                     AND (floor(log10(greatest(session_length, 1))) IS DISTINCT
                          FROM floor(log10(greatest(session_length, 1)))-1)
                     AND floor(log10(greatest(session_length, 1))) > floor(log10(greatest(session_length, 1)))-1
                     AND floor(log10(greatest(session_length, 1))) >= floor(log10(greatest(session_length, 1)))-1
                     AND floor(log10(greatest(session_length, 1))) < floor(log10(greatest(session_length, 1)))+1
                     AND floor(log10(greatest(session_length, 1))) <= floor(log10(greatest(session_length, 1)))+1
                     AND (floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1) IS TRUE
                     AND (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))-1) IS NOT TRUE
                     AND (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))-1) IS FALSE
                     AND (floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1) IS NOT FALSE
                     AND floor(log10(greatest(session_length, 1))) BETWEEN floor(log10(greatest(session_length, 1)))-1 AND floor(log10(greatest(session_length, 1)))+1
                     AND floor(log10(greatest(session_length, 1))) NOT BETWEEN floor(log10(greatest(session_length, 1))) AND floor(log10(greatest(session_length, 1)))-1
                     AND floor(log10(greatest(session_length, 1))) like '%'
                     AND floor(log10(greatest(session_length, 1))) not like '__DOES_NOT_EXIST__%'
                     AND floor(log10(greatest(session_length, 1))) IN (floor(log10(greatest(session_length, 1)))-1,
                                                                                                                floor(log10(greatest(session_length, 1)))+0,
                                                                                                                floor(log10(greatest(session_length, 1)))+1)
                     AND floor(log10(greatest(session_length, 1))) NOT IN (floor(log10(greatest(session_length, 1)))-1,
                                                                                                                    floor(log10(greatest(session_length, 1)))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(log10(greatest(session_length, 1))),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(log10(greatest(session_length, 1))) IS NULL
          OR (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))+0
              AND floor(log10(greatest(session_length, 1))) IS NOT DISTINCT
              FROM floor(log10(greatest(session_length, 1)))+0
              AND floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1
              AND (floor(log10(greatest(session_length, 1))) IS DISTINCT
                   FROM floor(log10(greatest(session_length, 1)))-1)
              AND floor(log10(greatest(session_length, 1))) > floor(log10(greatest(session_length, 1)))-1
              AND floor(log10(greatest(session_length, 1))) >= floor(log10(greatest(session_length, 1)))-1
              AND floor(log10(greatest(session_length, 1))) < floor(log10(greatest(session_length, 1)))+1
              AND floor(log10(greatest(session_length, 1))) <= floor(log10(greatest(session_length, 1)))+1
              AND (floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1) IS TRUE
              AND (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))-1) IS NOT TRUE
              AND (floor(log10(greatest(session_length, 1))) = floor(log10(greatest(session_length, 1)))-1) IS FALSE
              AND (floor(log10(greatest(session_length, 1))) <> floor(log10(greatest(session_length, 1)))-1) IS NOT FALSE
              AND floor(log10(greatest(session_length, 1))) BETWEEN floor(log10(greatest(session_length, 1)))-1 AND floor(log10(greatest(session_length, 1)))+1
              AND floor(log10(greatest(session_length, 1))) NOT BETWEEN floor(log10(greatest(session_length, 1))) AND floor(log10(greatest(session_length, 1)))-1
              AND floor(log10(greatest(session_length, 1))) like '%'
              AND floor(log10(greatest(session_length, 1))) not like '__DOES_NOT_EXIST__%'
              AND floor(log10(greatest(session_length, 1))) IN (floor(log10(greatest(session_length, 1)))-1,
                                                                                                         floor(log10(greatest(session_length, 1)))+0,
                                                                                                         floor(log10(greatest(session_length, 1)))+1)
              AND floor(log10(greatest(session_length, 1))) NOT IN (floor(log10(greatest(session_length, 1)))-1,
                                                                                                             floor(log10(greatest(session_length, 1)))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A9: power
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (power(session_length, 1) IS NULL
       OR (power(session_length, 1) = power(session_length, 1)+0
           AND power(session_length, 1) IS NOT DISTINCT
           FROM power(session_length, 1)+0
           AND power(session_length, 1) <> power(session_length, 1)-1
           AND (power(session_length, 1) IS DISTINCT
                FROM power(session_length, 1)-1)
           AND power(session_length, 1) > power(session_length, 1)-1
           AND power(session_length, 1) >= power(session_length, 1)-1
           AND power(session_length, 1) < power(session_length, 1)+1
           AND power(session_length, 1) <= power(session_length, 1)+1
           AND (power(session_length, 1) <> power(session_length, 1)-1) IS TRUE
           AND (power(session_length, 1) = power(session_length, 1)-1) IS NOT TRUE
           AND (power(session_length, 1) = power(session_length, 1)-1) IS FALSE
           AND (power(session_length, 1) <> power(session_length, 1)-1) IS NOT FALSE
           AND power(session_length, 1) BETWEEN power(session_length, 1)-1 AND power(session_length, 1)+1
           AND power(session_length, 1) NOT BETWEEN power(session_length, 1) AND power(session_length, 1)-1
           AND power(session_length, 1) like '%'
           AND power(session_length, 1) not like '__DOES_NOT_EXIST__%'
           AND power(session_length, 1) IN (power(session_length, 1)-1,
                                                                    power(session_length, 1)+0,
                                                                    power(session_length, 1)+1)
           AND power(session_length, 1) NOT IN (power(session_length, 1)-1,
                                                                        power(session_length, 1)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (power(session_length, 1) IS NULL
       OR power(session_length, 1) IN
         (SELECT power(session_length, 1)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (power(session_length, 1) IS NULL
                 OR (power(session_length, 1) = power(session_length, 1)+0
                     AND power(session_length, 1) IS NOT DISTINCT
                     FROM power(session_length, 1)+0
                     AND power(session_length, 1) <> power(session_length, 1)-1
                     AND (power(session_length, 1) IS DISTINCT
                          FROM power(session_length, 1)-1)
                     AND power(session_length, 1) > power(session_length, 1)-1
                     AND power(session_length, 1) >= power(session_length, 1)-1
                     AND power(session_length, 1) < power(session_length, 1)+1
                     AND power(session_length, 1) <= power(session_length, 1)+1
                     AND (power(session_length, 1) <> power(session_length, 1)-1) IS TRUE
                     AND (power(session_length, 1) = power(session_length, 1)-1) IS NOT TRUE
                     AND (power(session_length, 1) = power(session_length, 1)-1) IS FALSE
                     AND (power(session_length, 1) <> power(session_length, 1)-1) IS NOT FALSE
                     AND power(session_length, 1) BETWEEN power(session_length, 1)-1 AND power(session_length, 1)+1
                     AND power(session_length, 1) NOT BETWEEN power(session_length, 1) AND power(session_length, 1)-1
                     AND power(session_length, 1) like '%'
                     AND power(session_length, 1) not like '__DOES_NOT_EXIST__%'
                     AND power(session_length, 1) IN (power(session_length, 1)-1,
                                                                              power(session_length, 1)+0,
                                                                              power(session_length, 1)+1)
                     AND power(session_length, 1) NOT IN (power(session_length, 1)-1,
                                                                                  power(session_length, 1)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          power(session_length, 1),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (power(session_length, 1) IS NULL
          OR (power(session_length, 1) = power(session_length, 1)+0
              AND power(session_length, 1) IS NOT DISTINCT
              FROM power(session_length, 1)+0
              AND power(session_length, 1) <> power(session_length, 1)-1
              AND (power(session_length, 1) IS DISTINCT
                   FROM power(session_length, 1)-1)
              AND power(session_length, 1) > power(session_length, 1)-1
              AND power(session_length, 1) >= power(session_length, 1)-1
              AND power(session_length, 1) < power(session_length, 1)+1
              AND power(session_length, 1) <= power(session_length, 1)+1
              AND (power(session_length, 1) <> power(session_length, 1)-1) IS TRUE
              AND (power(session_length, 1) = power(session_length, 1)-1) IS NOT TRUE
              AND (power(session_length, 1) = power(session_length, 1)-1) IS FALSE
              AND (power(session_length, 1) <> power(session_length, 1)-1) IS NOT FALSE
              AND power(session_length, 1) BETWEEN power(session_length, 1)-1 AND power(session_length, 1)+1
              AND power(session_length, 1) NOT BETWEEN power(session_length, 1) AND power(session_length, 1)-1
              AND power(session_length, 1) like '%'
              AND power(session_length, 1) not like '__DOES_NOT_EXIST__%'
              AND power(session_length, 1) IN (power(session_length, 1)-1,
                                                                       power(session_length, 1)+0,
                                                                       power(session_length, 1)+1)
              AND power(session_length, 1) NOT IN (power(session_length, 1)-1,
                                                                           power(session_length, 1)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A10: sqrt
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(sqrt(session_length)) IS NULL
       OR (floor(sqrt(session_length)) = floor(sqrt(session_length))+0
           AND floor(sqrt(session_length)) IS NOT DISTINCT
           FROM floor(sqrt(session_length))+0
           AND floor(sqrt(session_length)) <> floor(sqrt(session_length))-1
           AND (floor(sqrt(session_length)) IS DISTINCT
                FROM floor(sqrt(session_length))-1)
           AND floor(sqrt(session_length)) > floor(sqrt(session_length))-1
           AND floor(sqrt(session_length)) >= floor(sqrt(session_length))-1
           AND floor(sqrt(session_length)) < floor(sqrt(session_length))+1
           AND floor(sqrt(session_length)) <= floor(sqrt(session_length))+1
           AND (floor(sqrt(session_length)) <> floor(sqrt(session_length))-1) IS TRUE
           AND (floor(sqrt(session_length)) = floor(sqrt(session_length))-1) IS NOT TRUE
           AND (floor(sqrt(session_length)) = floor(sqrt(session_length))-1) IS FALSE
           AND (floor(sqrt(session_length)) <> floor(sqrt(session_length))-1) IS NOT FALSE
           AND floor(sqrt(session_length)) BETWEEN floor(sqrt(session_length))-1 AND floor(sqrt(session_length))+1
           AND floor(sqrt(session_length)) NOT BETWEEN floor(sqrt(session_length)) AND floor(sqrt(session_length))-1
           AND floor(sqrt(session_length)) like '%'
           AND floor(sqrt(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(sqrt(session_length)) IN (floor(sqrt(session_length))-1,
                                                                          floor(sqrt(session_length))+0,
                                                                          floor(sqrt(session_length))+1)
           AND floor(sqrt(session_length)) NOT IN (floor(sqrt(session_length))-1,
                                                                              floor(sqrt(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(sqrt(session_length)) IS NULL
       OR floor(sqrt(session_length)) IN
         (SELECT floor(sqrt(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(sqrt(session_length)) IS NULL
                 OR (floor(sqrt(session_length)) = floor(sqrt(session_length))+0
                     AND floor(sqrt(session_length)) IS NOT DISTINCT
                     FROM floor(sqrt(session_length))+0
                     AND floor(sqrt(session_length)) <> floor(sqrt(session_length))-1
                     AND (floor(sqrt(session_length)) IS DISTINCT
                          FROM floor(sqrt(session_length))-1)
                     AND floor(sqrt(session_length)) > floor(sqrt(session_length))-1
                     AND floor(sqrt(session_length)) >= floor(sqrt(session_length))-1
                     AND floor(sqrt(session_length)) < floor(sqrt(session_length))+1
                     AND floor(sqrt(session_length)) <= floor(sqrt(session_length))+1
                     AND (floor(sqrt(session_length)) <> floor(sqrt(session_length))-1) IS TRUE
                     AND (floor(sqrt(session_length)) = floor(sqrt(session_length))-1) IS NOT TRUE
                     AND (floor(sqrt(session_length)) = floor(sqrt(session_length))-1) IS FALSE
                     AND (floor(sqrt(session_length)) <> floor(sqrt(session_length))-1) IS NOT FALSE
                     AND floor(sqrt(session_length)) BETWEEN floor(sqrt(session_length))-1 AND floor(sqrt(session_length))+1
                     AND floor(sqrt(session_length)) NOT BETWEEN floor(sqrt(session_length)) AND floor(sqrt(session_length))-1
                     AND floor(sqrt(session_length)) like '%'
                     AND floor(sqrt(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(sqrt(session_length)) IN (floor(sqrt(session_length))-1,
                                                                                    floor(sqrt(session_length))+0,
                                                                                    floor(sqrt(session_length))+1)
                     AND floor(sqrt(session_length)) NOT IN (floor(sqrt(session_length))-1,
                                                                                        floor(sqrt(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(sqrt(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(sqrt(session_length)) IS NULL
          OR (floor(sqrt(session_length)) = floor(sqrt(session_length))+0
              AND floor(sqrt(session_length)) IS NOT DISTINCT
              FROM floor(sqrt(session_length))+0
              AND floor(sqrt(session_length)) <> floor(sqrt(session_length))-1
              AND (floor(sqrt(session_length)) IS DISTINCT
                   FROM floor(sqrt(session_length))-1)
              AND floor(sqrt(session_length)) > floor(sqrt(session_length))-1
              AND floor(sqrt(session_length)) >= floor(sqrt(session_length))-1
              AND floor(sqrt(session_length)) < floor(sqrt(session_length))+1
              AND floor(sqrt(session_length)) <= floor(sqrt(session_length))+1
              AND (floor(sqrt(session_length)) <> floor(sqrt(session_length))-1) IS TRUE
              AND (floor(sqrt(session_length)) = floor(sqrt(session_length))-1) IS NOT TRUE
              AND (floor(sqrt(session_length)) = floor(sqrt(session_length))-1) IS FALSE
              AND (floor(sqrt(session_length)) <> floor(sqrt(session_length))-1) IS NOT FALSE
              AND floor(sqrt(session_length)) BETWEEN floor(sqrt(session_length))-1 AND floor(sqrt(session_length))+1
              AND floor(sqrt(session_length)) NOT BETWEEN floor(sqrt(session_length)) AND floor(sqrt(session_length))-1
              AND floor(sqrt(session_length)) like '%'
              AND floor(sqrt(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(sqrt(session_length)) IN (floor(sqrt(session_length))-1,
                                                                             floor(sqrt(session_length))+0,
                                                                             floor(sqrt(session_length))+1)
              AND floor(sqrt(session_length)) NOT IN (floor(sqrt(session_length))-1,
                                                                                 floor(sqrt(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A11: truncate
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(truncate(session_length, -1)) IS NULL
       OR (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))+0
           AND floor(truncate(session_length, -1)) IS NOT DISTINCT
           FROM floor(truncate(session_length, -1))+0
           AND floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1
           AND (floor(truncate(session_length, -1)) IS DISTINCT
                FROM floor(truncate(session_length, -1))-1)
           AND floor(truncate(session_length, -1)) > floor(truncate(session_length, -1))-1
           AND floor(truncate(session_length, -1)) >= floor(truncate(session_length, -1))-1
           AND floor(truncate(session_length, -1)) < floor(truncate(session_length, -1))+1
           AND floor(truncate(session_length, -1)) <= floor(truncate(session_length, -1))+1
           AND (floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1) IS TRUE
           AND (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))-1) IS NOT TRUE
           AND (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))-1) IS FALSE
           AND (floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1) IS NOT FALSE
           AND floor(truncate(session_length, -1)) BETWEEN floor(truncate(session_length, -1))-1 AND floor(truncate(session_length, -1))+1
           AND floor(truncate(session_length, -1)) NOT BETWEEN floor(truncate(session_length, -1)) AND floor(truncate(session_length, -1))-1
           AND floor(truncate(session_length, -1)) like '%'
           AND floor(truncate(session_length, -1)) not like '__DOES_NOT_EXIST__%'
           AND floor(truncate(session_length, -1)) IN (floor(truncate(session_length, -1))-1,
                                                                                          floor(truncate(session_length, -1))+0,
                                                                                          floor(truncate(session_length, -1))+1)
           AND floor(truncate(session_length, -1)) NOT IN (floor(truncate(session_length, -1))-1,
                                                                                              floor(truncate(session_length, -1))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(truncate(session_length, -1)) IS NULL
       OR floor(truncate(session_length, -1)) IN
         (SELECT floor(truncate(session_length, -1))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(truncate(session_length, -1)) IS NULL
                 OR (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))+0
                     AND floor(truncate(session_length, -1)) IS NOT DISTINCT
                     FROM floor(truncate(session_length, -1))+0
                     AND floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1
                     AND (floor(truncate(session_length, -1)) IS DISTINCT
                          FROM floor(truncate(session_length, -1))-1)
                     AND floor(truncate(session_length, -1)) > floor(truncate(session_length, -1))-1
                     AND floor(truncate(session_length, -1)) >= floor(truncate(session_length, -1))-1
                     AND floor(truncate(session_length, -1)) < floor(truncate(session_length, -1))+1
                     AND floor(truncate(session_length, -1)) <= floor(truncate(session_length, -1))+1
                     AND (floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1) IS TRUE
                     AND (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))-1) IS NOT TRUE
                     AND (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))-1) IS FALSE
                     AND (floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1) IS NOT FALSE
                     AND floor(truncate(session_length, -1)) BETWEEN floor(truncate(session_length, -1))-1 AND floor(truncate(session_length, -1))+1
                     AND floor(truncate(session_length, -1)) NOT BETWEEN floor(truncate(session_length, -1)) AND floor(truncate(session_length, -1))-1
                     AND floor(truncate(session_length, -1)) like '%'
                     AND floor(truncate(session_length, -1)) not like '__DOES_NOT_EXIST__%'
                     AND floor(truncate(session_length, -1)) IN (floor(truncate(session_length, -1))-1,
                                                                                                    floor(truncate(session_length, -1))+0,
                                                                                                    floor(truncate(session_length, -1))+1)
                     AND floor(truncate(session_length, -1)) NOT IN (floor(truncate(session_length, -1))-1,
                                                                                                        floor(truncate(session_length, -1))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(truncate(session_length, -1)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(truncate(session_length, -1)) IS NULL
          OR (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))+0
              AND floor(truncate(session_length, -1)) IS NOT DISTINCT
              FROM floor(truncate(session_length, -1))+0
              AND floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1
              AND (floor(truncate(session_length, -1)) IS DISTINCT
                   FROM floor(truncate(session_length, -1))-1)
              AND floor(truncate(session_length, -1)) > floor(truncate(session_length, -1))-1
              AND floor(truncate(session_length, -1)) >= floor(truncate(session_length, -1))-1
              AND floor(truncate(session_length, -1)) < floor(truncate(session_length, -1))+1
              AND floor(truncate(session_length, -1)) <= floor(truncate(session_length, -1))+1
              AND (floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1) IS TRUE
              AND (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))-1) IS NOT TRUE
              AND (floor(truncate(session_length, -1)) = floor(truncate(session_length, -1))-1) IS FALSE
              AND (floor(truncate(session_length, -1)) <> floor(truncate(session_length, -1))-1) IS NOT FALSE
              AND floor(truncate(session_length, -1)) BETWEEN floor(truncate(session_length, -1))-1 AND floor(truncate(session_length, -1))+1
              AND floor(truncate(session_length, -1)) NOT BETWEEN floor(truncate(session_length, -1)) AND floor(truncate(session_length, -1))-1
              AND floor(truncate(session_length, -1)) like '%'
              AND floor(truncate(session_length, -1)) not like '__DOES_NOT_EXIST__%'
              AND floor(truncate(session_length, -1)) IN (floor(truncate(session_length, -1))-1,
                                                                                             floor(truncate(session_length, -1))+0,
                                                                                             floor(truncate(session_length, -1))+1)
              AND floor(truncate(session_length, -1)) NOT IN (floor(truncate(session_length, -1))-1,
                                                                                                 floor(truncate(session_length, -1))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A12: trunc
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(trunc(session_length, -1)) IS NULL
       OR (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))+0
           AND floor(trunc(session_length, -1)) IS NOT DISTINCT
           FROM floor(trunc(session_length, -1))+0
           AND floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1
           AND (floor(trunc(session_length, -1)) IS DISTINCT
                FROM floor(trunc(session_length, -1))-1)
           AND floor(trunc(session_length, -1)) > floor(trunc(session_length, -1))-1
           AND floor(trunc(session_length, -1)) >= floor(trunc(session_length, -1))-1
           AND floor(trunc(session_length, -1)) < floor(trunc(session_length, -1))+1
           AND floor(trunc(session_length, -1)) <= floor(trunc(session_length, -1))+1
           AND (floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1) IS TRUE
           AND (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))-1) IS NOT TRUE
           AND (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))-1) IS FALSE
           AND (floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1) IS NOT FALSE
           AND floor(trunc(session_length, -1)) BETWEEN floor(trunc(session_length, -1))-1 AND floor(trunc(session_length, -1))+1
           AND floor(trunc(session_length, -1)) NOT BETWEEN floor(trunc(session_length, -1)) AND floor(trunc(session_length, -1))-1
           AND floor(trunc(session_length, -1)) like '%'
           AND floor(trunc(session_length, -1)) not like '__DOES_NOT_EXIST__%'
           AND floor(trunc(session_length, -1)) IN (floor(trunc(session_length, -1))-1,
                                                                                    floor(trunc(session_length, -1))+0,
                                                                                    floor(trunc(session_length, -1))+1)
           AND floor(trunc(session_length, -1)) NOT IN (floor(trunc(session_length, -1))-1,
                                                                                        floor(trunc(session_length, -1))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(trunc(session_length, -1)) IS NULL
       OR floor(trunc(session_length, -1)) IN
         (SELECT floor(trunc(session_length, -1))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(trunc(session_length, -1)) IS NULL
                 OR (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))+0
                     AND floor(trunc(session_length, -1)) IS NOT DISTINCT
                     FROM floor(trunc(session_length, -1))+0
                     AND floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1
                     AND (floor(trunc(session_length, -1)) IS DISTINCT
                          FROM floor(trunc(session_length, -1))-1)
                     AND floor(trunc(session_length, -1)) > floor(trunc(session_length, -1))-1
                     AND floor(trunc(session_length, -1)) >= floor(trunc(session_length, -1))-1
                     AND floor(trunc(session_length, -1)) < floor(trunc(session_length, -1))+1
                     AND floor(trunc(session_length, -1)) <= floor(trunc(session_length, -1))+1
                     AND (floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1) IS TRUE
                     AND (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))-1) IS NOT TRUE
                     AND (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))-1) IS FALSE
                     AND (floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1) IS NOT FALSE
                     AND floor(trunc(session_length, -1)) BETWEEN floor(trunc(session_length, -1))-1 AND floor(trunc(session_length, -1))+1
                     AND floor(trunc(session_length, -1)) NOT BETWEEN floor(trunc(session_length, -1)) AND floor(trunc(session_length, -1))-1
                     AND floor(trunc(session_length, -1)) like '%'
                     AND floor(trunc(session_length, -1)) not like '__DOES_NOT_EXIST__%'
                     AND floor(trunc(session_length, -1)) IN (floor(trunc(session_length, -1))-1,
                                                                                              floor(trunc(session_length, -1))+0,
                                                                                              floor(trunc(session_length, -1))+1)
                     AND floor(trunc(session_length, -1)) NOT IN (floor(trunc(session_length, -1))-1,
                                                                                                  floor(trunc(session_length, -1))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(trunc(session_length, -1)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(trunc(session_length, -1)) IS NULL
          OR (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))+0
              AND floor(trunc(session_length, -1)) IS NOT DISTINCT
              FROM floor(trunc(session_length, -1))+0
              AND floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1
              AND (floor(trunc(session_length, -1)) IS DISTINCT
                   FROM floor(trunc(session_length, -1))-1)
              AND floor(trunc(session_length, -1)) > floor(trunc(session_length, -1))-1
              AND floor(trunc(session_length, -1)) >= floor(trunc(session_length, -1))-1
              AND floor(trunc(session_length, -1)) < floor(trunc(session_length, -1))+1
              AND floor(trunc(session_length, -1)) <= floor(trunc(session_length, -1))+1
              AND (floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1) IS TRUE
              AND (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))-1) IS NOT TRUE
              AND (floor(trunc(session_length, -1)) = floor(trunc(session_length, -1))-1) IS FALSE
              AND (floor(trunc(session_length, -1)) <> floor(trunc(session_length, -1))-1) IS NOT FALSE
              AND floor(trunc(session_length, -1)) BETWEEN floor(trunc(session_length, -1))-1 AND floor(trunc(session_length, -1))+1
              AND floor(trunc(session_length, -1)) NOT BETWEEN floor(trunc(session_length, -1)) AND floor(trunc(session_length, -1))-1
              AND floor(trunc(session_length, -1)) like '%'
              AND floor(trunc(session_length, -1)) not like '__DOES_NOT_EXIST__%'
              AND floor(trunc(session_length, -1)) IN (floor(trunc(session_length, -1))-1,
                                                                                       floor(trunc(session_length, -1))+0,
                                                                                       floor(trunc(session_length, -1))+1)
              AND floor(trunc(session_length, -1)) NOT IN (floor(trunc(session_length, -1))-1,
                                                                                           floor(trunc(session_length, -1))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A13: round
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (round(session_length, 2) IS NULL
       OR (round(session_length, 2) = round(session_length, 2)+0
           AND round(session_length, 2) IS NOT DISTINCT
           FROM round(session_length, 2)+0
           AND round(session_length, 2) <> round(session_length, 2)-1
           AND (round(session_length, 2) IS DISTINCT
                FROM round(session_length, 2)-1)
           AND round(session_length, 2) > round(session_length, 2)-1
           AND round(session_length, 2) >= round(session_length, 2)-1
           AND round(session_length, 2) < round(session_length, 2)+1
           AND round(session_length, 2) <= round(session_length, 2)+1
           AND (round(session_length, 2) <> round(session_length, 2)-1) IS TRUE
           AND (round(session_length, 2) = round(session_length, 2)-1) IS NOT TRUE
           AND (round(session_length, 2) = round(session_length, 2)-1) IS FALSE
           AND (round(session_length, 2) <> round(session_length, 2)-1) IS NOT FALSE
           AND round(session_length, 2) BETWEEN round(session_length, 2)-1 AND round(session_length, 2)+1
           AND round(session_length, 2) NOT BETWEEN round(session_length, 2) AND round(session_length, 2)-1
           AND round(session_length, 2) like '%'
           AND round(session_length, 2) not like '__DOES_NOT_EXIST__%'
           AND round(session_length, 2) IN (round(session_length, 2)-1,
                                                                    round(session_length, 2)+0,
                                                                    round(session_length, 2)+1)
           AND round(session_length, 2) NOT IN (round(session_length, 2)-1,
                                                                        round(session_length, 2)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (round(session_length, 2) IS NULL
       OR round(session_length, 2) IN
         (SELECT round(session_length, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (round(session_length, 2) IS NULL
                 OR (round(session_length, 2) = round(session_length, 2)+0
                     AND round(session_length, 2) IS NOT DISTINCT
                     FROM round(session_length, 2)+0
                     AND round(session_length, 2) <> round(session_length, 2)-1
                     AND (round(session_length, 2) IS DISTINCT
                          FROM round(session_length, 2)-1)
                     AND round(session_length, 2) > round(session_length, 2)-1
                     AND round(session_length, 2) >= round(session_length, 2)-1
                     AND round(session_length, 2) < round(session_length, 2)+1
                     AND round(session_length, 2) <= round(session_length, 2)+1
                     AND (round(session_length, 2) <> round(session_length, 2)-1) IS TRUE
                     AND (round(session_length, 2) = round(session_length, 2)-1) IS NOT TRUE
                     AND (round(session_length, 2) = round(session_length, 2)-1) IS FALSE
                     AND (round(session_length, 2) <> round(session_length, 2)-1) IS NOT FALSE
                     AND round(session_length, 2) BETWEEN round(session_length, 2)-1 AND round(session_length, 2)+1
                     AND round(session_length, 2) NOT BETWEEN round(session_length, 2) AND round(session_length, 2)-1
                     AND round(session_length, 2) like '%'
                     AND round(session_length, 2) not like '__DOES_NOT_EXIST__%'
                     AND round(session_length, 2) IN (round(session_length, 2)-1,
                                                                              round(session_length, 2)+0,
                                                                              round(session_length, 2)+1)
                     AND round(session_length, 2) NOT IN (round(session_length, 2)-1,
                                                                                  round(session_length, 2)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          round(session_length, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (round(session_length, 2) IS NULL
          OR (round(session_length, 2) = round(session_length, 2)+0
              AND round(session_length, 2) IS NOT DISTINCT
              FROM round(session_length, 2)+0
              AND round(session_length, 2) <> round(session_length, 2)-1
              AND (round(session_length, 2) IS DISTINCT
                   FROM round(session_length, 2)-1)
              AND round(session_length, 2) > round(session_length, 2)-1
              AND round(session_length, 2) >= round(session_length, 2)-1
              AND round(session_length, 2) < round(session_length, 2)+1
              AND round(session_length, 2) <= round(session_length, 2)+1
              AND (round(session_length, 2) <> round(session_length, 2)-1) IS TRUE
              AND (round(session_length, 2) = round(session_length, 2)-1) IS NOT TRUE
              AND (round(session_length, 2) = round(session_length, 2)-1) IS FALSE
              AND (round(session_length, 2) <> round(session_length, 2)-1) IS NOT FALSE
              AND round(session_length, 2) BETWEEN round(session_length, 2)-1 AND round(session_length, 2)+1
              AND round(session_length, 2) NOT BETWEEN round(session_length, 2) AND round(session_length, 2)-1
              AND round(session_length, 2) like '%'
              AND round(session_length, 2) not like '__DOES_NOT_EXIST__%'
              AND round(session_length, 2) IN (round(session_length, 2)-1,
                                                                       round(session_length, 2)+0,
                                                                       round(session_length, 2)+1)
              AND round(session_length, 2) NOT IN (round(session_length, 2)-1,
                                                                           round(session_length, 2)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A14: mod
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (mod(session_length, 2) IS NULL
       OR (mod(session_length, 2) = mod(session_length, 2)+0
           AND mod(session_length, 2) IS NOT DISTINCT
           FROM mod(session_length, 2)+0
           AND mod(session_length, 2) <> mod(session_length, 2)-1
           AND (mod(session_length, 2) IS DISTINCT
                FROM mod(session_length, 2)-1)
           AND mod(session_length, 2) > mod(session_length, 2)-1
           AND mod(session_length, 2) >= mod(session_length, 2)-1
           AND mod(session_length, 2) < mod(session_length, 2)+1
           AND mod(session_length, 2) <= mod(session_length, 2)+1
           AND (mod(session_length, 2) <> mod(session_length, 2)-1) IS TRUE
           AND (mod(session_length, 2) = mod(session_length, 2)-1) IS NOT TRUE
           AND (mod(session_length, 2) = mod(session_length, 2)-1) IS FALSE
           AND (mod(session_length, 2) <> mod(session_length, 2)-1) IS NOT FALSE
           AND mod(session_length, 2) BETWEEN mod(session_length, 2)-1 AND mod(session_length, 2)+1
           AND mod(session_length, 2) NOT BETWEEN mod(session_length, 2) AND mod(session_length, 2)-1
           AND mod(session_length, 2) like '%'
           AND mod(session_length, 2) not like '__DOES_NOT_EXIST__%'
           AND mod(session_length, 2) IN (mod(session_length, 2)-1,
                                                                mod(session_length, 2)+0,
                                                                mod(session_length, 2)+1)
           AND mod(session_length, 2) NOT IN (mod(session_length, 2)-1,
                                                                    mod(session_length, 2)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (mod(session_length, 2) IS NULL
       OR mod(session_length, 2) IN
         (SELECT mod(session_length, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (mod(session_length, 2) IS NULL
                 OR (mod(session_length, 2) = mod(session_length, 2)+0
                     AND mod(session_length, 2) IS NOT DISTINCT
                     FROM mod(session_length, 2)+0
                     AND mod(session_length, 2) <> mod(session_length, 2)-1
                     AND (mod(session_length, 2) IS DISTINCT
                          FROM mod(session_length, 2)-1)
                     AND mod(session_length, 2) > mod(session_length, 2)-1
                     AND mod(session_length, 2) >= mod(session_length, 2)-1
                     AND mod(session_length, 2) < mod(session_length, 2)+1
                     AND mod(session_length, 2) <= mod(session_length, 2)+1
                     AND (mod(session_length, 2) <> mod(session_length, 2)-1) IS TRUE
                     AND (mod(session_length, 2) = mod(session_length, 2)-1) IS NOT TRUE
                     AND (mod(session_length, 2) = mod(session_length, 2)-1) IS FALSE
                     AND (mod(session_length, 2) <> mod(session_length, 2)-1) IS NOT FALSE
                     AND mod(session_length, 2) BETWEEN mod(session_length, 2)-1 AND mod(session_length, 2)+1
                     AND mod(session_length, 2) NOT BETWEEN mod(session_length, 2) AND mod(session_length, 2)-1
                     AND mod(session_length, 2) like '%'
                     AND mod(session_length, 2) not like '__DOES_NOT_EXIST__%'
                     AND mod(session_length, 2) IN (mod(session_length, 2)-1,
                                                                          mod(session_length, 2)+0,
                                                                          mod(session_length, 2)+1)
                     AND mod(session_length, 2) NOT IN (mod(session_length, 2)-1,
                                                                              mod(session_length, 2)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          mod(session_length, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (mod(session_length, 2) IS NULL
          OR (mod(session_length, 2) = mod(session_length, 2)+0
              AND mod(session_length, 2) IS NOT DISTINCT
              FROM mod(session_length, 2)+0
              AND mod(session_length, 2) <> mod(session_length, 2)-1
              AND (mod(session_length, 2) IS DISTINCT
                   FROM mod(session_length, 2)-1)
              AND mod(session_length, 2) > mod(session_length, 2)-1
              AND mod(session_length, 2) >= mod(session_length, 2)-1
              AND mod(session_length, 2) < mod(session_length, 2)+1
              AND mod(session_length, 2) <= mod(session_length, 2)+1
              AND (mod(session_length, 2) <> mod(session_length, 2)-1) IS TRUE
              AND (mod(session_length, 2) = mod(session_length, 2)-1) IS NOT TRUE
              AND (mod(session_length, 2) = mod(session_length, 2)-1) IS FALSE
              AND (mod(session_length, 2) <> mod(session_length, 2)-1) IS NOT FALSE
              AND mod(session_length, 2) BETWEEN mod(session_length, 2)-1 AND mod(session_length, 2)+1
              AND mod(session_length, 2) NOT BETWEEN mod(session_length, 2) AND mod(session_length, 2)-1
              AND mod(session_length, 2) like '%'
              AND mod(session_length, 2) not like '__DOES_NOT_EXIST__%'
              AND mod(session_length, 2) IN (mod(session_length, 2)-1,
                                                                   mod(session_length, 2)+0,
                                                                   mod(session_length, 2)+1)
              AND mod(session_length, 2) NOT IN (mod(session_length, 2)-1,
                                                                       mod(session_length, 2)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A15: sin
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(sin(session_length)) IS NULL
       OR (floor(sin(session_length)) = floor(sin(session_length))+0
           AND floor(sin(session_length)) IS NOT DISTINCT
           FROM floor(sin(session_length))+0
           AND floor(sin(session_length)) <> floor(sin(session_length))-1
           AND (floor(sin(session_length)) IS DISTINCT
                FROM floor(sin(session_length))-1)
           AND floor(sin(session_length)) > floor(sin(session_length))-1
           AND floor(sin(session_length)) >= floor(sin(session_length))-1
           AND floor(sin(session_length)) < floor(sin(session_length))+1
           AND floor(sin(session_length)) <= floor(sin(session_length))+1
           AND (floor(sin(session_length)) <> floor(sin(session_length))-1) IS TRUE
           AND (floor(sin(session_length)) = floor(sin(session_length))-1) IS NOT TRUE
           AND (floor(sin(session_length)) = floor(sin(session_length))-1) IS FALSE
           AND (floor(sin(session_length)) <> floor(sin(session_length))-1) IS NOT FALSE
           AND floor(sin(session_length)) BETWEEN floor(sin(session_length))-1 AND floor(sin(session_length))+1
           AND floor(sin(session_length)) NOT BETWEEN floor(sin(session_length)) AND floor(sin(session_length))-1
           AND floor(sin(session_length)) like '%'
           AND floor(sin(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(sin(session_length)) IN (floor(sin(session_length))-1,
                                                                        floor(sin(session_length))+0,
                                                                        floor(sin(session_length))+1)
           AND floor(sin(session_length)) NOT IN (floor(sin(session_length))-1,
                                                                            floor(sin(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(sin(session_length)) IS NULL
       OR floor(sin(session_length)) IN
         (SELECT floor(sin(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(sin(session_length)) IS NULL
                 OR (floor(sin(session_length)) = floor(sin(session_length))+0
                     AND floor(sin(session_length)) IS NOT DISTINCT
                     FROM floor(sin(session_length))+0
                     AND floor(sin(session_length)) <> floor(sin(session_length))-1
                     AND (floor(sin(session_length)) IS DISTINCT
                          FROM floor(sin(session_length))-1)
                     AND floor(sin(session_length)) > floor(sin(session_length))-1
                     AND floor(sin(session_length)) >= floor(sin(session_length))-1
                     AND floor(sin(session_length)) < floor(sin(session_length))+1
                     AND floor(sin(session_length)) <= floor(sin(session_length))+1
                     AND (floor(sin(session_length)) <> floor(sin(session_length))-1) IS TRUE
                     AND (floor(sin(session_length)) = floor(sin(session_length))-1) IS NOT TRUE
                     AND (floor(sin(session_length)) = floor(sin(session_length))-1) IS FALSE
                     AND (floor(sin(session_length)) <> floor(sin(session_length))-1) IS NOT FALSE
                     AND floor(sin(session_length)) BETWEEN floor(sin(session_length))-1 AND floor(sin(session_length))+1
                     AND floor(sin(session_length)) NOT BETWEEN floor(sin(session_length)) AND floor(sin(session_length))-1
                     AND floor(sin(session_length)) like '%'
                     AND floor(sin(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(sin(session_length)) IN (floor(sin(session_length))-1,
                                                                                  floor(sin(session_length))+0,
                                                                                  floor(sin(session_length))+1)
                     AND floor(sin(session_length)) NOT IN (floor(sin(session_length))-1,
                                                                                      floor(sin(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(sin(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(sin(session_length)) IS NULL
          OR (floor(sin(session_length)) = floor(sin(session_length))+0
              AND floor(sin(session_length)) IS NOT DISTINCT
              FROM floor(sin(session_length))+0
              AND floor(sin(session_length)) <> floor(sin(session_length))-1
              AND (floor(sin(session_length)) IS DISTINCT
                   FROM floor(sin(session_length))-1)
              AND floor(sin(session_length)) > floor(sin(session_length))-1
              AND floor(sin(session_length)) >= floor(sin(session_length))-1
              AND floor(sin(session_length)) < floor(sin(session_length))+1
              AND floor(sin(session_length)) <= floor(sin(session_length))+1
              AND (floor(sin(session_length)) <> floor(sin(session_length))-1) IS TRUE
              AND (floor(sin(session_length)) = floor(sin(session_length))-1) IS NOT TRUE
              AND (floor(sin(session_length)) = floor(sin(session_length))-1) IS FALSE
              AND (floor(sin(session_length)) <> floor(sin(session_length))-1) IS NOT FALSE
              AND floor(sin(session_length)) BETWEEN floor(sin(session_length))-1 AND floor(sin(session_length))+1
              AND floor(sin(session_length)) NOT BETWEEN floor(sin(session_length)) AND floor(sin(session_length))-1
              AND floor(sin(session_length)) like '%'
              AND floor(sin(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(sin(session_length)) IN (floor(sin(session_length))-1,
                                                                           floor(sin(session_length))+0,
                                                                           floor(sin(session_length))+1)
              AND floor(sin(session_length)) NOT IN (floor(sin(session_length))-1,
                                                                               floor(sin(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A16: cos
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(cos(session_length)) IS NULL
       OR (floor(cos(session_length)) = floor(cos(session_length))+0
           AND floor(cos(session_length)) IS NOT DISTINCT
           FROM floor(cos(session_length))+0
           AND floor(cos(session_length)) <> floor(cos(session_length))-1
           AND (floor(cos(session_length)) IS DISTINCT
                FROM floor(cos(session_length))-1)
           AND floor(cos(session_length)) > floor(cos(session_length))-1
           AND floor(cos(session_length)) >= floor(cos(session_length))-1
           AND floor(cos(session_length)) < floor(cos(session_length))+1
           AND floor(cos(session_length)) <= floor(cos(session_length))+1
           AND (floor(cos(session_length)) <> floor(cos(session_length))-1) IS TRUE
           AND (floor(cos(session_length)) = floor(cos(session_length))-1) IS NOT TRUE
           AND (floor(cos(session_length)) = floor(cos(session_length))-1) IS FALSE
           AND (floor(cos(session_length)) <> floor(cos(session_length))-1) IS NOT FALSE
           AND floor(cos(session_length)) BETWEEN floor(cos(session_length))-1 AND floor(cos(session_length))+1
           AND floor(cos(session_length)) NOT BETWEEN floor(cos(session_length)) AND floor(cos(session_length))-1
           AND floor(cos(session_length)) like '%'
           AND floor(cos(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(cos(session_length)) IN (floor(cos(session_length))-1,
                                                                        floor(cos(session_length))+0,
                                                                        floor(cos(session_length))+1)
           AND floor(cos(session_length)) NOT IN (floor(cos(session_length))-1,
                                                                            floor(cos(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(cos(session_length)) IS NULL
       OR floor(cos(session_length)) IN
         (SELECT floor(cos(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(cos(session_length)) IS NULL
                 OR (floor(cos(session_length)) = floor(cos(session_length))+0
                     AND floor(cos(session_length)) IS NOT DISTINCT
                     FROM floor(cos(session_length))+0
                     AND floor(cos(session_length)) <> floor(cos(session_length))-1
                     AND (floor(cos(session_length)) IS DISTINCT
                          FROM floor(cos(session_length))-1)
                     AND floor(cos(session_length)) > floor(cos(session_length))-1
                     AND floor(cos(session_length)) >= floor(cos(session_length))-1
                     AND floor(cos(session_length)) < floor(cos(session_length))+1
                     AND floor(cos(session_length)) <= floor(cos(session_length))+1
                     AND (floor(cos(session_length)) <> floor(cos(session_length))-1) IS TRUE
                     AND (floor(cos(session_length)) = floor(cos(session_length))-1) IS NOT TRUE
                     AND (floor(cos(session_length)) = floor(cos(session_length))-1) IS FALSE
                     AND (floor(cos(session_length)) <> floor(cos(session_length))-1) IS NOT FALSE
                     AND floor(cos(session_length)) BETWEEN floor(cos(session_length))-1 AND floor(cos(session_length))+1
                     AND floor(cos(session_length)) NOT BETWEEN floor(cos(session_length)) AND floor(cos(session_length))-1
                     AND floor(cos(session_length)) like '%'
                     AND floor(cos(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(cos(session_length)) IN (floor(cos(session_length))-1,
                                                                                  floor(cos(session_length))+0,
                                                                                  floor(cos(session_length))+1)
                     AND floor(cos(session_length)) NOT IN (floor(cos(session_length))-1,
                                                                                      floor(cos(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(cos(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(cos(session_length)) IS NULL
          OR (floor(cos(session_length)) = floor(cos(session_length))+0
              AND floor(cos(session_length)) IS NOT DISTINCT
              FROM floor(cos(session_length))+0
              AND floor(cos(session_length)) <> floor(cos(session_length))-1
              AND (floor(cos(session_length)) IS DISTINCT
                   FROM floor(cos(session_length))-1)
              AND floor(cos(session_length)) > floor(cos(session_length))-1
              AND floor(cos(session_length)) >= floor(cos(session_length))-1
              AND floor(cos(session_length)) < floor(cos(session_length))+1
              AND floor(cos(session_length)) <= floor(cos(session_length))+1
              AND (floor(cos(session_length)) <> floor(cos(session_length))-1) IS TRUE
              AND (floor(cos(session_length)) = floor(cos(session_length))-1) IS NOT TRUE
              AND (floor(cos(session_length)) = floor(cos(session_length))-1) IS FALSE
              AND (floor(cos(session_length)) <> floor(cos(session_length))-1) IS NOT FALSE
              AND floor(cos(session_length)) BETWEEN floor(cos(session_length))-1 AND floor(cos(session_length))+1
              AND floor(cos(session_length)) NOT BETWEEN floor(cos(session_length)) AND floor(cos(session_length))-1
              AND floor(cos(session_length)) like '%'
              AND floor(cos(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(cos(session_length)) IN (floor(cos(session_length))-1,
                                                                           floor(cos(session_length))+0,
                                                                           floor(cos(session_length))+1)
              AND floor(cos(session_length)) NOT IN (floor(cos(session_length))-1,
                                                                               floor(cos(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A17: tan
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(tan(session_length)) IS NULL
       OR (floor(tan(session_length)) = floor(tan(session_length))+0
           AND floor(tan(session_length)) IS NOT DISTINCT
           FROM floor(tan(session_length))+0
           AND floor(tan(session_length)) <> floor(tan(session_length))-1
           AND (floor(tan(session_length)) IS DISTINCT
                FROM floor(tan(session_length))-1)
           AND floor(tan(session_length)) > floor(tan(session_length))-1
           AND floor(tan(session_length)) >= floor(tan(session_length))-1
           AND floor(tan(session_length)) < floor(tan(session_length))+1
           AND floor(tan(session_length)) <= floor(tan(session_length))+1
           AND (floor(tan(session_length)) <> floor(tan(session_length))-1) IS TRUE
           AND (floor(tan(session_length)) = floor(tan(session_length))-1) IS NOT TRUE
           AND (floor(tan(session_length)) = floor(tan(session_length))-1) IS FALSE
           AND (floor(tan(session_length)) <> floor(tan(session_length))-1) IS NOT FALSE
           AND floor(tan(session_length)) BETWEEN floor(tan(session_length))-1 AND floor(tan(session_length))+1
           AND floor(tan(session_length)) NOT BETWEEN floor(tan(session_length)) AND floor(tan(session_length))-1
           AND floor(tan(session_length)) like '%'
           AND floor(tan(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(tan(session_length)) IN (floor(tan(session_length))-1,
                                                                        floor(tan(session_length))+0,
                                                                        floor(tan(session_length))+1)
           AND floor(tan(session_length)) NOT IN (floor(tan(session_length))-1,
                                                                            floor(tan(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(tan(session_length)) IS NULL
       OR floor(tan(session_length)) IN
         (SELECT floor(tan(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(tan(session_length)) IS NULL
                 OR (floor(tan(session_length)) = floor(tan(session_length))+0
                     AND floor(tan(session_length)) IS NOT DISTINCT
                     FROM floor(tan(session_length))+0
                     AND floor(tan(session_length)) <> floor(tan(session_length))-1
                     AND (floor(tan(session_length)) IS DISTINCT
                          FROM floor(tan(session_length))-1)
                     AND floor(tan(session_length)) > floor(tan(session_length))-1
                     AND floor(tan(session_length)) >= floor(tan(session_length))-1
                     AND floor(tan(session_length)) < floor(tan(session_length))+1
                     AND floor(tan(session_length)) <= floor(tan(session_length))+1
                     AND (floor(tan(session_length)) <> floor(tan(session_length))-1) IS TRUE
                     AND (floor(tan(session_length)) = floor(tan(session_length))-1) IS NOT TRUE
                     AND (floor(tan(session_length)) = floor(tan(session_length))-1) IS FALSE
                     AND (floor(tan(session_length)) <> floor(tan(session_length))-1) IS NOT FALSE
                     AND floor(tan(session_length)) BETWEEN floor(tan(session_length))-1 AND floor(tan(session_length))+1
                     AND floor(tan(session_length)) NOT BETWEEN floor(tan(session_length)) AND floor(tan(session_length))-1
                     AND floor(tan(session_length)) like '%'
                     AND floor(tan(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(tan(session_length)) IN (floor(tan(session_length))-1,
                                                                                  floor(tan(session_length))+0,
                                                                                  floor(tan(session_length))+1)
                     AND floor(tan(session_length)) NOT IN (floor(tan(session_length))-1,
                                                                                      floor(tan(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(tan(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(tan(session_length)) IS NULL
          OR (floor(tan(session_length)) = floor(tan(session_length))+0
              AND floor(tan(session_length)) IS NOT DISTINCT
              FROM floor(tan(session_length))+0
              AND floor(tan(session_length)) <> floor(tan(session_length))-1
              AND (floor(tan(session_length)) IS DISTINCT
                   FROM floor(tan(session_length))-1)
              AND floor(tan(session_length)) > floor(tan(session_length))-1
              AND floor(tan(session_length)) >= floor(tan(session_length))-1
              AND floor(tan(session_length)) < floor(tan(session_length))+1
              AND floor(tan(session_length)) <= floor(tan(session_length))+1
              AND (floor(tan(session_length)) <> floor(tan(session_length))-1) IS TRUE
              AND (floor(tan(session_length)) = floor(tan(session_length))-1) IS NOT TRUE
              AND (floor(tan(session_length)) = floor(tan(session_length))-1) IS FALSE
              AND (floor(tan(session_length)) <> floor(tan(session_length))-1) IS NOT FALSE
              AND floor(tan(session_length)) BETWEEN floor(tan(session_length))-1 AND floor(tan(session_length))+1
              AND floor(tan(session_length)) NOT BETWEEN floor(tan(session_length)) AND floor(tan(session_length))-1
              AND floor(tan(session_length)) like '%'
              AND floor(tan(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(tan(session_length)) IN (floor(tan(session_length))-1,
                                                                           floor(tan(session_length))+0,
                                                                           floor(tan(session_length))+1)
              AND floor(tan(session_length)) NOT IN (floor(tan(session_length))-1,
                                                                               floor(tan(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A18: cot
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(cot(greatest(session_length, 1))) IS NULL
       OR (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))+0
           AND floor(cot(greatest(session_length, 1))) IS NOT DISTINCT
           FROM floor(cot(greatest(session_length, 1)))+0
           AND floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1
           AND (floor(cot(greatest(session_length, 1))) IS DISTINCT
                FROM floor(cot(greatest(session_length, 1)))-1)
           AND floor(cot(greatest(session_length, 1))) > floor(cot(greatest(session_length, 1)))-1
           AND floor(cot(greatest(session_length, 1))) >= floor(cot(greatest(session_length, 1)))-1
           AND floor(cot(greatest(session_length, 1))) < floor(cot(greatest(session_length, 1)))+1
           AND floor(cot(greatest(session_length, 1))) <= floor(cot(greatest(session_length, 1)))+1
           AND (floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1) IS TRUE
           AND (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))-1) IS NOT TRUE
           AND (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))-1) IS FALSE
           AND (floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1) IS NOT FALSE
           AND floor(cot(greatest(session_length, 1))) BETWEEN floor(cot(greatest(session_length, 1)))-1 AND floor(cot(greatest(session_length, 1)))+1
           AND floor(cot(greatest(session_length, 1))) NOT BETWEEN floor(cot(greatest(session_length, 1))) AND floor(cot(greatest(session_length, 1)))-1
           AND floor(cot(greatest(session_length, 1))) like '%'
           AND floor(cot(greatest(session_length, 1))) not like '__DOES_NOT_EXIST__%'
           AND floor(cot(greatest(session_length, 1))) IN (floor(cot(greatest(session_length, 1)))-1,
                                                                                                  floor(cot(greatest(session_length, 1)))+0,
                                                                                                  floor(cot(greatest(session_length, 1)))+1)
           AND floor(cot(greatest(session_length, 1))) NOT IN (floor(cot(greatest(session_length, 1)))-1,
                                                                                                      floor(cot(greatest(session_length, 1)))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(cot(greatest(session_length, 1))) IS NULL
       OR floor(cot(greatest(session_length, 1))) IN
         (SELECT floor(cot(greatest(session_length, 1)))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(cot(greatest(session_length, 1))) IS NULL
                 OR (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))+0
                     AND floor(cot(greatest(session_length, 1))) IS NOT DISTINCT
                     FROM floor(cot(greatest(session_length, 1)))+0
                     AND floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1
                     AND (floor(cot(greatest(session_length, 1))) IS DISTINCT
                          FROM floor(cot(greatest(session_length, 1)))-1)
                     AND floor(cot(greatest(session_length, 1))) > floor(cot(greatest(session_length, 1)))-1
                     AND floor(cot(greatest(session_length, 1))) >= floor(cot(greatest(session_length, 1)))-1
                     AND floor(cot(greatest(session_length, 1))) < floor(cot(greatest(session_length, 1)))+1
                     AND floor(cot(greatest(session_length, 1))) <= floor(cot(greatest(session_length, 1)))+1
                     AND (floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1) IS TRUE
                     AND (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))-1) IS NOT TRUE
                     AND (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))-1) IS FALSE
                     AND (floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1) IS NOT FALSE
                     AND floor(cot(greatest(session_length, 1))) BETWEEN floor(cot(greatest(session_length, 1)))-1 AND floor(cot(greatest(session_length, 1)))+1
                     AND floor(cot(greatest(session_length, 1))) NOT BETWEEN floor(cot(greatest(session_length, 1))) AND floor(cot(greatest(session_length, 1)))-1
                     AND floor(cot(greatest(session_length, 1))) like '%'
                     AND floor(cot(greatest(session_length, 1))) not like '__DOES_NOT_EXIST__%'
                     AND floor(cot(greatest(session_length, 1))) IN (floor(cot(greatest(session_length, 1)))-1,
                                                                                                            floor(cot(greatest(session_length, 1)))+0,
                                                                                                            floor(cot(greatest(session_length, 1)))+1)
                     AND floor(cot(greatest(session_length, 1))) NOT IN (floor(cot(greatest(session_length, 1)))-1,
                                                                                                                floor(cot(greatest(session_length, 1)))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(cot(greatest(session_length, 1))),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(cot(greatest(session_length, 1))) IS NULL
          OR (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))+0
              AND floor(cot(greatest(session_length, 1))) IS NOT DISTINCT
              FROM floor(cot(greatest(session_length, 1)))+0
              AND floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1
              AND (floor(cot(greatest(session_length, 1))) IS DISTINCT
                   FROM floor(cot(greatest(session_length, 1)))-1)
              AND floor(cot(greatest(session_length, 1))) > floor(cot(greatest(session_length, 1)))-1
              AND floor(cot(greatest(session_length, 1))) >= floor(cot(greatest(session_length, 1)))-1
              AND floor(cot(greatest(session_length, 1))) < floor(cot(greatest(session_length, 1)))+1
              AND floor(cot(greatest(session_length, 1))) <= floor(cot(greatest(session_length, 1)))+1
              AND (floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1) IS TRUE
              AND (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))-1) IS NOT TRUE
              AND (floor(cot(greatest(session_length, 1))) = floor(cot(greatest(session_length, 1)))-1) IS FALSE
              AND (floor(cot(greatest(session_length, 1))) <> floor(cot(greatest(session_length, 1)))-1) IS NOT FALSE
              AND floor(cot(greatest(session_length, 1))) BETWEEN floor(cot(greatest(session_length, 1)))-1 AND floor(cot(greatest(session_length, 1)))+1
              AND floor(cot(greatest(session_length, 1))) NOT BETWEEN floor(cot(greatest(session_length, 1))) AND floor(cot(greatest(session_length, 1)))-1
              AND floor(cot(greatest(session_length, 1))) like '%'
              AND floor(cot(greatest(session_length, 1))) not like '__DOES_NOT_EXIST__%'
              AND floor(cot(greatest(session_length, 1))) IN (floor(cot(greatest(session_length, 1)))-1,
                                                                                                     floor(cot(greatest(session_length, 1)))+0,
                                                                                                     floor(cot(greatest(session_length, 1)))+1)
              AND floor(cot(greatest(session_length, 1))) NOT IN (floor(cot(greatest(session_length, 1)))-1,
                                                                                                         floor(cot(greatest(session_length, 1)))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A19: asin
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(asin(least(session_length, 1))) IS NULL
       OR (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))+0
           AND floor(asin(least(session_length, 1))) IS NOT DISTINCT
           FROM floor(asin(least(session_length, 1)))+0
           AND floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1
           AND (floor(asin(least(session_length, 1))) IS DISTINCT
                FROM floor(asin(least(session_length, 1)))-1)
           AND floor(asin(least(session_length, 1))) > floor(asin(least(session_length, 1)))-1
           AND floor(asin(least(session_length, 1))) >= floor(asin(least(session_length, 1)))-1
           AND floor(asin(least(session_length, 1))) < floor(asin(least(session_length, 1)))+1
           AND floor(asin(least(session_length, 1))) <= floor(asin(least(session_length, 1)))+1
           AND (floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1) IS TRUE
           AND (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))-1) IS NOT TRUE
           AND (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))-1) IS FALSE
           AND (floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1) IS NOT FALSE
           AND floor(asin(least(session_length, 1))) BETWEEN floor(asin(least(session_length, 1)))-1 AND floor(asin(least(session_length, 1)))+1
           AND floor(asin(least(session_length, 1))) NOT BETWEEN floor(asin(least(session_length, 1))) AND floor(asin(least(session_length, 1)))-1
           AND floor(asin(least(session_length, 1))) like '%'
           AND floor(asin(least(session_length, 1))) not like '__DOES_NOT_EXIST__%'
           AND floor(asin(least(session_length, 1))) IN (floor(asin(least(session_length, 1)))-1,
                                                                                              floor(asin(least(session_length, 1)))+0,
                                                                                              floor(asin(least(session_length, 1)))+1)
           AND floor(asin(least(session_length, 1))) NOT IN (floor(asin(least(session_length, 1)))-1,
                                                                                                  floor(asin(least(session_length, 1)))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(asin(least(session_length, 1))) IS NULL
       OR floor(asin(least(session_length, 1))) IN
         (SELECT floor(asin(least(session_length, 1)))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(asin(least(session_length, 1))) IS NULL
                 OR (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))+0
                     AND floor(asin(least(session_length, 1))) IS NOT DISTINCT
                     FROM floor(asin(least(session_length, 1)))+0
                     AND floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1
                     AND (floor(asin(least(session_length, 1))) IS DISTINCT
                          FROM floor(asin(least(session_length, 1)))-1)
                     AND floor(asin(least(session_length, 1))) > floor(asin(least(session_length, 1)))-1
                     AND floor(asin(least(session_length, 1))) >= floor(asin(least(session_length, 1)))-1
                     AND floor(asin(least(session_length, 1))) < floor(asin(least(session_length, 1)))+1
                     AND floor(asin(least(session_length, 1))) <= floor(asin(least(session_length, 1)))+1
                     AND (floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1) IS TRUE
                     AND (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))-1) IS NOT TRUE
                     AND (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))-1) IS FALSE
                     AND (floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1) IS NOT FALSE
                     AND floor(asin(least(session_length, 1))) BETWEEN floor(asin(least(session_length, 1)))-1 AND floor(asin(least(session_length, 1)))+1
                     AND floor(asin(least(session_length, 1))) NOT BETWEEN floor(asin(least(session_length, 1))) AND floor(asin(least(session_length, 1)))-1
                     AND floor(asin(least(session_length, 1))) like '%'
                     AND floor(asin(least(session_length, 1))) not like '__DOES_NOT_EXIST__%'
                     AND floor(asin(least(session_length, 1))) IN (floor(asin(least(session_length, 1)))-1,
                                                                                                        floor(asin(least(session_length, 1)))+0,
                                                                                                        floor(asin(least(session_length, 1)))+1)
                     AND floor(asin(least(session_length, 1))) NOT IN (floor(asin(least(session_length, 1)))-1,
                                                                                                            floor(asin(least(session_length, 1)))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(asin(least(session_length, 1))),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(asin(least(session_length, 1))) IS NULL
          OR (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))+0
              AND floor(asin(least(session_length, 1))) IS NOT DISTINCT
              FROM floor(asin(least(session_length, 1)))+0
              AND floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1
              AND (floor(asin(least(session_length, 1))) IS DISTINCT
                   FROM floor(asin(least(session_length, 1)))-1)
              AND floor(asin(least(session_length, 1))) > floor(asin(least(session_length, 1)))-1
              AND floor(asin(least(session_length, 1))) >= floor(asin(least(session_length, 1)))-1
              AND floor(asin(least(session_length, 1))) < floor(asin(least(session_length, 1)))+1
              AND floor(asin(least(session_length, 1))) <= floor(asin(least(session_length, 1)))+1
              AND (floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1) IS TRUE
              AND (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))-1) IS NOT TRUE
              AND (floor(asin(least(session_length, 1))) = floor(asin(least(session_length, 1)))-1) IS FALSE
              AND (floor(asin(least(session_length, 1))) <> floor(asin(least(session_length, 1)))-1) IS NOT FALSE
              AND floor(asin(least(session_length, 1))) BETWEEN floor(asin(least(session_length, 1)))-1 AND floor(asin(least(session_length, 1)))+1
              AND floor(asin(least(session_length, 1))) NOT BETWEEN floor(asin(least(session_length, 1))) AND floor(asin(least(session_length, 1)))-1
              AND floor(asin(least(session_length, 1))) like '%'
              AND floor(asin(least(session_length, 1))) not like '__DOES_NOT_EXIST__%'
              AND floor(asin(least(session_length, 1))) IN (floor(asin(least(session_length, 1)))-1,
                                                                                                 floor(asin(least(session_length, 1)))+0,
                                                                                                 floor(asin(least(session_length, 1)))+1)
              AND floor(asin(least(session_length, 1))) NOT IN (floor(asin(least(session_length, 1)))-1,
                                                                                                     floor(asin(least(session_length, 1)))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A20: acos
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(acos(least(session_length, 1))) IS NULL
       OR (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))+0
           AND floor(acos(least(session_length, 1))) IS NOT DISTINCT
           FROM floor(acos(least(session_length, 1)))+0
           AND floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1
           AND (floor(acos(least(session_length, 1))) IS DISTINCT
                FROM floor(acos(least(session_length, 1)))-1)
           AND floor(acos(least(session_length, 1))) > floor(acos(least(session_length, 1)))-1
           AND floor(acos(least(session_length, 1))) >= floor(acos(least(session_length, 1)))-1
           AND floor(acos(least(session_length, 1))) < floor(acos(least(session_length, 1)))+1
           AND floor(acos(least(session_length, 1))) <= floor(acos(least(session_length, 1)))+1
           AND (floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1) IS TRUE
           AND (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))-1) IS NOT TRUE
           AND (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))-1) IS FALSE
           AND (floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1) IS NOT FALSE
           AND floor(acos(least(session_length, 1))) BETWEEN floor(acos(least(session_length, 1)))-1 AND floor(acos(least(session_length, 1)))+1
           AND floor(acos(least(session_length, 1))) NOT BETWEEN floor(acos(least(session_length, 1))) AND floor(acos(least(session_length, 1)))-1
           AND floor(acos(least(session_length, 1))) like '%'
           AND floor(acos(least(session_length, 1))) not like '__DOES_NOT_EXIST__%'
           AND floor(acos(least(session_length, 1))) IN (floor(acos(least(session_length, 1)))-1,
                                                                                              floor(acos(least(session_length, 1)))+0,
                                                                                              floor(acos(least(session_length, 1)))+1)
           AND floor(acos(least(session_length, 1))) NOT IN (floor(acos(least(session_length, 1)))-1,
                                                                                                  floor(acos(least(session_length, 1)))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(acos(least(session_length, 1))) IS NULL
       OR floor(acos(least(session_length, 1))) IN
         (SELECT floor(acos(least(session_length, 1)))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(acos(least(session_length, 1))) IS NULL
                 OR (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))+0
                     AND floor(acos(least(session_length, 1))) IS NOT DISTINCT
                     FROM floor(acos(least(session_length, 1)))+0
                     AND floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1
                     AND (floor(acos(least(session_length, 1))) IS DISTINCT
                          FROM floor(acos(least(session_length, 1)))-1)
                     AND floor(acos(least(session_length, 1))) > floor(acos(least(session_length, 1)))-1
                     AND floor(acos(least(session_length, 1))) >= floor(acos(least(session_length, 1)))-1
                     AND floor(acos(least(session_length, 1))) < floor(acos(least(session_length, 1)))+1
                     AND floor(acos(least(session_length, 1))) <= floor(acos(least(session_length, 1)))+1
                     AND (floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1) IS TRUE
                     AND (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))-1) IS NOT TRUE
                     AND (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))-1) IS FALSE
                     AND (floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1) IS NOT FALSE
                     AND floor(acos(least(session_length, 1))) BETWEEN floor(acos(least(session_length, 1)))-1 AND floor(acos(least(session_length, 1)))+1
                     AND floor(acos(least(session_length, 1))) NOT BETWEEN floor(acos(least(session_length, 1))) AND floor(acos(least(session_length, 1)))-1
                     AND floor(acos(least(session_length, 1))) like '%'
                     AND floor(acos(least(session_length, 1))) not like '__DOES_NOT_EXIST__%'
                     AND floor(acos(least(session_length, 1))) IN (floor(acos(least(session_length, 1)))-1,
                                                                                                        floor(acos(least(session_length, 1)))+0,
                                                                                                        floor(acos(least(session_length, 1)))+1)
                     AND floor(acos(least(session_length, 1))) NOT IN (floor(acos(least(session_length, 1)))-1,
                                                                                                            floor(acos(least(session_length, 1)))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(acos(least(session_length, 1))),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(acos(least(session_length, 1))) IS NULL
          OR (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))+0
              AND floor(acos(least(session_length, 1))) IS NOT DISTINCT
              FROM floor(acos(least(session_length, 1)))+0
              AND floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1
              AND (floor(acos(least(session_length, 1))) IS DISTINCT
                   FROM floor(acos(least(session_length, 1)))-1)
              AND floor(acos(least(session_length, 1))) > floor(acos(least(session_length, 1)))-1
              AND floor(acos(least(session_length, 1))) >= floor(acos(least(session_length, 1)))-1
              AND floor(acos(least(session_length, 1))) < floor(acos(least(session_length, 1)))+1
              AND floor(acos(least(session_length, 1))) <= floor(acos(least(session_length, 1)))+1
              AND (floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1) IS TRUE
              AND (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))-1) IS NOT TRUE
              AND (floor(acos(least(session_length, 1))) = floor(acos(least(session_length, 1)))-1) IS FALSE
              AND (floor(acos(least(session_length, 1))) <> floor(acos(least(session_length, 1)))-1) IS NOT FALSE
              AND floor(acos(least(session_length, 1))) BETWEEN floor(acos(least(session_length, 1)))-1 AND floor(acos(least(session_length, 1)))+1
              AND floor(acos(least(session_length, 1))) NOT BETWEEN floor(acos(least(session_length, 1))) AND floor(acos(least(session_length, 1)))-1
              AND floor(acos(least(session_length, 1))) like '%'
              AND floor(acos(least(session_length, 1))) not like '__DOES_NOT_EXIST__%'
              AND floor(acos(least(session_length, 1))) IN (floor(acos(least(session_length, 1)))-1,
                                                                                                 floor(acos(least(session_length, 1)))+0,
                                                                                                 floor(acos(least(session_length, 1)))+1)
              AND floor(acos(least(session_length, 1))) NOT IN (floor(acos(least(session_length, 1)))-1,
                                                                                                     floor(acos(least(session_length, 1)))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A21: atan
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(atan(session_length)) IS NULL
       OR (floor(atan(session_length)) = floor(atan(session_length))+0
           AND floor(atan(session_length)) IS NOT DISTINCT
           FROM floor(atan(session_length))+0
           AND floor(atan(session_length)) <> floor(atan(session_length))-1
           AND (floor(atan(session_length)) IS DISTINCT
                FROM floor(atan(session_length))-1)
           AND floor(atan(session_length)) > floor(atan(session_length))-1
           AND floor(atan(session_length)) >= floor(atan(session_length))-1
           AND floor(atan(session_length)) < floor(atan(session_length))+1
           AND floor(atan(session_length)) <= floor(atan(session_length))+1
           AND (floor(atan(session_length)) <> floor(atan(session_length))-1) IS TRUE
           AND (floor(atan(session_length)) = floor(atan(session_length))-1) IS NOT TRUE
           AND (floor(atan(session_length)) = floor(atan(session_length))-1) IS FALSE
           AND (floor(atan(session_length)) <> floor(atan(session_length))-1) IS NOT FALSE
           AND floor(atan(session_length)) BETWEEN floor(atan(session_length))-1 AND floor(atan(session_length))+1
           AND floor(atan(session_length)) NOT BETWEEN floor(atan(session_length)) AND floor(atan(session_length))-1
           AND floor(atan(session_length)) like '%'
           AND floor(atan(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(atan(session_length)) IN (floor(atan(session_length))-1,
                                                                          floor(atan(session_length))+0,
                                                                          floor(atan(session_length))+1)
           AND floor(atan(session_length)) NOT IN (floor(atan(session_length))-1,
                                                                              floor(atan(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(atan(session_length)) IS NULL
       OR floor(atan(session_length)) IN
         (SELECT floor(atan(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(atan(session_length)) IS NULL
                 OR (floor(atan(session_length)) = floor(atan(session_length))+0
                     AND floor(atan(session_length)) IS NOT DISTINCT
                     FROM floor(atan(session_length))+0
                     AND floor(atan(session_length)) <> floor(atan(session_length))-1
                     AND (floor(atan(session_length)) IS DISTINCT
                          FROM floor(atan(session_length))-1)
                     AND floor(atan(session_length)) > floor(atan(session_length))-1
                     AND floor(atan(session_length)) >= floor(atan(session_length))-1
                     AND floor(atan(session_length)) < floor(atan(session_length))+1
                     AND floor(atan(session_length)) <= floor(atan(session_length))+1
                     AND (floor(atan(session_length)) <> floor(atan(session_length))-1) IS TRUE
                     AND (floor(atan(session_length)) = floor(atan(session_length))-1) IS NOT TRUE
                     AND (floor(atan(session_length)) = floor(atan(session_length))-1) IS FALSE
                     AND (floor(atan(session_length)) <> floor(atan(session_length))-1) IS NOT FALSE
                     AND floor(atan(session_length)) BETWEEN floor(atan(session_length))-1 AND floor(atan(session_length))+1
                     AND floor(atan(session_length)) NOT BETWEEN floor(atan(session_length)) AND floor(atan(session_length))-1
                     AND floor(atan(session_length)) like '%'
                     AND floor(atan(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(atan(session_length)) IN (floor(atan(session_length))-1,
                                                                                    floor(atan(session_length))+0,
                                                                                    floor(atan(session_length))+1)
                     AND floor(atan(session_length)) NOT IN (floor(atan(session_length))-1,
                                                                                        floor(atan(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(atan(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(atan(session_length)) IS NULL
          OR (floor(atan(session_length)) = floor(atan(session_length))+0
              AND floor(atan(session_length)) IS NOT DISTINCT
              FROM floor(atan(session_length))+0
              AND floor(atan(session_length)) <> floor(atan(session_length))-1
              AND (floor(atan(session_length)) IS DISTINCT
                   FROM floor(atan(session_length))-1)
              AND floor(atan(session_length)) > floor(atan(session_length))-1
              AND floor(atan(session_length)) >= floor(atan(session_length))-1
              AND floor(atan(session_length)) < floor(atan(session_length))+1
              AND floor(atan(session_length)) <= floor(atan(session_length))+1
              AND (floor(atan(session_length)) <> floor(atan(session_length))-1) IS TRUE
              AND (floor(atan(session_length)) = floor(atan(session_length))-1) IS NOT TRUE
              AND (floor(atan(session_length)) = floor(atan(session_length))-1) IS FALSE
              AND (floor(atan(session_length)) <> floor(atan(session_length))-1) IS NOT FALSE
              AND floor(atan(session_length)) BETWEEN floor(atan(session_length))-1 AND floor(atan(session_length))+1
              AND floor(atan(session_length)) NOT BETWEEN floor(atan(session_length)) AND floor(atan(session_length))-1
              AND floor(atan(session_length)) like '%'
              AND floor(atan(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(atan(session_length)) IN (floor(atan(session_length))-1,
                                                                             floor(atan(session_length))+0,
                                                                             floor(atan(session_length))+1)
              AND floor(atan(session_length)) NOT IN (floor(atan(session_length))-1,
                                                                                 floor(atan(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A22: atan2
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(atan2(session_length, 1)) IS NULL
       OR (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))+0
           AND floor(atan2(session_length, 1)) IS NOT DISTINCT
           FROM floor(atan2(session_length, 1))+0
           AND floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1
           AND (floor(atan2(session_length, 1)) IS DISTINCT
                FROM floor(atan2(session_length, 1))-1)
           AND floor(atan2(session_length, 1)) > floor(atan2(session_length, 1))-1
           AND floor(atan2(session_length, 1)) >= floor(atan2(session_length, 1))-1
           AND floor(atan2(session_length, 1)) < floor(atan2(session_length, 1))+1
           AND floor(atan2(session_length, 1)) <= floor(atan2(session_length, 1))+1
           AND (floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1) IS TRUE
           AND (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))-1) IS NOT TRUE
           AND (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))-1) IS FALSE
           AND (floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1) IS NOT FALSE
           AND floor(atan2(session_length, 1)) BETWEEN floor(atan2(session_length, 1))-1 AND floor(atan2(session_length, 1))+1
           AND floor(atan2(session_length, 1)) NOT BETWEEN floor(atan2(session_length, 1)) AND floor(atan2(session_length, 1))-1
           AND floor(atan2(session_length, 1)) like '%'
           AND floor(atan2(session_length, 1)) not like '__DOES_NOT_EXIST__%'
           AND floor(atan2(session_length, 1)) IN (floor(atan2(session_length, 1))-1,
                                                                                  floor(atan2(session_length, 1))+0,
                                                                                  floor(atan2(session_length, 1))+1)
           AND floor(atan2(session_length, 1)) NOT IN (floor(atan2(session_length, 1))-1,
                                                                                      floor(atan2(session_length, 1))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(atan2(session_length, 1)) IS NULL
       OR floor(atan2(session_length, 1)) IN
         (SELECT floor(atan2(session_length, 1))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(atan2(session_length, 1)) IS NULL
                 OR (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))+0
                     AND floor(atan2(session_length, 1)) IS NOT DISTINCT
                     FROM floor(atan2(session_length, 1))+0
                     AND floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1
                     AND (floor(atan2(session_length, 1)) IS DISTINCT
                          FROM floor(atan2(session_length, 1))-1)
                     AND floor(atan2(session_length, 1)) > floor(atan2(session_length, 1))-1
                     AND floor(atan2(session_length, 1)) >= floor(atan2(session_length, 1))-1
                     AND floor(atan2(session_length, 1)) < floor(atan2(session_length, 1))+1
                     AND floor(atan2(session_length, 1)) <= floor(atan2(session_length, 1))+1
                     AND (floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1) IS TRUE
                     AND (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))-1) IS NOT TRUE
                     AND (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))-1) IS FALSE
                     AND (floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1) IS NOT FALSE
                     AND floor(atan2(session_length, 1)) BETWEEN floor(atan2(session_length, 1))-1 AND floor(atan2(session_length, 1))+1
                     AND floor(atan2(session_length, 1)) NOT BETWEEN floor(atan2(session_length, 1)) AND floor(atan2(session_length, 1))-1
                     AND floor(atan2(session_length, 1)) like '%'
                     AND floor(atan2(session_length, 1)) not like '__DOES_NOT_EXIST__%'
                     AND floor(atan2(session_length, 1)) IN (floor(atan2(session_length, 1))-1,
                                                                                            floor(atan2(session_length, 1))+0,
                                                                                            floor(atan2(session_length, 1))+1)
                     AND floor(atan2(session_length, 1)) NOT IN (floor(atan2(session_length, 1))-1,
                                                                                                floor(atan2(session_length, 1))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(atan2(session_length, 1)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(atan2(session_length, 1)) IS NULL
          OR (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))+0
              AND floor(atan2(session_length, 1)) IS NOT DISTINCT
              FROM floor(atan2(session_length, 1))+0
              AND floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1
              AND (floor(atan2(session_length, 1)) IS DISTINCT
                   FROM floor(atan2(session_length, 1))-1)
              AND floor(atan2(session_length, 1)) > floor(atan2(session_length, 1))-1
              AND floor(atan2(session_length, 1)) >= floor(atan2(session_length, 1))-1
              AND floor(atan2(session_length, 1)) < floor(atan2(session_length, 1))+1
              AND floor(atan2(session_length, 1)) <= floor(atan2(session_length, 1))+1
              AND (floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1) IS TRUE
              AND (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))-1) IS NOT TRUE
              AND (floor(atan2(session_length, 1)) = floor(atan2(session_length, 1))-1) IS FALSE
              AND (floor(atan2(session_length, 1)) <> floor(atan2(session_length, 1))-1) IS NOT FALSE
              AND floor(atan2(session_length, 1)) BETWEEN floor(atan2(session_length, 1))-1 AND floor(atan2(session_length, 1))+1
              AND floor(atan2(session_length, 1)) NOT BETWEEN floor(atan2(session_length, 1)) AND floor(atan2(session_length, 1))-1
              AND floor(atan2(session_length, 1)) like '%'
              AND floor(atan2(session_length, 1)) not like '__DOES_NOT_EXIST__%'
              AND floor(atan2(session_length, 1)) IN (floor(atan2(session_length, 1))-1,
                                                                                     floor(atan2(session_length, 1))+0,
                                                                                     floor(atan2(session_length, 1))+1)
              AND floor(atan2(session_length, 1)) NOT IN (floor(atan2(session_length, 1))-1,
                                                                                         floor(atan2(session_length, 1))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A23: degrees
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(degrees(session_length)) IS NULL
       OR (floor(degrees(session_length)) = floor(degrees(session_length))+0
           AND floor(degrees(session_length)) IS NOT DISTINCT
           FROM floor(degrees(session_length))+0
           AND floor(degrees(session_length)) <> floor(degrees(session_length))-1
           AND (floor(degrees(session_length)) IS DISTINCT
                FROM floor(degrees(session_length))-1)
           AND floor(degrees(session_length)) > floor(degrees(session_length))-1
           AND floor(degrees(session_length)) >= floor(degrees(session_length))-1
           AND floor(degrees(session_length)) < floor(degrees(session_length))+1
           AND floor(degrees(session_length)) <= floor(degrees(session_length))+1
           AND (floor(degrees(session_length)) <> floor(degrees(session_length))-1) IS TRUE
           AND (floor(degrees(session_length)) = floor(degrees(session_length))-1) IS NOT TRUE
           AND (floor(degrees(session_length)) = floor(degrees(session_length))-1) IS FALSE
           AND (floor(degrees(session_length)) <> floor(degrees(session_length))-1) IS NOT FALSE
           AND floor(degrees(session_length)) BETWEEN floor(degrees(session_length))-1 AND floor(degrees(session_length))+1
           AND floor(degrees(session_length)) NOT BETWEEN floor(degrees(session_length)) AND floor(degrees(session_length))-1
           AND floor(degrees(session_length)) like '%'
           AND floor(degrees(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(degrees(session_length)) IN (floor(degrees(session_length))-1,
                                                                                floor(degrees(session_length))+0,
                                                                                floor(degrees(session_length))+1)
           AND floor(degrees(session_length)) NOT IN (floor(degrees(session_length))-1,
                                                                                    floor(degrees(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(degrees(session_length)) IS NULL
       OR floor(degrees(session_length)) IN
         (SELECT floor(degrees(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(degrees(session_length)) IS NULL
                 OR (floor(degrees(session_length)) = floor(degrees(session_length))+0
                     AND floor(degrees(session_length)) IS NOT DISTINCT
                     FROM floor(degrees(session_length))+0
                     AND floor(degrees(session_length)) <> floor(degrees(session_length))-1
                     AND (floor(degrees(session_length)) IS DISTINCT
                          FROM floor(degrees(session_length))-1)
                     AND floor(degrees(session_length)) > floor(degrees(session_length))-1
                     AND floor(degrees(session_length)) >= floor(degrees(session_length))-1
                     AND floor(degrees(session_length)) < floor(degrees(session_length))+1
                     AND floor(degrees(session_length)) <= floor(degrees(session_length))+1
                     AND (floor(degrees(session_length)) <> floor(degrees(session_length))-1) IS TRUE
                     AND (floor(degrees(session_length)) = floor(degrees(session_length))-1) IS NOT TRUE
                     AND (floor(degrees(session_length)) = floor(degrees(session_length))-1) IS FALSE
                     AND (floor(degrees(session_length)) <> floor(degrees(session_length))-1) IS NOT FALSE
                     AND floor(degrees(session_length)) BETWEEN floor(degrees(session_length))-1 AND floor(degrees(session_length))+1
                     AND floor(degrees(session_length)) NOT BETWEEN floor(degrees(session_length)) AND floor(degrees(session_length))-1
                     AND floor(degrees(session_length)) like '%'
                     AND floor(degrees(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(degrees(session_length)) IN (floor(degrees(session_length))-1,
                                                                                          floor(degrees(session_length))+0,
                                                                                          floor(degrees(session_length))+1)
                     AND floor(degrees(session_length)) NOT IN (floor(degrees(session_length))-1,
                                                                                              floor(degrees(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(degrees(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(degrees(session_length)) IS NULL
          OR (floor(degrees(session_length)) = floor(degrees(session_length))+0
              AND floor(degrees(session_length)) IS NOT DISTINCT
              FROM floor(degrees(session_length))+0
              AND floor(degrees(session_length)) <> floor(degrees(session_length))-1
              AND (floor(degrees(session_length)) IS DISTINCT
                   FROM floor(degrees(session_length))-1)
              AND floor(degrees(session_length)) > floor(degrees(session_length))-1
              AND floor(degrees(session_length)) >= floor(degrees(session_length))-1
              AND floor(degrees(session_length)) < floor(degrees(session_length))+1
              AND floor(degrees(session_length)) <= floor(degrees(session_length))+1
              AND (floor(degrees(session_length)) <> floor(degrees(session_length))-1) IS TRUE
              AND (floor(degrees(session_length)) = floor(degrees(session_length))-1) IS NOT TRUE
              AND (floor(degrees(session_length)) = floor(degrees(session_length))-1) IS FALSE
              AND (floor(degrees(session_length)) <> floor(degrees(session_length))-1) IS NOT FALSE
              AND floor(degrees(session_length)) BETWEEN floor(degrees(session_length))-1 AND floor(degrees(session_length))+1
              AND floor(degrees(session_length)) NOT BETWEEN floor(degrees(session_length)) AND floor(degrees(session_length))-1
              AND floor(degrees(session_length)) like '%'
              AND floor(degrees(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(degrees(session_length)) IN (floor(degrees(session_length))-1,
                                                                                   floor(degrees(session_length))+0,
                                                                                   floor(degrees(session_length))+1)
              AND floor(degrees(session_length)) NOT IN (floor(degrees(session_length))-1,
                                                                                       floor(degrees(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A24: radians
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(radians(session_length)) IS NULL
       OR (floor(radians(session_length)) = floor(radians(session_length))+0
           AND floor(radians(session_length)) IS NOT DISTINCT
           FROM floor(radians(session_length))+0
           AND floor(radians(session_length)) <> floor(radians(session_length))-1
           AND (floor(radians(session_length)) IS DISTINCT
                FROM floor(radians(session_length))-1)
           AND floor(radians(session_length)) > floor(radians(session_length))-1
           AND floor(radians(session_length)) >= floor(radians(session_length))-1
           AND floor(radians(session_length)) < floor(radians(session_length))+1
           AND floor(radians(session_length)) <= floor(radians(session_length))+1
           AND (floor(radians(session_length)) <> floor(radians(session_length))-1) IS TRUE
           AND (floor(radians(session_length)) = floor(radians(session_length))-1) IS NOT TRUE
           AND (floor(radians(session_length)) = floor(radians(session_length))-1) IS FALSE
           AND (floor(radians(session_length)) <> floor(radians(session_length))-1) IS NOT FALSE
           AND floor(radians(session_length)) BETWEEN floor(radians(session_length))-1 AND floor(radians(session_length))+1
           AND floor(radians(session_length)) NOT BETWEEN floor(radians(session_length)) AND floor(radians(session_length))-1
           AND floor(radians(session_length)) like '%'
           AND floor(radians(session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(radians(session_length)) IN (floor(radians(session_length))-1,
                                                                                floor(radians(session_length))+0,
                                                                                floor(radians(session_length))+1)
           AND floor(radians(session_length)) NOT IN (floor(radians(session_length))-1,
                                                                                    floor(radians(session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(radians(session_length)) IS NULL
       OR floor(radians(session_length)) IN
         (SELECT floor(radians(session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(radians(session_length)) IS NULL
                 OR (floor(radians(session_length)) = floor(radians(session_length))+0
                     AND floor(radians(session_length)) IS NOT DISTINCT
                     FROM floor(radians(session_length))+0
                     AND floor(radians(session_length)) <> floor(radians(session_length))-1
                     AND (floor(radians(session_length)) IS DISTINCT
                          FROM floor(radians(session_length))-1)
                     AND floor(radians(session_length)) > floor(radians(session_length))-1
                     AND floor(radians(session_length)) >= floor(radians(session_length))-1
                     AND floor(radians(session_length)) < floor(radians(session_length))+1
                     AND floor(radians(session_length)) <= floor(radians(session_length))+1
                     AND (floor(radians(session_length)) <> floor(radians(session_length))-1) IS TRUE
                     AND (floor(radians(session_length)) = floor(radians(session_length))-1) IS NOT TRUE
                     AND (floor(radians(session_length)) = floor(radians(session_length))-1) IS FALSE
                     AND (floor(radians(session_length)) <> floor(radians(session_length))-1) IS NOT FALSE
                     AND floor(radians(session_length)) BETWEEN floor(radians(session_length))-1 AND floor(radians(session_length))+1
                     AND floor(radians(session_length)) NOT BETWEEN floor(radians(session_length)) AND floor(radians(session_length))-1
                     AND floor(radians(session_length)) like '%'
                     AND floor(radians(session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(radians(session_length)) IN (floor(radians(session_length))-1,
                                                                                          floor(radians(session_length))+0,
                                                                                          floor(radians(session_length))+1)
                     AND floor(radians(session_length)) NOT IN (floor(radians(session_length))-1,
                                                                                              floor(radians(session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(radians(session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(radians(session_length)) IS NULL
          OR (floor(radians(session_length)) = floor(radians(session_length))+0
              AND floor(radians(session_length)) IS NOT DISTINCT
              FROM floor(radians(session_length))+0
              AND floor(radians(session_length)) <> floor(radians(session_length))-1
              AND (floor(radians(session_length)) IS DISTINCT
                   FROM floor(radians(session_length))-1)
              AND floor(radians(session_length)) > floor(radians(session_length))-1
              AND floor(radians(session_length)) >= floor(radians(session_length))-1
              AND floor(radians(session_length)) < floor(radians(session_length))+1
              AND floor(radians(session_length)) <= floor(radians(session_length))+1
              AND (floor(radians(session_length)) <> floor(radians(session_length))-1) IS TRUE
              AND (floor(radians(session_length)) = floor(radians(session_length))-1) IS NOT TRUE
              AND (floor(radians(session_length)) = floor(radians(session_length))-1) IS FALSE
              AND (floor(radians(session_length)) <> floor(radians(session_length))-1) IS NOT FALSE
              AND floor(radians(session_length)) BETWEEN floor(radians(session_length))-1 AND floor(radians(session_length))+1
              AND floor(radians(session_length)) NOT BETWEEN floor(radians(session_length)) AND floor(radians(session_length))-1
              AND floor(radians(session_length)) like '%'
              AND floor(radians(session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(radians(session_length)) IN (floor(radians(session_length))-1,
                                                                                   floor(radians(session_length))+0,
                                                                                   floor(radians(session_length))+1)
              AND floor(radians(session_length)) NOT IN (floor(radians(session_length))-1,
                                                                                       floor(radians(session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A25: bitwise_and
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_and(session_length, session_length) IS NULL
       OR (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)+0
           AND bitwise_and(session_length, session_length) IS NOT DISTINCT
           FROM bitwise_and(session_length, session_length)+0
           AND bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1
           AND (bitwise_and(session_length, session_length) IS DISTINCT
                FROM bitwise_and(session_length, session_length)-1)
           AND bitwise_and(session_length, session_length) > bitwise_and(session_length, session_length)-1
           AND bitwise_and(session_length, session_length) >= bitwise_and(session_length, session_length)-1
           AND bitwise_and(session_length, session_length) < bitwise_and(session_length, session_length)+1
           AND bitwise_and(session_length, session_length) <= bitwise_and(session_length, session_length)+1
           AND (bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1) IS TRUE
           AND (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)-1) IS NOT TRUE
           AND (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)-1) IS FALSE
           AND (bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1) IS NOT FALSE
           AND bitwise_and(session_length, session_length) BETWEEN bitwise_and(session_length, session_length)-1 AND bitwise_and(session_length, session_length)+1
           AND bitwise_and(session_length, session_length) NOT BETWEEN bitwise_and(session_length, session_length) AND bitwise_and(session_length, session_length)-1
           AND bitwise_and(session_length, session_length) like '%'
           AND bitwise_and(session_length, session_length) not like '__DOES_NOT_EXIST__%'
           AND bitwise_and(session_length, session_length) IN (bitwise_and(session_length, session_length)-1,
                                                                                                          bitwise_and(session_length, session_length)+0,
                                                                                                          bitwise_and(session_length, session_length)+1)
           AND bitwise_and(session_length, session_length) NOT IN (bitwise_and(session_length, session_length)-1,
                                                                                                              bitwise_and(session_length, session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_and(session_length, session_length) IS NULL
       OR bitwise_and(session_length, session_length) IN
         (SELECT bitwise_and(session_length, session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_and(session_length, session_length) IS NULL
                 OR (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)+0
                     AND bitwise_and(session_length, session_length) IS NOT DISTINCT
                     FROM bitwise_and(session_length, session_length)+0
                     AND bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1
                     AND (bitwise_and(session_length, session_length) IS DISTINCT
                          FROM bitwise_and(session_length, session_length)-1)
                     AND bitwise_and(session_length, session_length) > bitwise_and(session_length, session_length)-1
                     AND bitwise_and(session_length, session_length) >= bitwise_and(session_length, session_length)-1
                     AND bitwise_and(session_length, session_length) < bitwise_and(session_length, session_length)+1
                     AND bitwise_and(session_length, session_length) <= bitwise_and(session_length, session_length)+1
                     AND (bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1) IS TRUE
                     AND (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)-1) IS NOT TRUE
                     AND (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)-1) IS FALSE
                     AND (bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1) IS NOT FALSE
                     AND bitwise_and(session_length, session_length) BETWEEN bitwise_and(session_length, session_length)-1 AND bitwise_and(session_length, session_length)+1
                     AND bitwise_and(session_length, session_length) NOT BETWEEN bitwise_and(session_length, session_length) AND bitwise_and(session_length, session_length)-1
                     AND bitwise_and(session_length, session_length) like '%'
                     AND bitwise_and(session_length, session_length) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_and(session_length, session_length) IN (bitwise_and(session_length, session_length)-1,
                                                                                                                    bitwise_and(session_length, session_length)+0,
                                                                                                                    bitwise_and(session_length, session_length)+1)
                     AND bitwise_and(session_length, session_length) NOT IN (bitwise_and(session_length, session_length)-1,
                                                                                                                        bitwise_and(session_length, session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_and(session_length, session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_and(session_length, session_length) IS NULL
          OR (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)+0
              AND bitwise_and(session_length, session_length) IS NOT DISTINCT
              FROM bitwise_and(session_length, session_length)+0
              AND bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1
              AND (bitwise_and(session_length, session_length) IS DISTINCT
                   FROM bitwise_and(session_length, session_length)-1)
              AND bitwise_and(session_length, session_length) > bitwise_and(session_length, session_length)-1
              AND bitwise_and(session_length, session_length) >= bitwise_and(session_length, session_length)-1
              AND bitwise_and(session_length, session_length) < bitwise_and(session_length, session_length)+1
              AND bitwise_and(session_length, session_length) <= bitwise_and(session_length, session_length)+1
              AND (bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1) IS TRUE
              AND (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)-1) IS NOT TRUE
              AND (bitwise_and(session_length, session_length) = bitwise_and(session_length, session_length)-1) IS FALSE
              AND (bitwise_and(session_length, session_length) <> bitwise_and(session_length, session_length)-1) IS NOT FALSE
              AND bitwise_and(session_length, session_length) BETWEEN bitwise_and(session_length, session_length)-1 AND bitwise_and(session_length, session_length)+1
              AND bitwise_and(session_length, session_length) NOT BETWEEN bitwise_and(session_length, session_length) AND bitwise_and(session_length, session_length)-1
              AND bitwise_and(session_length, session_length) like '%'
              AND bitwise_and(session_length, session_length) not like '__DOES_NOT_EXIST__%'
              AND bitwise_and(session_length, session_length) IN (bitwise_and(session_length, session_length)-1,
                                                                                                             bitwise_and(session_length, session_length)+0,
                                                                                                             bitwise_and(session_length, session_length)+1)
              AND bitwise_and(session_length, session_length) NOT IN (bitwise_and(session_length, session_length)-1,
                                                                                                                 bitwise_and(session_length, session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A26: bitwise_complement
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_complement(session_length) IS NULL
       OR (bitwise_complement(session_length) = bitwise_complement(session_length)+0
           AND bitwise_complement(session_length) IS NOT DISTINCT
           FROM bitwise_complement(session_length)+0
           AND bitwise_complement(session_length) <> bitwise_complement(session_length)-1
           AND (bitwise_complement(session_length) IS DISTINCT
                FROM bitwise_complement(session_length)-1)
           AND bitwise_complement(session_length) > bitwise_complement(session_length)-1
           AND bitwise_complement(session_length) >= bitwise_complement(session_length)-1
           AND bitwise_complement(session_length) < bitwise_complement(session_length)+1
           AND bitwise_complement(session_length) <= bitwise_complement(session_length)+1
           AND (bitwise_complement(session_length) <> bitwise_complement(session_length)-1) IS TRUE
           AND (bitwise_complement(session_length) = bitwise_complement(session_length)-1) IS NOT TRUE
           AND (bitwise_complement(session_length) = bitwise_complement(session_length)-1) IS FALSE
           AND (bitwise_complement(session_length) <> bitwise_complement(session_length)-1) IS NOT FALSE
           AND bitwise_complement(session_length) BETWEEN bitwise_complement(session_length)-1 AND bitwise_complement(session_length)+1
           AND bitwise_complement(session_length) NOT BETWEEN bitwise_complement(session_length) AND bitwise_complement(session_length)-1
           AND bitwise_complement(session_length) like '%'
           AND bitwise_complement(session_length) not like '__DOES_NOT_EXIST__%'
           AND bitwise_complement(session_length) IN (bitwise_complement(session_length)-1,
                                                                                        bitwise_complement(session_length)+0,
                                                                                        bitwise_complement(session_length)+1)
           AND bitwise_complement(session_length) NOT IN (bitwise_complement(session_length)-1,
                                                                                            bitwise_complement(session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_complement(session_length) IS NULL
       OR bitwise_complement(session_length) IN
         (SELECT bitwise_complement(session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_complement(session_length) IS NULL
                 OR (bitwise_complement(session_length) = bitwise_complement(session_length)+0
                     AND bitwise_complement(session_length) IS NOT DISTINCT
                     FROM bitwise_complement(session_length)+0
                     AND bitwise_complement(session_length) <> bitwise_complement(session_length)-1
                     AND (bitwise_complement(session_length) IS DISTINCT
                          FROM bitwise_complement(session_length)-1)
                     AND bitwise_complement(session_length) > bitwise_complement(session_length)-1
                     AND bitwise_complement(session_length) >= bitwise_complement(session_length)-1
                     AND bitwise_complement(session_length) < bitwise_complement(session_length)+1
                     AND bitwise_complement(session_length) <= bitwise_complement(session_length)+1
                     AND (bitwise_complement(session_length) <> bitwise_complement(session_length)-1) IS TRUE
                     AND (bitwise_complement(session_length) = bitwise_complement(session_length)-1) IS NOT TRUE
                     AND (bitwise_complement(session_length) = bitwise_complement(session_length)-1) IS FALSE
                     AND (bitwise_complement(session_length) <> bitwise_complement(session_length)-1) IS NOT FALSE
                     AND bitwise_complement(session_length) BETWEEN bitwise_complement(session_length)-1 AND bitwise_complement(session_length)+1
                     AND bitwise_complement(session_length) NOT BETWEEN bitwise_complement(session_length) AND bitwise_complement(session_length)-1
                     AND bitwise_complement(session_length) like '%'
                     AND bitwise_complement(session_length) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_complement(session_length) IN (bitwise_complement(session_length)-1,
                                                                                                  bitwise_complement(session_length)+0,
                                                                                                  bitwise_complement(session_length)+1)
                     AND bitwise_complement(session_length) NOT IN (bitwise_complement(session_length)-1,
                                                                                                      bitwise_complement(session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_complement(session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_complement(session_length) IS NULL
          OR (bitwise_complement(session_length) = bitwise_complement(session_length)+0
              AND bitwise_complement(session_length) IS NOT DISTINCT
              FROM bitwise_complement(session_length)+0
              AND bitwise_complement(session_length) <> bitwise_complement(session_length)-1
              AND (bitwise_complement(session_length) IS DISTINCT
                   FROM bitwise_complement(session_length)-1)
              AND bitwise_complement(session_length) > bitwise_complement(session_length)-1
              AND bitwise_complement(session_length) >= bitwise_complement(session_length)-1
              AND bitwise_complement(session_length) < bitwise_complement(session_length)+1
              AND bitwise_complement(session_length) <= bitwise_complement(session_length)+1
              AND (bitwise_complement(session_length) <> bitwise_complement(session_length)-1) IS TRUE
              AND (bitwise_complement(session_length) = bitwise_complement(session_length)-1) IS NOT TRUE
              AND (bitwise_complement(session_length) = bitwise_complement(session_length)-1) IS FALSE
              AND (bitwise_complement(session_length) <> bitwise_complement(session_length)-1) IS NOT FALSE
              AND bitwise_complement(session_length) BETWEEN bitwise_complement(session_length)-1 AND bitwise_complement(session_length)+1
              AND bitwise_complement(session_length) NOT BETWEEN bitwise_complement(session_length) AND bitwise_complement(session_length)-1
              AND bitwise_complement(session_length) like '%'
              AND bitwise_complement(session_length) not like '__DOES_NOT_EXIST__%'
              AND bitwise_complement(session_length) IN (bitwise_complement(session_length)-1,
                                                                                           bitwise_complement(session_length)+0,
                                                                                           bitwise_complement(session_length)+1)
              AND bitwise_complement(session_length) NOT IN (bitwise_complement(session_length)-1,
                                                                                               bitwise_complement(session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A27: bitwise_convert_double_to_long_bits
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_convert_double_to_long_bits(session_length) IS NULL
       OR (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)+0
           AND bitwise_convert_double_to_long_bits(session_length) IS NOT DISTINCT
           FROM bitwise_convert_double_to_long_bits(session_length)+0
           AND bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1
           AND (bitwise_convert_double_to_long_bits(session_length) IS DISTINCT
                FROM bitwise_convert_double_to_long_bits(session_length)-1)
           AND bitwise_convert_double_to_long_bits(session_length) > bitwise_convert_double_to_long_bits(session_length)-1
           AND bitwise_convert_double_to_long_bits(session_length) >= bitwise_convert_double_to_long_bits(session_length)-1
           AND bitwise_convert_double_to_long_bits(session_length) < bitwise_convert_double_to_long_bits(session_length)+1
           AND bitwise_convert_double_to_long_bits(session_length) <= bitwise_convert_double_to_long_bits(session_length)+1
           AND (bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1) IS TRUE
           AND (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)-1) IS NOT TRUE
           AND (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)-1) IS FALSE
           AND (bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1) IS NOT FALSE
           AND bitwise_convert_double_to_long_bits(session_length) BETWEEN bitwise_convert_double_to_long_bits(session_length)-1 AND bitwise_convert_double_to_long_bits(session_length)+1
           AND bitwise_convert_double_to_long_bits(session_length) NOT BETWEEN bitwise_convert_double_to_long_bits(session_length) AND bitwise_convert_double_to_long_bits(session_length)-1
           AND bitwise_convert_double_to_long_bits(session_length) like '%'
           AND bitwise_convert_double_to_long_bits(session_length) not like '__DOES_NOT_EXIST__%'
           AND bitwise_convert_double_to_long_bits(session_length) IN (bitwise_convert_double_to_long_bits(session_length)-1,
                                                                                                                          bitwise_convert_double_to_long_bits(session_length)+0,
                                                                                                                          bitwise_convert_double_to_long_bits(session_length)+1)
           AND bitwise_convert_double_to_long_bits(session_length) NOT IN (bitwise_convert_double_to_long_bits(session_length)-1,
                                                                                                                              bitwise_convert_double_to_long_bits(session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_convert_double_to_long_bits(session_length) IS NULL
       OR bitwise_convert_double_to_long_bits(session_length) IN
         (SELECT bitwise_convert_double_to_long_bits(session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_convert_double_to_long_bits(session_length) IS NULL
                 OR (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)+0
                     AND bitwise_convert_double_to_long_bits(session_length) IS NOT DISTINCT
                     FROM bitwise_convert_double_to_long_bits(session_length)+0
                     AND bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1
                     AND (bitwise_convert_double_to_long_bits(session_length) IS DISTINCT
                          FROM bitwise_convert_double_to_long_bits(session_length)-1)
                     AND bitwise_convert_double_to_long_bits(session_length) > bitwise_convert_double_to_long_bits(session_length)-1
                     AND bitwise_convert_double_to_long_bits(session_length) >= bitwise_convert_double_to_long_bits(session_length)-1
                     AND bitwise_convert_double_to_long_bits(session_length) < bitwise_convert_double_to_long_bits(session_length)+1
                     AND bitwise_convert_double_to_long_bits(session_length) <= bitwise_convert_double_to_long_bits(session_length)+1
                     AND (bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1) IS TRUE
                     AND (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)-1) IS NOT TRUE
                     AND (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)-1) IS FALSE
                     AND (bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1) IS NOT FALSE
                     AND bitwise_convert_double_to_long_bits(session_length) BETWEEN bitwise_convert_double_to_long_bits(session_length)-1 AND bitwise_convert_double_to_long_bits(session_length)+1
                     AND bitwise_convert_double_to_long_bits(session_length) NOT BETWEEN bitwise_convert_double_to_long_bits(session_length) AND bitwise_convert_double_to_long_bits(session_length)-1
                     AND bitwise_convert_double_to_long_bits(session_length) like '%'
                     AND bitwise_convert_double_to_long_bits(session_length) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_convert_double_to_long_bits(session_length) IN (bitwise_convert_double_to_long_bits(session_length)-1,
                                                                                                                                    bitwise_convert_double_to_long_bits(session_length)+0,
                                                                                                                                    bitwise_convert_double_to_long_bits(session_length)+1)
                     AND bitwise_convert_double_to_long_bits(session_length) NOT IN (bitwise_convert_double_to_long_bits(session_length)-1,
                                                                                                                                        bitwise_convert_double_to_long_bits(session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_convert_double_to_long_bits(session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_convert_double_to_long_bits(session_length) IS NULL
          OR (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)+0
              AND bitwise_convert_double_to_long_bits(session_length) IS NOT DISTINCT
              FROM bitwise_convert_double_to_long_bits(session_length)+0
              AND bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1
              AND (bitwise_convert_double_to_long_bits(session_length) IS DISTINCT
                   FROM bitwise_convert_double_to_long_bits(session_length)-1)
              AND bitwise_convert_double_to_long_bits(session_length) > bitwise_convert_double_to_long_bits(session_length)-1
              AND bitwise_convert_double_to_long_bits(session_length) >= bitwise_convert_double_to_long_bits(session_length)-1
              AND bitwise_convert_double_to_long_bits(session_length) < bitwise_convert_double_to_long_bits(session_length)+1
              AND bitwise_convert_double_to_long_bits(session_length) <= bitwise_convert_double_to_long_bits(session_length)+1
              AND (bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1) IS TRUE
              AND (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)-1) IS NOT TRUE
              AND (bitwise_convert_double_to_long_bits(session_length) = bitwise_convert_double_to_long_bits(session_length)-1) IS FALSE
              AND (bitwise_convert_double_to_long_bits(session_length) <> bitwise_convert_double_to_long_bits(session_length)-1) IS NOT FALSE
              AND bitwise_convert_double_to_long_bits(session_length) BETWEEN bitwise_convert_double_to_long_bits(session_length)-1 AND bitwise_convert_double_to_long_bits(session_length)+1
              AND bitwise_convert_double_to_long_bits(session_length) NOT BETWEEN bitwise_convert_double_to_long_bits(session_length) AND bitwise_convert_double_to_long_bits(session_length)-1
              AND bitwise_convert_double_to_long_bits(session_length) like '%'
              AND bitwise_convert_double_to_long_bits(session_length) not like '__DOES_NOT_EXIST__%'
              AND bitwise_convert_double_to_long_bits(session_length) IN (bitwise_convert_double_to_long_bits(session_length)-1,
                                                                                                                             bitwise_convert_double_to_long_bits(session_length)+0,
                                                                                                                             bitwise_convert_double_to_long_bits(session_length)+1)
              AND bitwise_convert_double_to_long_bits(session_length) NOT IN (bitwise_convert_double_to_long_bits(session_length)-1,
                                                                                                                                 bitwise_convert_double_to_long_bits(session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A28: bitwise_convert_long_bits_to_double
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_convert_long_bits_to_double(session_length) IS NULL
       OR (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)+0
           AND bitwise_convert_long_bits_to_double(session_length) IS NOT DISTINCT
           FROM bitwise_convert_long_bits_to_double(session_length)+0
           AND bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1
           AND (bitwise_convert_long_bits_to_double(session_length) IS DISTINCT
                FROM bitwise_convert_long_bits_to_double(session_length)-1)
           AND bitwise_convert_long_bits_to_double(session_length) > bitwise_convert_long_bits_to_double(session_length)-1
           AND bitwise_convert_long_bits_to_double(session_length) >= bitwise_convert_long_bits_to_double(session_length)-1
           AND bitwise_convert_long_bits_to_double(session_length) < bitwise_convert_long_bits_to_double(session_length)+1
           AND bitwise_convert_long_bits_to_double(session_length) <= bitwise_convert_long_bits_to_double(session_length)+1
           AND (bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1) IS TRUE
           AND (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)-1) IS NOT TRUE
           AND (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)-1) IS FALSE
           AND (bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1) IS NOT FALSE
           AND bitwise_convert_long_bits_to_double(session_length) BETWEEN bitwise_convert_long_bits_to_double(session_length)-1 AND bitwise_convert_long_bits_to_double(session_length)+1
           AND bitwise_convert_long_bits_to_double(session_length) NOT BETWEEN bitwise_convert_long_bits_to_double(session_length) AND bitwise_convert_long_bits_to_double(session_length)-1
           AND bitwise_convert_long_bits_to_double(session_length) like '%'
           AND bitwise_convert_long_bits_to_double(session_length) not like '__DOES_NOT_EXIST__%'
           AND bitwise_convert_long_bits_to_double(session_length) IN (bitwise_convert_long_bits_to_double(session_length)-1,
                                                                                                                          bitwise_convert_long_bits_to_double(session_length)+0,
                                                                                                                          bitwise_convert_long_bits_to_double(session_length)+1)
           AND bitwise_convert_long_bits_to_double(session_length) NOT IN (bitwise_convert_long_bits_to_double(session_length)-1,
                                                                                                                              bitwise_convert_long_bits_to_double(session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_convert_long_bits_to_double(session_length) IS NULL
       OR bitwise_convert_long_bits_to_double(session_length) IN
         (SELECT bitwise_convert_long_bits_to_double(session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_convert_long_bits_to_double(session_length) IS NULL
                 OR (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)+0
                     AND bitwise_convert_long_bits_to_double(session_length) IS NOT DISTINCT
                     FROM bitwise_convert_long_bits_to_double(session_length)+0
                     AND bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1
                     AND (bitwise_convert_long_bits_to_double(session_length) IS DISTINCT
                          FROM bitwise_convert_long_bits_to_double(session_length)-1)
                     AND bitwise_convert_long_bits_to_double(session_length) > bitwise_convert_long_bits_to_double(session_length)-1
                     AND bitwise_convert_long_bits_to_double(session_length) >= bitwise_convert_long_bits_to_double(session_length)-1
                     AND bitwise_convert_long_bits_to_double(session_length) < bitwise_convert_long_bits_to_double(session_length)+1
                     AND bitwise_convert_long_bits_to_double(session_length) <= bitwise_convert_long_bits_to_double(session_length)+1
                     AND (bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1) IS TRUE
                     AND (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)-1) IS NOT TRUE
                     AND (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)-1) IS FALSE
                     AND (bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1) IS NOT FALSE
                     AND bitwise_convert_long_bits_to_double(session_length) BETWEEN bitwise_convert_long_bits_to_double(session_length)-1 AND bitwise_convert_long_bits_to_double(session_length)+1
                     AND bitwise_convert_long_bits_to_double(session_length) NOT BETWEEN bitwise_convert_long_bits_to_double(session_length) AND bitwise_convert_long_bits_to_double(session_length)-1
                     AND bitwise_convert_long_bits_to_double(session_length) like '%'
                     AND bitwise_convert_long_bits_to_double(session_length) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_convert_long_bits_to_double(session_length) IN (bitwise_convert_long_bits_to_double(session_length)-1,
                                                                                                                                    bitwise_convert_long_bits_to_double(session_length)+0,
                                                                                                                                    bitwise_convert_long_bits_to_double(session_length)+1)
                     AND bitwise_convert_long_bits_to_double(session_length) NOT IN (bitwise_convert_long_bits_to_double(session_length)-1,
                                                                                                                                        bitwise_convert_long_bits_to_double(session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_convert_long_bits_to_double(session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_convert_long_bits_to_double(session_length) IS NULL
          OR (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)+0
              AND bitwise_convert_long_bits_to_double(session_length) IS NOT DISTINCT
              FROM bitwise_convert_long_bits_to_double(session_length)+0
              AND bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1
              AND (bitwise_convert_long_bits_to_double(session_length) IS DISTINCT
                   FROM bitwise_convert_long_bits_to_double(session_length)-1)
              AND bitwise_convert_long_bits_to_double(session_length) > bitwise_convert_long_bits_to_double(session_length)-1
              AND bitwise_convert_long_bits_to_double(session_length) >= bitwise_convert_long_bits_to_double(session_length)-1
              AND bitwise_convert_long_bits_to_double(session_length) < bitwise_convert_long_bits_to_double(session_length)+1
              AND bitwise_convert_long_bits_to_double(session_length) <= bitwise_convert_long_bits_to_double(session_length)+1
              AND (bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1) IS TRUE
              AND (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)-1) IS NOT TRUE
              AND (bitwise_convert_long_bits_to_double(session_length) = bitwise_convert_long_bits_to_double(session_length)-1) IS FALSE
              AND (bitwise_convert_long_bits_to_double(session_length) <> bitwise_convert_long_bits_to_double(session_length)-1) IS NOT FALSE
              AND bitwise_convert_long_bits_to_double(session_length) BETWEEN bitwise_convert_long_bits_to_double(session_length)-1 AND bitwise_convert_long_bits_to_double(session_length)+1
              AND bitwise_convert_long_bits_to_double(session_length) NOT BETWEEN bitwise_convert_long_bits_to_double(session_length) AND bitwise_convert_long_bits_to_double(session_length)-1
              AND bitwise_convert_long_bits_to_double(session_length) like '%'
              AND bitwise_convert_long_bits_to_double(session_length) not like '__DOES_NOT_EXIST__%'
              AND bitwise_convert_long_bits_to_double(session_length) IN (bitwise_convert_long_bits_to_double(session_length)-1,
                                                                                                                             bitwise_convert_long_bits_to_double(session_length)+0,
                                                                                                                             bitwise_convert_long_bits_to_double(session_length)+1)
              AND bitwise_convert_long_bits_to_double(session_length) NOT IN (bitwise_convert_long_bits_to_double(session_length)-1,
                                                                                                                                 bitwise_convert_long_bits_to_double(session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A29: bitwise_or
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_or(session_length, session_length) IS NULL
       OR (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)+0
           AND bitwise_or(session_length, session_length) IS NOT DISTINCT
           FROM bitwise_or(session_length, session_length)+0
           AND bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1
           AND (bitwise_or(session_length, session_length) IS DISTINCT
                FROM bitwise_or(session_length, session_length)-1)
           AND bitwise_or(session_length, session_length) > bitwise_or(session_length, session_length)-1
           AND bitwise_or(session_length, session_length) >= bitwise_or(session_length, session_length)-1
           AND bitwise_or(session_length, session_length) < bitwise_or(session_length, session_length)+1
           AND bitwise_or(session_length, session_length) <= bitwise_or(session_length, session_length)+1
           AND (bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1) IS TRUE
           AND (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)-1) IS NOT TRUE
           AND (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)-1) IS FALSE
           AND (bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1) IS NOT FALSE
           AND bitwise_or(session_length, session_length) BETWEEN bitwise_or(session_length, session_length)-1 AND bitwise_or(session_length, session_length)+1
           AND bitwise_or(session_length, session_length) NOT BETWEEN bitwise_or(session_length, session_length) AND bitwise_or(session_length, session_length)-1
           AND bitwise_or(session_length, session_length) like '%'
           AND bitwise_or(session_length, session_length) not like '__DOES_NOT_EXIST__%'
           AND bitwise_or(session_length, session_length) IN (bitwise_or(session_length, session_length)-1,
                                                                                                        bitwise_or(session_length, session_length)+0,
                                                                                                        bitwise_or(session_length, session_length)+1)
           AND bitwise_or(session_length, session_length) NOT IN (bitwise_or(session_length, session_length)-1,
                                                                                                            bitwise_or(session_length, session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_or(session_length, session_length) IS NULL
       OR bitwise_or(session_length, session_length) IN
         (SELECT bitwise_or(session_length, session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_or(session_length, session_length) IS NULL
                 OR (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)+0
                     AND bitwise_or(session_length, session_length) IS NOT DISTINCT
                     FROM bitwise_or(session_length, session_length)+0
                     AND bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1
                     AND (bitwise_or(session_length, session_length) IS DISTINCT
                          FROM bitwise_or(session_length, session_length)-1)
                     AND bitwise_or(session_length, session_length) > bitwise_or(session_length, session_length)-1
                     AND bitwise_or(session_length, session_length) >= bitwise_or(session_length, session_length)-1
                     AND bitwise_or(session_length, session_length) < bitwise_or(session_length, session_length)+1
                     AND bitwise_or(session_length, session_length) <= bitwise_or(session_length, session_length)+1
                     AND (bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1) IS TRUE
                     AND (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)-1) IS NOT TRUE
                     AND (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)-1) IS FALSE
                     AND (bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1) IS NOT FALSE
                     AND bitwise_or(session_length, session_length) BETWEEN bitwise_or(session_length, session_length)-1 AND bitwise_or(session_length, session_length)+1
                     AND bitwise_or(session_length, session_length) NOT BETWEEN bitwise_or(session_length, session_length) AND bitwise_or(session_length, session_length)-1
                     AND bitwise_or(session_length, session_length) like '%'
                     AND bitwise_or(session_length, session_length) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_or(session_length, session_length) IN (bitwise_or(session_length, session_length)-1,
                                                                                                                  bitwise_or(session_length, session_length)+0,
                                                                                                                  bitwise_or(session_length, session_length)+1)
                     AND bitwise_or(session_length, session_length) NOT IN (bitwise_or(session_length, session_length)-1,
                                                                                                                      bitwise_or(session_length, session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_or(session_length, session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_or(session_length, session_length) IS NULL
          OR (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)+0
              AND bitwise_or(session_length, session_length) IS NOT DISTINCT
              FROM bitwise_or(session_length, session_length)+0
              AND bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1
              AND (bitwise_or(session_length, session_length) IS DISTINCT
                   FROM bitwise_or(session_length, session_length)-1)
              AND bitwise_or(session_length, session_length) > bitwise_or(session_length, session_length)-1
              AND bitwise_or(session_length, session_length) >= bitwise_or(session_length, session_length)-1
              AND bitwise_or(session_length, session_length) < bitwise_or(session_length, session_length)+1
              AND bitwise_or(session_length, session_length) <= bitwise_or(session_length, session_length)+1
              AND (bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1) IS TRUE
              AND (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)-1) IS NOT TRUE
              AND (bitwise_or(session_length, session_length) = bitwise_or(session_length, session_length)-1) IS FALSE
              AND (bitwise_or(session_length, session_length) <> bitwise_or(session_length, session_length)-1) IS NOT FALSE
              AND bitwise_or(session_length, session_length) BETWEEN bitwise_or(session_length, session_length)-1 AND bitwise_or(session_length, session_length)+1
              AND bitwise_or(session_length, session_length) NOT BETWEEN bitwise_or(session_length, session_length) AND bitwise_or(session_length, session_length)-1
              AND bitwise_or(session_length, session_length) like '%'
              AND bitwise_or(session_length, session_length) not like '__DOES_NOT_EXIST__%'
              AND bitwise_or(session_length, session_length) IN (bitwise_or(session_length, session_length)-1,
                                                                                                           bitwise_or(session_length, session_length)+0,
                                                                                                           bitwise_or(session_length, session_length)+1)
              AND bitwise_or(session_length, session_length) NOT IN (bitwise_or(session_length, session_length)-1,
                                                                                                               bitwise_or(session_length, session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A30: bitwise_shift_left
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_shift_left(session_length, 2) IS NULL
       OR (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)+0
           AND bitwise_shift_left(session_length, 2) IS NOT DISTINCT
           FROM bitwise_shift_left(session_length, 2)+0
           AND bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1
           AND (bitwise_shift_left(session_length, 2) IS DISTINCT
                FROM bitwise_shift_left(session_length, 2)-1)
           AND bitwise_shift_left(session_length, 2) > bitwise_shift_left(session_length, 2)-1
           AND bitwise_shift_left(session_length, 2) >= bitwise_shift_left(session_length, 2)-1
           AND bitwise_shift_left(session_length, 2) < bitwise_shift_left(session_length, 2)+1
           AND bitwise_shift_left(session_length, 2) <= bitwise_shift_left(session_length, 2)+1
           AND (bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1) IS TRUE
           AND (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)-1) IS NOT TRUE
           AND (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)-1) IS FALSE
           AND (bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1) IS NOT FALSE
           AND bitwise_shift_left(session_length, 2) BETWEEN bitwise_shift_left(session_length, 2)-1 AND bitwise_shift_left(session_length, 2)+1
           AND bitwise_shift_left(session_length, 2) NOT BETWEEN bitwise_shift_left(session_length, 2) AND bitwise_shift_left(session_length, 2)-1
           AND bitwise_shift_left(session_length, 2) like '%'
           AND bitwise_shift_left(session_length, 2) not like '__DOES_NOT_EXIST__%'
           AND bitwise_shift_left(session_length, 2) IN (bitwise_shift_left(session_length, 2)-1,
                                                                                              bitwise_shift_left(session_length, 2)+0,
                                                                                              bitwise_shift_left(session_length, 2)+1)
           AND bitwise_shift_left(session_length, 2) NOT IN (bitwise_shift_left(session_length, 2)-1,
                                                                                                  bitwise_shift_left(session_length, 2)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_shift_left(session_length, 2) IS NULL
       OR bitwise_shift_left(session_length, 2) IN
         (SELECT bitwise_shift_left(session_length, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_shift_left(session_length, 2) IS NULL
                 OR (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)+0
                     AND bitwise_shift_left(session_length, 2) IS NOT DISTINCT
                     FROM bitwise_shift_left(session_length, 2)+0
                     AND bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1
                     AND (bitwise_shift_left(session_length, 2) IS DISTINCT
                          FROM bitwise_shift_left(session_length, 2)-1)
                     AND bitwise_shift_left(session_length, 2) > bitwise_shift_left(session_length, 2)-1
                     AND bitwise_shift_left(session_length, 2) >= bitwise_shift_left(session_length, 2)-1
                     AND bitwise_shift_left(session_length, 2) < bitwise_shift_left(session_length, 2)+1
                     AND bitwise_shift_left(session_length, 2) <= bitwise_shift_left(session_length, 2)+1
                     AND (bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1) IS TRUE
                     AND (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)-1) IS NOT TRUE
                     AND (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)-1) IS FALSE
                     AND (bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1) IS NOT FALSE
                     AND bitwise_shift_left(session_length, 2) BETWEEN bitwise_shift_left(session_length, 2)-1 AND bitwise_shift_left(session_length, 2)+1
                     AND bitwise_shift_left(session_length, 2) NOT BETWEEN bitwise_shift_left(session_length, 2) AND bitwise_shift_left(session_length, 2)-1
                     AND bitwise_shift_left(session_length, 2) like '%'
                     AND bitwise_shift_left(session_length, 2) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_shift_left(session_length, 2) IN (bitwise_shift_left(session_length, 2)-1,
                                                                                                        bitwise_shift_left(session_length, 2)+0,
                                                                                                        bitwise_shift_left(session_length, 2)+1)
                     AND bitwise_shift_left(session_length, 2) NOT IN (bitwise_shift_left(session_length, 2)-1,
                                                                                                            bitwise_shift_left(session_length, 2)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_shift_left(session_length, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_shift_left(session_length, 2) IS NULL
          OR (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)+0
              AND bitwise_shift_left(session_length, 2) IS NOT DISTINCT
              FROM bitwise_shift_left(session_length, 2)+0
              AND bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1
              AND (bitwise_shift_left(session_length, 2) IS DISTINCT
                   FROM bitwise_shift_left(session_length, 2)-1)
              AND bitwise_shift_left(session_length, 2) > bitwise_shift_left(session_length, 2)-1
              AND bitwise_shift_left(session_length, 2) >= bitwise_shift_left(session_length, 2)-1
              AND bitwise_shift_left(session_length, 2) < bitwise_shift_left(session_length, 2)+1
              AND bitwise_shift_left(session_length, 2) <= bitwise_shift_left(session_length, 2)+1
              AND (bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1) IS TRUE
              AND (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)-1) IS NOT TRUE
              AND (bitwise_shift_left(session_length, 2) = bitwise_shift_left(session_length, 2)-1) IS FALSE
              AND (bitwise_shift_left(session_length, 2) <> bitwise_shift_left(session_length, 2)-1) IS NOT FALSE
              AND bitwise_shift_left(session_length, 2) BETWEEN bitwise_shift_left(session_length, 2)-1 AND bitwise_shift_left(session_length, 2)+1
              AND bitwise_shift_left(session_length, 2) NOT BETWEEN bitwise_shift_left(session_length, 2) AND bitwise_shift_left(session_length, 2)-1
              AND bitwise_shift_left(session_length, 2) like '%'
              AND bitwise_shift_left(session_length, 2) not like '__DOES_NOT_EXIST__%'
              AND bitwise_shift_left(session_length, 2) IN (bitwise_shift_left(session_length, 2)-1,
                                                                                                 bitwise_shift_left(session_length, 2)+0,
                                                                                                 bitwise_shift_left(session_length, 2)+1)
              AND bitwise_shift_left(session_length, 2) NOT IN (bitwise_shift_left(session_length, 2)-1,
                                                                                                     bitwise_shift_left(session_length, 2)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A31: bitwise_shift_right
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_shift_right(session_length, 2) IS NULL
       OR (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)+0
           AND bitwise_shift_right(session_length, 2) IS NOT DISTINCT
           FROM bitwise_shift_right(session_length, 2)+0
           AND bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1
           AND (bitwise_shift_right(session_length, 2) IS DISTINCT
                FROM bitwise_shift_right(session_length, 2)-1)
           AND bitwise_shift_right(session_length, 2) > bitwise_shift_right(session_length, 2)-1
           AND bitwise_shift_right(session_length, 2) >= bitwise_shift_right(session_length, 2)-1
           AND bitwise_shift_right(session_length, 2) < bitwise_shift_right(session_length, 2)+1
           AND bitwise_shift_right(session_length, 2) <= bitwise_shift_right(session_length, 2)+1
           AND (bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1) IS TRUE
           AND (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)-1) IS NOT TRUE
           AND (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)-1) IS FALSE
           AND (bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1) IS NOT FALSE
           AND bitwise_shift_right(session_length, 2) BETWEEN bitwise_shift_right(session_length, 2)-1 AND bitwise_shift_right(session_length, 2)+1
           AND bitwise_shift_right(session_length, 2) NOT BETWEEN bitwise_shift_right(session_length, 2) AND bitwise_shift_right(session_length, 2)-1
           AND bitwise_shift_right(session_length, 2) like '%'
           AND bitwise_shift_right(session_length, 2) not like '__DOES_NOT_EXIST__%'
           AND bitwise_shift_right(session_length, 2) IN (bitwise_shift_right(session_length, 2)-1,
                                                                                                bitwise_shift_right(session_length, 2)+0,
                                                                                                bitwise_shift_right(session_length, 2)+1)
           AND bitwise_shift_right(session_length, 2) NOT IN (bitwise_shift_right(session_length, 2)-1,
                                                                                                    bitwise_shift_right(session_length, 2)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_shift_right(session_length, 2) IS NULL
       OR bitwise_shift_right(session_length, 2) IN
         (SELECT bitwise_shift_right(session_length, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_shift_right(session_length, 2) IS NULL
                 OR (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)+0
                     AND bitwise_shift_right(session_length, 2) IS NOT DISTINCT
                     FROM bitwise_shift_right(session_length, 2)+0
                     AND bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1
                     AND (bitwise_shift_right(session_length, 2) IS DISTINCT
                          FROM bitwise_shift_right(session_length, 2)-1)
                     AND bitwise_shift_right(session_length, 2) > bitwise_shift_right(session_length, 2)-1
                     AND bitwise_shift_right(session_length, 2) >= bitwise_shift_right(session_length, 2)-1
                     AND bitwise_shift_right(session_length, 2) < bitwise_shift_right(session_length, 2)+1
                     AND bitwise_shift_right(session_length, 2) <= bitwise_shift_right(session_length, 2)+1
                     AND (bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1) IS TRUE
                     AND (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)-1) IS NOT TRUE
                     AND (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)-1) IS FALSE
                     AND (bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1) IS NOT FALSE
                     AND bitwise_shift_right(session_length, 2) BETWEEN bitwise_shift_right(session_length, 2)-1 AND bitwise_shift_right(session_length, 2)+1
                     AND bitwise_shift_right(session_length, 2) NOT BETWEEN bitwise_shift_right(session_length, 2) AND bitwise_shift_right(session_length, 2)-1
                     AND bitwise_shift_right(session_length, 2) like '%'
                     AND bitwise_shift_right(session_length, 2) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_shift_right(session_length, 2) IN (bitwise_shift_right(session_length, 2)-1,
                                                                                                          bitwise_shift_right(session_length, 2)+0,
                                                                                                          bitwise_shift_right(session_length, 2)+1)
                     AND bitwise_shift_right(session_length, 2) NOT IN (bitwise_shift_right(session_length, 2)-1,
                                                                                                              bitwise_shift_right(session_length, 2)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_shift_right(session_length, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_shift_right(session_length, 2) IS NULL
          OR (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)+0
              AND bitwise_shift_right(session_length, 2) IS NOT DISTINCT
              FROM bitwise_shift_right(session_length, 2)+0
              AND bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1
              AND (bitwise_shift_right(session_length, 2) IS DISTINCT
                   FROM bitwise_shift_right(session_length, 2)-1)
              AND bitwise_shift_right(session_length, 2) > bitwise_shift_right(session_length, 2)-1
              AND bitwise_shift_right(session_length, 2) >= bitwise_shift_right(session_length, 2)-1
              AND bitwise_shift_right(session_length, 2) < bitwise_shift_right(session_length, 2)+1
              AND bitwise_shift_right(session_length, 2) <= bitwise_shift_right(session_length, 2)+1
              AND (bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1) IS TRUE
              AND (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)-1) IS NOT TRUE
              AND (bitwise_shift_right(session_length, 2) = bitwise_shift_right(session_length, 2)-1) IS FALSE
              AND (bitwise_shift_right(session_length, 2) <> bitwise_shift_right(session_length, 2)-1) IS NOT FALSE
              AND bitwise_shift_right(session_length, 2) BETWEEN bitwise_shift_right(session_length, 2)-1 AND bitwise_shift_right(session_length, 2)+1
              AND bitwise_shift_right(session_length, 2) NOT BETWEEN bitwise_shift_right(session_length, 2) AND bitwise_shift_right(session_length, 2)-1
              AND bitwise_shift_right(session_length, 2) like '%'
              AND bitwise_shift_right(session_length, 2) not like '__DOES_NOT_EXIST__%'
              AND bitwise_shift_right(session_length, 2) IN (bitwise_shift_right(session_length, 2)-1,
                                                                                                   bitwise_shift_right(session_length, 2)+0,
                                                                                                   bitwise_shift_right(session_length, 2)+1)
              AND bitwise_shift_right(session_length, 2) NOT IN (bitwise_shift_right(session_length, 2)-1,
                                                                                                       bitwise_shift_right(session_length, 2)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A32: bitwise_xor
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_xor(session_length, session_length) IS NULL
       OR (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)+0
           AND bitwise_xor(session_length, session_length) IS NOT DISTINCT
           FROM bitwise_xor(session_length, session_length)+0
           AND bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1
           AND (bitwise_xor(session_length, session_length) IS DISTINCT
                FROM bitwise_xor(session_length, session_length)-1)
           AND bitwise_xor(session_length, session_length) > bitwise_xor(session_length, session_length)-1
           AND bitwise_xor(session_length, session_length) >= bitwise_xor(session_length, session_length)-1
           AND bitwise_xor(session_length, session_length) < bitwise_xor(session_length, session_length)+1
           AND bitwise_xor(session_length, session_length) <= bitwise_xor(session_length, session_length)+1
           AND (bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1) IS TRUE
           AND (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)-1) IS NOT TRUE
           AND (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)-1) IS FALSE
           AND (bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1) IS NOT FALSE
           AND bitwise_xor(session_length, session_length) BETWEEN bitwise_xor(session_length, session_length)-1 AND bitwise_xor(session_length, session_length)+1
           AND bitwise_xor(session_length, session_length) NOT BETWEEN bitwise_xor(session_length, session_length) AND bitwise_xor(session_length, session_length)-1
           AND bitwise_xor(session_length, session_length) like '%'
           AND bitwise_xor(session_length, session_length) not like '__DOES_NOT_EXIST__%'
           AND bitwise_xor(session_length, session_length) IN (bitwise_xor(session_length, session_length)-1,
                                                                                                          bitwise_xor(session_length, session_length)+0,
                                                                                                          bitwise_xor(session_length, session_length)+1)
           AND bitwise_xor(session_length, session_length) NOT IN (bitwise_xor(session_length, session_length)-1,
                                                                                                              bitwise_xor(session_length, session_length)+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (bitwise_xor(session_length, session_length) IS NULL
       OR bitwise_xor(session_length, session_length) IN
         (SELECT bitwise_xor(session_length, session_length)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (bitwise_xor(session_length, session_length) IS NULL
                 OR (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)+0
                     AND bitwise_xor(session_length, session_length) IS NOT DISTINCT
                     FROM bitwise_xor(session_length, session_length)+0
                     AND bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1
                     AND (bitwise_xor(session_length, session_length) IS DISTINCT
                          FROM bitwise_xor(session_length, session_length)-1)
                     AND bitwise_xor(session_length, session_length) > bitwise_xor(session_length, session_length)-1
                     AND bitwise_xor(session_length, session_length) >= bitwise_xor(session_length, session_length)-1
                     AND bitwise_xor(session_length, session_length) < bitwise_xor(session_length, session_length)+1
                     AND bitwise_xor(session_length, session_length) <= bitwise_xor(session_length, session_length)+1
                     AND (bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1) IS TRUE
                     AND (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)-1) IS NOT TRUE
                     AND (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)-1) IS FALSE
                     AND (bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1) IS NOT FALSE
                     AND bitwise_xor(session_length, session_length) BETWEEN bitwise_xor(session_length, session_length)-1 AND bitwise_xor(session_length, session_length)+1
                     AND bitwise_xor(session_length, session_length) NOT BETWEEN bitwise_xor(session_length, session_length) AND bitwise_xor(session_length, session_length)-1
                     AND bitwise_xor(session_length, session_length) like '%'
                     AND bitwise_xor(session_length, session_length) not like '__DOES_NOT_EXIST__%'
                     AND bitwise_xor(session_length, session_length) IN (bitwise_xor(session_length, session_length)-1,
                                                                                                                    bitwise_xor(session_length, session_length)+0,
                                                                                                                    bitwise_xor(session_length, session_length)+1)
                     AND bitwise_xor(session_length, session_length) NOT IN (bitwise_xor(session_length, session_length)-1,
                                                                                                                        bitwise_xor(session_length, session_length)+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          bitwise_xor(session_length, session_length),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (bitwise_xor(session_length, session_length) IS NULL
          OR (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)+0
              AND bitwise_xor(session_length, session_length) IS NOT DISTINCT
              FROM bitwise_xor(session_length, session_length)+0
              AND bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1
              AND (bitwise_xor(session_length, session_length) IS DISTINCT
                   FROM bitwise_xor(session_length, session_length)-1)
              AND bitwise_xor(session_length, session_length) > bitwise_xor(session_length, session_length)-1
              AND bitwise_xor(session_length, session_length) >= bitwise_xor(session_length, session_length)-1
              AND bitwise_xor(session_length, session_length) < bitwise_xor(session_length, session_length)+1
              AND bitwise_xor(session_length, session_length) <= bitwise_xor(session_length, session_length)+1
              AND (bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1) IS TRUE
              AND (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)-1) IS NOT TRUE
              AND (bitwise_xor(session_length, session_length) = bitwise_xor(session_length, session_length)-1) IS FALSE
              AND (bitwise_xor(session_length, session_length) <> bitwise_xor(session_length, session_length)-1) IS NOT FALSE
              AND bitwise_xor(session_length, session_length) BETWEEN bitwise_xor(session_length, session_length)-1 AND bitwise_xor(session_length, session_length)+1
              AND bitwise_xor(session_length, session_length) NOT BETWEEN bitwise_xor(session_length, session_length) AND bitwise_xor(session_length, session_length)-1
              AND bitwise_xor(session_length, session_length) like '%'
              AND bitwise_xor(session_length, session_length) not like '__DOES_NOT_EXIST__%'
              AND bitwise_xor(session_length, session_length) IN (bitwise_xor(session_length, session_length)-1,
                                                                                                             bitwise_xor(session_length, session_length)+0,
                                                                                                             bitwise_xor(session_length, session_length)+1)
              AND bitwise_xor(session_length, session_length) NOT IN (bitwise_xor(session_length, session_length)-1,
                                                                                                                 bitwise_xor(session_length, session_length)+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A33: human_readable_binary_byte_format
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||human_readable_binary_byte_format(session_length, 1) IS NULL
       OR ('1'||human_readable_binary_byte_format(session_length, 1) = 1||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) IS NOT DISTINCT
           FROM 1||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)
           AND ('1'||human_readable_binary_byte_format(session_length, 1) IS DISTINCT
                FROM '0'||human_readable_binary_byte_format(session_length, 1))
           AND '1'||human_readable_binary_byte_format(session_length, 1) > '0'||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) >= '0'||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) < 2||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) <= 2||human_readable_binary_byte_format(session_length, 1)
           AND ('1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)) IS TRUE
           AND ('1'||human_readable_binary_byte_format(session_length, 1) = '0'||human_readable_binary_byte_format(session_length, 1)) IS NOT TRUE
           AND ('1'||human_readable_binary_byte_format(session_length, 1) = '0'||human_readable_binary_byte_format(session_length, 1)) IS FALSE
           AND ('1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)) IS NOT FALSE
           AND '1'||human_readable_binary_byte_format(session_length, 1) BETWEEN '0'||human_readable_binary_byte_format(session_length, 1) AND 2||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) NOT BETWEEN '1'||human_readable_binary_byte_format(session_length, 1) AND '0'||human_readable_binary_byte_format(session_length, 1)
           AND '1'||human_readable_binary_byte_format(session_length, 1) like '%'
           AND '1'||human_readable_binary_byte_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
           AND '1'||human_readable_binary_byte_format(session_length, 1) IN ('0'||human_readable_binary_byte_format(session_length, 1),
                                                                             1||human_readable_binary_byte_format(session_length, 1),
                                                                             2||human_readable_binary_byte_format(session_length, 1))
           AND '1'||human_readable_binary_byte_format(session_length, 1) NOT IN ('0'||human_readable_binary_byte_format(session_length, 1),
                                                                                 2||human_readable_binary_byte_format(session_length, 1)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||human_readable_binary_byte_format(session_length, 1) IS NULL
       OR '1'||human_readable_binary_byte_format(session_length, 1) IN
         (SELECT '1'||human_readable_binary_byte_format(session_length, 1)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||human_readable_binary_byte_format(session_length, 1) IS NULL
                 OR ('1'||human_readable_binary_byte_format(session_length, 1) = 1||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) IS NOT DISTINCT
                     FROM 1||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)
                     AND ('1'||human_readable_binary_byte_format(session_length, 1) IS DISTINCT
                          FROM '0'||human_readable_binary_byte_format(session_length, 1))
                     AND '1'||human_readable_binary_byte_format(session_length, 1) > '0'||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) >= '0'||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) < 2||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) <= 2||human_readable_binary_byte_format(session_length, 1)
                     AND ('1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)) IS TRUE
                     AND ('1'||human_readable_binary_byte_format(session_length, 1) = '0'||human_readable_binary_byte_format(session_length, 1)) IS NOT TRUE
                     AND ('1'||human_readable_binary_byte_format(session_length, 1) = '0'||human_readable_binary_byte_format(session_length, 1)) IS FALSE
                     AND ('1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)) IS NOT FALSE
                     AND '1'||human_readable_binary_byte_format(session_length, 1) BETWEEN '0'||human_readable_binary_byte_format(session_length, 1) AND 2||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) NOT BETWEEN '1'||human_readable_binary_byte_format(session_length, 1) AND '0'||human_readable_binary_byte_format(session_length, 1)
                     AND '1'||human_readable_binary_byte_format(session_length, 1) like '%'
                     AND '1'||human_readable_binary_byte_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
                     AND '1'||human_readable_binary_byte_format(session_length, 1) IN ('0'||human_readable_binary_byte_format(session_length, 1),
                                                                                       1||human_readable_binary_byte_format(session_length, 1),
                                                                                       2||human_readable_binary_byte_format(session_length, 1))
                     AND '1'||human_readable_binary_byte_format(session_length, 1) NOT IN ('0'||human_readable_binary_byte_format(session_length, 1),
                                                                                           2||human_readable_binary_byte_format(session_length, 1))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||human_readable_binary_byte_format(session_length, 1),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||human_readable_binary_byte_format(session_length, 1) IS NULL
          OR ('1'||human_readable_binary_byte_format(session_length, 1) = 1||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) IS NOT DISTINCT
              FROM 1||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)
              AND ('1'||human_readable_binary_byte_format(session_length, 1) IS DISTINCT
                   FROM '0'||human_readable_binary_byte_format(session_length, 1))
              AND '1'||human_readable_binary_byte_format(session_length, 1) > '0'||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) >= '0'||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) < 2||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) <= 2||human_readable_binary_byte_format(session_length, 1)
              AND ('1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)) IS TRUE
              AND ('1'||human_readable_binary_byte_format(session_length, 1) = '0'||human_readable_binary_byte_format(session_length, 1)) IS NOT TRUE
              AND ('1'||human_readable_binary_byte_format(session_length, 1) = '0'||human_readable_binary_byte_format(session_length, 1)) IS FALSE
              AND ('1'||human_readable_binary_byte_format(session_length, 1) <> '0'||human_readable_binary_byte_format(session_length, 1)) IS NOT FALSE
              AND '1'||human_readable_binary_byte_format(session_length, 1) BETWEEN '0'||human_readable_binary_byte_format(session_length, 1) AND 2||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) NOT BETWEEN '1'||human_readable_binary_byte_format(session_length, 1) AND '0'||human_readable_binary_byte_format(session_length, 1)
              AND '1'||human_readable_binary_byte_format(session_length, 1) like '%'
              AND '1'||human_readable_binary_byte_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
              AND '1'||human_readable_binary_byte_format(session_length, 1) IN ('0'||human_readable_binary_byte_format(session_length, 1),
                                                                                1||human_readable_binary_byte_format(session_length, 1),
                                                                                2||human_readable_binary_byte_format(session_length, 1))
              AND '1'||human_readable_binary_byte_format(session_length, 1) NOT IN ('0'||human_readable_binary_byte_format(session_length, 1),
                                                                                    2||human_readable_binary_byte_format(session_length, 1))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A34: human_readable_decimal_byte_format
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS NULL
       OR ('1'||human_readable_decimal_byte_format(session_length, 1) = 1||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) IS NOT DISTINCT
           FROM 1||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)
           AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS DISTINCT
                FROM '0'||human_readable_decimal_byte_format(session_length, 1))
           AND '1'||human_readable_decimal_byte_format(session_length, 1) > '0'||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) >= '0'||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) < 2||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) <= 2||human_readable_decimal_byte_format(session_length, 1)
           AND ('1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)) IS TRUE
           AND ('1'||human_readable_decimal_byte_format(session_length, 1) = '0'||human_readable_decimal_byte_format(session_length, 1)) IS NOT TRUE
           AND ('1'||human_readable_decimal_byte_format(session_length, 1) = '0'||human_readable_decimal_byte_format(session_length, 1)) IS FALSE
           AND ('1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)) IS NOT FALSE
           AND '1'||human_readable_decimal_byte_format(session_length, 1) BETWEEN '0'||human_readable_decimal_byte_format(session_length, 1) AND 2||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) NOT BETWEEN '1'||human_readable_decimal_byte_format(session_length, 1) AND '0'||human_readable_decimal_byte_format(session_length, 1)
           AND '1'||human_readable_decimal_byte_format(session_length, 1) like '%'
           AND '1'||human_readable_decimal_byte_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
           AND '1'||human_readable_decimal_byte_format(session_length, 1) IN ('0'||human_readable_decimal_byte_format(session_length, 1),
                                                                              1||human_readable_decimal_byte_format(session_length, 1),
                                                                              2||human_readable_decimal_byte_format(session_length, 1))
           AND '1'||human_readable_decimal_byte_format(session_length, 1) NOT IN ('0'||human_readable_decimal_byte_format(session_length, 1),
                                                                                  2||human_readable_decimal_byte_format(session_length, 1)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS NULL
       OR '1'||human_readable_decimal_byte_format(session_length, 1) IN
         (SELECT '1'||human_readable_decimal_byte_format(session_length, 1)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS NULL
                 OR ('1'||human_readable_decimal_byte_format(session_length, 1) = 1||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) IS NOT DISTINCT
                     FROM 1||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)
                     AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS DISTINCT
                          FROM '0'||human_readable_decimal_byte_format(session_length, 1))
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) > '0'||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) >= '0'||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) < 2||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) <= 2||human_readable_decimal_byte_format(session_length, 1)
                     AND ('1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)) IS TRUE
                     AND ('1'||human_readable_decimal_byte_format(session_length, 1) = '0'||human_readable_decimal_byte_format(session_length, 1)) IS NOT TRUE
                     AND ('1'||human_readable_decimal_byte_format(session_length, 1) = '0'||human_readable_decimal_byte_format(session_length, 1)) IS FALSE
                     AND ('1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)) IS NOT FALSE
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) BETWEEN '0'||human_readable_decimal_byte_format(session_length, 1) AND 2||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) NOT BETWEEN '1'||human_readable_decimal_byte_format(session_length, 1) AND '0'||human_readable_decimal_byte_format(session_length, 1)
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) like '%'
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) IN ('0'||human_readable_decimal_byte_format(session_length, 1),
                                                                                        1||human_readable_decimal_byte_format(session_length, 1),
                                                                                        2||human_readable_decimal_byte_format(session_length, 1))
                     AND '1'||human_readable_decimal_byte_format(session_length, 1) NOT IN ('0'||human_readable_decimal_byte_format(session_length, 1),
                                                                                            2||human_readable_decimal_byte_format(session_length, 1))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||human_readable_decimal_byte_format(session_length, 1),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS NULL
          OR ('1'||human_readable_decimal_byte_format(session_length, 1) = 1||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) IS NOT DISTINCT
              FROM 1||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)
              AND ('1'||human_readable_decimal_byte_format(session_length, 1) IS DISTINCT
                   FROM '0'||human_readable_decimal_byte_format(session_length, 1))
              AND '1'||human_readable_decimal_byte_format(session_length, 1) > '0'||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) >= '0'||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) < 2||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) <= 2||human_readable_decimal_byte_format(session_length, 1)
              AND ('1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)) IS TRUE
              AND ('1'||human_readable_decimal_byte_format(session_length, 1) = '0'||human_readable_decimal_byte_format(session_length, 1)) IS NOT TRUE
              AND ('1'||human_readable_decimal_byte_format(session_length, 1) = '0'||human_readable_decimal_byte_format(session_length, 1)) IS FALSE
              AND ('1'||human_readable_decimal_byte_format(session_length, 1) <> '0'||human_readable_decimal_byte_format(session_length, 1)) IS NOT FALSE
              AND '1'||human_readable_decimal_byte_format(session_length, 1) BETWEEN '0'||human_readable_decimal_byte_format(session_length, 1) AND 2||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) NOT BETWEEN '1'||human_readable_decimal_byte_format(session_length, 1) AND '0'||human_readable_decimal_byte_format(session_length, 1)
              AND '1'||human_readable_decimal_byte_format(session_length, 1) like '%'
              AND '1'||human_readable_decimal_byte_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
              AND '1'||human_readable_decimal_byte_format(session_length, 1) IN ('0'||human_readable_decimal_byte_format(session_length, 1),
                                                                                 1||human_readable_decimal_byte_format(session_length, 1),
                                                                                 2||human_readable_decimal_byte_format(session_length, 1))
              AND '1'||human_readable_decimal_byte_format(session_length, 1) NOT IN ('0'||human_readable_decimal_byte_format(session_length, 1),
                                                                                     2||human_readable_decimal_byte_format(session_length, 1))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A35: human_readable_decimal_format
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||human_readable_decimal_format(session_length, 1) IS NULL
       OR ('1'||human_readable_decimal_format(session_length, 1) = 1||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) IS NOT DISTINCT
           FROM 1||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)
           AND ('1'||human_readable_decimal_format(session_length, 1) IS DISTINCT
                FROM '0'||human_readable_decimal_format(session_length, 1))
           AND '1'||human_readable_decimal_format(session_length, 1) > '0'||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) >= '0'||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) < 2||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) <= 2||human_readable_decimal_format(session_length, 1)
           AND ('1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)) IS TRUE
           AND ('1'||human_readable_decimal_format(session_length, 1) = '0'||human_readable_decimal_format(session_length, 1)) IS NOT TRUE
           AND ('1'||human_readable_decimal_format(session_length, 1) = '0'||human_readable_decimal_format(session_length, 1)) IS FALSE
           AND ('1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)) IS NOT FALSE
           AND '1'||human_readable_decimal_format(session_length, 1) BETWEEN '0'||human_readable_decimal_format(session_length, 1) AND 2||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) NOT BETWEEN '1'||human_readable_decimal_format(session_length, 1) AND '0'||human_readable_decimal_format(session_length, 1)
           AND '1'||human_readable_decimal_format(session_length, 1) like '%'
           AND '1'||human_readable_decimal_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
           AND '1'||human_readable_decimal_format(session_length, 1) IN ('0'||human_readable_decimal_format(session_length, 1),
                                                                         1||human_readable_decimal_format(session_length, 1),
                                                                         2||human_readable_decimal_format(session_length, 1))
           AND '1'||human_readable_decimal_format(session_length, 1) NOT IN ('0'||human_readable_decimal_format(session_length, 1),
                                                                             2||human_readable_decimal_format(session_length, 1)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||human_readable_decimal_format(session_length, 1) IS NULL
       OR '1'||human_readable_decimal_format(session_length, 1) IN
         (SELECT '1'||human_readable_decimal_format(session_length, 1)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||human_readable_decimal_format(session_length, 1) IS NULL
                 OR ('1'||human_readable_decimal_format(session_length, 1) = 1||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) IS NOT DISTINCT
                     FROM 1||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)
                     AND ('1'||human_readable_decimal_format(session_length, 1) IS DISTINCT
                          FROM '0'||human_readable_decimal_format(session_length, 1))
                     AND '1'||human_readable_decimal_format(session_length, 1) > '0'||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) >= '0'||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) < 2||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) <= 2||human_readable_decimal_format(session_length, 1)
                     AND ('1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)) IS TRUE
                     AND ('1'||human_readable_decimal_format(session_length, 1) = '0'||human_readable_decimal_format(session_length, 1)) IS NOT TRUE
                     AND ('1'||human_readable_decimal_format(session_length, 1) = '0'||human_readable_decimal_format(session_length, 1)) IS FALSE
                     AND ('1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)) IS NOT FALSE
                     AND '1'||human_readable_decimal_format(session_length, 1) BETWEEN '0'||human_readable_decimal_format(session_length, 1) AND 2||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) NOT BETWEEN '1'||human_readable_decimal_format(session_length, 1) AND '0'||human_readable_decimal_format(session_length, 1)
                     AND '1'||human_readable_decimal_format(session_length, 1) like '%'
                     AND '1'||human_readable_decimal_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
                     AND '1'||human_readable_decimal_format(session_length, 1) IN ('0'||human_readable_decimal_format(session_length, 1),
                                                                                   1||human_readable_decimal_format(session_length, 1),
                                                                                   2||human_readable_decimal_format(session_length, 1))
                     AND '1'||human_readable_decimal_format(session_length, 1) NOT IN ('0'||human_readable_decimal_format(session_length, 1),
                                                                                       2||human_readable_decimal_format(session_length, 1))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||human_readable_decimal_format(session_length, 1),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||human_readable_decimal_format(session_length, 1) IS NULL
          OR ('1'||human_readable_decimal_format(session_length, 1) = 1||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) IS NOT DISTINCT
              FROM 1||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)
              AND ('1'||human_readable_decimal_format(session_length, 1) IS DISTINCT
                   FROM '0'||human_readable_decimal_format(session_length, 1))
              AND '1'||human_readable_decimal_format(session_length, 1) > '0'||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) >= '0'||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) < 2||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) <= 2||human_readable_decimal_format(session_length, 1)
              AND ('1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)) IS TRUE
              AND ('1'||human_readable_decimal_format(session_length, 1) = '0'||human_readable_decimal_format(session_length, 1)) IS NOT TRUE
              AND ('1'||human_readable_decimal_format(session_length, 1) = '0'||human_readable_decimal_format(session_length, 1)) IS FALSE
              AND ('1'||human_readable_decimal_format(session_length, 1) <> '0'||human_readable_decimal_format(session_length, 1)) IS NOT FALSE
              AND '1'||human_readable_decimal_format(session_length, 1) BETWEEN '0'||human_readable_decimal_format(session_length, 1) AND 2||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) NOT BETWEEN '1'||human_readable_decimal_format(session_length, 1) AND '0'||human_readable_decimal_format(session_length, 1)
              AND '1'||human_readable_decimal_format(session_length, 1) like '%'
              AND '1'||human_readable_decimal_format(session_length, 1) not like '__DOES_NOT_EXIST__%'
              AND '1'||human_readable_decimal_format(session_length, 1) IN ('0'||human_readable_decimal_format(session_length, 1),
                                                                            1||human_readable_decimal_format(session_length, 1),
                                                                            2||human_readable_decimal_format(session_length, 1))
              AND '1'||human_readable_decimal_format(session_length, 1) NOT IN ('0'||human_readable_decimal_format(session_length, 1),
                                                                                2||human_readable_decimal_format(session_length, 1))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A36: safe_divide
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(safe_divide(session_length, session_length)) IS NULL
       OR (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))+0
           AND floor(safe_divide(session_length, session_length)) IS NOT DISTINCT
           FROM floor(safe_divide(session_length, session_length))+0
           AND floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1
           AND (floor(safe_divide(session_length, session_length)) IS DISTINCT
                FROM floor(safe_divide(session_length, session_length))-1)
           AND floor(safe_divide(session_length, session_length)) > floor(safe_divide(session_length, session_length))-1
           AND floor(safe_divide(session_length, session_length)) >= floor(safe_divide(session_length, session_length))-1
           AND floor(safe_divide(session_length, session_length)) < floor(safe_divide(session_length, session_length))+1
           AND floor(safe_divide(session_length, session_length)) <= floor(safe_divide(session_length, session_length))+1
           AND (floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1) IS TRUE
           AND (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))-1) IS NOT TRUE
           AND (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))-1) IS FALSE
           AND (floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1) IS NOT FALSE
           AND floor(safe_divide(session_length, session_length)) BETWEEN floor(safe_divide(session_length, session_length))-1 AND floor(safe_divide(session_length, session_length))+1
           AND floor(safe_divide(session_length, session_length)) NOT BETWEEN floor(safe_divide(session_length, session_length)) AND floor(safe_divide(session_length, session_length))-1
           AND floor(safe_divide(session_length, session_length)) like '%'
           AND floor(safe_divide(session_length, session_length)) not like '__DOES_NOT_EXIST__%'
           AND floor(safe_divide(session_length, session_length)) IN (floor(safe_divide(session_length, session_length))-1,
                                                                                                                        floor(safe_divide(session_length, session_length))+0,
                                                                                                                        floor(safe_divide(session_length, session_length))+1)
           AND floor(safe_divide(session_length, session_length)) NOT IN (floor(safe_divide(session_length, session_length))-1,
                                                                                                                            floor(safe_divide(session_length, session_length))+1))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (floor(safe_divide(session_length, session_length)) IS NULL
       OR floor(safe_divide(session_length, session_length)) IN
         (SELECT floor(safe_divide(session_length, session_length))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (floor(safe_divide(session_length, session_length)) IS NULL
                 OR (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))+0
                     AND floor(safe_divide(session_length, session_length)) IS NOT DISTINCT
                     FROM floor(safe_divide(session_length, session_length))+0
                     AND floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1
                     AND (floor(safe_divide(session_length, session_length)) IS DISTINCT
                          FROM floor(safe_divide(session_length, session_length))-1)
                     AND floor(safe_divide(session_length, session_length)) > floor(safe_divide(session_length, session_length))-1
                     AND floor(safe_divide(session_length, session_length)) >= floor(safe_divide(session_length, session_length))-1
                     AND floor(safe_divide(session_length, session_length)) < floor(safe_divide(session_length, session_length))+1
                     AND floor(safe_divide(session_length, session_length)) <= floor(safe_divide(session_length, session_length))+1
                     AND (floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1) IS TRUE
                     AND (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))-1) IS NOT TRUE
                     AND (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))-1) IS FALSE
                     AND (floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1) IS NOT FALSE
                     AND floor(safe_divide(session_length, session_length)) BETWEEN floor(safe_divide(session_length, session_length))-1 AND floor(safe_divide(session_length, session_length))+1
                     AND floor(safe_divide(session_length, session_length)) NOT BETWEEN floor(safe_divide(session_length, session_length)) AND floor(safe_divide(session_length, session_length))-1
                     AND floor(safe_divide(session_length, session_length)) like '%'
                     AND floor(safe_divide(session_length, session_length)) not like '__DOES_NOT_EXIST__%'
                     AND floor(safe_divide(session_length, session_length)) IN (floor(safe_divide(session_length, session_length))-1,
                                                                                                                                  floor(safe_divide(session_length, session_length))+0,
                                                                                                                                  floor(safe_divide(session_length, session_length))+1)
                     AND floor(safe_divide(session_length, session_length)) NOT IN (floor(safe_divide(session_length, session_length))-1,
                                                                                                                                      floor(safe_divide(session_length, session_length))+1)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          floor(safe_divide(session_length, session_length)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (floor(safe_divide(session_length, session_length)) IS NULL
          OR (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))+0
              AND floor(safe_divide(session_length, session_length)) IS NOT DISTINCT
              FROM floor(safe_divide(session_length, session_length))+0
              AND floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1
              AND (floor(safe_divide(session_length, session_length)) IS DISTINCT
                   FROM floor(safe_divide(session_length, session_length))-1)
              AND floor(safe_divide(session_length, session_length)) > floor(safe_divide(session_length, session_length))-1
              AND floor(safe_divide(session_length, session_length)) >= floor(safe_divide(session_length, session_length))-1
              AND floor(safe_divide(session_length, session_length)) < floor(safe_divide(session_length, session_length))+1
              AND floor(safe_divide(session_length, session_length)) <= floor(safe_divide(session_length, session_length))+1
              AND (floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1) IS TRUE
              AND (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))-1) IS NOT TRUE
              AND (floor(safe_divide(session_length, session_length)) = floor(safe_divide(session_length, session_length))-1) IS FALSE
              AND (floor(safe_divide(session_length, session_length)) <> floor(safe_divide(session_length, session_length))-1) IS NOT FALSE
              AND floor(safe_divide(session_length, session_length)) BETWEEN floor(safe_divide(session_length, session_length))-1 AND floor(safe_divide(session_length, session_length))+1
              AND floor(safe_divide(session_length, session_length)) NOT BETWEEN floor(safe_divide(session_length, session_length)) AND floor(safe_divide(session_length, session_length))-1
              AND floor(safe_divide(session_length, session_length)) like '%'
              AND floor(safe_divide(session_length, session_length)) not like '__DOES_NOT_EXIST__%'
              AND floor(safe_divide(session_length, session_length)) IN (floor(safe_divide(session_length, session_length))-1,
                                                                                                                           floor(safe_divide(session_length, session_length))+0,
                                                                                                                           floor(safe_divide(session_length, session_length))+1)
              AND floor(safe_divide(session_length, session_length)) NOT IN (floor(safe_divide(session_length, session_length))-1,
                                                                                                                               floor(safe_divide(session_length, session_length))+1)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# Total query count 109
#-------------------------------------------------------------------------
