!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=StandardComponentSupplier&datasets=sql/src/test/quidem/qatests/qaArray/sql&numMergeBuffers=3
!set outputformat mysql
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_bool
FROM test_array;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_bool" ],
  "columnTypes" : [ "ARRAY<LONG>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_int
FROM test_array;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_int" ],
  "columnTypes" : [ "ARRAY<LONG>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[1]' RETURNING bigint array)
FROM test_array;
+--------------+
| EXPR$0       |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<LONG>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 1
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<LONG>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array)
FROM test_array;
+--------------+
| EXPR$0       |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<LONG>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 1
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<LONG>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_float
FROM test_array;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_float" ],
  "columnTypes" : [ "ARRAY<DOUBLE>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[2]' RETURNING decimal array)
FROM test_array;
+------------------+
| EXPR$0           |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<DOUBLE>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 2
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<DOUBLE>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A9_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array)
FROM test_array;
+------------------+
| EXPR$0           |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<DOUBLE>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 2
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<DOUBLE>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A10_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_str
FROM test_array;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_str" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A11_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[3]' RETURNING varchar array)
FROM test_array;
+----------------+
| EXPR$0         |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 3
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A12_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array)
FROM test_array;
+----------------+
| EXPR$0         |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 3
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A13_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_null
FROM test_array;
+--------------------+
| a_null             |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_null" ],
  "columnTypes" : [ "ARRAY<LONG>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A14_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[4]' RETURNING varchar array)
FROM test_array;
+--------------------+
| EXPR$0             |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 4
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A15_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array)
FROM test_array;
+--------------------+
| EXPR$0             |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 4
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A16_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_empty
FROM test_array;
+---------+
| a_empty |
+---------+
| []      |
| []      |
| []      |
| []      |
+---------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_empty" ],
  "columnTypes" : [ "ARRAY<LONG>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A17_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[5]' RETURNING varchar array)
FROM test_array;
+--------+
| EXPR$0 |
+--------+
| []     |
| []     |
| []     |
| []     |
+--------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 5
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A18_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array)
FROM test_array;
+--------+
| EXPR$0 |
+--------+
| []     |
| []     |
| []     |
| []     |
+--------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 5
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A19_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_mixed
FROM test_array;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_mixed" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A20_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[6]' RETURNING varchar array)
FROM test_array;
+--------------------------+
| EXPR$0                   |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 6
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A21_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array)
FROM test_array;
+--------------------------+
| EXPR$0                   |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 6
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A22_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT a_nested
FROM test_array;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "resultFormat" : "compactedList",
  "columns" : [ "a_nested" ],
  "columnTypes" : [ "COMPLEX<json>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A23_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7]' RETURNING varchar array)
FROM test_array;
+--------+
| EXPR$0 |
+--------+
|        |
|        |
|        |
|        |
+--------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_explain TEST_ID: A24_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------

SELECT json_value(a_nested, '$[7][7]' RETURNING varchar array)
FROM test_array;
+--------+
| EXPR$0 |
+--------+
|        |
|        |
|        |
|        |
+--------+
(4 rows)

!ok

{
  "queryType" : "scan",
  "dataSource" : {
    "type" : "table",
    "name" : "test_array"
  },
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "virtualColumns" : [ {
    "type" : "nested-field",
    "columnName" : "a_nested",
    "outputName" : "v0",
    "expectedType" : "ARRAY<STRING>",
    "pathParts" : [ {
      "type" : "arrayElement",
      "index" : 7
    }, {
      "type" : "arrayElement",
      "index" : 7
    } ],
    "processFromRaw" : false
  } ],
  "resultFormat" : "compactedList",
  "columns" : [ "v0" ],
  "columnTypes" : [ "ARRAY<STRING>" ],
  "granularity" : {
    "type" : "all"
  },
  "legacy" : false
}
!nativePlan

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A1_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_bool) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A1_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_bool) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A2_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A2_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_int) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A2_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_int) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A3_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A3_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_float) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A3_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_float) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A4_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_str) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A4_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_str) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A5_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_null) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A5_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_null) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A6_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_empty) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A6_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_empty) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A7_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_mixed) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A7_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_mixed) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A8_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(a_nested) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   4 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_count TEST_ID: A8_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(DISTINCT a_nested) cnt
FROM test_array;
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_bool
FROM test_array;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A1_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_bool
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_int
FROM test_array;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A4_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_int
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[1]' RETURNING bigint array)
FROM test_array;
+--------------+
| EXPR$0       |
+--------------+
| [1, 2, null] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A5_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[1]' RETURNING bigint array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[7][1]' RETURNING bigint array)
FROM test_array;
+--------------+
| EXPR$0       |
+--------------+
| [1, 2, null] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A6_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[7][1]' RETURNING bigint array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_float
FROM test_array;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A7_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_float
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[2]' RETURNING decimal array)
FROM test_array;
+------------------+
| EXPR$0           |
+------------------+
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A8_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[2]' RETURNING decimal array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A9_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[7][2]' RETURNING decimal array)
FROM test_array;
+------------------+
| EXPR$0           |
+------------------+
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A9_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[7][2]' RETURNING decimal array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A10_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_str
FROM test_array;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A10_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_str
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A11_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[3]' RETURNING varchar array)
FROM test_array;
+----------------+
| EXPR$0         |
+----------------+
| [S1, S2, null] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A11_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[3]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A12_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[7][3]' RETURNING varchar array)
FROM test_array;
+----------------+
| EXPR$0         |
+----------------+
| [S1, S2, null] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A12_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[7][3]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A13_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_null
FROM test_array;
+--------------------+
| a_null             |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A13_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_null
   FROM test_array);
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A14_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[4]' RETURNING varchar array)
FROM test_array;
+--------------------+
| EXPR$0             |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A14_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[4]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A15_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[7][4]' RETURNING varchar array)
FROM test_array;
+--------------------+
| EXPR$0             |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A15_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[7][4]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A16_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_empty
FROM test_array;
+---------+
| a_empty |
+---------+
| []      |
+---------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A16_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_empty
   FROM test_array);
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A17_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[5]' RETURNING varchar array)
FROM test_array;
+--------+
| EXPR$0 |
+--------+
| []     |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A17_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[5]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A18_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[7][5]' RETURNING varchar array)
FROM test_array;
+--------+
| EXPR$0 |
+--------+
| []     |
+--------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A18_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[7][5]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   1 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A19_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_mixed
FROM test_array;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A19_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_mixed
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A20_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[6]' RETURNING varchar array)
FROM test_array;
+--------------------------+
| EXPR$0                   |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A20_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[6]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A21_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_value(a_nested, '$[7][6]' RETURNING varchar array)
FROM test_array;
+--------------------------+
| EXPR$0                   |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A21_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_value(a_nested, '$[7][6]' RETURNING varchar array)
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A22_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT a_nested
FROM test_array;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A22_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT a_nested
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A23_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_query(a_nested, '$[7]')
FROM test_array;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| EXPR$0                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A23_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_query(a_nested, '$[7]')
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A24_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT DISTINCT json_query(a_nested, '$[7][7]')
FROM test_array;
+-----------------------------------------------------------------------------------------------------------+
| EXPR$0                                                                                                    |
+-----------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |
+-----------------------------------------------------------------------------------------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_select_distinct TEST_ID: A24_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM
  (SELECT DISTINCT json_query(a_nested, '$[7][7]')
   FROM test_array);
+-----+
| cnt |
+-----+
|   2 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_int;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_int
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_int);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_int)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_int;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_int
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_int)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_int)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_int;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_int
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_float;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_float
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_float);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_float)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_float;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_float
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_float)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_float)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_float;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_float
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_str);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_str)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_str)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_str)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B3_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_null);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_null)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_null)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_null)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B4_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_empty);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_empty)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_empty)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_empty)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B5_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_mixed);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_mixed)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_mixed)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_mixed)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B6_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_bool=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_bool=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_bool=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B7_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_bool=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=a_float;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=a_float
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_float);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_float)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_float;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_float
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_float)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_float)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=a_float;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=a_float
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_str);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_str)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_str)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_str)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_null);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_null)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_null)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_null)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_empty);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_empty)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_empty)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_empty)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_mixed);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_mixed)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_mixed)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_mixed)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B13_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_float=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_float=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_str);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_str)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_str)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_str)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_float=a_str;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_float=a_str
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_float=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_float=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_null);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_null)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_null)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_null)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_float=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B15_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_float=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_float=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_float=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_empty);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_empty)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_empty)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_empty)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_float=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B16_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_float=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_float=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_float=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_mixed);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_mixed)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_mixed)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_mixed)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_float=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B17_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_float=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_float=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_float=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_float=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B18_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_float=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_str=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_str=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_null);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_null)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_null)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_null)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_str=a_null;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_str=a_null
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_str=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_str=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_empty);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_empty)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_empty)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_empty)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_str=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_str=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_str=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_str=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_mixed);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_mixed)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_mixed)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_mixed)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_str=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B21_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_str=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_str=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_str=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_str=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B22_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_str=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_null=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_null=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_null=a_empty);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_null=a_empty)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_null=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_null=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_null=a_empty)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_null=a_empty)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_null=a_empty;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B23_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_null=a_empty
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_null=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_null=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_null=a_mixed);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_null=a_mixed)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_null=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_null=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_null=a_mixed)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_null=a_mixed)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_null=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B24_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_null=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_null=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_null=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_null=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_null=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_null=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_null=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_null=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_null=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_null=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B25_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_null=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_empty=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_empty=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_empty=a_mixed);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_empty=a_mixed)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_empty=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_empty=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_empty=a_mixed)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_empty=a_mixed)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_empty=a_mixed;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B26_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_empty=a_mixed
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_empty=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_empty=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_empty=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_empty=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_empty=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_empty=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_empty=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_empty=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_empty=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B27_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_empty=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_mixed=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_mixed=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=a_nested)
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=a_nested)
SELECT a_int
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=a_nested)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_mixed=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A0_B28_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_mixed=a_nested
GROUP BY a_int;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool=ARRAY[1,
                   0];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool=ARRAY[1,
                   0]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0]);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0])
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=ARRAY[1,
                   0];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=ARRAY[1,
                   0]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0])
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool=ARRAY[1,
                   0];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool=ARRAY[1,
                   0]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool=ARRAY[1,
                   0,
                   NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool=ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0,
                      NULL]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0,
                      NULL])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=ARRAY[1,
                   0,
                   NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0,
                      NULL])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      0,
                      NULL])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool=ARRAY[1,
                   0,
                   NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool=ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool=ARRAY[1,
                   2,
                   3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool=ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      2,
                      3]);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      2,
                      3])
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=ARRAY[1,
                   2,
                   3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      2,
                      3])
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=ARRAY[1,
                      2,
                      3])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool=ARRAY[1,
                   2,
                   3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B3_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool=ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B4_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B5_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<>ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<>ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<>ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B6_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<>ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<>ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<>ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0,
                       NULL]);
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0,
                       NULL])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0,
                       NULL])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       0,
                       NULL])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<>ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B7_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<>ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<>ARRAY[1,
                    2,
                    3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<>ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       2,
                       3]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       2,
                       3])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>ARRAY[1,
                    2,
                    3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       2,
                       3])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>ARRAY[1,
                       2,
                       3])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<>ARRAY[1,
                    2,
                    3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<>ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<>json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>ARRAY[1,
                   0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>ARRAY[1,
                   0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>ARRAY[1,
                   0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>ARRAY[1,
                   0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>ARRAY[1,
                   0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>ARRAY[1,
                   0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>ARRAY[1,
                   0,
                   NULL];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0,
                      NULL]);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0,
                      NULL])
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>ARRAY[1,
                   0,
                   NULL];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0,
                      NULL])
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      0,
                      NULL])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>ARRAY[1,
                   0,
                   NULL];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>ARRAY[1,
                   2,
                   3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      2,
                      3]);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      2,
                      3])
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>ARRAY[1,
                   2,
                   3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      2,
                      3])
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>ARRAY[1,
                      2,
                      3])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>ARRAY[1,
                   2,
                   3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B13_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B15_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>=ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>=ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>=ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B16_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>=ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>=ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>=ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0,
                       NULL]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0,
                       NULL])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0,
                       NULL])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       0,
                       NULL])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>=ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B17_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>=ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>=ARRAY[1,
                    2,
                    3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>=ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       2,
                       3]);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       2,
                       3])
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=ARRAY[1,
                    2,
                    3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       2,
                       3])
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=ARRAY[1,
                       2,
                       3])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>=ARRAY[1,
                    2,
                    3];
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B18_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>=ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<ARRAY[1,
                   0];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<ARRAY[1,
                   0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0]);
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<ARRAY[1,
                   0];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<ARRAY[1,
                   0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<ARRAY[1,
                   0];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B21_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<ARRAY[1,
                   0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<ARRAY[1,
                   0,
                   NULL];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0,
                      NULL]);
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0,
                      NULL])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<ARRAY[1,
                   0,
                   NULL];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0,
                      NULL])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      0,
                      NULL])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<ARRAY[1,
                   0,
                   NULL];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B22_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<ARRAY[1,
                   0,
                   NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<ARRAY[1,
                   2,
                   3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      2,
                      3]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      2,
                      3])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<ARRAY[1,
                   2,
                   3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      2,
                      3])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<ARRAY[1,
                      2,
                      3])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<ARRAY[1,
                   2,
                   3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B23_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<ARRAY[1,
                   2,
                   3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B24_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B25_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<=ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<=ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0]);
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<=ARRAY[1,
                    0];
+--------------+
| a_bool       |
+--------------+
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B26_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<=ARRAY[1,
                    0]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<=ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<=ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0,
                       NULL]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0,
                       NULL])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0,
                       NULL])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       0,
                       NULL])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<=ARRAY[1,
                    0,
                    NULL];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B27_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<=ARRAY[1,
                    0,
                    NULL]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<=ARRAY[1,
                    2,
                    3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<=ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       2,
                       3]);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       2,
                       3])
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=ARRAY[1,
                    2,
                    3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       2,
                       3])
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=ARRAY[1,
                       2,
                       3])
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<=ARRAY[1,
                    2,
                    3];
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B28_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<=ARRAY[1,
                    2,
                    3]
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B29_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B30_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<=json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
  AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
           AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
  AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
           AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
     AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
              AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
     AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
              AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
  AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
           AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
  AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
           AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
     AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
              AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
     AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
              AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
  AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
           AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B31_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array)
  AND NOT (a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
           AND a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
  OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
  OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
  OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
  OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
     OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
     OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
     OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
     OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
  OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
  OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
  OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
  OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
     OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
     OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
     OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
     OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
     OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
  OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
  OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B32_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE NOT (a_bool<=json_value(a_nested, '$[0]' RETURNING boolean array))
  OR NOT (a_bool>=json_value(a_nested, '$[7][0]' RETURNING boolean array))
  OR a_bool=json_value(a_nested, '$[0]' RETURNING boolean array)
  OR a_bool<>json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool IS NULL;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool IS NULL
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IS NULL);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IS NULL)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IS NULL;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IS NULL
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IS NULL)
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IS NULL)
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool IS NULL;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B33_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool IS NULL
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool IS NOT NULL;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool IS NOT NULL
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IS NOT NULL);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IS NOT NULL)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IS NOT NULL;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IS NOT NULL
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IS NOT NULL)
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IS NOT NULL)
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool IS NOT NULL;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B34_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool IS NOT NULL
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE)
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE)
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B35_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS TRUE
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE)
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE)
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B36_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT TRUE
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE)
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE)
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B37_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS FALSE
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE)
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE)
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B38_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE (a_bool<json_value(a_nested, '$[0]' RETURNING boolean array)) IS NOT FALSE
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B39_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array);
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B40_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool NOT BETWEEN json_value(a_nested, '$[0]' RETURNING boolean array) AND json_value(a_nested, '$[7][0]' RETURNING boolean array)
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE array_to_string(a_bool, ',') like '%';
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE array_to_string(a_bool, ',') like '%'
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_bool, ',') like '%');
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_bool, ',') like '%')
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_bool, ',') like '%';
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_bool, ',') like '%'
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_bool, ',') like '%')
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_bool, ',') like '%')
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE array_to_string(a_bool, ',') like '%';
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B41_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE array_to_string(a_bool, ',') like '%'
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%';
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%'
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%');
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%')
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%';
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%'
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%')
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%')
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%';
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B42_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE array_to_string(json_value(a_nested, '$[0]' RETURNING boolean array), ',') not like '%'
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                 json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                 json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                    json_value(a_nested, '$[7][0]' RETURNING boolean array)));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                    json_value(a_nested, '$[7][0]' RETURNING boolean array)))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                 json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                 json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                    json_value(a_nested, '$[7][0]' RETURNING boolean array)))
SELECT a_bool
FROM t1;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                    json_value(a_nested, '$[7][0]' RETURNING boolean array)))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                 json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B43_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                 json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------------+-----+
| a_bool       | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                     json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                     json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                        json_value(a_nested, '$[7][0]' RETURNING boolean array)));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                        json_value(a_nested, '$[7][0]' RETURNING boolean array)))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                     json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                     json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                        json_value(a_nested, '$[7][0]' RETURNING boolean array)))
SELECT a_bool
FROM t1;
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                        json_value(a_nested, '$[7][0]' RETURNING boolean array)))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                     json_value(a_nested, '$[7][0]' RETURNING boolean array));
+--------+
| a_bool |
+--------+
+--------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B44_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool NOT IN (json_value(a_nested, '$[0]' RETURNING boolean array),
                     json_value(a_nested, '$[7][0]' RETURNING boolean array))
GROUP BY a_bool;
+--------+-----+
| a_bool | cnt |
+--------+-----+
+--------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool IN
    (SELECT a_bool
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool IN
    (SELECT a_bool
     FROM test_array)
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IN
       (SELECT a_bool
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool IN
       (SELECT a_bool
        FROM test_array))
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IN
    (SELECT a_bool
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool IN
    (SELECT a_bool
     FROM test_array)
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IN
       (SELECT a_bool
        FROM test_array))
SELECT a_bool
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool IN
       (SELECT a_bool
        FROM test_array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool IN
    (SELECT a_bool
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B45_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool IN
    (SELECT a_bool
     FROM test_array)
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM test_array
WHERE a_bool NOT IN
    (SELECT a_bool
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM test_array
WHERE a_bool NOT IN
    (SELECT a_bool
     FROM test_array)
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN
       (SELECT a_bool
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN
       (SELECT a_bool
        FROM test_array))
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool NOT IN
    (SELECT a_bool
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_bool NOT IN
    (SELECT a_bool
     FROM test_array)
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN
       (SELECT a_bool
        FROM test_array))
SELECT a_bool
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_bool NOT IN
       (SELECT a_bool
        FROM test_array))
SELECT a_bool,
       count(*) cnt
FROM t1
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool
FROM t1
WHERE a_bool NOT IN
    (SELECT a_bool
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A1_B46_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_bool,
       count(*) cnt
FROM t1
WHERE a_bool NOT IN
    (SELECT a_bool
     FROM test_array)
GROUP BY a_bool;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=ARRAY[1,
                  2];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=ARRAY[1,
                  2]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2]);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2])
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=ARRAY[1,
                  2];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=ARRAY[1,
                  2]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2])
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=ARRAY[1,
                  2];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=ARRAY[1,
                  2]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=ARRAY[1,
                  2,
                  NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     NULL]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     NULL])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=ARRAY[1,
                  2,
                  NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     NULL])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     NULL])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=ARRAY[1,
                  2,
                  NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=ARRAY[1,
                  2,
                  3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     3]);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     3])
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=ARRAY[1,
                  2,
                  3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     3])
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=ARRAY[1,
                     2,
                     3])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=ARRAY[1,
                  2,
                  3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B3_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B4_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B5_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<>ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<>ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<>ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B6_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<>ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<>ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<>ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      NULL]);
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      NULL])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      NULL])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      NULL])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<>ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B7_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<>ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<>ARRAY[1,
                   2,
                   3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<>ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      3]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      3])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>ARRAY[1,
                   2,
                   3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      3])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>ARRAY[1,
                      2,
                      3])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<>ARRAY[1,
                   2,
                   3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<>ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<>json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>ARRAY[1,
                  2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>ARRAY[1,
                  2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>ARRAY[1,
                  2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>ARRAY[1,
                  2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>ARRAY[1,
                  2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>ARRAY[1,
                  2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>ARRAY[1,
                  2,
                  NULL];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     NULL]);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     NULL])
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>ARRAY[1,
                  2,
                  NULL];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     NULL])
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     NULL])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>ARRAY[1,
                  2,
                  NULL];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>ARRAY[1,
                  2,
                  3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     3]);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     3])
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>ARRAY[1,
                  2,
                  3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     3])
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>ARRAY[1,
                     2,
                     3])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>ARRAY[1,
                  2,
                  3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B13_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B15_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>=ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>=ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>=ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B16_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>=ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>=ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>=ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      NULL]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      NULL])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      NULL])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      NULL])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>=ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B17_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>=ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>=ARRAY[1,
                   2,
                   3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>=ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      3]);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      3])
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=ARRAY[1,
                   2,
                   3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      3])
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=ARRAY[1,
                      2,
                      3])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>=ARRAY[1,
                   2,
                   3];
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B18_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>=ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<ARRAY[1,
                  2];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<ARRAY[1,
                  2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2]);
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<ARRAY[1,
                  2];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<ARRAY[1,
                  2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<ARRAY[1,
                  2];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B21_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<ARRAY[1,
                  2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<ARRAY[1,
                  2,
                  NULL];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     NULL]);
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     NULL])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<ARRAY[1,
                  2,
                  NULL];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     NULL])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     NULL])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<ARRAY[1,
                  2,
                  NULL];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B22_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<ARRAY[1,
                  2,
                  NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<ARRAY[1,
                  2,
                  3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     3]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     3])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<ARRAY[1,
                  2,
                  3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     3])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<ARRAY[1,
                     2,
                     3])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<ARRAY[1,
                  2,
                  3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B23_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<ARRAY[1,
                  2,
                  3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B24_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B25_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<=ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<=ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2]);
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<=ARRAY[1,
                   2];
+--------------+
| a_int        |
+--------------+
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B26_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<=ARRAY[1,
                   2]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<=ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<=ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      NULL]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      NULL])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      NULL])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      NULL])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<=ARRAY[1,
                   2,
                   NULL];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B27_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<=ARRAY[1,
                   2,
                   NULL]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<=ARRAY[1,
                   2,
                   3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<=ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      3]);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      3])
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=ARRAY[1,
                   2,
                   3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      3])
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=ARRAY[1,
                      2,
                      3])
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<=ARRAY[1,
                   2,
                   3];
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B28_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<=ARRAY[1,
                   2,
                   3]
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B29_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B30_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<=json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
  AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
           AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
  AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
           AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
     AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
              AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
     AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
              AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
  AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
           AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
  AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
           AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
     AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
              AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
     AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
              AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
  AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
           AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B31_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int<=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array)
  AND NOT (a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
           AND a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
  OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
  OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
  OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
  OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
     OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
     OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
     OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
     OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
  OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
  OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
  OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
  OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
     OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
     OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
     OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
     OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
     OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
  OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
  OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B32_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE NOT (a_int<=json_value(a_nested, '$[1]' RETURNING bigint array))
  OR NOT (a_int>=json_value(a_nested, '$[7][1]' RETURNING bigint array))
  OR a_int=json_value(a_nested, '$[1]' RETURNING bigint array)
  OR a_int<>json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int IS NULL;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int IS NULL
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IS NULL);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IS NULL)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IS NULL;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IS NULL
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IS NULL)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IS NULL)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int IS NULL;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B33_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int IS NULL
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int IS NOT NULL;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int IS NOT NULL
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IS NOT NULL);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IS NOT NULL)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IS NOT NULL;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IS NOT NULL
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IS NOT NULL)
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IS NOT NULL)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int IS NOT NULL;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B34_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int IS NOT NULL
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B35_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS TRUE
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE)
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B36_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT TRUE
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE)
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B37_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS FALSE
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE)
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE)
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B38_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE (a_int<json_value(a_nested, '$[1]' RETURNING bigint array)) IS NOT FALSE
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B39_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array);
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B40_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int NOT BETWEEN json_value(a_nested, '$[1]' RETURNING bigint array) AND json_value(a_nested, '$[7][1]' RETURNING bigint array)
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE array_to_string(a_int, ',') like '%';
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE array_to_string(a_int, ',') like '%'
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_int, ',') like '%');
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_int, ',') like '%')
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_int, ',') like '%';
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_int, ',') like '%'
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_int, ',') like '%')
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_int, ',') like '%')
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE array_to_string(a_int, ',') like '%';
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B41_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE array_to_string(a_int, ',') like '%'
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%';
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%'
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%');
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%')
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%';
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%'
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%')
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%')
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%';
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B42_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE array_to_string(json_value(a_nested, '$[1]' RETURNING bigint array), ',') not like '%'
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                   json_value(a_nested, '$[7][1]' RETURNING bigint array)));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                   json_value(a_nested, '$[7][1]' RETURNING bigint array)))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                   json_value(a_nested, '$[7][1]' RETURNING bigint array)))
SELECT a_int
FROM t1;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                   json_value(a_nested, '$[7][1]' RETURNING bigint array)))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B43_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+--------------+-----+
| a_int        | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                    json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                    json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                       json_value(a_nested, '$[7][1]' RETURNING bigint array)));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                       json_value(a_nested, '$[7][1]' RETURNING bigint array)))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                    json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                    json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                       json_value(a_nested, '$[7][1]' RETURNING bigint array)))
SELECT a_int
FROM t1;
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                       json_value(a_nested, '$[7][1]' RETURNING bigint array)))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                    json_value(a_nested, '$[7][1]' RETURNING bigint array));
+-------+
| a_int |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B44_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int NOT IN (json_value(a_nested, '$[1]' RETURNING bigint array),
                    json_value(a_nested, '$[7][1]' RETURNING bigint array))
GROUP BY a_int;
+-------+-----+
| a_int | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int IN
    (SELECT a_int
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int IN
    (SELECT a_int
     FROM test_array)
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IN
       (SELECT a_int
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int IN
       (SELECT a_int
        FROM test_array))
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IN
    (SELECT a_int
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int IN
    (SELECT a_int
     FROM test_array)
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IN
       (SELECT a_int
        FROM test_array))
SELECT a_int
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int IN
       (SELECT a_int
        FROM test_array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int IN
    (SELECT a_int
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B45_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int IN
    (SELECT a_int
     FROM test_array)
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM test_array
WHERE a_int NOT IN
    (SELECT a_int
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM test_array
WHERE a_int NOT IN
    (SELECT a_int
     FROM test_array)
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN
       (SELECT a_int
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN
       (SELECT a_int
        FROM test_array))
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array)
WHERE a_int NOT IN
    (SELECT a_int
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_int NOT IN
    (SELECT a_int
     FROM test_array)
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN
       (SELECT a_int
        FROM test_array))
SELECT a_int
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_int NOT IN
       (SELECT a_int
        FROM test_array))
SELECT a_int,
       count(*) cnt
FROM t1
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int
FROM t1
WHERE a_int NOT IN
    (SELECT a_int
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A2_B46_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_int,
       count(*) cnt
FROM t1
WHERE a_int NOT IN
    (SELECT a_int
     FROM test_array)
GROUP BY a_int;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float=ARRAY[0.1,
                    0.2];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float=ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2]);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2])
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=ARRAY[0.1,
                    0.2];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2])
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float=ARRAY[0.1,
                    0.2];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float=ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float=ARRAY[0.1,
                    0.2,
                    NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float=ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       NULL]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       NULL])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=ARRAY[0.1,
                    0.2,
                    NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       NULL])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       NULL])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float=ARRAY[0.1,
                    0.2,
                    NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float=ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float=ARRAY[0.1,
                    0.2,
                    0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float=ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       0.3]);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       0.3])
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=ARRAY[0.1,
                    0.2,
                    0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       0.3])
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=ARRAY[0.1,
                       0.2,
                       0.3])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float=ARRAY[0.1,
                    0.2,
                    0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B3_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float=ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B4_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B5_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<>ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<>ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<>ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B6_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<>ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        NULL]);
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        NULL])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        NULL])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        NULL])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B7_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        0.3]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        0.3])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        0.3])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>ARRAY[0.1,
                        0.2,
                        0.3])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<>ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<>json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>ARRAY[0.1,
                    0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>ARRAY[0.1,
                    0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>ARRAY[0.1,
                    0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>ARRAY[0.1,
                    0.2,
                    NULL];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       NULL]);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       NULL])
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>ARRAY[0.1,
                    0.2,
                    NULL];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       NULL])
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       NULL])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>ARRAY[0.1,
                    0.2,
                    NULL];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>ARRAY[0.1,
                    0.2,
                    0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       0.3]);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       0.3])
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>ARRAY[0.1,
                    0.2,
                    0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       0.3])
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>ARRAY[0.1,
                       0.2,
                       0.3])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>ARRAY[0.1,
                    0.2,
                    0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B13_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B15_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>=ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>=ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>=ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B16_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>=ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        NULL]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        NULL])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        NULL])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        NULL])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B17_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        0.3]);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        0.3])
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        0.3])
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=ARRAY[0.1,
                        0.2,
                        0.3])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     0.3];
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B18_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>=ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<ARRAY[0.1,
                    0.2];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2]);
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<ARRAY[0.1,
                    0.2];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<ARRAY[0.1,
                    0.2];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B21_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<ARRAY[0.1,
                    0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<ARRAY[0.1,
                    0.2,
                    NULL];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       NULL]);
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       NULL])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<ARRAY[0.1,
                    0.2,
                    NULL];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       NULL])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       NULL])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<ARRAY[0.1,
                    0.2,
                    NULL];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B22_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<ARRAY[0.1,
                    0.2,
                    NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<ARRAY[0.1,
                    0.2,
                    0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       0.3]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       0.3])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<ARRAY[0.1,
                    0.2,
                    0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       0.3])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<ARRAY[0.1,
                       0.2,
                       0.3])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<ARRAY[0.1,
                    0.2,
                    0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B23_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<ARRAY[0.1,
                    0.2,
                    0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B24_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B25_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<=ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<=ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2]);
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<=ARRAY[0.1,
                     0.2];
+------------------+
| a_float          |
+------------------+
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B26_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<=ARRAY[0.1,
                     0.2]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        NULL]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        NULL])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        NULL])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        NULL])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B27_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     NULL]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        0.3]);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        0.3])
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        0.3])
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=ARRAY[0.1,
                        0.2,
                        0.3])
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     0.3];
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B28_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<=ARRAY[0.1,
                     0.2,
                     0.3]
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B29_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B30_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<=json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
  AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
           AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
  AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
           AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
     AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
              AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
     AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
              AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
  AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
           AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
  AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
           AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
     AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
              AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
     AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
              AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
  AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
           AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B31_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float<=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array)
  AND NOT (a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
           AND a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
  OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
  OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
  OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
  OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
     OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
     OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
     OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
     OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
  OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
  OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
  OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
  OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
     OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
     OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
     OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
     OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
     OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
  OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
  OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B32_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE NOT (a_float<=json_value(a_nested, '$[2]' RETURNING decimal array))
  OR NOT (a_float>=json_value(a_nested, '$[7][2]' RETURNING decimal array))
  OR a_float=json_value(a_nested, '$[2]' RETURNING decimal array)
  OR a_float<>json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float IS NULL;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float IS NULL
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IS NULL);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IS NULL)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IS NULL;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IS NULL
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IS NULL)
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IS NULL)
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float IS NULL;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B33_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float IS NULL
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float IS NOT NULL;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float IS NOT NULL
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IS NOT NULL);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IS NOT NULL)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IS NOT NULL;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IS NOT NULL
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IS NOT NULL)
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IS NOT NULL)
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float IS NOT NULL;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B34_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float IS NOT NULL
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE)
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE)
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B35_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS TRUE
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE)
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE)
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B36_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT TRUE
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE)
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE)
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B37_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS FALSE
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE)
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE)
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B38_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE (a_float<json_value(a_nested, '$[2]' RETURNING decimal array)) IS NOT FALSE
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B39_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array);
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B40_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float NOT BETWEEN json_value(a_nested, '$[2]' RETURNING decimal array) AND json_value(a_nested, '$[7][2]' RETURNING decimal array)
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE array_to_string(a_float, ',') like '%';
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE array_to_string(a_float, ',') like '%'
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_float, ',') like '%');
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_float, ',') like '%')
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_float, ',') like '%';
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_float, ',') like '%'
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_float, ',') like '%')
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_float, ',') like '%')
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE array_to_string(a_float, ',') like '%';
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B41_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE array_to_string(a_float, ',') like '%'
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%';
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%'
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%');
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%')
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%';
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%'
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%')
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%')
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%';
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B42_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE array_to_string(json_value(a_nested, '$[2]' RETURNING decimal array), ',') not like '%'
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                  json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                  json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                     json_value(a_nested, '$[7][2]' RETURNING decimal array)));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                     json_value(a_nested, '$[7][2]' RETURNING decimal array)))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                  json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                  json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                     json_value(a_nested, '$[7][2]' RETURNING decimal array)))
SELECT a_float
FROM t1;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                     json_value(a_nested, '$[7][2]' RETURNING decimal array)))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                  json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B43_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                  json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+------------------+-----+
| a_float          | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                      json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                      json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                         json_value(a_nested, '$[7][2]' RETURNING decimal array)));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                         json_value(a_nested, '$[7][2]' RETURNING decimal array)))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                      json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                      json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                         json_value(a_nested, '$[7][2]' RETURNING decimal array)))
SELECT a_float
FROM t1;
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                         json_value(a_nested, '$[7][2]' RETURNING decimal array)))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                      json_value(a_nested, '$[7][2]' RETURNING decimal array));
+---------+
| a_float |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B44_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float NOT IN (json_value(a_nested, '$[2]' RETURNING decimal array),
                      json_value(a_nested, '$[7][2]' RETURNING decimal array))
GROUP BY a_float;
+---------+-----+
| a_float | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float IN
    (SELECT a_float
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float IN
    (SELECT a_float
     FROM test_array)
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IN
       (SELECT a_float
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float IN
       (SELECT a_float
        FROM test_array))
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IN
    (SELECT a_float
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float IN
    (SELECT a_float
     FROM test_array)
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IN
       (SELECT a_float
        FROM test_array))
SELECT a_float
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float IN
       (SELECT a_float
        FROM test_array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float IN
    (SELECT a_float
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B45_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float IN
    (SELECT a_float
     FROM test_array)
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM test_array
WHERE a_float NOT IN
    (SELECT a_float
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM test_array
WHERE a_float NOT IN
    (SELECT a_float
     FROM test_array)
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN
       (SELECT a_float
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN
       (SELECT a_float
        FROM test_array))
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array)
WHERE a_float NOT IN
    (SELECT a_float
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_float NOT IN
    (SELECT a_float
     FROM test_array)
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN
       (SELECT a_float
        FROM test_array))
SELECT a_float
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_float NOT IN
       (SELECT a_float
        FROM test_array))
SELECT a_float,
       count(*) cnt
FROM t1
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float
FROM t1
WHERE a_float NOT IN
    (SELECT a_float
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A3_B46_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_float,
       count(*) cnt
FROM t1
WHERE a_float NOT IN
    (SELECT a_float
     FROM test_array)
GROUP BY a_float;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str=ARRAY['S1',
                  'S2'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str=ARRAY['S1',
                  'S2']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2']);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2'])
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=ARRAY['S1',
                  'S2'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=ARRAY['S1',
                  'S2']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2'])
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str=ARRAY['S1',
                  'S2'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str=ARRAY['S1',
                  'S2']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str=ARRAY['S1',
                  'S2',
                  NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str=ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     NULL]);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     NULL])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=ARRAY['S1',
                  'S2',
                  NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     NULL])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     NULL])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str=ARRAY['S1',
                  'S2',
                  NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str=ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str=ARRAY['S1',
                  'S2',
                  'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str=ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     'S3']);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     'S3'])
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=ARRAY['S1',
                  'S2',
                  'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     'S3'])
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=ARRAY['S1',
                     'S2',
                     'S3'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str=ARRAY['S1',
                  'S2',
                  'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B3_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str=ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B4_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B5_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<>ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<>ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2']);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<>ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B6_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<>ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<>ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<>ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      NULL]);
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      NULL])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      NULL])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      NULL])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<>ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B7_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<>ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<>ARRAY['S1',
                   'S2',
                   'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<>ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      'S3']);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      'S3'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>ARRAY['S1',
                   'S2',
                   'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      'S3'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>ARRAY['S1',
                      'S2',
                      'S3'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<>ARRAY['S1',
                   'S2',
                   'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<>ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<>json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>ARRAY['S1',
                  'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>ARRAY['S1',
                  'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2']);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>ARRAY['S1',
                  'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>ARRAY['S1',
                  'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>ARRAY['S1',
                  'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>ARRAY['S1',
                  'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>ARRAY['S1',
                  'S2',
                  NULL];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     NULL]);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     NULL])
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>ARRAY['S1',
                  'S2',
                  NULL];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     NULL])
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     NULL])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>ARRAY['S1',
                  'S2',
                  NULL];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>ARRAY['S1',
                  'S2',
                  'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     'S3']);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     'S3'])
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>ARRAY['S1',
                  'S2',
                  'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     'S3'])
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>ARRAY['S1',
                     'S2',
                     'S3'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>ARRAY['S1',
                  'S2',
                  'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B13_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B15_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>=ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>=ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2']);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>=ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B16_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>=ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>=ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      NULL]);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      NULL])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      NULL])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      NULL])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B17_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>=ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>=ARRAY['S1',
                   'S2',
                   'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>=ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      'S3']);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      'S3'])
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=ARRAY['S1',
                   'S2',
                   'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      'S3'])
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=ARRAY['S1',
                      'S2',
                      'S3'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>=ARRAY['S1',
                   'S2',
                   'S3'];
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B18_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>=ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<ARRAY['S1',
                  'S2'];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<ARRAY['S1',
                  'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2']);
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<ARRAY['S1',
                  'S2'];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<ARRAY['S1',
                  'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<ARRAY['S1',
                  'S2'];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B21_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<ARRAY['S1',
                  'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<ARRAY['S1',
                  'S2',
                  NULL];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     NULL]);
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     NULL])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<ARRAY['S1',
                  'S2',
                  NULL];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     NULL])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     NULL])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<ARRAY['S1',
                  'S2',
                  NULL];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B22_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<ARRAY['S1',
                  'S2',
                  NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<ARRAY['S1',
                  'S2',
                  'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     'S3']);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     'S3'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<ARRAY['S1',
                  'S2',
                  'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     'S3'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<ARRAY['S1',
                     'S2',
                     'S3'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<ARRAY['S1',
                  'S2',
                  'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B23_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<ARRAY['S1',
                  'S2',
                  'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B24_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B25_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<=ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<=ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2']);
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<=ARRAY['S1',
                   'S2'];
+----------------+
| a_str          |
+----------------+
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B26_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<=ARRAY['S1',
                   'S2']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<=ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      NULL]);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      NULL])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      NULL])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      NULL])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B27_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<=ARRAY['S1',
                   'S2',
                   NULL]
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<=ARRAY['S1',
                   'S2',
                   'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<=ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      'S3']);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      'S3'])
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=ARRAY['S1',
                   'S2',
                   'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      'S3'])
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=ARRAY['S1',
                      'S2',
                      'S3'])
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<=ARRAY['S1',
                   'S2',
                   'S3'];
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B28_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<=ARRAY['S1',
                   'S2',
                   'S3']
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B29_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B30_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<=json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
  AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
           AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
  AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
           AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
     AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
              AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
     AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
              AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
  AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
           AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
  AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
           AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
     AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
              AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
     AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
              AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
  AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
           AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B31_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str<=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array)
  AND NOT (a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
           AND a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
  OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
  OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
  OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
  OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
     OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
     OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
     OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
     OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
  OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
  OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
  OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
  OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
     OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
     OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
     OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
     OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
     OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
  OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
  OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B32_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE NOT (a_str<=json_value(a_nested, '$[3]' RETURNING varchar array))
  OR NOT (a_str>=json_value(a_nested, '$[7][3]' RETURNING varchar array))
  OR a_str=json_value(a_nested, '$[3]' RETURNING varchar array)
  OR a_str<>json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str IS NULL;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str IS NULL
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IS NULL);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IS NULL)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IS NULL;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IS NULL
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IS NULL)
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IS NULL)
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str IS NULL;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B33_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str IS NULL
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str IS NOT NULL;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str IS NOT NULL
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IS NOT NULL);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IS NOT NULL)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IS NOT NULL;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IS NOT NULL
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IS NOT NULL)
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IS NOT NULL)
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str IS NOT NULL;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B34_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str IS NOT NULL
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE)
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE)
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B35_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS TRUE
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE)
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE)
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B36_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT TRUE
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE)
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE)
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B37_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS FALSE
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE)
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE)
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B38_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE (a_str<json_value(a_nested, '$[3]' RETURNING varchar array)) IS NOT FALSE
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B39_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array);
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B40_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str NOT BETWEEN json_value(a_nested, '$[3]' RETURNING varchar array) AND json_value(a_nested, '$[7][3]' RETURNING varchar array)
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE array_to_string(a_str, ',') like '%';
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE array_to_string(a_str, ',') like '%'
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_str, ',') like '%');
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_str, ',') like '%')
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_str, ',') like '%';
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_str, ',') like '%'
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_str, ',') like '%')
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_str, ',') like '%')
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE array_to_string(a_str, ',') like '%';
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B41_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE array_to_string(a_str, ',') like '%'
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%';
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%'
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%');
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%')
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%';
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%'
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%')
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%')
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%';
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B42_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE array_to_string(json_value(a_nested, '$[3]' RETURNING varchar array), ',') not like '%'
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                   json_value(a_nested, '$[7][3]' RETURNING varchar array)));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                   json_value(a_nested, '$[7][3]' RETURNING varchar array)))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                   json_value(a_nested, '$[7][3]' RETURNING varchar array)))
SELECT a_str
FROM t1;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                   json_value(a_nested, '$[7][3]' RETURNING varchar array)))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B43_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+----------------+-----+
| a_str          | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                    json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                    json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                       json_value(a_nested, '$[7][3]' RETURNING varchar array)));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                       json_value(a_nested, '$[7][3]' RETURNING varchar array)))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                    json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                    json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                       json_value(a_nested, '$[7][3]' RETURNING varchar array)))
SELECT a_str
FROM t1;
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                       json_value(a_nested, '$[7][3]' RETURNING varchar array)))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                    json_value(a_nested, '$[7][3]' RETURNING varchar array));
+-------+
| a_str |
+-------+
+-------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B44_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str NOT IN (json_value(a_nested, '$[3]' RETURNING varchar array),
                    json_value(a_nested, '$[7][3]' RETURNING varchar array))
GROUP BY a_str;
+-------+-----+
| a_str | cnt |
+-------+-----+
+-------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str IN
    (SELECT a_str
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str IN
    (SELECT a_str
     FROM test_array)
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IN
       (SELECT a_str
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str IN
       (SELECT a_str
        FROM test_array))
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IN
    (SELECT a_str
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str IN
    (SELECT a_str
     FROM test_array)
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IN
       (SELECT a_str
        FROM test_array))
SELECT a_str
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str IN
       (SELECT a_str
        FROM test_array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str IN
    (SELECT a_str
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B45_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str IN
    (SELECT a_str
     FROM test_array)
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM test_array
WHERE a_str NOT IN
    (SELECT a_str
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM test_array
WHERE a_str NOT IN
    (SELECT a_str
     FROM test_array)
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN
       (SELECT a_str
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN
       (SELECT a_str
        FROM test_array))
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array)
WHERE a_str NOT IN
    (SELECT a_str
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_str NOT IN
    (SELECT a_str
     FROM test_array)
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN
       (SELECT a_str
        FROM test_array))
SELECT a_str
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_str NOT IN
       (SELECT a_str
        FROM test_array))
SELECT a_str,
       count(*) cnt
FROM t1
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str
FROM t1
WHERE a_str NOT IN
    (SELECT a_str
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A4_B46_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_str,
       count(*) cnt
FROM t1
WHERE a_str NOT IN
    (SELECT a_str
     FROM test_array)
GROUP BY a_str;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1']);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL]);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element']);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B3_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed=ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B4_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B5_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B6_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL]);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B7_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<>ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<>json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL]);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element']);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B13_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B15_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B16_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL]);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B17_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element']);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B18_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B21_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL]);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B22_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<ARRAY['true',
                       '1',
                       '0.1',
                       'S1',
                       NULL,
                       'extra element'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B23_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<ARRAY['true',
                    '1',
                    '0.1',
                    'S1',
                    NULL,
                    'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B24_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B25_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
+--------------------------+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B26_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL]);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B27_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL]
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element']);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=ARRAY['true',
                        '1',
                        '0.1',
                        'S1',
                        NULL,
                        'extra element'])
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element'];
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B28_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL,
                     'extra element']
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B29_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B30_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<=json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
  AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
           AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
  AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
           AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
     AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
              AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
     AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
              AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
  AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
           AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
  AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
           AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
     AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
              AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
     AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
              AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
  AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
           AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B31_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array)
  AND NOT (a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
           AND a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
  OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
  OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
  OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
  OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
     OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
     OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
     OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
     OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
  OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
  OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
  OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
  OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
     OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
     OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
     OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
     OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
     OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
  OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
  OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B32_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE NOT (a_mixed<=json_value(a_nested, '$[6]' RETURNING varchar array))
  OR NOT (a_mixed>=json_value(a_nested, '$[7][6]' RETURNING varchar array))
  OR a_mixed=json_value(a_nested, '$[6]' RETURNING varchar array)
  OR a_mixed<>json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed IS NULL;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed IS NULL
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NULL);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NULL)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IS NULL;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IS NULL
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NULL)
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NULL)
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed IS NULL;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B33_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed IS NULL
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed IS NOT NULL;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed IS NOT NULL
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NOT NULL);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NOT NULL)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IS NOT NULL;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IS NOT NULL
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NOT NULL)
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IS NOT NULL)
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed IS NOT NULL;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B34_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed IS NOT NULL
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE)
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE)
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B35_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS TRUE
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE)
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE)
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B36_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT TRUE
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE)
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE)
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B37_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS FALSE
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE)
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE)
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B38_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE (a_mixed<json_value(a_nested, '$[6]' RETURNING varchar array)) IS NOT FALSE
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B39_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array);
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B40_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed NOT BETWEEN json_value(a_nested, '$[6]' RETURNING varchar array) AND json_value(a_nested, '$[7][6]' RETURNING varchar array)
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE array_to_string(a_mixed, ',') like '%';
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE array_to_string(a_mixed, ',') like '%'
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_mixed, ',') like '%');
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_mixed, ',') like '%')
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_mixed, ',') like '%';
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(a_mixed, ',') like '%'
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_mixed, ',') like '%')
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(a_mixed, ',') like '%')
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE array_to_string(a_mixed, ',') like '%';
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B41_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE array_to_string(a_mixed, ',') like '%'
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%';
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%'
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%');
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%')
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%';
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%'
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%')
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%')
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%';
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B42_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE array_to_string(json_value(a_nested, '$[6]' RETURNING varchar array), ',') not like '%'
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                  json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                  json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                     json_value(a_nested, '$[7][6]' RETURNING varchar array)));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                     json_value(a_nested, '$[7][6]' RETURNING varchar array)))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                  json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                  json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                     json_value(a_nested, '$[7][6]' RETURNING varchar array)))
SELECT a_mixed
FROM t1;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                     json_value(a_nested, '$[7][6]' RETURNING varchar array)))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                  json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B43_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                  json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+--------------------------+-----+
| a_mixed                  | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                      json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                      json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                         json_value(a_nested, '$[7][6]' RETURNING varchar array)));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                         json_value(a_nested, '$[7][6]' RETURNING varchar array)))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                      json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                      json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                         json_value(a_nested, '$[7][6]' RETURNING varchar array)))
SELECT a_mixed
FROM t1;
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                         json_value(a_nested, '$[7][6]' RETURNING varchar array)))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                      json_value(a_nested, '$[7][6]' RETURNING varchar array));
+---------+
| a_mixed |
+---------+
+---------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B44_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed NOT IN (json_value(a_nested, '$[6]' RETURNING varchar array),
                      json_value(a_nested, '$[7][6]' RETURNING varchar array))
GROUP BY a_mixed;
+---------+-----+
| a_mixed | cnt |
+---------+-----+
+---------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed IN
    (SELECT a_mixed
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed IN
    (SELECT a_mixed
     FROM test_array)
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IN
       (SELECT a_mixed
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed IN
       (SELECT a_mixed
        FROM test_array))
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IN
    (SELECT a_mixed
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed IN
    (SELECT a_mixed
     FROM test_array)
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IN
       (SELECT a_mixed
        FROM test_array))
SELECT a_mixed
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed IN
       (SELECT a_mixed
        FROM test_array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed IN
    (SELECT a_mixed
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B45_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed IN
    (SELECT a_mixed
     FROM test_array)
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM test_array
WHERE a_mixed NOT IN
    (SELECT a_mixed
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM test_array
WHERE a_mixed NOT IN
    (SELECT a_mixed
     FROM test_array)
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN
       (SELECT a_mixed
        FROM test_array));
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN
       (SELECT a_mixed
        FROM test_array))
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed NOT IN
    (SELECT a_mixed
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_mixed NOT IN
    (SELECT a_mixed
     FROM test_array)
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN
       (SELECT a_mixed
        FROM test_array))
SELECT a_mixed
FROM t1;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_mixed NOT IN
       (SELECT a_mixed
        FROM test_array))
SELECT a_mixed,
       count(*) cnt
FROM t1
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed
FROM t1
WHERE a_mixed NOT IN
    (SELECT a_mixed
     FROM test_array);
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A7_B46_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_mixed,
       count(*) cnt
FROM t1
WHERE a_mixed NOT IN
    (SELECT a_mixed
     FROM test_array)
GROUP BY a_mixed;
ARRAY
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested=a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested=a_nested
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested=a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested=a_nested
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested)
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested=a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B1_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested=a_nested
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested<>a_nested;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested<>a_nested
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested<>a_nested);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested<>a_nested)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested<>a_nested;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested<>a_nested
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested<>a_nested)
SELECT a_nested
FROM t1;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested<>a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested<>a_nested;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B2_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested<>a_nested
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested>a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested>a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested>a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested>a_nested)
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested>a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested>a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested>a_nested)
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested>a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested>a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B3_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested>a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested>=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested>=a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested>=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested>=a_nested)
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested>=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested>=a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested>=a_nested)
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested>=a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested>=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B4_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested>=a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested<a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested<a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested<a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested<a_nested)
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested<a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested<a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested<a_nested)
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested<a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested<a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B5_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested<a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested<=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested<=a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested<=a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested<=a_nested)
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested<=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested<=a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested<=a_nested)
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested<=a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested<=a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B6_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested<=a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested=a_nested
  OR a_nested<>a_nested
  AND NOT (a_nested=a_nested
           AND a_nested<>a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested=a_nested
  OR a_nested<>a_nested
  AND NOT (a_nested=a_nested
           AND a_nested<>a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested
     OR a_nested<>a_nested
     AND NOT (a_nested=a_nested
              AND a_nested<>a_nested));
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested
     OR a_nested<>a_nested
     AND NOT (a_nested=a_nested
              AND a_nested<>a_nested))
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested=a_nested
  OR a_nested<>a_nested
  AND NOT (a_nested=a_nested
           AND a_nested<>a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested=a_nested
  OR a_nested<>a_nested
  AND NOT (a_nested=a_nested
           AND a_nested<>a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested
     OR a_nested<>a_nested
     AND NOT (a_nested=a_nested
              AND a_nested<>a_nested))
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested=a_nested
     OR a_nested<>a_nested
     AND NOT (a_nested=a_nested
              AND a_nested<>a_nested))
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested=a_nested
  OR a_nested<>a_nested
  AND NOT (a_nested=a_nested
           AND a_nested<>a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B7_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested=a_nested
  OR a_nested<>a_nested
  AND NOT (a_nested=a_nested
           AND a_nested<>a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE NOT (a_nested<>a_nested)
  OR NOT (a_nested=a_nested)
  OR a_nested=a_nested
  OR a_nested<>a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE NOT (a_nested<>a_nested)
  OR NOT (a_nested=a_nested)
  OR a_nested=a_nested
  OR a_nested<>a_nested
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_nested<>a_nested)
     OR NOT (a_nested=a_nested)
     OR a_nested=a_nested
     OR a_nested<>a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE NOT (a_nested<>a_nested)
     OR NOT (a_nested=a_nested)
     OR a_nested=a_nested
     OR a_nested<>a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_nested<>a_nested)
  OR NOT (a_nested=a_nested)
  OR a_nested=a_nested
  OR a_nested<>a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE NOT (a_nested<>a_nested)
  OR NOT (a_nested=a_nested)
  OR a_nested=a_nested
  OR a_nested<>a_nested
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_nested<>a_nested)
     OR NOT (a_nested=a_nested)
     OR a_nested=a_nested
     OR a_nested<>a_nested)
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE NOT (a_nested<>a_nested)
     OR NOT (a_nested=a_nested)
     OR a_nested=a_nested
     OR a_nested<>a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE NOT (a_nested<>a_nested)
  OR NOT (a_nested=a_nested)
  OR a_nested=a_nested
  OR a_nested<>a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B8_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE NOT (a_nested<>a_nested)
  OR NOT (a_nested=a_nested)
  OR a_nested=a_nested
  OR a_nested<>a_nested
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested IS NULL;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested IS NULL
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IS NULL);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IS NULL)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IS NULL;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IS NULL
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IS NULL)
SELECT a_nested
FROM t1;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IS NULL)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested IS NULL;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B9_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested IS NULL
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested IS NOT NULL;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested IS NOT NULL
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IS NOT NULL);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IS NOT NULL)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IS NOT NULL;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IS NOT NULL
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IS NOT NULL)
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IS NOT NULL)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested IS NOT NULL;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B10_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested IS NOT NULL
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE (a_nested=a_nested) IS TRUE;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE (a_nested=a_nested) IS TRUE
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS TRUE);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS TRUE)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS TRUE;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS TRUE
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS TRUE)
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS TRUE)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE (a_nested=a_nested) IS TRUE;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B11_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE (a_nested=a_nested) IS TRUE
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE (a_nested=a_nested) IS NOT TRUE;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE (a_nested=a_nested) IS NOT TRUE
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT TRUE);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT TRUE)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS NOT TRUE;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS NOT TRUE
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT TRUE)
SELECT a_nested
FROM t1;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT TRUE)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE (a_nested=a_nested) IS NOT TRUE;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B12_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE (a_nested=a_nested) IS NOT TRUE
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE (a_nested=a_nested) IS FALSE;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE (a_nested=a_nested) IS FALSE
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS FALSE);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS FALSE)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS FALSE;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS FALSE
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS FALSE)
SELECT a_nested
FROM t1;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS FALSE)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE (a_nested=a_nested) IS FALSE;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B13_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE (a_nested=a_nested) IS FALSE
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE (a_nested=a_nested) IS NOT FALSE;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE (a_nested=a_nested) IS NOT FALSE
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT FALSE);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT FALSE)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS NOT FALSE;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE (a_nested=a_nested) IS NOT FALSE
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT FALSE)
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE (a_nested=a_nested) IS NOT FALSE)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE (a_nested=a_nested) IS NOT FALSE;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B14_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE (a_nested=a_nested) IS NOT FALSE
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested BETWEEN a_nested AND a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested BETWEEN a_nested AND a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested BETWEEN a_nested AND a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested BETWEEN a_nested AND a_nested)
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested BETWEEN a_nested AND a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested BETWEEN a_nested AND a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested BETWEEN a_nested AND a_nested)
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested BETWEEN a_nested AND a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested BETWEEN a_nested AND a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B15_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested BETWEEN a_nested AND a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested NOT BETWEEN a_nested AND a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested NOT BETWEEN a_nested AND a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested NOT BETWEEN a_nested AND a_nested);
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested NOT BETWEEN a_nested AND a_nested)
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested NOT BETWEEN a_nested AND a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested NOT BETWEEN a_nested AND a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested NOT BETWEEN a_nested AND a_nested)
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested NOT BETWEEN a_nested AND a_nested)
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested NOT BETWEEN a_nested AND a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B16_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested NOT BETWEEN a_nested AND a_nested
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested like '%';
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested like '%'
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested like '%');
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested like '%')
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested like '%';
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested like '%'
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested like '%')
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested like '%')
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested like '%';
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B17_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested like '%'
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested not like '%';
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested not like '%'
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested not like '%');
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested not like '%')
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested not like '%';
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested not like '%'
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested not like '%')
SELECT a_nested
FROM t1;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested not like '%')
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested not like '%';
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B18_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested not like '%'
GROUP BY a_nested;
Cannot apply
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested IN (a_nested,
                   a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested IN (a_nested,
                   a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IN (a_nested,
                      a_nested));
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IN (a_nested,
                      a_nested))
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IN (a_nested,
                   a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IN (a_nested,
                   a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IN (a_nested,
                      a_nested))
SELECT a_nested
FROM t1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IN (a_nested,
                      a_nested))
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested IN (a_nested,
                   a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B19_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested IN (a_nested,
                   a_nested)
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| a_nested                                                                                                                                                                                                                                                                                                                      | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested NOT IN (a_nested,
                       a_nested);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested NOT IN (a_nested,
                       a_nested)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN (a_nested,
                          a_nested));
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN (a_nested,
                          a_nested))
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested NOT IN (a_nested,
                       a_nested);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested NOT IN (a_nested,
                       a_nested)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN (a_nested,
                          a_nested))
SELECT a_nested
FROM t1;
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN (a_nested,
                          a_nested))
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested NOT IN (a_nested,
                       a_nested);
+----------+
| a_nested |
+----------+
+----------+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B20_C10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested NOT IN (a_nested,
                       a_nested)
GROUP BY a_nested;
+----------+-----+
| a_nested | cnt |
+----------+-----+
+----------+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested IN
    (SELECT a_nested
     FROM test_array);
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested IN
    (SELECT a_nested
     FROM test_array)
GROUP BY a_nested;
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IN
       (SELECT a_nested
        FROM test_array));
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested IN
       (SELECT a_nested
        FROM test_array))
GROUP BY a_nested;
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IN
    (SELECT a_nested
     FROM test_array);
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested IN
    (SELECT a_nested
     FROM test_array)
GROUP BY a_nested;
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IN
       (SELECT a_nested
        FROM test_array))
SELECT a_nested
FROM t1;
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested IN
       (SELECT a_nested
        FROM test_array))
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested IN
    (SELECT a_nested
     FROM test_array);
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B21_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested IN
    (SELECT a_nested
     FROM test_array)
GROUP BY a_nested;
Cannot join
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM test_array
WHERE a_nested NOT IN
    (SELECT a_nested
     FROM test_array);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM test_array
WHERE a_nested NOT IN
    (SELECT a_nested
     FROM test_array)
GROUP BY a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN
       (SELECT a_nested
        FROM test_array));
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C4 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN
       (SELECT a_nested
        FROM test_array))
GROUP BY a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested NOT IN
    (SELECT a_nested
     FROM test_array);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested,
       count(*) cnt
FROM
  (SELECT *
   FROM test_array)
WHERE a_nested NOT IN
    (SELECT a_nested
     FROM test_array)
GROUP BY a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C7 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN
       (SELECT a_nested
        FROM test_array))
SELECT a_nested
FROM t1;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C8 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array
   WHERE a_nested NOT IN
       (SELECT a_nested
        FROM test_array))
SELECT a_nested,
       count(*) cnt
FROM t1
GROUP BY a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested
FROM t1
WHERE a_nested NOT IN
    (SELECT a_nested
     FROM test_array);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_subquery_with_where TEST_ID: A8_B22_C10 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT a_nested,
       count(*) cnt
FROM t1
WHERE a_nested NOT IN
    (SELECT a_nested
     FROM test_array)
GROUP BY a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY a_bool;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A1_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_bool);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A1_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_bool);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A1_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_bool);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A1_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY a_bool
HAVING a_bool=ARRAY[1,
                    0,
                    NULL];
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY a_int;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A4_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_int);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A4_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_int);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A4_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_int);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A4_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY a_int
HAVING a_int=ARRAY[1,
                   2,
                   NULL];
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[1]' RETURNING bigint array);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A5_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[1]' RETURNING bigint array));
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A5_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[1]' RETURNING bigint array));
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A5_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[1]' RETURNING bigint array));
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A5_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[1]' RETURNING bigint array)
HAVING json_value(a_nested, '$[1]' RETURNING bigint array)=ARRAY[1,
                                                                 2,
                                                                 NULL];
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][1]' RETURNING bigint array);
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A6_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A6_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A6_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[7][1]' RETURNING bigint array));
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
|              |   4 |
+--------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A6_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][1]' RETURNING bigint array)
HAVING json_value(a_nested, '$[7][1]' RETURNING bigint array)=ARRAY[1,
                                                                    2,
                                                                    NULL];
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
+--------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY a_float;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A7_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_float);
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A7_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_float);
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
|                  |   4 |
+------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A7_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_float);
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
|                  |   4 |
+------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A7_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY a_float
HAVING a_float=ARRAY[0.1,
                     0.2,
                     NULL];
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[2]' RETURNING decimal array);
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A8_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[2]' RETURNING decimal array));
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A8_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[2]' RETURNING decimal array));
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
|                  |   4 |
+------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A8_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[2]' RETURNING decimal array));
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
|                  |   4 |
+------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A8_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[2]' RETURNING decimal array)
HAVING json_value(a_nested, '$[2]' RETURNING decimal array)=ARRAY[0.1,
                                                                  0.2,
                                                                  NULL];
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A9_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][2]' RETURNING decimal array);
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A9_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A9_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
|                  |   4 |
+------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A9_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[7][2]' RETURNING decimal array));
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
|                  |   4 |
+------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A9_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][2]' RETURNING decimal array)
HAVING json_value(a_nested, '$[7][2]' RETURNING decimal array)=ARRAY[0.1,
                                                                     0.2,
                                                                     NULL];
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A10_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY a_str;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A10_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_str);
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A10_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_str);
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
|                |   4 |
+----------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A10_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_str);
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
|                |   4 |
+----------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A10_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY a_str
HAVING a_str=ARRAY['S1',
                   'S2',
                   NULL];
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A11_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[3]' RETURNING varchar array);
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A11_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[3]' RETURNING varchar array));
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A11_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[3]' RETURNING varchar array));
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
|                |   4 |
+----------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A11_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[3]' RETURNING varchar array));
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
|                |   4 |
+----------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A11_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[3]' RETURNING varchar array)
HAVING json_value(a_nested, '$[3]' RETURNING varchar array)=ARRAY['S1',
                                                                  'S2',
                                                                  NULL];
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A12_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][3]' RETURNING varchar array);
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A12_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A12_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
|                |   4 |
+----------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A12_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[7][3]' RETURNING varchar array));
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
|                |   4 |
+----------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A12_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][3]' RETURNING varchar array)
HAVING json_value(a_nested, '$[7][3]' RETURNING varchar array)=ARRAY['S1',
                                                                     'S2',
                                                                     NULL];
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A13_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY a_null;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A13_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_null);
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A13_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_null);
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
|                    |   4 |
+--------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A13_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_null);
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
|                    |   4 |
+--------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A13_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY a_null
HAVING a_null=ARRAY[NULL,
                    NULL,
                    NULL];
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A14_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[4]' RETURNING varchar array);
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A14_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[4]' RETURNING varchar array));
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A14_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[4]' RETURNING varchar array));
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
|                    |   4 |
+--------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A14_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[4]' RETURNING varchar array));
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
|                    |   4 |
+--------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A14_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[4]' RETURNING varchar array)
HAVING json_value(a_nested, '$[4]' RETURNING varchar array)=ARRAY[NULL,
                                                                  NULL,
                                                                  NULL];
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A15_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][4]' RETURNING varchar array);
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A15_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[7][4]' RETURNING varchar array));
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A15_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[7][4]' RETURNING varchar array));
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
|                    |   4 |
+--------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A15_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[7][4]' RETURNING varchar array));
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
|                    |   4 |
+--------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A15_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][4]' RETURNING varchar array)
HAVING json_value(a_nested, '$[7][4]' RETURNING varchar array)=ARRAY[NULL,
                                                                     NULL,
                                                                     NULL];
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A16_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY a_empty;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A16_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_empty);
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A16_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_empty);
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
|    |   4 |
+----+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A16_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_empty);
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
|    |   4 |
+----+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A16_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY a_empty
HAVING a_empty=ARRAY['A'];
+---+-----+
| c | cnt |
+---+-----+
+---+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A17_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[5]' RETURNING varchar array);
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A17_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[5]' RETURNING varchar array));
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A17_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[5]' RETURNING varchar array));
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
|    |   4 |
+----+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A17_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[5]' RETURNING varchar array));
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
|    |   4 |
+----+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A17_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[5]' RETURNING varchar array)
HAVING json_value(a_nested, '$[5]' RETURNING varchar array)=ARRAY['A'];
+---+-----+
| c | cnt |
+---+-----+
+---+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A18_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][5]' RETURNING varchar array);
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A18_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[7][5]' RETURNING varchar array));
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A18_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[7][5]' RETURNING varchar array));
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
|    |   4 |
+----+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A18_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[7][5]' RETURNING varchar array));
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
|    |   4 |
+----+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A18_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][5]' RETURNING varchar array)
HAVING json_value(a_nested, '$[7][5]' RETURNING varchar array)=ARRAY['A'];
+---+-----+
| c | cnt |
+---+-----+
+---+-----+
(0 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A19_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY a_mixed;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A19_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_mixed);
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A19_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_mixed);
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
|                          |   4 |
+--------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A19_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_mixed);
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
|                          |   4 |
+--------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A19_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY a_mixed
HAVING a_mixed=ARRAY['true',
                     '1',
                     '0.1',
                     'S1',
                     NULL];
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A20_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[6]' RETURNING varchar array);
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A20_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[6]' RETURNING varchar array));
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A20_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[6]' RETURNING varchar array));
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
|                          |   4 |
+--------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A20_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[6]' RETURNING varchar array));
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
|                          |   4 |
+--------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A20_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[6]' RETURNING varchar array)
HAVING json_value(a_nested, '$[6]' RETURNING varchar array)=ARRAY['true',
                                                                  '1',
                                                                  '0.1',
                                                                  'S1',
                                                                  NULL];
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A21_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][6]' RETURNING varchar array);
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A21_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A21_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
|                          |   4 |
+--------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A21_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_value(a_nested, '$[7][6]' RETURNING varchar array));
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
|                          |   4 |
+--------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A21_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][6]' RETURNING varchar array)
HAVING json_value(a_nested, '$[7][6]' RETURNING varchar array)=ARRAY['true',
                                                                     '1',
                                                                     '0.1',
                                                                     'S1',
                                                                     NULL];
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A22_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY a_nested;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                                                                                                                             | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A22_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                                                                                                                             | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A22_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                                                                                                                             | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
|                                                                                                                                                                                                                                                                                                                               |   4 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A22_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_nested);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                                                                                                                             | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
|                                                                                                                                                                                                                                                                                                                               |   4 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A22_B9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY a_nested
HAVING a_nested=ARRAY[NULL,
                      NULL,
                      NULL];
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A23_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY json_query(a_nested, '$[7]');
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                   | cnt |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |   2 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A23_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_query(a_nested, '$[7]'));
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                   | cnt |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |   2 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A23_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_query(a_nested, '$[7]'));
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                   | cnt |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |   2 |
|                                                                                                                                                                                                                     |   4 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A23_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_query(a_nested, '$[7]'));
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                   | cnt |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |   2 |
|                                                                                                                                                                                                                     |   4 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A23_B9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY json_query(a_nested, '$[7]')
HAVING json_query(a_nested, '$[7]')=ARRAY[NULL,
                                          NULL,
                                          NULL];
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A24_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY json_query(a_nested, '$[7][7]');
+-----------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                         | cnt |
+-----------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |   2 |
+-----------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A24_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (json_query(a_nested, '$[7][7]'));
+-----------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                         | cnt |
+-----------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |   2 |
+-----------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A24_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY rollup(json_query(a_nested, '$[7][7]'));
+-----------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                         | cnt |
+-----------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |   2 |
|                                                                                                           |   4 |
+-----------------------------------------------------------------------------------------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A24_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY cube(json_query(a_nested, '$[7][7]'));
+-----------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                         | cnt |
+-----------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |   2 |
|                                                                                                           |   4 |
+-----------------------------------------------------------------------------------------------------------+-----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A24_B9 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY json_query(a_nested, '$[7][7]')
HAVING json_query(a_nested, '$[7][7]')=ARRAY[NULL,
                                             NULL,
                                             NULL];
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A25_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       json_value(a_nested, '$[2]' RETURNING decimal array),
       json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY a_int,
         json_value(a_nested, '$[2]' RETURNING decimal array),
         json_value(a_nested, '$[7][3]' RETURNING varchar array);
+--------------+------------------+----------------+-----+
| a_int        | EXPR$1           | c              | cnt |
+--------------+------------------+----------------+-----+
| [1, 2, null] | [0.1, 0.2, null] | [S1, S2, null] |   2 |
| [null, 2, 1] | [null, 0.2, 0.1] | [null, S2, S1] |   2 |
+--------------+------------------+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A25_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       json_value(a_nested, '$[2]' RETURNING decimal array),
       json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY GROUPING
SETS (a_int,
      json_value(a_nested, '$[2]' RETURNING decimal array),
      json_value(a_nested, '$[7][3]' RETURNING varchar array));
+--------------+------------------+----------------+-----+
| a_int        | EXPR$1           | c              | cnt |
+--------------+------------------+----------------+-----+
| [1, 2, null] |                  |                |   2 |
| [null, 2, 1] |                  |                |   2 |
|              | [0.1, 0.2, null] |                |   2 |
|              | [null, 0.2, 0.1] |                |   2 |
|              |                  | [S1, S2, null] |   2 |
|              |                  | [null, S2, S1] |   2 |
+--------------+------------------+----------------+-----+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A25_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       json_value(a_nested, '$[2]' RETURNING decimal array),
       json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY rollup(a_int, json_value(a_nested, '$[2]' RETURNING decimal array), json_value(a_nested, '$[7][3]' RETURNING varchar array));
+--------------+------------------+----------------+-----+
| a_int        | EXPR$1           | c              | cnt |
+--------------+------------------+----------------+-----+
| [1, 2, null] | [0.1, 0.2, null] | [S1, S2, null] |   2 |
| [1, 2, null] | [0.1, 0.2, null] |                |   2 |
| [1, 2, null] |                  |                |   2 |
| [null, 2, 1] | [null, 0.2, 0.1] | [null, S2, S1] |   2 |
| [null, 2, 1] | [null, 0.2, 0.1] |                |   2 |
| [null, 2, 1] |                  |                |   2 |
|              |                  |                |   4 |
+--------------+------------------+----------------+-----+
(7 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A25_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       json_value(a_nested, '$[2]' RETURNING decimal array),
       json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY cube(a_int, json_value(a_nested, '$[2]' RETURNING decimal array), json_value(a_nested, '$[7][3]' RETURNING varchar array));
+--------------+------------------+----------------+-----+
| a_int        | EXPR$1           | c              | cnt |
+--------------+------------------+----------------+-----+
| [1, 2, null] | [0.1, 0.2, null] | [S1, S2, null] |   2 |
| [1, 2, null] | [0.1, 0.2, null] |                |   2 |
| [1, 2, null] |                  | [S1, S2, null] |   2 |
| [1, 2, null] |                  |                |   2 |
| [null, 2, 1] | [null, 0.2, 0.1] | [null, S2, S1] |   2 |
| [null, 2, 1] | [null, 0.2, 0.1] |                |   2 |
| [null, 2, 1] |                  | [null, S2, S1] |   2 |
| [null, 2, 1] |                  |                |   2 |
|              | [0.1, 0.2, null] | [S1, S2, null] |   2 |
|              | [0.1, 0.2, null] |                |   2 |
|              | [null, 0.2, 0.1] | [null, S2, S1] |   2 |
|              | [null, 0.2, 0.1] |                |   2 |
|              |                  | [S1, S2, null] |   2 |
|              |                  | [null, S2, S1] |   2 |
|              |                  |                |   4 |
+--------------+------------------+----------------+-----+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_group_by TEST_ID: A25_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int,
       json_value(a_nested, '$[2]' RETURNING decimal array),
       json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY a_int,
         json_value(a_nested, '$[2]' RETURNING decimal array),
         json_value(a_nested, '$[7][3]' RETURNING varchar array)
HAVING a_int=ARRAY[1,
                   2,
                   NULL]
AND json_value(a_nested, '$[2]' RETURNING decimal array)=ARRAY[0.1,
                                                               0.2,
                                                               NULL]
AND json_value(a_nested, '$[7][3]' RETURNING varchar array)=ARRAY['S1',
                                                                  'S2',
                                                                  NULL];
+--------------+------------------+----------------+-----+
| a_int        | EXPR$1           | c              | cnt |
+--------------+------------------+----------------+-----+
| [1, 2, null] | [0.1, 0.2, null] | [S1, S2, null] |   2 |
+--------------+------------------+----------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT __time,
       count(*) cnt
FROM test_array
GROUP BY __time
ORDER BY __time ASC;
+-------------------------+-----+
| __time                  | cnt |
+-------------------------+-----+
| 2022-01-01 00:00:00.000 |   2 |
| 2022-02-01 00:00:00.000 |   2 |
+-------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT __time,
       count(*) cnt
FROM test_array
GROUP BY __time
ORDER BY __time DESC;
+-------------------------+-----+
| __time                  | cnt |
+-------------------------+-----+
| 2022-02-01 00:00:00.000 |   2 |
| 2022-01-01 00:00:00.000 |   2 |
+-------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT __time
FROM test_array
ORDER BY __time ASC;
+-------------------------+
| __time                  |
+-------------------------+
| 2022-01-01 00:00:00.000 |
| 2022-01-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
+-------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT __time
FROM test_array
ORDER BY 1 DESC;
+-------------------------+
| __time                  |
+-------------------------+
| 2022-02-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
| 2022-01-01 00:00:00.000 |
| 2022-01-01 00:00:00.000 |
+-------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT __time
FROM
  (SELECT __time
   FROM test_array
   ORDER BY __time ASC);
+-------------------------+
| __time                  |
+-------------------------+
| 2022-01-01 00:00:00.000 |
| 2022-01-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
+-------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A1_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT __time
FROM
  (SELECT __time
   FROM test_array
   ORDER BY 1 DESC);
+-------------------------+
| __time                  |
+-------------------------+
| 2022-01-01 00:00:00.000 |
| 2022-01-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
| 2022-02-01 00:00:00.000 |
+-------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A2_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY a_bool
ORDER BY a_bool ASC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [null, 0, 1] |   2 |
| [1, 0, null] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A2_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 0, null] |   2 |
| [null, 0, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A2_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A2_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A2_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_bool c
   FROM test_array
   ORDER BY c ASC);
+--------------+
| c            |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A2_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_bool c
   FROM test_array
   ORDER BY 1 DESC);
+--------------+
| c            |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY a_int
ORDER BY a_int ASC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
| [1, 2, null] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A5_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A5_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A5_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A5_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_int c
   FROM test_array
   ORDER BY c ASC);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A5_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_int c
   FROM test_array
   ORDER BY 1 DESC);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[1]' RETURNING bigint array)
ORDER BY json_value(a_nested, '$[1]' RETURNING bigint array) ASC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
| [1, 2, null] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A6_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A6_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A6_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A6_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
   FROM test_array
   ORDER BY c ASC);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A6_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
   FROM test_array
   ORDER BY 1 DESC);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][1]' RETURNING bigint array)
ORDER BY json_value(a_nested, '$[7][1]' RETURNING bigint array) ASC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [null, 2, 1] |   2 |
| [1, 2, null] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A7_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------+-----+
| c            | cnt |
+--------------+-----+
| [1, 2, null] |   2 |
| [null, 2, 1] |   2 |
+--------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A7_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A7_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A7_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
   FROM test_array
   ORDER BY c ASC);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A7_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
   FROM test_array
   ORDER BY 1 DESC);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY a_float
ORDER BY a_float ASC;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A8_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A8_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A8_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A8_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_float c
   FROM test_array
   ORDER BY c ASC);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A8_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_float c
   FROM test_array
   ORDER BY 1 DESC);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A9_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[2]' RETURNING decimal array)
ORDER BY json_value(a_nested, '$[2]' RETURNING decimal array) ASC;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A9_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A9_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A9_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A9_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
   FROM test_array
   ORDER BY c ASC);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A9_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
   FROM test_array
   ORDER BY 1 DESC);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A10_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][2]' RETURNING decimal array)
ORDER BY json_value(a_nested, '$[7][2]' RETURNING decimal array) ASC;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [null, 0.2, 0.1] |   2 |
| [0.1, 0.2, null] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A10_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+------------------+-----+
| c                | cnt |
+------------------+-----+
| [0.1, 0.2, null] |   2 |
| [null, 0.2, 0.1] |   2 |
+------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A10_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A10_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A10_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
   FROM test_array
   ORDER BY c ASC);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A10_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
   FROM test_array
   ORDER BY 1 DESC);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A11_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY a_str
ORDER BY a_str ASC;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
| [S1, S2, null] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A11_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A11_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A11_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A11_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_str c
   FROM test_array
   ORDER BY c ASC);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A11_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_str c
   FROM test_array
   ORDER BY 1 DESC);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A12_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[3]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[3]' RETURNING varchar array) ASC;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
| [S1, S2, null] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A12_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A12_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A12_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A12_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A12_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A13_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][3]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[7][3]' RETURNING varchar array) ASC;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [null, S2, S1] |   2 |
| [S1, S2, null] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A13_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+----------------+-----+
| c              | cnt |
+----------------+-----+
| [S1, S2, null] |   2 |
| [null, S2, S1] |   2 |
+----------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A13_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A13_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A13_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A13_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A14_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY a_null
ORDER BY a_null ASC;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A14_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A14_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A14_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A14_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_null c
   FROM test_array
   ORDER BY c ASC);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A14_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_null c
   FROM test_array
   ORDER BY 1 DESC);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A15_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[4]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[4]' RETURNING varchar array) ASC;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A15_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A15_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A15_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A15_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A15_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A16_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][4]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[7][4]' RETURNING varchar array) ASC;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A16_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------------+-----+
| c                  | cnt |
+--------------------+-----+
| [null, null, null] |   4 |
+--------------------+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A16_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A16_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A16_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A16_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A17_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY a_empty
ORDER BY a_empty ASC;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A17_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A17_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A17_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A17_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_empty c
   FROM test_array
   ORDER BY c ASC);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A17_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_empty c
   FROM test_array
   ORDER BY 1 DESC);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A18_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[5]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[5]' RETURNING varchar array) ASC;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A18_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A18_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A18_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A18_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A18_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A19_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][5]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[7][5]' RETURNING varchar array) ASC;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A19_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+----+-----+
| c  | cnt |
+----+-----+
| [] |   4 |
+----+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A19_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A19_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A19_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A19_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
+----+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A20_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY a_mixed
ORDER BY a_mixed ASC;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A20_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A20_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A20_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A20_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_mixed c
   FROM test_array
   ORDER BY c ASC);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A20_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_mixed c
   FROM test_array
   ORDER BY 1 DESC);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A21_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[6]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[6]' RETURNING varchar array) ASC;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A21_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A21_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A21_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A21_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A21_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A22_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY json_value(a_nested, '$[7][6]' RETURNING varchar array)
ORDER BY json_value(a_nested, '$[7][6]' RETURNING varchar array) ASC;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [null, S1, 0.1, 1, true] |   2 |
| [true, 1, 0.1, S1, null] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A22_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+--------------------------+-----+
| c                        | cnt |
+--------------------------+-----+
| [true, 1, 0.1, S1, null] |   2 |
| [null, S1, 0.1, 1, true] |   2 |
+--------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A22_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A22_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A22_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
   FROM test_array
   ORDER BY c ASC);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A22_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
   FROM test_array
   ORDER BY 1 DESC);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A23_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY a_nested
ORDER BY a_nested ASC;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                                                                                                                             | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A23_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                                                                                                                             | cnt |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |   2 |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |   2 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A23_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A23_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A23_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_nested c
   FROM test_array
   ORDER BY c ASC);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                                                                                                                             |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A23_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_nested c
   FROM test_array
   ORDER BY 1 DESC);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                                                                                                                             |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A24_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY json_query(a_nested, '$[7]')
ORDER BY json_query(a_nested, '$[7]') ASC;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                   | cnt |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |   2 |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |   2 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A24_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                                                                                                                                   | cnt |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |   2 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A24_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A24_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7]') c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A24_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_query(a_nested, '$[7]') c
   FROM test_array
   ORDER BY c ASC);
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A24_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_query(a_nested, '$[7]') c
   FROM test_array
   ORDER BY 1 DESC);
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]] |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A25_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY json_query(a_nested, '$[7][7]')
ORDER BY json_query(a_nested, '$[7][7]') ASC;
+-----------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                         | cnt |
+-----------------------------------------------------------------------------------------------------------+-----+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |   2 |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |   2 |
+-----------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A25_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c,
       count(*) cnt
FROM test_array
GROUP BY 1
ORDER BY 1 DESC;
+-----------------------------------------------------------------------------------------------------------+-----+
| c                                                                                                         | cnt |
+-----------------------------------------------------------------------------------------------------------+-----+
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |   2 |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |   2 |
+-----------------------------------------------------------------------------------------------------------+-----+
(2 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A25_B5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c
FROM test_array
ORDER BY c ASC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A25_B6 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT json_query(a_nested, '$[7][7]') c
FROM test_array
ORDER BY 1 DESC;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A25_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_query(a_nested, '$[7][7]') c
   FROM test_array
   ORDER BY c ASC);
+-----------------------------------------------------------------------------------------------------------+
| c                                                                                                         |
+-----------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |
+-----------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_order_by TEST_ID: A25_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_query(a_nested, '$[7][7]') c
   FROM test_array
   ORDER BY 1 DESC);
+-----------------------------------------------------------------------------------------------------------+
| c                                                                                                         |
+-----------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]] |
+-----------------------------------------------------------------------------------------------------------+
(4 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c
FROM test_array
LIMIT 1;
+--------------+
| c            |
+--------------+
| [1, 0, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A1_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c
FROM test_array
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A1_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 0, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c
FROM test_array
LIMIT 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A4_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c
FROM test_array
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A4_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
FROM test_array
LIMIT 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A5_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
FROM test_array
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A5_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
FROM test_array
LIMIT 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A6_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
FROM test_array
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A6_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------+
| c            |
+--------------+
| [1, 2, null] |
+--------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c
FROM test_array
LIMIT 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
+------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A7_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c
FROM test_array
OFFSET 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A7_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float c
FROM test_array
LIMIT 1
OFFSET 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
+------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
FROM test_array
LIMIT 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
+------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A8_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
FROM test_array
OFFSET 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A8_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
FROM test_array
LIMIT 1
OFFSET 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
+------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A9_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
FROM test_array
LIMIT 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
+------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A9_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
FROM test_array
OFFSET 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A9_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
FROM test_array
LIMIT 1
OFFSET 1;
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
+------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A10_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c
FROM test_array
LIMIT 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A10_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c
FROM test_array
OFFSET 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A10_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str c
FROM test_array
LIMIT 1
OFFSET 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A11_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A11_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A11_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A12_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A12_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A12_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
+----------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A13_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c
FROM test_array
LIMIT 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A13_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c
FROM test_array
OFFSET 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A13_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A14_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A14_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A14_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A15_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A15_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A15_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
+--------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A16_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c
FROM test_array
LIMIT 1;
+----+
| c  |
+----+
| [] |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A16_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c
FROM test_array
OFFSET 1;
+----+
| c  |
+----+
| [] |
| [] |
| [] |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A16_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty c
FROM test_array
LIMIT 1
OFFSET 1;
+----+
| c  |
+----+
| [] |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A17_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+----+
| c  |
+----+
| [] |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A17_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+----+
| c  |
+----+
| [] |
| [] |
| [] |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A17_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+----+
| c  |
+----+
| [] |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A18_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+----+
| c  |
+----+
| [] |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A18_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+----+
| c  |
+----+
| [] |
| [] |
| [] |
+----+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A18_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+----+
| c  |
+----+
| [] |
+----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A19_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c
FROM test_array
LIMIT 1;
+--------------------------+
| c                        |
+--------------------------+
| [true, 1, 0.1, S1, null] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A19_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c
FROM test_array
OFFSET 1;
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A19_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------------------+
| c                        |
+--------------------------+
| [true, 1, 0.1, S1, null] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A20_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+--------------------------+
| c                        |
+--------------------------+
| [true, 1, 0.1, S1, null] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A20_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A20_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------------------+
| c                        |
+--------------------------+
| [true, 1, 0.1, S1, null] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A21_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+--------------------------+
| c                        |
+--------------------------+
| [true, 1, 0.1, S1, null] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A21_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A21_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+--------------------------+
| c                        |
+--------------------------+
| [true, 1, 0.1, S1, null] |
+--------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A22_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c
FROM test_array
LIMIT 1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                                                                                                                             |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A22_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c
FROM test_array
OFFSET 1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                                                                                                                             |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A22_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested c
FROM test_array
LIMIT 1
OFFSET 1;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                                                                                                                             |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A23_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A23_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A23_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A24_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][7]' RETURNING varchar array) c
FROM test_array
LIMIT 1;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A24_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][7]' RETURNING varchar array) c
FROM test_array
OFFSET 1;
+---+
| c |
+---+
|   |
|   |
|   |
+---+
(3 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_limit_offset TEST_ID: A24_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT json_value(a_nested, '$[7][7]' RETURNING varchar array) c
FROM test_array
LIMIT 1
OFFSET 1;
+---+
| c |
+---+
|   |
+---+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B1_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B1_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_bool=t2.a_bool);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1
INNER JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B2_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B2_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_int=t2.a_int);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1
INNER JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_float=t2.a_float);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1
INNER JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_str=t2.a_str);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1
INNER JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_null=t2.a_null);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1
INNER JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_empty=t2.a_empty);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1
INNER JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_mixed=t2.a_mixed);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1
INNER JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B8_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1
INNER JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B8_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1
   INNER JOIN test_array t2 ON t1.a_nested=t2.a_nested);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1
INNER JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B1_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1
JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B1_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_bool=t2.a_bool);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1
JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B2_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1
JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B2_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_int=t2.a_int);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1
JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1
JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_float=t2.a_float);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1
JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1
JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_str=t2.a_str);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1
JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1
JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_null=t2.a_null);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1
JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1
JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_empty=t2.a_empty);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1
JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1
JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_mixed=t2.a_mixed);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1
JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B8_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1
JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B8_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1
   JOIN test_array t2 ON t1.a_nested=t2.a_nested);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1
JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B1_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B1_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_bool=t2.a_bool);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1
LEFT JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B2_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B2_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_int=t2.a_int);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1
LEFT JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_float=t2.a_float);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1
LEFT JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_str=t2.a_str);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1
LEFT JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_null=t2.a_null);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1
LEFT JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_empty=t2.a_empty);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1
LEFT JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_mixed=t2.a_mixed);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1
LEFT JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B8_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1
LEFT JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B8_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1
   LEFT JOIN test_array t2 ON t1.a_nested=t2.a_nested);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1
LEFT JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B1_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B1_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_bool=t2.a_bool);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1
RIGHT JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B2_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B2_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_int=t2.a_int);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1
RIGHT JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_float=t2.a_float);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1
RIGHT JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_str=t2.a_str);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1
RIGHT JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_null=t2.a_null);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1
RIGHT JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_empty=t2.a_empty);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1
RIGHT JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_mixed=t2.a_mixed);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1
RIGHT JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B8_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1
RIGHT JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B8_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1
   RIGHT JOIN test_array t2 ON t1.a_nested=t2.a_nested);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1
RIGHT JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B1_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B1_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_bool=t2.a_bool);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1
FULL JOIN test_array t2 ON t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B2_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B2_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_int=t2.a_int);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1
FULL JOIN test_array t2 ON t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_float=t2.a_float);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1
FULL JOIN test_array t2 ON t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_str=t2.a_str);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1
FULL JOIN test_array t2 ON t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_null=t2.a_null);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1
FULL JOIN test_array t2 ON t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_empty=t2.a_empty);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1
FULL JOIN test_array t2 ON t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_mixed=t2.a_mixed);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1
FULL JOIN test_array t2 ON t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B8_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1
FULL JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B8_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1
   FULL JOIN test_array t2 ON t1.a_nested=t2.a_nested);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1
FULL JOIN test_array t2 ON t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B1_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1,
     test_array t2
WHERE t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B1_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_bool=t2.a_bool);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B1_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1,
     test_array t2
WHERE t1.a_bool=t2.a_bool;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B2_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1,
     test_array t2
WHERE t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B2_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_int=t2.a_int);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B2_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1,
     test_array t2
WHERE t1.a_int=t2.a_int;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B3_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1,
     test_array t2
WHERE t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B3_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_float=t2.a_float);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B3_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1,
     test_array t2
WHERE t1.a_float=t2.a_float;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B4_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1,
     test_array t2
WHERE t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B4_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_str=t2.a_str);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B4_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1,
     test_array t2
WHERE t1.a_str=t2.a_str;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B5_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1,
     test_array t2
WHERE t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B5_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_null=t2.a_null);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B5_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1,
     test_array t2
WHERE t1.a_null=t2.a_null;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B6_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1,
     test_array t2
WHERE t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B6_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_empty=t2.a_empty);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B6_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1,
     test_array t2
WHERE t1.a_empty=t2.a_empty;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B7_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1,
     test_array t2
WHERE t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B7_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_mixed=t2.a_mixed);
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B7_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1,
     test_array t2
WHERE t1.a_mixed=t2.a_mixed;
not support
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B8_C1 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1,
     test_array t2
WHERE t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B8_C3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1,
        test_array t2
   WHERE t1.a_nested=t2.a_nested);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B8_C5 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1,
     test_array t2
WHERE t1.a_nested=t2.a_nested;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B1_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_bool
FROM test_array t1
CROSS JOIN test_array t2;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B1_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_bool
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B1_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_bool
FROM t1
CROSS JOIN test_array t2;
+--------------+
| a_bool       |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B2_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_int
FROM test_array t1
CROSS JOIN test_array t2;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B2_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_int
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B2_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_int
FROM t1
CROSS JOIN test_array t2;
+--------------+
| a_int        |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B3_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_float
FROM test_array t1
CROSS JOIN test_array t2;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B3_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_float
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B3_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_float
FROM t1
CROSS JOIN test_array t2;
+------------------+
| a_float          |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B4_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_str
FROM test_array t1
CROSS JOIN test_array t2;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B4_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_str
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B4_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_str
FROM t1
CROSS JOIN test_array t2;
+----------------+
| a_str          |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B5_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_null
FROM test_array t1
CROSS JOIN test_array t2;
+--------------------+
| a_null             |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B5_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_null
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+--------------------+
| a_null             |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B5_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_null
FROM t1
CROSS JOIN test_array t2;
+--------------------+
| a_null             |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B6_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_empty
FROM test_array t1
CROSS JOIN test_array t2;
+---------+
| a_empty |
+---------+
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
+---------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B6_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_empty
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+---------+
| a_empty |
+---------+
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
+---------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B6_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_empty
FROM t1
CROSS JOIN test_array t2;
+---------+
| a_empty |
+---------+
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
| []      |
+---------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B7_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_mixed
FROM test_array t1
CROSS JOIN test_array t2;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B7_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_mixed
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B7_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_mixed
FROM t1
CROSS JOIN test_array t2;
+--------------------------+
| a_mixed                  |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B8_C1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.a_nested
FROM test_array t1
CROSS JOIN test_array t2;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B8_C3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT a_nested
FROM
  (SELECT *
   FROM test_array t1
   CROSS JOIN test_array t2);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B8_C5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_array)
SELECT t1.a_nested
FROM t1
CROSS JOIN test_array t2;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a_nested                                                                                                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(16 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_bool c
   FROM test_array
   UNION ALL SELECT a_bool c
   FROM test_array);
+--------------+
| c            |
+--------------+
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [1, 0, null] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
| [null, 0, 1] |
+--------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_int c
   FROM test_array
   UNION ALL SELECT a_int c
   FROM test_array);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[1]' RETURNING bigint array) c
   FROM test_array);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][1]' RETURNING bigint array) c
   FROM test_array);
+--------------+
| c            |
+--------------+
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [1, 2, null] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
| [null, 2, 1] |
+--------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_float c
   FROM test_array
   UNION ALL SELECT a_float c
   FROM test_array);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A8_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[2]' RETURNING decimal array) c
   FROM test_array);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A9_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][2]' RETURNING decimal array) c
   FROM test_array);
+------------------+
| c                |
+------------------+
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [0.1, 0.2, null] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
| [null, 0.2, 0.1] |
+------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A10_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_str c
   FROM test_array
   UNION ALL SELECT a_str c
   FROM test_array);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A11_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[3]' RETURNING varchar array) c
   FROM test_array);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A12_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][3]' RETURNING varchar array) c
   FROM test_array);
+----------------+
| c              |
+----------------+
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [S1, S2, null] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
| [null, S2, S1] |
+----------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A13_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_null c
   FROM test_array
   UNION ALL SELECT a_null c
   FROM test_array);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A14_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[4]' RETURNING varchar array) c
   FROM test_array);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A15_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][4]' RETURNING varchar array) c
   FROM test_array);
+--------------------+
| c                  |
+--------------------+
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
| [null, null, null] |
+--------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A16_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_empty c
   FROM test_array
   UNION ALL SELECT a_empty c
   FROM test_array);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A17_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[5]' RETURNING varchar array) c
   FROM test_array);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A18_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][5]' RETURNING varchar array) c
   FROM test_array);
+----+
| c  |
+----+
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
| [] |
+----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A19_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_mixed c
   FROM test_array
   UNION ALL SELECT a_mixed c
   FROM test_array);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A20_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[6]' RETURNING varchar array) c
   FROM test_array);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A21_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][6]' RETURNING varchar array) c
   FROM test_array);
+--------------------------+
| c                        |
+--------------------------+
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [null, S1, 0.1, 1, true] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
| [true, 1, 0.1, S1, null] |
+--------------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A22_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT a_nested c
   FROM test_array
   UNION ALL SELECT a_nested c
   FROM test_array);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c                                                                                                                                                                                                                                                                                                                             |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true],[[null,false,true],[null,2,1],[null,0.2,0.1],[null,"S2","S1"],[null,null,null],[],[null,"S1",0.1,1,true]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
| [[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null],[[true,false,null],[1,2,null],[0.1,0.2,null],["S1","S2",null],[null,null,null],[],[true,1,0.1,"S1",null]]]] |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A23_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7]' RETURNING varchar array) c
   FROM test_array);
+---+
| c |
+---+
|   |
|   |
|   |
|   |
|   |
|   |
|   |
|   |
+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_union_all TEST_ID: A24_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT c
FROM
  (SELECT json_value(a_nested, '$[7][7]' RETURNING varchar array) c
   FROM test_array
   UNION ALL SELECT json_value(a_nested, '$[7][7]' RETURNING varchar array) c
   FROM test_array);
+---+
| c |
+---+
|   |
|   |
|   |
|   |
|   |
|   |
|   |
|   |
+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 3400 Positive tests: 2939 Negative tests: 461
#-------------------------------------------------------------------------
