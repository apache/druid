!set useApproximateCountDistinct false
!use druidtest:///?componentSupplier=KttmNestedComponentSupplier
!set outputformat mysql
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00';
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A1: plain_value_string
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||loaded_image IS NULL
       OR ('1'||loaded_image = 1||loaded_image
           AND '1'||loaded_image IS NOT DISTINCT
           FROM 1||loaded_image
           AND '1'||loaded_image <> '0'||loaded_image
           AND ('1'||loaded_image IS DISTINCT
                FROM '0'||loaded_image)
           AND '1'||loaded_image > '0'||loaded_image
           AND '1'||loaded_image >= '0'||loaded_image
           AND '1'||loaded_image < 2||loaded_image
           AND '1'||loaded_image <= 2||loaded_image
           AND ('1'||loaded_image <> '0'||loaded_image) IS TRUE
           AND ('1'||loaded_image = '0'||loaded_image) IS NOT TRUE
           AND ('1'||loaded_image = '0'||loaded_image) IS FALSE
           AND ('1'||loaded_image <> '0'||loaded_image) IS NOT FALSE
           AND '1'||loaded_image BETWEEN '0'||loaded_image AND 2||loaded_image
           AND '1'||loaded_image NOT BETWEEN '1'||loaded_image AND '0'||loaded_image
           AND '1'||loaded_image like '%'
           AND '1'||loaded_image not like '__DOES_NOT_EXIST__%'
           AND '1'||loaded_image IN ('0'||loaded_image,
                                     1||loaded_image,
                                     2||loaded_image)
           AND '1'||loaded_image NOT IN ('0'||loaded_image,
                                         2||loaded_image))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||loaded_image IS NULL
       OR '1'||loaded_image IN
         (SELECT '1'||loaded_image
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||loaded_image IS NULL
                 OR ('1'||loaded_image = 1||loaded_image
                     AND '1'||loaded_image IS NOT DISTINCT
                     FROM 1||loaded_image
                     AND '1'||loaded_image <> '0'||loaded_image
                     AND ('1'||loaded_image IS DISTINCT
                          FROM '0'||loaded_image)
                     AND '1'||loaded_image > '0'||loaded_image
                     AND '1'||loaded_image >= '0'||loaded_image
                     AND '1'||loaded_image < 2||loaded_image
                     AND '1'||loaded_image <= 2||loaded_image
                     AND ('1'||loaded_image <> '0'||loaded_image) IS TRUE
                     AND ('1'||loaded_image = '0'||loaded_image) IS NOT TRUE
                     AND ('1'||loaded_image = '0'||loaded_image) IS FALSE
                     AND ('1'||loaded_image <> '0'||loaded_image) IS NOT FALSE
                     AND '1'||loaded_image BETWEEN '0'||loaded_image AND 2||loaded_image
                     AND '1'||loaded_image NOT BETWEEN '1'||loaded_image AND '0'||loaded_image
                     AND '1'||loaded_image like '%'
                     AND '1'||loaded_image not like '__DOES_NOT_EXIST__%'
                     AND '1'||loaded_image IN ('0'||loaded_image,
                                               1||loaded_image,
                                               2||loaded_image)
                     AND '1'||loaded_image NOT IN ('0'||loaded_image,
                                                   2||loaded_image)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||loaded_image,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||loaded_image IS NULL
          OR ('1'||loaded_image = 1||loaded_image
              AND '1'||loaded_image IS NOT DISTINCT
              FROM 1||loaded_image
              AND '1'||loaded_image <> '0'||loaded_image
              AND ('1'||loaded_image IS DISTINCT
                   FROM '0'||loaded_image)
              AND '1'||loaded_image > '0'||loaded_image
              AND '1'||loaded_image >= '0'||loaded_image
              AND '1'||loaded_image < 2||loaded_image
              AND '1'||loaded_image <= 2||loaded_image
              AND ('1'||loaded_image <> '0'||loaded_image) IS TRUE
              AND ('1'||loaded_image = '0'||loaded_image) IS NOT TRUE
              AND ('1'||loaded_image = '0'||loaded_image) IS FALSE
              AND ('1'||loaded_image <> '0'||loaded_image) IS NOT FALSE
              AND '1'||loaded_image BETWEEN '0'||loaded_image AND 2||loaded_image
              AND '1'||loaded_image NOT BETWEEN '1'||loaded_image AND '0'||loaded_image
              AND '1'||loaded_image like '%'
              AND '1'||loaded_image not like '__DOES_NOT_EXIST__%'
              AND '1'||loaded_image IN ('0'||loaded_image,
                                        1||loaded_image,
                                        2||loaded_image)
              AND '1'||loaded_image NOT IN ('0'||loaded_image,
                                            2||loaded_image)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A2: ||
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||loaded_image||loaded_image IS NULL
       OR ('1'||loaded_image||loaded_image = 1||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image IS NOT DISTINCT
           FROM 1||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image
           AND ('1'||loaded_image||loaded_image IS DISTINCT
                FROM '0'||loaded_image||loaded_image)
           AND '1'||loaded_image||loaded_image > '0'||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image >= '0'||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image < 2||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image <= 2||loaded_image||loaded_image
           AND ('1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image) IS TRUE
           AND ('1'||loaded_image||loaded_image = '0'||loaded_image||loaded_image) IS NOT TRUE
           AND ('1'||loaded_image||loaded_image = '0'||loaded_image||loaded_image) IS FALSE
           AND ('1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image) IS NOT FALSE
           AND '1'||loaded_image||loaded_image BETWEEN '0'||loaded_image||loaded_image AND 2||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image NOT BETWEEN '1'||loaded_image||loaded_image AND '0'||loaded_image||loaded_image
           AND '1'||loaded_image||loaded_image like '%'
           AND '1'||loaded_image||loaded_image not like '__DOES_NOT_EXIST__%'
           AND '1'||loaded_image||loaded_image IN ('0'||loaded_image||loaded_image,
                                                   1||loaded_image||loaded_image,
                                                   2||loaded_image||loaded_image)
           AND '1'||loaded_image||loaded_image NOT IN ('0'||loaded_image||loaded_image,
                                                       2||loaded_image||loaded_image))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||loaded_image||loaded_image IS NULL
       OR '1'||loaded_image||loaded_image IN
         (SELECT '1'||loaded_image||loaded_image
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||loaded_image||loaded_image IS NULL
                 OR ('1'||loaded_image||loaded_image = 1||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image IS NOT DISTINCT
                     FROM 1||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image
                     AND ('1'||loaded_image||loaded_image IS DISTINCT
                          FROM '0'||loaded_image||loaded_image)
                     AND '1'||loaded_image||loaded_image > '0'||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image >= '0'||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image < 2||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image <= 2||loaded_image||loaded_image
                     AND ('1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image) IS TRUE
                     AND ('1'||loaded_image||loaded_image = '0'||loaded_image||loaded_image) IS NOT TRUE
                     AND ('1'||loaded_image||loaded_image = '0'||loaded_image||loaded_image) IS FALSE
                     AND ('1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image) IS NOT FALSE
                     AND '1'||loaded_image||loaded_image BETWEEN '0'||loaded_image||loaded_image AND 2||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image NOT BETWEEN '1'||loaded_image||loaded_image AND '0'||loaded_image||loaded_image
                     AND '1'||loaded_image||loaded_image like '%'
                     AND '1'||loaded_image||loaded_image not like '__DOES_NOT_EXIST__%'
                     AND '1'||loaded_image||loaded_image IN ('0'||loaded_image||loaded_image,
                                                             1||loaded_image||loaded_image,
                                                             2||loaded_image||loaded_image)
                     AND '1'||loaded_image||loaded_image NOT IN ('0'||loaded_image||loaded_image,
                                                                 2||loaded_image||loaded_image)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||loaded_image||loaded_image,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||loaded_image||loaded_image IS NULL
          OR ('1'||loaded_image||loaded_image = 1||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image IS NOT DISTINCT
              FROM 1||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image
              AND ('1'||loaded_image||loaded_image IS DISTINCT
                   FROM '0'||loaded_image||loaded_image)
              AND '1'||loaded_image||loaded_image > '0'||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image >= '0'||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image < 2||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image <= 2||loaded_image||loaded_image
              AND ('1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image) IS TRUE
              AND ('1'||loaded_image||loaded_image = '0'||loaded_image||loaded_image) IS NOT TRUE
              AND ('1'||loaded_image||loaded_image = '0'||loaded_image||loaded_image) IS FALSE
              AND ('1'||loaded_image||loaded_image <> '0'||loaded_image||loaded_image) IS NOT FALSE
              AND '1'||loaded_image||loaded_image BETWEEN '0'||loaded_image||loaded_image AND 2||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image NOT BETWEEN '1'||loaded_image||loaded_image AND '0'||loaded_image||loaded_image
              AND '1'||loaded_image||loaded_image like '%'
              AND '1'||loaded_image||loaded_image not like '__DOES_NOT_EXIST__%'
              AND '1'||loaded_image||loaded_image IN ('0'||loaded_image||loaded_image,
                                                      1||loaded_image||loaded_image,
                                                      2||loaded_image||loaded_image)
              AND '1'||loaded_image||loaded_image NOT IN ('0'||loaded_image||loaded_image,
                                                          2||loaded_image||loaded_image)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A3: concat
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (concat('1', loaded_image, loaded_image) IS NULL
       OR (concat('1', loaded_image, loaded_image) = concat('1', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) IS NOT DISTINCT
           FROM concat('1', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)
           AND (concat('1', loaded_image, loaded_image) IS DISTINCT
                FROM concat('0', loaded_image, loaded_image))
           AND concat('1', loaded_image, loaded_image) > concat('0', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) >= concat('0', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) < concat('2', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) <= concat('2', loaded_image, loaded_image)
           AND (concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)) IS TRUE
           AND (concat('1', loaded_image, loaded_image) = concat('0', loaded_image, loaded_image)) IS NOT TRUE
           AND (concat('1', loaded_image, loaded_image) = concat('0', loaded_image, loaded_image)) IS FALSE
           AND (concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)) IS NOT FALSE
           AND concat('1', loaded_image, loaded_image) BETWEEN concat('0', loaded_image, loaded_image) AND concat('2', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) NOT BETWEEN concat('1', loaded_image, loaded_image) AND concat('0', loaded_image, loaded_image)
           AND concat('1', loaded_image, loaded_image) like '%'
           AND concat('1', loaded_image, loaded_image) not like '__DOES_NOT_EXIST__%'
           AND concat('1', loaded_image, loaded_image) IN (concat('0', loaded_image, loaded_image),
                                                           concat('1', loaded_image, loaded_image),
                                                           concat('2', loaded_image, loaded_image))
           AND concat('1', loaded_image, loaded_image) NOT IN (concat('0', loaded_image, loaded_image),
                                                               concat('2', loaded_image, loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (concat('1', loaded_image, loaded_image) IS NULL
       OR concat('1', loaded_image, loaded_image) IN
         (SELECT concat('1', loaded_image, loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (concat('1', loaded_image, loaded_image) IS NULL
                 OR (concat('1', loaded_image, loaded_image) = concat('1', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) IS NOT DISTINCT
                     FROM concat('1', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)
                     AND (concat('1', loaded_image, loaded_image) IS DISTINCT
                          FROM concat('0', loaded_image, loaded_image))
                     AND concat('1', loaded_image, loaded_image) > concat('0', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) >= concat('0', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) < concat('2', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) <= concat('2', loaded_image, loaded_image)
                     AND (concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)) IS TRUE
                     AND (concat('1', loaded_image, loaded_image) = concat('0', loaded_image, loaded_image)) IS NOT TRUE
                     AND (concat('1', loaded_image, loaded_image) = concat('0', loaded_image, loaded_image)) IS FALSE
                     AND (concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)) IS NOT FALSE
                     AND concat('1', loaded_image, loaded_image) BETWEEN concat('0', loaded_image, loaded_image) AND concat('2', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) NOT BETWEEN concat('1', loaded_image, loaded_image) AND concat('0', loaded_image, loaded_image)
                     AND concat('1', loaded_image, loaded_image) like '%'
                     AND concat('1', loaded_image, loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND concat('1', loaded_image, loaded_image) IN (concat('0', loaded_image, loaded_image),
                                                                     concat('1', loaded_image, loaded_image),
                                                                     concat('2', loaded_image, loaded_image))
                     AND concat('1', loaded_image, loaded_image) NOT IN (concat('0', loaded_image, loaded_image),
                                                                         concat('2', loaded_image, loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          concat('1', loaded_image, loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (concat('1', loaded_image, loaded_image) IS NULL
          OR (concat('1', loaded_image, loaded_image) = concat('1', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) IS NOT DISTINCT
              FROM concat('1', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)
              AND (concat('1', loaded_image, loaded_image) IS DISTINCT
                   FROM concat('0', loaded_image, loaded_image))
              AND concat('1', loaded_image, loaded_image) > concat('0', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) >= concat('0', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) < concat('2', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) <= concat('2', loaded_image, loaded_image)
              AND (concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)) IS TRUE
              AND (concat('1', loaded_image, loaded_image) = concat('0', loaded_image, loaded_image)) IS NOT TRUE
              AND (concat('1', loaded_image, loaded_image) = concat('0', loaded_image, loaded_image)) IS FALSE
              AND (concat('1', loaded_image, loaded_image) <> concat('0', loaded_image, loaded_image)) IS NOT FALSE
              AND concat('1', loaded_image, loaded_image) BETWEEN concat('0', loaded_image, loaded_image) AND concat('2', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) NOT BETWEEN concat('1', loaded_image, loaded_image) AND concat('0', loaded_image, loaded_image)
              AND concat('1', loaded_image, loaded_image) like '%'
              AND concat('1', loaded_image, loaded_image) not like '__DOES_NOT_EXIST__%'
              AND concat('1', loaded_image, loaded_image) IN (concat('0', loaded_image, loaded_image),
                                                              concat('1', loaded_image, loaded_image),
                                                              concat('2', loaded_image, loaded_image))
              AND concat('1', loaded_image, loaded_image) NOT IN (concat('0', loaded_image, loaded_image),
                                                                  concat('2', loaded_image, loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A4: textcat
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (textcat('1', loaded_image) IS NULL
       OR (textcat('1', loaded_image) = textcat('1', loaded_image)
           AND textcat('1', loaded_image) IS NOT DISTINCT
           FROM textcat('1', loaded_image)
           AND textcat('1', loaded_image) <> textcat('0', loaded_image)
           AND (textcat('1', loaded_image) IS DISTINCT
                FROM textcat('0', loaded_image))
           AND textcat('1', loaded_image) > textcat('0', loaded_image)
           AND textcat('1', loaded_image) >= textcat('0', loaded_image)
           AND textcat('1', loaded_image) < textcat('2', loaded_image)
           AND textcat('1', loaded_image) <= textcat('2', loaded_image)
           AND (textcat('1', loaded_image) <> textcat('0', loaded_image)) IS TRUE
           AND (textcat('1', loaded_image) = textcat('0', loaded_image)) IS NOT TRUE
           AND (textcat('1', loaded_image) = textcat('0', loaded_image)) IS FALSE
           AND (textcat('1', loaded_image) <> textcat('0', loaded_image)) IS NOT FALSE
           AND textcat('1', loaded_image) BETWEEN textcat('0', loaded_image) AND textcat('2', loaded_image)
           AND textcat('1', loaded_image) NOT BETWEEN textcat('1', loaded_image) AND textcat('0', loaded_image)
           AND textcat('1', loaded_image) like '%'
           AND textcat('1', loaded_image) not like '__DOES_NOT_EXIST__%'
           AND textcat('1', loaded_image) IN (textcat('0', loaded_image),
                                              textcat('1', loaded_image),
                                              textcat('2', loaded_image))
           AND textcat('1', loaded_image) NOT IN (textcat('0', loaded_image),
                                                  textcat('2', loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (textcat('1', loaded_image) IS NULL
       OR textcat('1', loaded_image) IN
         (SELECT textcat('1', loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (textcat('1', loaded_image) IS NULL
                 OR (textcat('1', loaded_image) = textcat('1', loaded_image)
                     AND textcat('1', loaded_image) IS NOT DISTINCT
                     FROM textcat('1', loaded_image)
                     AND textcat('1', loaded_image) <> textcat('0', loaded_image)
                     AND (textcat('1', loaded_image) IS DISTINCT
                          FROM textcat('0', loaded_image))
                     AND textcat('1', loaded_image) > textcat('0', loaded_image)
                     AND textcat('1', loaded_image) >= textcat('0', loaded_image)
                     AND textcat('1', loaded_image) < textcat('2', loaded_image)
                     AND textcat('1', loaded_image) <= textcat('2', loaded_image)
                     AND (textcat('1', loaded_image) <> textcat('0', loaded_image)) IS TRUE
                     AND (textcat('1', loaded_image) = textcat('0', loaded_image)) IS NOT TRUE
                     AND (textcat('1', loaded_image) = textcat('0', loaded_image)) IS FALSE
                     AND (textcat('1', loaded_image) <> textcat('0', loaded_image)) IS NOT FALSE
                     AND textcat('1', loaded_image) BETWEEN textcat('0', loaded_image) AND textcat('2', loaded_image)
                     AND textcat('1', loaded_image) NOT BETWEEN textcat('1', loaded_image) AND textcat('0', loaded_image)
                     AND textcat('1', loaded_image) like '%'
                     AND textcat('1', loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND textcat('1', loaded_image) IN (textcat('0', loaded_image),
                                                        textcat('1', loaded_image),
                                                        textcat('2', loaded_image))
                     AND textcat('1', loaded_image) NOT IN (textcat('0', loaded_image),
                                                            textcat('2', loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          textcat('1', loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (textcat('1', loaded_image) IS NULL
          OR (textcat('1', loaded_image) = textcat('1', loaded_image)
              AND textcat('1', loaded_image) IS NOT DISTINCT
              FROM textcat('1', loaded_image)
              AND textcat('1', loaded_image) <> textcat('0', loaded_image)
              AND (textcat('1', loaded_image) IS DISTINCT
                   FROM textcat('0', loaded_image))
              AND textcat('1', loaded_image) > textcat('0', loaded_image)
              AND textcat('1', loaded_image) >= textcat('0', loaded_image)
              AND textcat('1', loaded_image) < textcat('2', loaded_image)
              AND textcat('1', loaded_image) <= textcat('2', loaded_image)
              AND (textcat('1', loaded_image) <> textcat('0', loaded_image)) IS TRUE
              AND (textcat('1', loaded_image) = textcat('0', loaded_image)) IS NOT TRUE
              AND (textcat('1', loaded_image) = textcat('0', loaded_image)) IS FALSE
              AND (textcat('1', loaded_image) <> textcat('0', loaded_image)) IS NOT FALSE
              AND textcat('1', loaded_image) BETWEEN textcat('0', loaded_image) AND textcat('2', loaded_image)
              AND textcat('1', loaded_image) NOT BETWEEN textcat('1', loaded_image) AND textcat('0', loaded_image)
              AND textcat('1', loaded_image) like '%'
              AND textcat('1', loaded_image) not like '__DOES_NOT_EXIST__%'
              AND textcat('1', loaded_image) IN (textcat('0', loaded_image),
                                                 textcat('1', loaded_image),
                                                 textcat('2', loaded_image))
              AND textcat('1', loaded_image) NOT IN (textcat('0', loaded_image),
                                                     textcat('2', loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A5: string_format
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (string_format('1 %s', loaded_image) IS NULL
       OR (string_format('1 %s', loaded_image) = string_format('1 %s', loaded_image)
           AND string_format('1 %s', loaded_image) IS NOT DISTINCT
           FROM string_format('1 %s', loaded_image)
           AND string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)
           AND (string_format('1 %s', loaded_image) IS DISTINCT
                FROM string_format('0 %s', loaded_image))
           AND string_format('1 %s', loaded_image) > string_format('0 %s', loaded_image)
           AND string_format('1 %s', loaded_image) >= string_format('0 %s', loaded_image)
           AND string_format('1 %s', loaded_image) < string_format('2 %s', loaded_image)
           AND string_format('1 %s', loaded_image) <= string_format('2 %s', loaded_image)
           AND (string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)) IS TRUE
           AND (string_format('1 %s', loaded_image) = string_format('0 %s', loaded_image)) IS NOT TRUE
           AND (string_format('1 %s', loaded_image) = string_format('0 %s', loaded_image)) IS FALSE
           AND (string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)) IS NOT FALSE
           AND string_format('1 %s', loaded_image) BETWEEN string_format('0 %s', loaded_image) AND string_format('2 %s', loaded_image)
           AND string_format('1 %s', loaded_image) NOT BETWEEN string_format('1 %s', loaded_image) AND string_format('0 %s', loaded_image)
           AND string_format('1 %s', loaded_image) like '%'
           AND string_format('1 %s', loaded_image) not like '__DOES_NOT_EXIST__%'
           AND string_format('1 %s', loaded_image) IN (string_format('0 %s', loaded_image),
                                                       string_format('1 %s', loaded_image),
                                                       string_format('2 %s', loaded_image))
           AND string_format('1 %s', loaded_image) NOT IN (string_format('0 %s', loaded_image),
                                                           string_format('2 %s', loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (string_format('1 %s', loaded_image) IS NULL
       OR string_format('1 %s', loaded_image) IN
         (SELECT string_format('1 %s', loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (string_format('1 %s', loaded_image) IS NULL
                 OR (string_format('1 %s', loaded_image) = string_format('1 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) IS NOT DISTINCT
                     FROM string_format('1 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)
                     AND (string_format('1 %s', loaded_image) IS DISTINCT
                          FROM string_format('0 %s', loaded_image))
                     AND string_format('1 %s', loaded_image) > string_format('0 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) >= string_format('0 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) < string_format('2 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) <= string_format('2 %s', loaded_image)
                     AND (string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)) IS TRUE
                     AND (string_format('1 %s', loaded_image) = string_format('0 %s', loaded_image)) IS NOT TRUE
                     AND (string_format('1 %s', loaded_image) = string_format('0 %s', loaded_image)) IS FALSE
                     AND (string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)) IS NOT FALSE
                     AND string_format('1 %s', loaded_image) BETWEEN string_format('0 %s', loaded_image) AND string_format('2 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) NOT BETWEEN string_format('1 %s', loaded_image) AND string_format('0 %s', loaded_image)
                     AND string_format('1 %s', loaded_image) like '%'
                     AND string_format('1 %s', loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND string_format('1 %s', loaded_image) IN (string_format('0 %s', loaded_image),
                                                                 string_format('1 %s', loaded_image),
                                                                 string_format('2 %s', loaded_image))
                     AND string_format('1 %s', loaded_image) NOT IN (string_format('0 %s', loaded_image),
                                                                     string_format('2 %s', loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          string_format('1 %s', loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (string_format('1 %s', loaded_image) IS NULL
          OR (string_format('1 %s', loaded_image) = string_format('1 %s', loaded_image)
              AND string_format('1 %s', loaded_image) IS NOT DISTINCT
              FROM string_format('1 %s', loaded_image)
              AND string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)
              AND (string_format('1 %s', loaded_image) IS DISTINCT
                   FROM string_format('0 %s', loaded_image))
              AND string_format('1 %s', loaded_image) > string_format('0 %s', loaded_image)
              AND string_format('1 %s', loaded_image) >= string_format('0 %s', loaded_image)
              AND string_format('1 %s', loaded_image) < string_format('2 %s', loaded_image)
              AND string_format('1 %s', loaded_image) <= string_format('2 %s', loaded_image)
              AND (string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)) IS TRUE
              AND (string_format('1 %s', loaded_image) = string_format('0 %s', loaded_image)) IS NOT TRUE
              AND (string_format('1 %s', loaded_image) = string_format('0 %s', loaded_image)) IS FALSE
              AND (string_format('1 %s', loaded_image) <> string_format('0 %s', loaded_image)) IS NOT FALSE
              AND string_format('1 %s', loaded_image) BETWEEN string_format('0 %s', loaded_image) AND string_format('2 %s', loaded_image)
              AND string_format('1 %s', loaded_image) NOT BETWEEN string_format('1 %s', loaded_image) AND string_format('0 %s', loaded_image)
              AND string_format('1 %s', loaded_image) like '%'
              AND string_format('1 %s', loaded_image) not like '__DOES_NOT_EXIST__%'
              AND string_format('1 %s', loaded_image) IN (string_format('0 %s', loaded_image),
                                                          string_format('1 %s', loaded_image),
                                                          string_format('2 %s', loaded_image))
              AND string_format('1 %s', loaded_image) NOT IN (string_format('0 %s', loaded_image),
                                                              string_format('2 %s', loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A6: length
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||length(loaded_image) IS NULL
       OR ('1'||length(loaded_image) = 1||length(loaded_image)
           AND '1'||length(loaded_image) IS NOT DISTINCT
           FROM 1||length(loaded_image)
           AND '1'||length(loaded_image) <> '0'||length(loaded_image)
           AND ('1'||length(loaded_image) IS DISTINCT
                FROM '0'||length(loaded_image))
           AND '1'||length(loaded_image) > '0'||length(loaded_image)
           AND '1'||length(loaded_image) >= '0'||length(loaded_image)
           AND '1'||length(loaded_image) < 2||length(loaded_image)
           AND '1'||length(loaded_image) <= 2||length(loaded_image)
           AND ('1'||length(loaded_image) <> '0'||length(loaded_image)) IS TRUE
           AND ('1'||length(loaded_image) = '0'||length(loaded_image)) IS NOT TRUE
           AND ('1'||length(loaded_image) = '0'||length(loaded_image)) IS FALSE
           AND ('1'||length(loaded_image) <> '0'||length(loaded_image)) IS NOT FALSE
           AND '1'||length(loaded_image) BETWEEN '0'||length(loaded_image) AND 2||length(loaded_image)
           AND '1'||length(loaded_image) NOT BETWEEN '1'||length(loaded_image) AND '0'||length(loaded_image)
           AND '1'||length(loaded_image) like '%'
           AND '1'||length(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||length(loaded_image) IN ('0'||length(loaded_image),
                                             1||length(loaded_image),
                                             2||length(loaded_image))
           AND '1'||length(loaded_image) NOT IN ('0'||length(loaded_image),
                                                 2||length(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||length(loaded_image) IS NULL
       OR '1'||length(loaded_image) IN
         (SELECT '1'||length(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||length(loaded_image) IS NULL
                 OR ('1'||length(loaded_image) = 1||length(loaded_image)
                     AND '1'||length(loaded_image) IS NOT DISTINCT
                     FROM 1||length(loaded_image)
                     AND '1'||length(loaded_image) <> '0'||length(loaded_image)
                     AND ('1'||length(loaded_image) IS DISTINCT
                          FROM '0'||length(loaded_image))
                     AND '1'||length(loaded_image) > '0'||length(loaded_image)
                     AND '1'||length(loaded_image) >= '0'||length(loaded_image)
                     AND '1'||length(loaded_image) < 2||length(loaded_image)
                     AND '1'||length(loaded_image) <= 2||length(loaded_image)
                     AND ('1'||length(loaded_image) <> '0'||length(loaded_image)) IS TRUE
                     AND ('1'||length(loaded_image) = '0'||length(loaded_image)) IS NOT TRUE
                     AND ('1'||length(loaded_image) = '0'||length(loaded_image)) IS FALSE
                     AND ('1'||length(loaded_image) <> '0'||length(loaded_image)) IS NOT FALSE
                     AND '1'||length(loaded_image) BETWEEN '0'||length(loaded_image) AND 2||length(loaded_image)
                     AND '1'||length(loaded_image) NOT BETWEEN '1'||length(loaded_image) AND '0'||length(loaded_image)
                     AND '1'||length(loaded_image) like '%'
                     AND '1'||length(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||length(loaded_image) IN ('0'||length(loaded_image),
                                                       1||length(loaded_image),
                                                       2||length(loaded_image))
                     AND '1'||length(loaded_image) NOT IN ('0'||length(loaded_image),
                                                           2||length(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||length(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||length(loaded_image) IS NULL
          OR ('1'||length(loaded_image) = 1||length(loaded_image)
              AND '1'||length(loaded_image) IS NOT DISTINCT
              FROM 1||length(loaded_image)
              AND '1'||length(loaded_image) <> '0'||length(loaded_image)
              AND ('1'||length(loaded_image) IS DISTINCT
                   FROM '0'||length(loaded_image))
              AND '1'||length(loaded_image) > '0'||length(loaded_image)
              AND '1'||length(loaded_image) >= '0'||length(loaded_image)
              AND '1'||length(loaded_image) < 2||length(loaded_image)
              AND '1'||length(loaded_image) <= 2||length(loaded_image)
              AND ('1'||length(loaded_image) <> '0'||length(loaded_image)) IS TRUE
              AND ('1'||length(loaded_image) = '0'||length(loaded_image)) IS NOT TRUE
              AND ('1'||length(loaded_image) = '0'||length(loaded_image)) IS FALSE
              AND ('1'||length(loaded_image) <> '0'||length(loaded_image)) IS NOT FALSE
              AND '1'||length(loaded_image) BETWEEN '0'||length(loaded_image) AND 2||length(loaded_image)
              AND '1'||length(loaded_image) NOT BETWEEN '1'||length(loaded_image) AND '0'||length(loaded_image)
              AND '1'||length(loaded_image) like '%'
              AND '1'||length(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||length(loaded_image) IN ('0'||length(loaded_image),
                                                1||length(loaded_image),
                                                2||length(loaded_image))
              AND '1'||length(loaded_image) NOT IN ('0'||length(loaded_image),
                                                    2||length(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A7: char_length
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||char_length(loaded_image) IS NULL
       OR ('1'||char_length(loaded_image) = 1||char_length(loaded_image)
           AND '1'||char_length(loaded_image) IS NOT DISTINCT
           FROM 1||char_length(loaded_image)
           AND '1'||char_length(loaded_image) <> '0'||char_length(loaded_image)
           AND ('1'||char_length(loaded_image) IS DISTINCT
                FROM '0'||char_length(loaded_image))
           AND '1'||char_length(loaded_image) > '0'||char_length(loaded_image)
           AND '1'||char_length(loaded_image) >= '0'||char_length(loaded_image)
           AND '1'||char_length(loaded_image) < 2||char_length(loaded_image)
           AND '1'||char_length(loaded_image) <= 2||char_length(loaded_image)
           AND ('1'||char_length(loaded_image) <> '0'||char_length(loaded_image)) IS TRUE
           AND ('1'||char_length(loaded_image) = '0'||char_length(loaded_image)) IS NOT TRUE
           AND ('1'||char_length(loaded_image) = '0'||char_length(loaded_image)) IS FALSE
           AND ('1'||char_length(loaded_image) <> '0'||char_length(loaded_image)) IS NOT FALSE
           AND '1'||char_length(loaded_image) BETWEEN '0'||char_length(loaded_image) AND 2||char_length(loaded_image)
           AND '1'||char_length(loaded_image) NOT BETWEEN '1'||char_length(loaded_image) AND '0'||char_length(loaded_image)
           AND '1'||char_length(loaded_image) like '%'
           AND '1'||char_length(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||char_length(loaded_image) IN ('0'||char_length(loaded_image),
                                                  1||char_length(loaded_image),
                                                  2||char_length(loaded_image))
           AND '1'||char_length(loaded_image) NOT IN ('0'||char_length(loaded_image),
                                                      2||char_length(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||char_length(loaded_image) IS NULL
       OR '1'||char_length(loaded_image) IN
         (SELECT '1'||char_length(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||char_length(loaded_image) IS NULL
                 OR ('1'||char_length(loaded_image) = 1||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) IS NOT DISTINCT
                     FROM 1||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) <> '0'||char_length(loaded_image)
                     AND ('1'||char_length(loaded_image) IS DISTINCT
                          FROM '0'||char_length(loaded_image))
                     AND '1'||char_length(loaded_image) > '0'||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) >= '0'||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) < 2||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) <= 2||char_length(loaded_image)
                     AND ('1'||char_length(loaded_image) <> '0'||char_length(loaded_image)) IS TRUE
                     AND ('1'||char_length(loaded_image) = '0'||char_length(loaded_image)) IS NOT TRUE
                     AND ('1'||char_length(loaded_image) = '0'||char_length(loaded_image)) IS FALSE
                     AND ('1'||char_length(loaded_image) <> '0'||char_length(loaded_image)) IS NOT FALSE
                     AND '1'||char_length(loaded_image) BETWEEN '0'||char_length(loaded_image) AND 2||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) NOT BETWEEN '1'||char_length(loaded_image) AND '0'||char_length(loaded_image)
                     AND '1'||char_length(loaded_image) like '%'
                     AND '1'||char_length(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||char_length(loaded_image) IN ('0'||char_length(loaded_image),
                                                            1||char_length(loaded_image),
                                                            2||char_length(loaded_image))
                     AND '1'||char_length(loaded_image) NOT IN ('0'||char_length(loaded_image),
                                                                2||char_length(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||char_length(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||char_length(loaded_image) IS NULL
          OR ('1'||char_length(loaded_image) = 1||char_length(loaded_image)
              AND '1'||char_length(loaded_image) IS NOT DISTINCT
              FROM 1||char_length(loaded_image)
              AND '1'||char_length(loaded_image) <> '0'||char_length(loaded_image)
              AND ('1'||char_length(loaded_image) IS DISTINCT
                   FROM '0'||char_length(loaded_image))
              AND '1'||char_length(loaded_image) > '0'||char_length(loaded_image)
              AND '1'||char_length(loaded_image) >= '0'||char_length(loaded_image)
              AND '1'||char_length(loaded_image) < 2||char_length(loaded_image)
              AND '1'||char_length(loaded_image) <= 2||char_length(loaded_image)
              AND ('1'||char_length(loaded_image) <> '0'||char_length(loaded_image)) IS TRUE
              AND ('1'||char_length(loaded_image) = '0'||char_length(loaded_image)) IS NOT TRUE
              AND ('1'||char_length(loaded_image) = '0'||char_length(loaded_image)) IS FALSE
              AND ('1'||char_length(loaded_image) <> '0'||char_length(loaded_image)) IS NOT FALSE
              AND '1'||char_length(loaded_image) BETWEEN '0'||char_length(loaded_image) AND 2||char_length(loaded_image)
              AND '1'||char_length(loaded_image) NOT BETWEEN '1'||char_length(loaded_image) AND '0'||char_length(loaded_image)
              AND '1'||char_length(loaded_image) like '%'
              AND '1'||char_length(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||char_length(loaded_image) IN ('0'||char_length(loaded_image),
                                                     1||char_length(loaded_image),
                                                     2||char_length(loaded_image))
              AND '1'||char_length(loaded_image) NOT IN ('0'||char_length(loaded_image),
                                                         2||char_length(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A8: character_length
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||character_length(loaded_image) IS NULL
       OR ('1'||character_length(loaded_image) = 1||character_length(loaded_image)
           AND '1'||character_length(loaded_image) IS NOT DISTINCT
           FROM 1||character_length(loaded_image)
           AND '1'||character_length(loaded_image) <> '0'||character_length(loaded_image)
           AND ('1'||character_length(loaded_image) IS DISTINCT
                FROM '0'||character_length(loaded_image))
           AND '1'||character_length(loaded_image) > '0'||character_length(loaded_image)
           AND '1'||character_length(loaded_image) >= '0'||character_length(loaded_image)
           AND '1'||character_length(loaded_image) < 2||character_length(loaded_image)
           AND '1'||character_length(loaded_image) <= 2||character_length(loaded_image)
           AND ('1'||character_length(loaded_image) <> '0'||character_length(loaded_image)) IS TRUE
           AND ('1'||character_length(loaded_image) = '0'||character_length(loaded_image)) IS NOT TRUE
           AND ('1'||character_length(loaded_image) = '0'||character_length(loaded_image)) IS FALSE
           AND ('1'||character_length(loaded_image) <> '0'||character_length(loaded_image)) IS NOT FALSE
           AND '1'||character_length(loaded_image) BETWEEN '0'||character_length(loaded_image) AND 2||character_length(loaded_image)
           AND '1'||character_length(loaded_image) NOT BETWEEN '1'||character_length(loaded_image) AND '0'||character_length(loaded_image)
           AND '1'||character_length(loaded_image) like '%'
           AND '1'||character_length(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||character_length(loaded_image) IN ('0'||character_length(loaded_image),
                                                       1||character_length(loaded_image),
                                                       2||character_length(loaded_image))
           AND '1'||character_length(loaded_image) NOT IN ('0'||character_length(loaded_image),
                                                           2||character_length(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||character_length(loaded_image) IS NULL
       OR '1'||character_length(loaded_image) IN
         (SELECT '1'||character_length(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||character_length(loaded_image) IS NULL
                 OR ('1'||character_length(loaded_image) = 1||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) IS NOT DISTINCT
                     FROM 1||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) <> '0'||character_length(loaded_image)
                     AND ('1'||character_length(loaded_image) IS DISTINCT
                          FROM '0'||character_length(loaded_image))
                     AND '1'||character_length(loaded_image) > '0'||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) >= '0'||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) < 2||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) <= 2||character_length(loaded_image)
                     AND ('1'||character_length(loaded_image) <> '0'||character_length(loaded_image)) IS TRUE
                     AND ('1'||character_length(loaded_image) = '0'||character_length(loaded_image)) IS NOT TRUE
                     AND ('1'||character_length(loaded_image) = '0'||character_length(loaded_image)) IS FALSE
                     AND ('1'||character_length(loaded_image) <> '0'||character_length(loaded_image)) IS NOT FALSE
                     AND '1'||character_length(loaded_image) BETWEEN '0'||character_length(loaded_image) AND 2||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) NOT BETWEEN '1'||character_length(loaded_image) AND '0'||character_length(loaded_image)
                     AND '1'||character_length(loaded_image) like '%'
                     AND '1'||character_length(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||character_length(loaded_image) IN ('0'||character_length(loaded_image),
                                                                 1||character_length(loaded_image),
                                                                 2||character_length(loaded_image))
                     AND '1'||character_length(loaded_image) NOT IN ('0'||character_length(loaded_image),
                                                                     2||character_length(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||character_length(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||character_length(loaded_image) IS NULL
          OR ('1'||character_length(loaded_image) = 1||character_length(loaded_image)
              AND '1'||character_length(loaded_image) IS NOT DISTINCT
              FROM 1||character_length(loaded_image)
              AND '1'||character_length(loaded_image) <> '0'||character_length(loaded_image)
              AND ('1'||character_length(loaded_image) IS DISTINCT
                   FROM '0'||character_length(loaded_image))
              AND '1'||character_length(loaded_image) > '0'||character_length(loaded_image)
              AND '1'||character_length(loaded_image) >= '0'||character_length(loaded_image)
              AND '1'||character_length(loaded_image) < 2||character_length(loaded_image)
              AND '1'||character_length(loaded_image) <= 2||character_length(loaded_image)
              AND ('1'||character_length(loaded_image) <> '0'||character_length(loaded_image)) IS TRUE
              AND ('1'||character_length(loaded_image) = '0'||character_length(loaded_image)) IS NOT TRUE
              AND ('1'||character_length(loaded_image) = '0'||character_length(loaded_image)) IS FALSE
              AND ('1'||character_length(loaded_image) <> '0'||character_length(loaded_image)) IS NOT FALSE
              AND '1'||character_length(loaded_image) BETWEEN '0'||character_length(loaded_image) AND 2||character_length(loaded_image)
              AND '1'||character_length(loaded_image) NOT BETWEEN '1'||character_length(loaded_image) AND '0'||character_length(loaded_image)
              AND '1'||character_length(loaded_image) like '%'
              AND '1'||character_length(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||character_length(loaded_image) IN ('0'||character_length(loaded_image),
                                                          1||character_length(loaded_image),
                                                          2||character_length(loaded_image))
              AND '1'||character_length(loaded_image) NOT IN ('0'||character_length(loaded_image),
                                                              2||character_length(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A9: strlen
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||strlen(loaded_image) IS NULL
       OR ('1'||strlen(loaded_image) = 1||strlen(loaded_image)
           AND '1'||strlen(loaded_image) IS NOT DISTINCT
           FROM 1||strlen(loaded_image)
           AND '1'||strlen(loaded_image) <> '0'||strlen(loaded_image)
           AND ('1'||strlen(loaded_image) IS DISTINCT
                FROM '0'||strlen(loaded_image))
           AND '1'||strlen(loaded_image) > '0'||strlen(loaded_image)
           AND '1'||strlen(loaded_image) >= '0'||strlen(loaded_image)
           AND '1'||strlen(loaded_image) < 2||strlen(loaded_image)
           AND '1'||strlen(loaded_image) <= 2||strlen(loaded_image)
           AND ('1'||strlen(loaded_image) <> '0'||strlen(loaded_image)) IS TRUE
           AND ('1'||strlen(loaded_image) = '0'||strlen(loaded_image)) IS NOT TRUE
           AND ('1'||strlen(loaded_image) = '0'||strlen(loaded_image)) IS FALSE
           AND ('1'||strlen(loaded_image) <> '0'||strlen(loaded_image)) IS NOT FALSE
           AND '1'||strlen(loaded_image) BETWEEN '0'||strlen(loaded_image) AND 2||strlen(loaded_image)
           AND '1'||strlen(loaded_image) NOT BETWEEN '1'||strlen(loaded_image) AND '0'||strlen(loaded_image)
           AND '1'||strlen(loaded_image) like '%'
           AND '1'||strlen(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||strlen(loaded_image) IN ('0'||strlen(loaded_image),
                                             1||strlen(loaded_image),
                                             2||strlen(loaded_image))
           AND '1'||strlen(loaded_image) NOT IN ('0'||strlen(loaded_image),
                                                 2||strlen(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||strlen(loaded_image) IS NULL
       OR '1'||strlen(loaded_image) IN
         (SELECT '1'||strlen(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||strlen(loaded_image) IS NULL
                 OR ('1'||strlen(loaded_image) = 1||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) IS NOT DISTINCT
                     FROM 1||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) <> '0'||strlen(loaded_image)
                     AND ('1'||strlen(loaded_image) IS DISTINCT
                          FROM '0'||strlen(loaded_image))
                     AND '1'||strlen(loaded_image) > '0'||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) >= '0'||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) < 2||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) <= 2||strlen(loaded_image)
                     AND ('1'||strlen(loaded_image) <> '0'||strlen(loaded_image)) IS TRUE
                     AND ('1'||strlen(loaded_image) = '0'||strlen(loaded_image)) IS NOT TRUE
                     AND ('1'||strlen(loaded_image) = '0'||strlen(loaded_image)) IS FALSE
                     AND ('1'||strlen(loaded_image) <> '0'||strlen(loaded_image)) IS NOT FALSE
                     AND '1'||strlen(loaded_image) BETWEEN '0'||strlen(loaded_image) AND 2||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) NOT BETWEEN '1'||strlen(loaded_image) AND '0'||strlen(loaded_image)
                     AND '1'||strlen(loaded_image) like '%'
                     AND '1'||strlen(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||strlen(loaded_image) IN ('0'||strlen(loaded_image),
                                                       1||strlen(loaded_image),
                                                       2||strlen(loaded_image))
                     AND '1'||strlen(loaded_image) NOT IN ('0'||strlen(loaded_image),
                                                           2||strlen(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||strlen(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||strlen(loaded_image) IS NULL
          OR ('1'||strlen(loaded_image) = 1||strlen(loaded_image)
              AND '1'||strlen(loaded_image) IS NOT DISTINCT
              FROM 1||strlen(loaded_image)
              AND '1'||strlen(loaded_image) <> '0'||strlen(loaded_image)
              AND ('1'||strlen(loaded_image) IS DISTINCT
                   FROM '0'||strlen(loaded_image))
              AND '1'||strlen(loaded_image) > '0'||strlen(loaded_image)
              AND '1'||strlen(loaded_image) >= '0'||strlen(loaded_image)
              AND '1'||strlen(loaded_image) < 2||strlen(loaded_image)
              AND '1'||strlen(loaded_image) <= 2||strlen(loaded_image)
              AND ('1'||strlen(loaded_image) <> '0'||strlen(loaded_image)) IS TRUE
              AND ('1'||strlen(loaded_image) = '0'||strlen(loaded_image)) IS NOT TRUE
              AND ('1'||strlen(loaded_image) = '0'||strlen(loaded_image)) IS FALSE
              AND ('1'||strlen(loaded_image) <> '0'||strlen(loaded_image)) IS NOT FALSE
              AND '1'||strlen(loaded_image) BETWEEN '0'||strlen(loaded_image) AND 2||strlen(loaded_image)
              AND '1'||strlen(loaded_image) NOT BETWEEN '1'||strlen(loaded_image) AND '0'||strlen(loaded_image)
              AND '1'||strlen(loaded_image) like '%'
              AND '1'||strlen(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||strlen(loaded_image) IN ('0'||strlen(loaded_image),
                                                1||strlen(loaded_image),
                                                2||strlen(loaded_image))
              AND '1'||strlen(loaded_image) NOT IN ('0'||strlen(loaded_image),
                                                    2||strlen(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A10: lower
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||lower(loaded_image) IS NULL
       OR ('1'||lower(loaded_image) = 1||lower(loaded_image)
           AND '1'||lower(loaded_image) IS NOT DISTINCT
           FROM 1||lower(loaded_image)
           AND '1'||lower(loaded_image) <> '0'||lower(loaded_image)
           AND ('1'||lower(loaded_image) IS DISTINCT
                FROM '0'||lower(loaded_image))
           AND '1'||lower(loaded_image) > '0'||lower(loaded_image)
           AND '1'||lower(loaded_image) >= '0'||lower(loaded_image)
           AND '1'||lower(loaded_image) < 2||lower(loaded_image)
           AND '1'||lower(loaded_image) <= 2||lower(loaded_image)
           AND ('1'||lower(loaded_image) <> '0'||lower(loaded_image)) IS TRUE
           AND ('1'||lower(loaded_image) = '0'||lower(loaded_image)) IS NOT TRUE
           AND ('1'||lower(loaded_image) = '0'||lower(loaded_image)) IS FALSE
           AND ('1'||lower(loaded_image) <> '0'||lower(loaded_image)) IS NOT FALSE
           AND '1'||lower(loaded_image) BETWEEN '0'||lower(loaded_image) AND 2||lower(loaded_image)
           AND '1'||lower(loaded_image) NOT BETWEEN '1'||lower(loaded_image) AND '0'||lower(loaded_image)
           AND '1'||lower(loaded_image) like '%'
           AND '1'||lower(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||lower(loaded_image) IN ('0'||lower(loaded_image),
                                            1||lower(loaded_image),
                                            2||lower(loaded_image))
           AND '1'||lower(loaded_image) NOT IN ('0'||lower(loaded_image),
                                                2||lower(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||lower(loaded_image) IS NULL
       OR '1'||lower(loaded_image) IN
         (SELECT '1'||lower(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||lower(loaded_image) IS NULL
                 OR ('1'||lower(loaded_image) = 1||lower(loaded_image)
                     AND '1'||lower(loaded_image) IS NOT DISTINCT
                     FROM 1||lower(loaded_image)
                     AND '1'||lower(loaded_image) <> '0'||lower(loaded_image)
                     AND ('1'||lower(loaded_image) IS DISTINCT
                          FROM '0'||lower(loaded_image))
                     AND '1'||lower(loaded_image) > '0'||lower(loaded_image)
                     AND '1'||lower(loaded_image) >= '0'||lower(loaded_image)
                     AND '1'||lower(loaded_image) < 2||lower(loaded_image)
                     AND '1'||lower(loaded_image) <= 2||lower(loaded_image)
                     AND ('1'||lower(loaded_image) <> '0'||lower(loaded_image)) IS TRUE
                     AND ('1'||lower(loaded_image) = '0'||lower(loaded_image)) IS NOT TRUE
                     AND ('1'||lower(loaded_image) = '0'||lower(loaded_image)) IS FALSE
                     AND ('1'||lower(loaded_image) <> '0'||lower(loaded_image)) IS NOT FALSE
                     AND '1'||lower(loaded_image) BETWEEN '0'||lower(loaded_image) AND 2||lower(loaded_image)
                     AND '1'||lower(loaded_image) NOT BETWEEN '1'||lower(loaded_image) AND '0'||lower(loaded_image)
                     AND '1'||lower(loaded_image) like '%'
                     AND '1'||lower(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||lower(loaded_image) IN ('0'||lower(loaded_image),
                                                      1||lower(loaded_image),
                                                      2||lower(loaded_image))
                     AND '1'||lower(loaded_image) NOT IN ('0'||lower(loaded_image),
                                                          2||lower(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||lower(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||lower(loaded_image) IS NULL
          OR ('1'||lower(loaded_image) = 1||lower(loaded_image)
              AND '1'||lower(loaded_image) IS NOT DISTINCT
              FROM 1||lower(loaded_image)
              AND '1'||lower(loaded_image) <> '0'||lower(loaded_image)
              AND ('1'||lower(loaded_image) IS DISTINCT
                   FROM '0'||lower(loaded_image))
              AND '1'||lower(loaded_image) > '0'||lower(loaded_image)
              AND '1'||lower(loaded_image) >= '0'||lower(loaded_image)
              AND '1'||lower(loaded_image) < 2||lower(loaded_image)
              AND '1'||lower(loaded_image) <= 2||lower(loaded_image)
              AND ('1'||lower(loaded_image) <> '0'||lower(loaded_image)) IS TRUE
              AND ('1'||lower(loaded_image) = '0'||lower(loaded_image)) IS NOT TRUE
              AND ('1'||lower(loaded_image) = '0'||lower(loaded_image)) IS FALSE
              AND ('1'||lower(loaded_image) <> '0'||lower(loaded_image)) IS NOT FALSE
              AND '1'||lower(loaded_image) BETWEEN '0'||lower(loaded_image) AND 2||lower(loaded_image)
              AND '1'||lower(loaded_image) NOT BETWEEN '1'||lower(loaded_image) AND '0'||lower(loaded_image)
              AND '1'||lower(loaded_image) like '%'
              AND '1'||lower(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||lower(loaded_image) IN ('0'||lower(loaded_image),
                                               1||lower(loaded_image),
                                               2||lower(loaded_image))
              AND '1'||lower(loaded_image) NOT IN ('0'||lower(loaded_image),
                                                   2||lower(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A11: upper
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||upper(loaded_image) IS NULL
       OR ('1'||upper(loaded_image) = 1||upper(loaded_image)
           AND '1'||upper(loaded_image) IS NOT DISTINCT
           FROM 1||upper(loaded_image)
           AND '1'||upper(loaded_image) <> '0'||upper(loaded_image)
           AND ('1'||upper(loaded_image) IS DISTINCT
                FROM '0'||upper(loaded_image))
           AND '1'||upper(loaded_image) > '0'||upper(loaded_image)
           AND '1'||upper(loaded_image) >= '0'||upper(loaded_image)
           AND '1'||upper(loaded_image) < 2||upper(loaded_image)
           AND '1'||upper(loaded_image) <= 2||upper(loaded_image)
           AND ('1'||upper(loaded_image) <> '0'||upper(loaded_image)) IS TRUE
           AND ('1'||upper(loaded_image) = '0'||upper(loaded_image)) IS NOT TRUE
           AND ('1'||upper(loaded_image) = '0'||upper(loaded_image)) IS FALSE
           AND ('1'||upper(loaded_image) <> '0'||upper(loaded_image)) IS NOT FALSE
           AND '1'||upper(loaded_image) BETWEEN '0'||upper(loaded_image) AND 2||upper(loaded_image)
           AND '1'||upper(loaded_image) NOT BETWEEN '1'||upper(loaded_image) AND '0'||upper(loaded_image)
           AND '1'||upper(loaded_image) like '%'
           AND '1'||upper(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||upper(loaded_image) IN ('0'||upper(loaded_image),
                                            1||upper(loaded_image),
                                            2||upper(loaded_image))
           AND '1'||upper(loaded_image) NOT IN ('0'||upper(loaded_image),
                                                2||upper(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||upper(loaded_image) IS NULL
       OR '1'||upper(loaded_image) IN
         (SELECT '1'||upper(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||upper(loaded_image) IS NULL
                 OR ('1'||upper(loaded_image) = 1||upper(loaded_image)
                     AND '1'||upper(loaded_image) IS NOT DISTINCT
                     FROM 1||upper(loaded_image)
                     AND '1'||upper(loaded_image) <> '0'||upper(loaded_image)
                     AND ('1'||upper(loaded_image) IS DISTINCT
                          FROM '0'||upper(loaded_image))
                     AND '1'||upper(loaded_image) > '0'||upper(loaded_image)
                     AND '1'||upper(loaded_image) >= '0'||upper(loaded_image)
                     AND '1'||upper(loaded_image) < 2||upper(loaded_image)
                     AND '1'||upper(loaded_image) <= 2||upper(loaded_image)
                     AND ('1'||upper(loaded_image) <> '0'||upper(loaded_image)) IS TRUE
                     AND ('1'||upper(loaded_image) = '0'||upper(loaded_image)) IS NOT TRUE
                     AND ('1'||upper(loaded_image) = '0'||upper(loaded_image)) IS FALSE
                     AND ('1'||upper(loaded_image) <> '0'||upper(loaded_image)) IS NOT FALSE
                     AND '1'||upper(loaded_image) BETWEEN '0'||upper(loaded_image) AND 2||upper(loaded_image)
                     AND '1'||upper(loaded_image) NOT BETWEEN '1'||upper(loaded_image) AND '0'||upper(loaded_image)
                     AND '1'||upper(loaded_image) like '%'
                     AND '1'||upper(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||upper(loaded_image) IN ('0'||upper(loaded_image),
                                                      1||upper(loaded_image),
                                                      2||upper(loaded_image))
                     AND '1'||upper(loaded_image) NOT IN ('0'||upper(loaded_image),
                                                          2||upper(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||upper(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||upper(loaded_image) IS NULL
          OR ('1'||upper(loaded_image) = 1||upper(loaded_image)
              AND '1'||upper(loaded_image) IS NOT DISTINCT
              FROM 1||upper(loaded_image)
              AND '1'||upper(loaded_image) <> '0'||upper(loaded_image)
              AND ('1'||upper(loaded_image) IS DISTINCT
                   FROM '0'||upper(loaded_image))
              AND '1'||upper(loaded_image) > '0'||upper(loaded_image)
              AND '1'||upper(loaded_image) >= '0'||upper(loaded_image)
              AND '1'||upper(loaded_image) < 2||upper(loaded_image)
              AND '1'||upper(loaded_image) <= 2||upper(loaded_image)
              AND ('1'||upper(loaded_image) <> '0'||upper(loaded_image)) IS TRUE
              AND ('1'||upper(loaded_image) = '0'||upper(loaded_image)) IS NOT TRUE
              AND ('1'||upper(loaded_image) = '0'||upper(loaded_image)) IS FALSE
              AND ('1'||upper(loaded_image) <> '0'||upper(loaded_image)) IS NOT FALSE
              AND '1'||upper(loaded_image) BETWEEN '0'||upper(loaded_image) AND 2||upper(loaded_image)
              AND '1'||upper(loaded_image) NOT BETWEEN '1'||upper(loaded_image) AND '0'||upper(loaded_image)
              AND '1'||upper(loaded_image) like '%'
              AND '1'||upper(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||upper(loaded_image) IN ('0'||upper(loaded_image),
                                               1||upper(loaded_image),
                                               2||upper(loaded_image))
              AND '1'||upper(loaded_image) NOT IN ('0'||upper(loaded_image),
                                                   2||upper(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A12: parse_long
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (parse_long(number, 10)+1 IS NULL
       OR (parse_long(number, 10)+1 = parse_long(number, 10)+1
           AND parse_long(number, 10)+1 IS NOT DISTINCT
           FROM parse_long(number, 10)+1
           AND parse_long(number, 10)+1 <> parse_long(number, 10)
           AND (parse_long(number, 10)+1 IS DISTINCT
                FROM parse_long(number, 10))
           AND parse_long(number, 10)+1 > parse_long(number, 10)
           AND parse_long(number, 10)+1 >= parse_long(number, 10)
           AND parse_long(number, 10)+1 < parse_long(number, 10)+2
           AND parse_long(number, 10)+1 <= parse_long(number, 10)+2
           AND (parse_long(number, 10)+1 <> parse_long(number, 10)) IS TRUE
           AND (parse_long(number, 10)+1 = parse_long(number, 10)) IS NOT TRUE
           AND (parse_long(number, 10)+1 = parse_long(number, 10)) IS FALSE
           AND (parse_long(number, 10)+1 <> parse_long(number, 10)) IS NOT FALSE
           AND parse_long(number, 10)+1 BETWEEN parse_long(number, 10) AND parse_long(number, 10)+2
           AND parse_long(number, 10)+1 NOT BETWEEN parse_long(number, 10)+1 AND parse_long(number, 10)
           AND parse_long(number, 10)+1 like '%'
           AND parse_long(number, 10)+1 not like '__DOES_NOT_EXIST__%'
           AND parse_long(number, 10)+1 IN (parse_long(number, 10),
                                            parse_long(number, 10)+1,
                                            parse_long(number, 10)+2)
           AND parse_long(number, 10)+1 NOT IN (parse_long(number, 10),
                                                parse_long(number, 10)+2))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (parse_long(number, 10)+1 IS NULL
       OR parse_long(number, 10)+1 IN
         (SELECT parse_long(number, 10)+1
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (parse_long(number, 10)+1 IS NULL
                 OR (parse_long(number, 10)+1 = parse_long(number, 10)+1
                     AND parse_long(number, 10)+1 IS NOT DISTINCT
                     FROM parse_long(number, 10)+1
                     AND parse_long(number, 10)+1 <> parse_long(number, 10)
                     AND (parse_long(number, 10)+1 IS DISTINCT
                          FROM parse_long(number, 10))
                     AND parse_long(number, 10)+1 > parse_long(number, 10)
                     AND parse_long(number, 10)+1 >= parse_long(number, 10)
                     AND parse_long(number, 10)+1 < parse_long(number, 10)+2
                     AND parse_long(number, 10)+1 <= parse_long(number, 10)+2
                     AND (parse_long(number, 10)+1 <> parse_long(number, 10)) IS TRUE
                     AND (parse_long(number, 10)+1 = parse_long(number, 10)) IS NOT TRUE
                     AND (parse_long(number, 10)+1 = parse_long(number, 10)) IS FALSE
                     AND (parse_long(number, 10)+1 <> parse_long(number, 10)) IS NOT FALSE
                     AND parse_long(number, 10)+1 BETWEEN parse_long(number, 10) AND parse_long(number, 10)+2
                     AND parse_long(number, 10)+1 NOT BETWEEN parse_long(number, 10)+1 AND parse_long(number, 10)
                     AND parse_long(number, 10)+1 like '%'
                     AND parse_long(number, 10)+1 not like '__DOES_NOT_EXIST__%'
                     AND parse_long(number, 10)+1 IN (parse_long(number, 10),
                                                      parse_long(number, 10)+1,
                                                      parse_long(number, 10)+2)
                     AND parse_long(number, 10)+1 NOT IN (parse_long(number, 10),
                                                          parse_long(number, 10)+2)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          parse_long(number, 10)+1,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (parse_long(number, 10)+1 IS NULL
          OR (parse_long(number, 10)+1 = parse_long(number, 10)+1
              AND parse_long(number, 10)+1 IS NOT DISTINCT
              FROM parse_long(number, 10)+1
              AND parse_long(number, 10)+1 <> parse_long(number, 10)
              AND (parse_long(number, 10)+1 IS DISTINCT
                   FROM parse_long(number, 10))
              AND parse_long(number, 10)+1 > parse_long(number, 10)
              AND parse_long(number, 10)+1 >= parse_long(number, 10)
              AND parse_long(number, 10)+1 < parse_long(number, 10)+2
              AND parse_long(number, 10)+1 <= parse_long(number, 10)+2
              AND (parse_long(number, 10)+1 <> parse_long(number, 10)) IS TRUE
              AND (parse_long(number, 10)+1 = parse_long(number, 10)) IS NOT TRUE
              AND (parse_long(number, 10)+1 = parse_long(number, 10)) IS FALSE
              AND (parse_long(number, 10)+1 <> parse_long(number, 10)) IS NOT FALSE
              AND parse_long(number, 10)+1 BETWEEN parse_long(number, 10) AND parse_long(number, 10)+2
              AND parse_long(number, 10)+1 NOT BETWEEN parse_long(number, 10)+1 AND parse_long(number, 10)
              AND parse_long(number, 10)+1 like '%'
              AND parse_long(number, 10)+1 not like '__DOES_NOT_EXIST__%'
              AND parse_long(number, 10)+1 IN (parse_long(number, 10),
                                               parse_long(number, 10)+1,
                                               parse_long(number, 10)+2)
              AND parse_long(number, 10)+1 NOT IN (parse_long(number, 10),
                                                   parse_long(number, 10)+2)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A13: position
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (position('a' IN loaded_image
                FROM 3)+1 IS NULL
       OR (position('a' IN loaded_image
                    FROM 3)+1 = position('a' IN loaded_image
                                         FROM 3)+1
           AND position('a' IN loaded_image
                        FROM 3)+1 IS NOT DISTINCT
           FROM position('a' IN loaded_image
                         FROM 3)+1
           AND position('a' IN loaded_image
                        FROM 3)+1 <> position('a' IN loaded_image
                                              FROM 3)
           AND (position('a' IN loaded_image
                         FROM 3)+1 IS DISTINCT
                FROM position('a' IN loaded_image
                              FROM 3))
           AND position('a' IN loaded_image
                        FROM 3)+1 > position('a' IN loaded_image
                                             FROM 3)
           AND position('a' IN loaded_image
                        FROM 3)+1 >= position('a' IN loaded_image
                                              FROM 3)
           AND position('a' IN loaded_image
                        FROM 3)+1 < position('a' IN loaded_image
                                             FROM 3)+2
           AND position('a' IN loaded_image
                        FROM 3)+1 <= position('a' IN loaded_image
                                              FROM 3)+2
           AND (position('a' IN loaded_image
                         FROM 3)+1 <> position('a' IN loaded_image
                                               FROM 3)) IS TRUE
           AND (position('a' IN loaded_image
                         FROM 3)+1 = position('a' IN loaded_image
                                              FROM 3)) IS NOT TRUE
           AND (position('a' IN loaded_image
                         FROM 3)+1 = position('a' IN loaded_image
                                              FROM 3)) IS FALSE
           AND (position('a' IN loaded_image
                         FROM 3)+1 <> position('a' IN loaded_image
                                               FROM 3)) IS NOT FALSE
           AND position('a' IN loaded_image
                        FROM 3)+1 BETWEEN position('a' IN loaded_image
                                                   FROM 3) AND position('a' IN loaded_image
                                                                        FROM 3)+2
           AND position('a' IN loaded_image
                        FROM 3)+1 NOT BETWEEN position('a' IN loaded_image
                                                       FROM 3)+1 AND position('a' IN loaded_image
                                                                              FROM 3)
           AND position('a' IN loaded_image
                        FROM 3)+1 like '%'
           AND position('a' IN loaded_image
                        FROM 3)+1 not like '__DOES_NOT_EXIST__%'
           AND position('a' IN loaded_image
                        FROM 3)+1 IN (position('a' IN loaded_image
                                               FROM 3),
                                      position('a' IN loaded_image
                                               FROM 3)+1,
                                      position('a' IN loaded_image
                                               FROM 3)+2)
           AND position('a' IN loaded_image
                        FROM 3)+1 NOT IN (position('a' IN loaded_image
                                                   FROM 3),
                                          position('a' IN loaded_image
                                                   FROM 3)+2))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (position('a' IN loaded_image
                FROM 3)+1 IS NULL
       OR position('a' IN loaded_image
                   FROM 3)+1 IN
         (SELECT position('a' IN loaded_image
                          FROM 3)+1
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (position('a' IN loaded_image
                          FROM 3)+1 IS NULL
                 OR (position('a' IN loaded_image
                              FROM 3)+1 = position('a' IN loaded_image
                                                   FROM 3)+1
                     AND position('a' IN loaded_image
                                  FROM 3)+1 IS NOT DISTINCT
                     FROM position('a' IN loaded_image
                                   FROM 3)+1
                     AND position('a' IN loaded_image
                                  FROM 3)+1 <> position('a' IN loaded_image
                                                        FROM 3)
                     AND (position('a' IN loaded_image
                                   FROM 3)+1 IS DISTINCT
                          FROM position('a' IN loaded_image
                                        FROM 3))
                     AND position('a' IN loaded_image
                                  FROM 3)+1 > position('a' IN loaded_image
                                                       FROM 3)
                     AND position('a' IN loaded_image
                                  FROM 3)+1 >= position('a' IN loaded_image
                                                        FROM 3)
                     AND position('a' IN loaded_image
                                  FROM 3)+1 < position('a' IN loaded_image
                                                       FROM 3)+2
                     AND position('a' IN loaded_image
                                  FROM 3)+1 <= position('a' IN loaded_image
                                                        FROM 3)+2
                     AND (position('a' IN loaded_image
                                   FROM 3)+1 <> position('a' IN loaded_image
                                                         FROM 3)) IS TRUE
                     AND (position('a' IN loaded_image
                                   FROM 3)+1 = position('a' IN loaded_image
                                                        FROM 3)) IS NOT TRUE
                     AND (position('a' IN loaded_image
                                   FROM 3)+1 = position('a' IN loaded_image
                                                        FROM 3)) IS FALSE
                     AND (position('a' IN loaded_image
                                   FROM 3)+1 <> position('a' IN loaded_image
                                                         FROM 3)) IS NOT FALSE
                     AND position('a' IN loaded_image
                                  FROM 3)+1 BETWEEN position('a' IN loaded_image
                                                             FROM 3) AND position('a' IN loaded_image
                                                                                  FROM 3)+2
                     AND position('a' IN loaded_image
                                  FROM 3)+1 NOT BETWEEN position('a' IN loaded_image
                                                                 FROM 3)+1 AND position('a' IN loaded_image
                                                                                        FROM 3)
                     AND position('a' IN loaded_image
                                  FROM 3)+1 like '%'
                     AND position('a' IN loaded_image
                                  FROM 3)+1 not like '__DOES_NOT_EXIST__%'
                     AND position('a' IN loaded_image
                                  FROM 3)+1 IN (position('a' IN loaded_image
                                                         FROM 3),
                                                position('a' IN loaded_image
                                                         FROM 3)+1,
                                                position('a' IN loaded_image
                                                         FROM 3)+2)
                     AND position('a' IN loaded_image
                                  FROM 3)+1 NOT IN (position('a' IN loaded_image
                                                             FROM 3),
                                                    position('a' IN loaded_image
                                                             FROM 3)+2)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          position('a' IN loaded_image
                                   FROM 3)+1,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (position('a' IN loaded_image
                   FROM 3)+1 IS NULL
          OR (position('a' IN loaded_image
                       FROM 3)+1 = position('a' IN loaded_image
                                            FROM 3)+1
              AND position('a' IN loaded_image
                           FROM 3)+1 IS NOT DISTINCT
              FROM position('a' IN loaded_image
                            FROM 3)+1
              AND position('a' IN loaded_image
                           FROM 3)+1 <> position('a' IN loaded_image
                                                 FROM 3)
              AND (position('a' IN loaded_image
                            FROM 3)+1 IS DISTINCT
                   FROM position('a' IN loaded_image
                                 FROM 3))
              AND position('a' IN loaded_image
                           FROM 3)+1 > position('a' IN loaded_image
                                                FROM 3)
              AND position('a' IN loaded_image
                           FROM 3)+1 >= position('a' IN loaded_image
                                                 FROM 3)
              AND position('a' IN loaded_image
                           FROM 3)+1 < position('a' IN loaded_image
                                                FROM 3)+2
              AND position('a' IN loaded_image
                           FROM 3)+1 <= position('a' IN loaded_image
                                                 FROM 3)+2
              AND (position('a' IN loaded_image
                            FROM 3)+1 <> position('a' IN loaded_image
                                                  FROM 3)) IS TRUE
              AND (position('a' IN loaded_image
                            FROM 3)+1 = position('a' IN loaded_image
                                                 FROM 3)) IS NOT TRUE
              AND (position('a' IN loaded_image
                            FROM 3)+1 = position('a' IN loaded_image
                                                 FROM 3)) IS FALSE
              AND (position('a' IN loaded_image
                            FROM 3)+1 <> position('a' IN loaded_image
                                                  FROM 3)) IS NOT FALSE
              AND position('a' IN loaded_image
                           FROM 3)+1 BETWEEN position('a' IN loaded_image
                                                      FROM 3) AND position('a' IN loaded_image
                                                                           FROM 3)+2
              AND position('a' IN loaded_image
                           FROM 3)+1 NOT BETWEEN position('a' IN loaded_image
                                                          FROM 3)+1 AND position('a' IN loaded_image
                                                                                 FROM 3)
              AND position('a' IN loaded_image
                           FROM 3)+1 like '%'
              AND position('a' IN loaded_image
                           FROM 3)+1 not like '__DOES_NOT_EXIST__%'
              AND position('a' IN loaded_image
                           FROM 3)+1 IN (position('a' IN loaded_image
                                                  FROM 3),
                                         position('a' IN loaded_image
                                                  FROM 3)+1,
                                         position('a' IN loaded_image
                                                  FROM 3)+2)
              AND position('a' IN loaded_image
                           FROM 3)+1 NOT IN (position('a' IN loaded_image
                                                      FROM 3),
                                             position('a' IN loaded_image
                                                      FROM 3)+2)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A14: regexp_extract
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||regexp_extract(loaded_image, '.*') IS NULL
       OR ('1'||regexp_extract(loaded_image, '.*') = 1||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') IS NOT DISTINCT
           FROM 1||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')
           AND ('1'||regexp_extract(loaded_image, '.*') IS DISTINCT
                FROM '0'||regexp_extract(loaded_image, '.*'))
           AND '1'||regexp_extract(loaded_image, '.*') > '0'||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') >= '0'||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') < 2||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') <= 2||regexp_extract(loaded_image, '.*')
           AND ('1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')) IS TRUE
           AND ('1'||regexp_extract(loaded_image, '.*') = '0'||regexp_extract(loaded_image, '.*')) IS NOT TRUE
           AND ('1'||regexp_extract(loaded_image, '.*') = '0'||regexp_extract(loaded_image, '.*')) IS FALSE
           AND ('1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')) IS NOT FALSE
           AND '1'||regexp_extract(loaded_image, '.*') BETWEEN '0'||regexp_extract(loaded_image, '.*') AND 2||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') NOT BETWEEN '1'||regexp_extract(loaded_image, '.*') AND '0'||regexp_extract(loaded_image, '.*')
           AND '1'||regexp_extract(loaded_image, '.*') like '%'
           AND '1'||regexp_extract(loaded_image, '.*') not like '__DOES_NOT_EXIST__%'
           AND '1'||regexp_extract(loaded_image, '.*') IN ('0'||regexp_extract(loaded_image, '.*'),
                                                           1||regexp_extract(loaded_image, '.*'),
                                                           2||regexp_extract(loaded_image, '.*'))
           AND '1'||regexp_extract(loaded_image, '.*') NOT IN ('0'||regexp_extract(loaded_image, '.*'),
                                                               2||regexp_extract(loaded_image, '.*')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||regexp_extract(loaded_image, '.*') IS NULL
       OR '1'||regexp_extract(loaded_image, '.*') IN
         (SELECT '1'||regexp_extract(loaded_image, '.*')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||regexp_extract(loaded_image, '.*') IS NULL
                 OR ('1'||regexp_extract(loaded_image, '.*') = 1||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') IS NOT DISTINCT
                     FROM 1||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')
                     AND ('1'||regexp_extract(loaded_image, '.*') IS DISTINCT
                          FROM '0'||regexp_extract(loaded_image, '.*'))
                     AND '1'||regexp_extract(loaded_image, '.*') > '0'||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') >= '0'||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') < 2||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') <= 2||regexp_extract(loaded_image, '.*')
                     AND ('1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')) IS TRUE
                     AND ('1'||regexp_extract(loaded_image, '.*') = '0'||regexp_extract(loaded_image, '.*')) IS NOT TRUE
                     AND ('1'||regexp_extract(loaded_image, '.*') = '0'||regexp_extract(loaded_image, '.*')) IS FALSE
                     AND ('1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')) IS NOT FALSE
                     AND '1'||regexp_extract(loaded_image, '.*') BETWEEN '0'||regexp_extract(loaded_image, '.*') AND 2||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') NOT BETWEEN '1'||regexp_extract(loaded_image, '.*') AND '0'||regexp_extract(loaded_image, '.*')
                     AND '1'||regexp_extract(loaded_image, '.*') like '%'
                     AND '1'||regexp_extract(loaded_image, '.*') not like '__DOES_NOT_EXIST__%'
                     AND '1'||regexp_extract(loaded_image, '.*') IN ('0'||regexp_extract(loaded_image, '.*'),
                                                                     1||regexp_extract(loaded_image, '.*'),
                                                                     2||regexp_extract(loaded_image, '.*'))
                     AND '1'||regexp_extract(loaded_image, '.*') NOT IN ('0'||regexp_extract(loaded_image, '.*'),
                                                                         2||regexp_extract(loaded_image, '.*'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||regexp_extract(loaded_image, '.*'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||regexp_extract(loaded_image, '.*') IS NULL
          OR ('1'||regexp_extract(loaded_image, '.*') = 1||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') IS NOT DISTINCT
              FROM 1||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')
              AND ('1'||regexp_extract(loaded_image, '.*') IS DISTINCT
                   FROM '0'||regexp_extract(loaded_image, '.*'))
              AND '1'||regexp_extract(loaded_image, '.*') > '0'||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') >= '0'||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') < 2||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') <= 2||regexp_extract(loaded_image, '.*')
              AND ('1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')) IS TRUE
              AND ('1'||regexp_extract(loaded_image, '.*') = '0'||regexp_extract(loaded_image, '.*')) IS NOT TRUE
              AND ('1'||regexp_extract(loaded_image, '.*') = '0'||regexp_extract(loaded_image, '.*')) IS FALSE
              AND ('1'||regexp_extract(loaded_image, '.*') <> '0'||regexp_extract(loaded_image, '.*')) IS NOT FALSE
              AND '1'||regexp_extract(loaded_image, '.*') BETWEEN '0'||regexp_extract(loaded_image, '.*') AND 2||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') NOT BETWEEN '1'||regexp_extract(loaded_image, '.*') AND '0'||regexp_extract(loaded_image, '.*')
              AND '1'||regexp_extract(loaded_image, '.*') like '%'
              AND '1'||regexp_extract(loaded_image, '.*') not like '__DOES_NOT_EXIST__%'
              AND '1'||regexp_extract(loaded_image, '.*') IN ('0'||regexp_extract(loaded_image, '.*'),
                                                              1||regexp_extract(loaded_image, '.*'),
                                                              2||regexp_extract(loaded_image, '.*'))
              AND '1'||regexp_extract(loaded_image, '.*') NOT IN ('0'||regexp_extract(loaded_image, '.*'),
                                                                  2||regexp_extract(loaded_image, '.*'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A15: regexp_like
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (CASE
           WHEN regexp_like(loaded_image, '.*') THEN 1
           ELSE 101
       END IS NULL
       OR (CASE
               WHEN regexp_like(loaded_image, '.*') THEN 1
               ELSE 101
           END = CASE
                     WHEN regexp_like(loaded_image, '.*') THEN 1
                     ELSE 101
                 END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END IS NOT DISTINCT
           FROM CASE
                    WHEN regexp_like(loaded_image, '.*') THEN 1
                    ELSE 101
                END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END <> CASE
                          WHEN regexp_like(loaded_image, '.*') THEN 0
                          ELSE 100
                      END
           AND (CASE
                    WHEN regexp_like(loaded_image, '.*') THEN 1
                    ELSE 101
                END IS DISTINCT
                FROM CASE
                         WHEN regexp_like(loaded_image, '.*') THEN 0
                         ELSE 100
                     END)
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END > CASE
                         WHEN regexp_like(loaded_image, '.*') THEN 0
                         ELSE 100
                     END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END >= CASE
                          WHEN regexp_like(loaded_image, '.*') THEN 0
                          ELSE 100
                      END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END < CASE
                         WHEN regexp_like(loaded_image, '.*') THEN 2
                         ELSE 102
                     END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END <= CASE
                          WHEN regexp_like(loaded_image, '.*') THEN 2
                          ELSE 102
                      END
           AND (CASE
                    WHEN regexp_like(loaded_image, '.*') THEN 1
                    ELSE 101
                END <> CASE
                           WHEN regexp_like(loaded_image, '.*') THEN 0
                           ELSE 100
                       END) IS TRUE
           AND (CASE
                    WHEN regexp_like(loaded_image, '.*') THEN 1
                    ELSE 101
                END = CASE
                          WHEN regexp_like(loaded_image, '.*') THEN 0
                          ELSE 100
                      END) IS NOT TRUE
           AND (CASE
                    WHEN regexp_like(loaded_image, '.*') THEN 1
                    ELSE 101
                END = CASE
                          WHEN regexp_like(loaded_image, '.*') THEN 0
                          ELSE 100
                      END) IS FALSE
           AND (CASE
                    WHEN regexp_like(loaded_image, '.*') THEN 1
                    ELSE 101
                END <> CASE
                           WHEN regexp_like(loaded_image, '.*') THEN 0
                           ELSE 100
                       END) IS NOT FALSE
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END BETWEEN CASE
                               WHEN regexp_like(loaded_image, '.*') THEN 0
                               ELSE 100
                           END AND CASE
                                       WHEN regexp_like(loaded_image, '.*') THEN 2
                                       ELSE 102
                                   END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END NOT BETWEEN CASE
                                   WHEN regexp_like(loaded_image, '.*') THEN 1
                                   ELSE 101
                               END AND CASE
                                           WHEN regexp_like(loaded_image, '.*') THEN 0
                                           ELSE 100
                                       END
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END like '%'
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END not like '__DOES_NOT_EXIST__%'
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END IN (CASE
                           WHEN regexp_like(loaded_image, '.*') THEN 0
                           ELSE 100
                       END,
                       CASE
                           WHEN regexp_like(loaded_image, '.*') THEN 1
                           ELSE 101
                       END,
                       CASE
                           WHEN regexp_like(loaded_image, '.*') THEN 2
                           ELSE 102
                       END)
           AND CASE
                   WHEN regexp_like(loaded_image, '.*') THEN 1
                   ELSE 101
               END NOT IN (CASE
                               WHEN regexp_like(loaded_image, '.*') THEN 0
                               ELSE 100
                           END,
                           CASE
                               WHEN regexp_like(loaded_image, '.*') THEN 2
                               ELSE 102
                           END))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (CASE
           WHEN regexp_like(loaded_image, '.*') THEN 1
           ELSE 101
       END IS NULL
       OR CASE
              WHEN regexp_like(loaded_image, '.*') THEN 1
              ELSE 101
          END IN
         (SELECT CASE
                     WHEN regexp_like(loaded_image, '.*') THEN 1
                     ELSE 101
                 END
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (CASE
                     WHEN regexp_like(loaded_image, '.*') THEN 1
                     ELSE 101
                 END IS NULL
                 OR (CASE
                         WHEN regexp_like(loaded_image, '.*') THEN 1
                         ELSE 101
                     END = CASE
                               WHEN regexp_like(loaded_image, '.*') THEN 1
                               ELSE 101
                           END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END IS NOT DISTINCT
                     FROM CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END <> CASE
                                    WHEN regexp_like(loaded_image, '.*') THEN 0
                                    ELSE 100
                                END
                     AND (CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END IS DISTINCT
                          FROM CASE
                                   WHEN regexp_like(loaded_image, '.*') THEN 0
                                   ELSE 100
                               END)
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END > CASE
                                   WHEN regexp_like(loaded_image, '.*') THEN 0
                                   ELSE 100
                               END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END >= CASE
                                    WHEN regexp_like(loaded_image, '.*') THEN 0
                                    ELSE 100
                                END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END < CASE
                                   WHEN regexp_like(loaded_image, '.*') THEN 2
                                   ELSE 102
                               END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END <= CASE
                                    WHEN regexp_like(loaded_image, '.*') THEN 2
                                    ELSE 102
                                END
                     AND (CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END <> CASE
                                     WHEN regexp_like(loaded_image, '.*') THEN 0
                                     ELSE 100
                                 END) IS TRUE
                     AND (CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END = CASE
                                    WHEN regexp_like(loaded_image, '.*') THEN 0
                                    ELSE 100
                                END) IS NOT TRUE
                     AND (CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END = CASE
                                    WHEN regexp_like(loaded_image, '.*') THEN 0
                                    ELSE 100
                                END) IS FALSE
                     AND (CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END <> CASE
                                     WHEN regexp_like(loaded_image, '.*') THEN 0
                                     ELSE 100
                                 END) IS NOT FALSE
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END BETWEEN CASE
                                         WHEN regexp_like(loaded_image, '.*') THEN 0
                                         ELSE 100
                                     END AND CASE
                                                 WHEN regexp_like(loaded_image, '.*') THEN 2
                                                 ELSE 102
                                             END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END NOT BETWEEN CASE
                                             WHEN regexp_like(loaded_image, '.*') THEN 1
                                             ELSE 101
                                         END AND CASE
                                                     WHEN regexp_like(loaded_image, '.*') THEN 0
                                                     ELSE 100
                                                 END
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END like '%'
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END not like '__DOES_NOT_EXIST__%'
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END IN (CASE
                                     WHEN regexp_like(loaded_image, '.*') THEN 0
                                     ELSE 100
                                 END,
                                 CASE
                                     WHEN regexp_like(loaded_image, '.*') THEN 1
                                     ELSE 101
                                 END,
                                 CASE
                                     WHEN regexp_like(loaded_image, '.*') THEN 2
                                     ELSE 102
                                 END)
                     AND CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 1
                             ELSE 101
                         END NOT IN (CASE
                                         WHEN regexp_like(loaded_image, '.*') THEN 0
                                         ELSE 100
                                     END,
                                     CASE
                                         WHEN regexp_like(loaded_image, '.*') THEN 2
                                         ELSE 102
                                     END)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (CASE
              WHEN regexp_like(loaded_image, '.*') THEN 1
              ELSE 101
          END IS NULL
          OR (CASE
                  WHEN regexp_like(loaded_image, '.*') THEN 1
                  ELSE 101
              END = CASE
                        WHEN regexp_like(loaded_image, '.*') THEN 1
                        ELSE 101
                    END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END IS NOT DISTINCT
              FROM CASE
                       WHEN regexp_like(loaded_image, '.*') THEN 1
                       ELSE 101
                   END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END <> CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 0
                             ELSE 100
                         END
              AND (CASE
                       WHEN regexp_like(loaded_image, '.*') THEN 1
                       ELSE 101
                   END IS DISTINCT
                   FROM CASE
                            WHEN regexp_like(loaded_image, '.*') THEN 0
                            ELSE 100
                        END)
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END > CASE
                            WHEN regexp_like(loaded_image, '.*') THEN 0
                            ELSE 100
                        END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END >= CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 0
                             ELSE 100
                         END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END < CASE
                            WHEN regexp_like(loaded_image, '.*') THEN 2
                            ELSE 102
                        END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END <= CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 2
                             ELSE 102
                         END
              AND (CASE
                       WHEN regexp_like(loaded_image, '.*') THEN 1
                       ELSE 101
                   END <> CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 0
                              ELSE 100
                          END) IS TRUE
              AND (CASE
                       WHEN regexp_like(loaded_image, '.*') THEN 1
                       ELSE 101
                   END = CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 0
                             ELSE 100
                         END) IS NOT TRUE
              AND (CASE
                       WHEN regexp_like(loaded_image, '.*') THEN 1
                       ELSE 101
                   END = CASE
                             WHEN regexp_like(loaded_image, '.*') THEN 0
                             ELSE 100
                         END) IS FALSE
              AND (CASE
                       WHEN regexp_like(loaded_image, '.*') THEN 1
                       ELSE 101
                   END <> CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 0
                              ELSE 100
                          END) IS NOT FALSE
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END BETWEEN CASE
                                  WHEN regexp_like(loaded_image, '.*') THEN 0
                                  ELSE 100
                              END AND CASE
                                          WHEN regexp_like(loaded_image, '.*') THEN 2
                                          ELSE 102
                                      END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END NOT BETWEEN CASE
                                      WHEN regexp_like(loaded_image, '.*') THEN 1
                                      ELSE 101
                                  END AND CASE
                                              WHEN regexp_like(loaded_image, '.*') THEN 0
                                              ELSE 100
                                          END
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END like '%'
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END not like '__DOES_NOT_EXIST__%'
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END IN (CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 0
                              ELSE 100
                          END,
                          CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 1
                              ELSE 101
                          END,
                          CASE
                              WHEN regexp_like(loaded_image, '.*') THEN 2
                              ELSE 102
                          END)
              AND CASE
                      WHEN regexp_like(loaded_image, '.*') THEN 1
                      ELSE 101
                  END NOT IN (CASE
                                  WHEN regexp_like(loaded_image, '.*') THEN 0
                                  ELSE 100
                              END,
                              CASE
                                  WHEN regexp_like(loaded_image, '.*') THEN 2
                                  ELSE 102
                              END)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A16: regexp_replace
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (regexp_replace(loaded_image, '.', '1') IS NULL
       OR (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '1')
           AND regexp_replace(loaded_image, '.', '1') IS NOT DISTINCT
           FROM regexp_replace(loaded_image, '.', '1')
           AND regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')
           AND (regexp_replace(loaded_image, '.', '1') IS DISTINCT
                FROM regexp_replace(loaded_image, '.', '0'))
           AND regexp_replace(loaded_image, '.', '1') > regexp_replace(loaded_image, '.', '0')
           AND regexp_replace(loaded_image, '.', '1') >= regexp_replace(loaded_image, '.', '0')
           AND regexp_replace(loaded_image, '.', '1') < regexp_replace(loaded_image, '.', '2')
           AND regexp_replace(loaded_image, '.', '1') <= regexp_replace(loaded_image, '.', '2')
           AND (regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')) IS TRUE
           AND (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '0')) IS NOT TRUE
           AND (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '0')) IS FALSE
           AND (regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')) IS NOT FALSE
           AND regexp_replace(loaded_image, '.', '1') BETWEEN regexp_replace(loaded_image, '.', '0') AND regexp_replace(loaded_image, '.', '2')
           AND regexp_replace(loaded_image, '.', '1') NOT BETWEEN regexp_replace(loaded_image, '.', '1') AND regexp_replace(loaded_image, '.', '0')
           AND regexp_replace(loaded_image, '.', '1') like '%'
           AND regexp_replace(loaded_image, '.', '1') not like '__DOES_NOT_EXIST__%'
           AND regexp_replace(loaded_image, '.', '1') IN (regexp_replace(loaded_image, '.', '0'),
                                                          regexp_replace(loaded_image, '.', '1'),
                                                          regexp_replace(loaded_image, '.', '2'))
           AND regexp_replace(loaded_image, '.', '1') NOT IN (regexp_replace(loaded_image, '.', '0'),
                                                              regexp_replace(loaded_image, '.', '2')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (regexp_replace(loaded_image, '.', '1') IS NULL
       OR regexp_replace(loaded_image, '.', '1') IN
         (SELECT regexp_replace(loaded_image, '.', '1')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (regexp_replace(loaded_image, '.', '1') IS NULL
                 OR (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '1')
                     AND regexp_replace(loaded_image, '.', '1') IS NOT DISTINCT
                     FROM regexp_replace(loaded_image, '.', '1')
                     AND regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')
                     AND (regexp_replace(loaded_image, '.', '1') IS DISTINCT
                          FROM regexp_replace(loaded_image, '.', '0'))
                     AND regexp_replace(loaded_image, '.', '1') > regexp_replace(loaded_image, '.', '0')
                     AND regexp_replace(loaded_image, '.', '1') >= regexp_replace(loaded_image, '.', '0')
                     AND regexp_replace(loaded_image, '.', '1') < regexp_replace(loaded_image, '.', '2')
                     AND regexp_replace(loaded_image, '.', '1') <= regexp_replace(loaded_image, '.', '2')
                     AND (regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')) IS TRUE
                     AND (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '0')) IS NOT TRUE
                     AND (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '0')) IS FALSE
                     AND (regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')) IS NOT FALSE
                     AND regexp_replace(loaded_image, '.', '1') BETWEEN regexp_replace(loaded_image, '.', '0') AND regexp_replace(loaded_image, '.', '2')
                     AND regexp_replace(loaded_image, '.', '1') NOT BETWEEN regexp_replace(loaded_image, '.', '1') AND regexp_replace(loaded_image, '.', '0')
                     AND regexp_replace(loaded_image, '.', '1') like '%'
                     AND regexp_replace(loaded_image, '.', '1') not like '__DOES_NOT_EXIST__%'
                     AND regexp_replace(loaded_image, '.', '1') IN (regexp_replace(loaded_image, '.', '0'),
                                                                    regexp_replace(loaded_image, '.', '1'),
                                                                    regexp_replace(loaded_image, '.', '2'))
                     AND regexp_replace(loaded_image, '.', '1') NOT IN (regexp_replace(loaded_image, '.', '0'),
                                                                        regexp_replace(loaded_image, '.', '2'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          regexp_replace(loaded_image, '.', '1'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (regexp_replace(loaded_image, '.', '1') IS NULL
          OR (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '1')
              AND regexp_replace(loaded_image, '.', '1') IS NOT DISTINCT
              FROM regexp_replace(loaded_image, '.', '1')
              AND regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')
              AND (regexp_replace(loaded_image, '.', '1') IS DISTINCT
                   FROM regexp_replace(loaded_image, '.', '0'))
              AND regexp_replace(loaded_image, '.', '1') > regexp_replace(loaded_image, '.', '0')
              AND regexp_replace(loaded_image, '.', '1') >= regexp_replace(loaded_image, '.', '0')
              AND regexp_replace(loaded_image, '.', '1') < regexp_replace(loaded_image, '.', '2')
              AND regexp_replace(loaded_image, '.', '1') <= regexp_replace(loaded_image, '.', '2')
              AND (regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')) IS TRUE
              AND (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '0')) IS NOT TRUE
              AND (regexp_replace(loaded_image, '.', '1') = regexp_replace(loaded_image, '.', '0')) IS FALSE
              AND (regexp_replace(loaded_image, '.', '1') <> regexp_replace(loaded_image, '.', '0')) IS NOT FALSE
              AND regexp_replace(loaded_image, '.', '1') BETWEEN regexp_replace(loaded_image, '.', '0') AND regexp_replace(loaded_image, '.', '2')
              AND regexp_replace(loaded_image, '.', '1') NOT BETWEEN regexp_replace(loaded_image, '.', '1') AND regexp_replace(loaded_image, '.', '0')
              AND regexp_replace(loaded_image, '.', '1') like '%'
              AND regexp_replace(loaded_image, '.', '1') not like '__DOES_NOT_EXIST__%'
              AND regexp_replace(loaded_image, '.', '1') IN (regexp_replace(loaded_image, '.', '0'),
                                                             regexp_replace(loaded_image, '.', '1'),
                                                             regexp_replace(loaded_image, '.', '2'))
              AND regexp_replace(loaded_image, '.', '1') NOT IN (regexp_replace(loaded_image, '.', '0'),
                                                                 regexp_replace(loaded_image, '.', '2'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A17: contains_string
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||contains_string(loaded_image, 'a') IS NULL
       OR ('1'||contains_string(loaded_image, 'a') = 1||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') IS NOT DISTINCT
           FROM 1||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')
           AND ('1'||contains_string(loaded_image, 'a') IS DISTINCT
                FROM '0'||contains_string(loaded_image, 'a'))
           AND '1'||contains_string(loaded_image, 'a') > '0'||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') >= '0'||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') < 2||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') <= 2||contains_string(loaded_image, 'a')
           AND ('1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')) IS TRUE
           AND ('1'||contains_string(loaded_image, 'a') = '0'||contains_string(loaded_image, 'a')) IS NOT TRUE
           AND ('1'||contains_string(loaded_image, 'a') = '0'||contains_string(loaded_image, 'a')) IS FALSE
           AND ('1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')) IS NOT FALSE
           AND '1'||contains_string(loaded_image, 'a') BETWEEN '0'||contains_string(loaded_image, 'a') AND 2||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') NOT BETWEEN '1'||contains_string(loaded_image, 'a') AND '0'||contains_string(loaded_image, 'a')
           AND '1'||contains_string(loaded_image, 'a') like '%'
           AND '1'||contains_string(loaded_image, 'a') not like '__DOES_NOT_EXIST__%'
           AND '1'||contains_string(loaded_image, 'a') IN ('0'||contains_string(loaded_image, 'a'),
                                                           1||contains_string(loaded_image, 'a'),
                                                           2||contains_string(loaded_image, 'a'))
           AND '1'||contains_string(loaded_image, 'a') NOT IN ('0'||contains_string(loaded_image, 'a'),
                                                               2||contains_string(loaded_image, 'a')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||contains_string(loaded_image, 'a') IS NULL
       OR '1'||contains_string(loaded_image, 'a') IN
         (SELECT '1'||contains_string(loaded_image, 'a')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||contains_string(loaded_image, 'a') IS NULL
                 OR ('1'||contains_string(loaded_image, 'a') = 1||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') IS NOT DISTINCT
                     FROM 1||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')
                     AND ('1'||contains_string(loaded_image, 'a') IS DISTINCT
                          FROM '0'||contains_string(loaded_image, 'a'))
                     AND '1'||contains_string(loaded_image, 'a') > '0'||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') >= '0'||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') < 2||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') <= 2||contains_string(loaded_image, 'a')
                     AND ('1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')) IS TRUE
                     AND ('1'||contains_string(loaded_image, 'a') = '0'||contains_string(loaded_image, 'a')) IS NOT TRUE
                     AND ('1'||contains_string(loaded_image, 'a') = '0'||contains_string(loaded_image, 'a')) IS FALSE
                     AND ('1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')) IS NOT FALSE
                     AND '1'||contains_string(loaded_image, 'a') BETWEEN '0'||contains_string(loaded_image, 'a') AND 2||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') NOT BETWEEN '1'||contains_string(loaded_image, 'a') AND '0'||contains_string(loaded_image, 'a')
                     AND '1'||contains_string(loaded_image, 'a') like '%'
                     AND '1'||contains_string(loaded_image, 'a') not like '__DOES_NOT_EXIST__%'
                     AND '1'||contains_string(loaded_image, 'a') IN ('0'||contains_string(loaded_image, 'a'),
                                                                     1||contains_string(loaded_image, 'a'),
                                                                     2||contains_string(loaded_image, 'a'))
                     AND '1'||contains_string(loaded_image, 'a') NOT IN ('0'||contains_string(loaded_image, 'a'),
                                                                         2||contains_string(loaded_image, 'a'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||contains_string(loaded_image, 'a'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||contains_string(loaded_image, 'a') IS NULL
          OR ('1'||contains_string(loaded_image, 'a') = 1||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') IS NOT DISTINCT
              FROM 1||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')
              AND ('1'||contains_string(loaded_image, 'a') IS DISTINCT
                   FROM '0'||contains_string(loaded_image, 'a'))
              AND '1'||contains_string(loaded_image, 'a') > '0'||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') >= '0'||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') < 2||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') <= 2||contains_string(loaded_image, 'a')
              AND ('1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')) IS TRUE
              AND ('1'||contains_string(loaded_image, 'a') = '0'||contains_string(loaded_image, 'a')) IS NOT TRUE
              AND ('1'||contains_string(loaded_image, 'a') = '0'||contains_string(loaded_image, 'a')) IS FALSE
              AND ('1'||contains_string(loaded_image, 'a') <> '0'||contains_string(loaded_image, 'a')) IS NOT FALSE
              AND '1'||contains_string(loaded_image, 'a') BETWEEN '0'||contains_string(loaded_image, 'a') AND 2||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') NOT BETWEEN '1'||contains_string(loaded_image, 'a') AND '0'||contains_string(loaded_image, 'a')
              AND '1'||contains_string(loaded_image, 'a') like '%'
              AND '1'||contains_string(loaded_image, 'a') not like '__DOES_NOT_EXIST__%'
              AND '1'||contains_string(loaded_image, 'a') IN ('0'||contains_string(loaded_image, 'a'),
                                                              1||contains_string(loaded_image, 'a'),
                                                              2||contains_string(loaded_image, 'a'))
              AND '1'||contains_string(loaded_image, 'a') NOT IN ('0'||contains_string(loaded_image, 'a'),
                                                                  2||contains_string(loaded_image, 'a'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A18: icontains_string
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||icontains_string(loaded_image, 'a') IS NULL
       OR ('1'||icontains_string(loaded_image, 'a') = 1||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') IS NOT DISTINCT
           FROM 1||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')
           AND ('1'||icontains_string(loaded_image, 'a') IS DISTINCT
                FROM '0'||icontains_string(loaded_image, 'a'))
           AND '1'||icontains_string(loaded_image, 'a') > '0'||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') >= '0'||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') < 2||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') <= 2||icontains_string(loaded_image, 'a')
           AND ('1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')) IS TRUE
           AND ('1'||icontains_string(loaded_image, 'a') = '0'||icontains_string(loaded_image, 'a')) IS NOT TRUE
           AND ('1'||icontains_string(loaded_image, 'a') = '0'||icontains_string(loaded_image, 'a')) IS FALSE
           AND ('1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')) IS NOT FALSE
           AND '1'||icontains_string(loaded_image, 'a') BETWEEN '0'||icontains_string(loaded_image, 'a') AND 2||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') NOT BETWEEN '1'||icontains_string(loaded_image, 'a') AND '0'||icontains_string(loaded_image, 'a')
           AND '1'||icontains_string(loaded_image, 'a') like '%'
           AND '1'||icontains_string(loaded_image, 'a') not like '__DOES_NOT_EXIST__%'
           AND '1'||icontains_string(loaded_image, 'a') IN ('0'||icontains_string(loaded_image, 'a'),
                                                            1||icontains_string(loaded_image, 'a'),
                                                            2||icontains_string(loaded_image, 'a'))
           AND '1'||icontains_string(loaded_image, 'a') NOT IN ('0'||icontains_string(loaded_image, 'a'),
                                                                2||icontains_string(loaded_image, 'a')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||icontains_string(loaded_image, 'a') IS NULL
       OR '1'||icontains_string(loaded_image, 'a') IN
         (SELECT '1'||icontains_string(loaded_image, 'a')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||icontains_string(loaded_image, 'a') IS NULL
                 OR ('1'||icontains_string(loaded_image, 'a') = 1||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') IS NOT DISTINCT
                     FROM 1||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')
                     AND ('1'||icontains_string(loaded_image, 'a') IS DISTINCT
                          FROM '0'||icontains_string(loaded_image, 'a'))
                     AND '1'||icontains_string(loaded_image, 'a') > '0'||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') >= '0'||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') < 2||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') <= 2||icontains_string(loaded_image, 'a')
                     AND ('1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')) IS TRUE
                     AND ('1'||icontains_string(loaded_image, 'a') = '0'||icontains_string(loaded_image, 'a')) IS NOT TRUE
                     AND ('1'||icontains_string(loaded_image, 'a') = '0'||icontains_string(loaded_image, 'a')) IS FALSE
                     AND ('1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')) IS NOT FALSE
                     AND '1'||icontains_string(loaded_image, 'a') BETWEEN '0'||icontains_string(loaded_image, 'a') AND 2||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') NOT BETWEEN '1'||icontains_string(loaded_image, 'a') AND '0'||icontains_string(loaded_image, 'a')
                     AND '1'||icontains_string(loaded_image, 'a') like '%'
                     AND '1'||icontains_string(loaded_image, 'a') not like '__DOES_NOT_EXIST__%'
                     AND '1'||icontains_string(loaded_image, 'a') IN ('0'||icontains_string(loaded_image, 'a'),
                                                                      1||icontains_string(loaded_image, 'a'),
                                                                      2||icontains_string(loaded_image, 'a'))
                     AND '1'||icontains_string(loaded_image, 'a') NOT IN ('0'||icontains_string(loaded_image, 'a'),
                                                                          2||icontains_string(loaded_image, 'a'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||icontains_string(loaded_image, 'a'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||icontains_string(loaded_image, 'a') IS NULL
          OR ('1'||icontains_string(loaded_image, 'a') = 1||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') IS NOT DISTINCT
              FROM 1||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')
              AND ('1'||icontains_string(loaded_image, 'a') IS DISTINCT
                   FROM '0'||icontains_string(loaded_image, 'a'))
              AND '1'||icontains_string(loaded_image, 'a') > '0'||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') >= '0'||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') < 2||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') <= 2||icontains_string(loaded_image, 'a')
              AND ('1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')) IS TRUE
              AND ('1'||icontains_string(loaded_image, 'a') = '0'||icontains_string(loaded_image, 'a')) IS NOT TRUE
              AND ('1'||icontains_string(loaded_image, 'a') = '0'||icontains_string(loaded_image, 'a')) IS FALSE
              AND ('1'||icontains_string(loaded_image, 'a') <> '0'||icontains_string(loaded_image, 'a')) IS NOT FALSE
              AND '1'||icontains_string(loaded_image, 'a') BETWEEN '0'||icontains_string(loaded_image, 'a') AND 2||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') NOT BETWEEN '1'||icontains_string(loaded_image, 'a') AND '0'||icontains_string(loaded_image, 'a')
              AND '1'||icontains_string(loaded_image, 'a') like '%'
              AND '1'||icontains_string(loaded_image, 'a') not like '__DOES_NOT_EXIST__%'
              AND '1'||icontains_string(loaded_image, 'a') IN ('0'||icontains_string(loaded_image, 'a'),
                                                               1||icontains_string(loaded_image, 'a'),
                                                               2||icontains_string(loaded_image, 'a'))
              AND '1'||icontains_string(loaded_image, 'a') NOT IN ('0'||icontains_string(loaded_image, 'a'),
                                                                   2||icontains_string(loaded_image, 'a'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A19: replace
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||replace(loaded_image, 'a', 'z') IS NULL
       OR ('1'||replace(loaded_image, 'a', 'z') = 1||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') IS NOT DISTINCT
           FROM 1||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')
           AND ('1'||replace(loaded_image, 'a', 'z') IS DISTINCT
                FROM '0'||replace(loaded_image, 'a', 'z'))
           AND '1'||replace(loaded_image, 'a', 'z') > '0'||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') >= '0'||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') < 2||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') <= 2||replace(loaded_image, 'a', 'z')
           AND ('1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')) IS TRUE
           AND ('1'||replace(loaded_image, 'a', 'z') = '0'||replace(loaded_image, 'a', 'z')) IS NOT TRUE
           AND ('1'||replace(loaded_image, 'a', 'z') = '0'||replace(loaded_image, 'a', 'z')) IS FALSE
           AND ('1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')) IS NOT FALSE
           AND '1'||replace(loaded_image, 'a', 'z') BETWEEN '0'||replace(loaded_image, 'a', 'z') AND 2||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') NOT BETWEEN '1'||replace(loaded_image, 'a', 'z') AND '0'||replace(loaded_image, 'a', 'z')
           AND '1'||replace(loaded_image, 'a', 'z') like '%'
           AND '1'||replace(loaded_image, 'a', 'z') not like '__DOES_NOT_EXIST__%'
           AND '1'||replace(loaded_image, 'a', 'z') IN ('0'||replace(loaded_image, 'a', 'z'),
                                                        1||replace(loaded_image, 'a', 'z'),
                                                        2||replace(loaded_image, 'a', 'z'))
           AND '1'||replace(loaded_image, 'a', 'z') NOT IN ('0'||replace(loaded_image, 'a', 'z'),
                                                            2||replace(loaded_image, 'a', 'z')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||replace(loaded_image, 'a', 'z') IS NULL
       OR '1'||replace(loaded_image, 'a', 'z') IN
         (SELECT '1'||replace(loaded_image, 'a', 'z')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||replace(loaded_image, 'a', 'z') IS NULL
                 OR ('1'||replace(loaded_image, 'a', 'z') = 1||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') IS NOT DISTINCT
                     FROM 1||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')
                     AND ('1'||replace(loaded_image, 'a', 'z') IS DISTINCT
                          FROM '0'||replace(loaded_image, 'a', 'z'))
                     AND '1'||replace(loaded_image, 'a', 'z') > '0'||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') >= '0'||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') < 2||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') <= 2||replace(loaded_image, 'a', 'z')
                     AND ('1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')) IS TRUE
                     AND ('1'||replace(loaded_image, 'a', 'z') = '0'||replace(loaded_image, 'a', 'z')) IS NOT TRUE
                     AND ('1'||replace(loaded_image, 'a', 'z') = '0'||replace(loaded_image, 'a', 'z')) IS FALSE
                     AND ('1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')) IS NOT FALSE
                     AND '1'||replace(loaded_image, 'a', 'z') BETWEEN '0'||replace(loaded_image, 'a', 'z') AND 2||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') NOT BETWEEN '1'||replace(loaded_image, 'a', 'z') AND '0'||replace(loaded_image, 'a', 'z')
                     AND '1'||replace(loaded_image, 'a', 'z') like '%'
                     AND '1'||replace(loaded_image, 'a', 'z') not like '__DOES_NOT_EXIST__%'
                     AND '1'||replace(loaded_image, 'a', 'z') IN ('0'||replace(loaded_image, 'a', 'z'),
                                                                  1||replace(loaded_image, 'a', 'z'),
                                                                  2||replace(loaded_image, 'a', 'z'))
                     AND '1'||replace(loaded_image, 'a', 'z') NOT IN ('0'||replace(loaded_image, 'a', 'z'),
                                                                      2||replace(loaded_image, 'a', 'z'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||replace(loaded_image, 'a', 'z'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||replace(loaded_image, 'a', 'z') IS NULL
          OR ('1'||replace(loaded_image, 'a', 'z') = 1||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') IS NOT DISTINCT
              FROM 1||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')
              AND ('1'||replace(loaded_image, 'a', 'z') IS DISTINCT
                   FROM '0'||replace(loaded_image, 'a', 'z'))
              AND '1'||replace(loaded_image, 'a', 'z') > '0'||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') >= '0'||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') < 2||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') <= 2||replace(loaded_image, 'a', 'z')
              AND ('1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')) IS TRUE
              AND ('1'||replace(loaded_image, 'a', 'z') = '0'||replace(loaded_image, 'a', 'z')) IS NOT TRUE
              AND ('1'||replace(loaded_image, 'a', 'z') = '0'||replace(loaded_image, 'a', 'z')) IS FALSE
              AND ('1'||replace(loaded_image, 'a', 'z') <> '0'||replace(loaded_image, 'a', 'z')) IS NOT FALSE
              AND '1'||replace(loaded_image, 'a', 'z') BETWEEN '0'||replace(loaded_image, 'a', 'z') AND 2||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') NOT BETWEEN '1'||replace(loaded_image, 'a', 'z') AND '0'||replace(loaded_image, 'a', 'z')
              AND '1'||replace(loaded_image, 'a', 'z') like '%'
              AND '1'||replace(loaded_image, 'a', 'z') not like '__DOES_NOT_EXIST__%'
              AND '1'||replace(loaded_image, 'a', 'z') IN ('0'||replace(loaded_image, 'a', 'z'),
                                                           1||replace(loaded_image, 'a', 'z'),
                                                           2||replace(loaded_image, 'a', 'z'))
              AND '1'||replace(loaded_image, 'a', 'z') NOT IN ('0'||replace(loaded_image, 'a', 'z'),
                                                               2||replace(loaded_image, 'a', 'z'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A20: strpos
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (strpos(loaded_image, 'a')+1 IS NULL
       OR (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')+1
           AND strpos(loaded_image, 'a')+1 IS NOT DISTINCT
           FROM strpos(loaded_image, 'a')+1
           AND strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')
           AND (strpos(loaded_image, 'a')+1 IS DISTINCT
                FROM strpos(loaded_image, 'a'))
           AND strpos(loaded_image, 'a')+1 > strpos(loaded_image, 'a')
           AND strpos(loaded_image, 'a')+1 >= strpos(loaded_image, 'a')
           AND strpos(loaded_image, 'a')+1 < strpos(loaded_image, 'a')+2
           AND strpos(loaded_image, 'a')+1 <= strpos(loaded_image, 'a')+2
           AND (strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')) IS TRUE
           AND (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')) IS NOT TRUE
           AND (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')) IS FALSE
           AND (strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')) IS NOT FALSE
           AND strpos(loaded_image, 'a')+1 BETWEEN strpos(loaded_image, 'a') AND strpos(loaded_image, 'a')+2
           AND strpos(loaded_image, 'a')+1 NOT BETWEEN strpos(loaded_image, 'a')+1 AND strpos(loaded_image, 'a')
           AND strpos(loaded_image, 'a')+1 like '%'
           AND strpos(loaded_image, 'a')+1 not like '__DOES_NOT_EXIST__%'
           AND strpos(loaded_image, 'a')+1 IN (strpos(loaded_image, 'a'),
                                               strpos(loaded_image, 'a')+1,
                                               strpos(loaded_image, 'a')+2)
           AND strpos(loaded_image, 'a')+1 NOT IN (strpos(loaded_image, 'a'),
                                                   strpos(loaded_image, 'a')+2))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND (strpos(loaded_image, 'a')+1 IS NULL
       OR strpos(loaded_image, 'a')+1 IN
         (SELECT strpos(loaded_image, 'a')+1
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND (strpos(loaded_image, 'a')+1 IS NULL
                 OR (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')+1
                     AND strpos(loaded_image, 'a')+1 IS NOT DISTINCT
                     FROM strpos(loaded_image, 'a')+1
                     AND strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')
                     AND (strpos(loaded_image, 'a')+1 IS DISTINCT
                          FROM strpos(loaded_image, 'a'))
                     AND strpos(loaded_image, 'a')+1 > strpos(loaded_image, 'a')
                     AND strpos(loaded_image, 'a')+1 >= strpos(loaded_image, 'a')
                     AND strpos(loaded_image, 'a')+1 < strpos(loaded_image, 'a')+2
                     AND strpos(loaded_image, 'a')+1 <= strpos(loaded_image, 'a')+2
                     AND (strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')) IS TRUE
                     AND (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')) IS NOT TRUE
                     AND (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')) IS FALSE
                     AND (strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')) IS NOT FALSE
                     AND strpos(loaded_image, 'a')+1 BETWEEN strpos(loaded_image, 'a') AND strpos(loaded_image, 'a')+2
                     AND strpos(loaded_image, 'a')+1 NOT BETWEEN strpos(loaded_image, 'a')+1 AND strpos(loaded_image, 'a')
                     AND strpos(loaded_image, 'a')+1 like '%'
                     AND strpos(loaded_image, 'a')+1 not like '__DOES_NOT_EXIST__%'
                     AND strpos(loaded_image, 'a')+1 IN (strpos(loaded_image, 'a'),
                                                         strpos(loaded_image, 'a')+1,
                                                         strpos(loaded_image, 'a')+2)
                     AND strpos(loaded_image, 'a')+1 NOT IN (strpos(loaded_image, 'a'),
                                                             strpos(loaded_image, 'a')+2)))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          strpos(loaded_image, 'a')+1,
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND (strpos(loaded_image, 'a')+1 IS NULL
          OR (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')+1
              AND strpos(loaded_image, 'a')+1 IS NOT DISTINCT
              FROM strpos(loaded_image, 'a')+1
              AND strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')
              AND (strpos(loaded_image, 'a')+1 IS DISTINCT
                   FROM strpos(loaded_image, 'a'))
              AND strpos(loaded_image, 'a')+1 > strpos(loaded_image, 'a')
              AND strpos(loaded_image, 'a')+1 >= strpos(loaded_image, 'a')
              AND strpos(loaded_image, 'a')+1 < strpos(loaded_image, 'a')+2
              AND strpos(loaded_image, 'a')+1 <= strpos(loaded_image, 'a')+2
              AND (strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')) IS TRUE
              AND (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')) IS NOT TRUE
              AND (strpos(loaded_image, 'a')+1 = strpos(loaded_image, 'a')) IS FALSE
              AND (strpos(loaded_image, 'a')+1 <> strpos(loaded_image, 'a')) IS NOT FALSE
              AND strpos(loaded_image, 'a')+1 BETWEEN strpos(loaded_image, 'a') AND strpos(loaded_image, 'a')+2
              AND strpos(loaded_image, 'a')+1 NOT BETWEEN strpos(loaded_image, 'a')+1 AND strpos(loaded_image, 'a')
              AND strpos(loaded_image, 'a')+1 like '%'
              AND strpos(loaded_image, 'a')+1 not like '__DOES_NOT_EXIST__%'
              AND strpos(loaded_image, 'a')+1 IN (strpos(loaded_image, 'a'),
                                                  strpos(loaded_image, 'a')+1,
                                                  strpos(loaded_image, 'a')+2)
              AND strpos(loaded_image, 'a')+1 NOT IN (strpos(loaded_image, 'a'),
                                                      strpos(loaded_image, 'a')+2)))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A21: substring
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS NULL
       OR ('1'||substring(loaded_image, 1, length(loaded_image)) = 1||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) IS NOT DISTINCT
           FROM 1||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))
           AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS DISTINCT
                FROM '0'||substring(loaded_image, 1, length(loaded_image)))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) > '0'||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) >= '0'||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) < 2||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) <= 2||substring(loaded_image, 1, length(loaded_image))
           AND ('1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))) IS TRUE
           AND ('1'||substring(loaded_image, 1, length(loaded_image)) = '0'||substring(loaded_image, 1, length(loaded_image))) IS NOT TRUE
           AND ('1'||substring(loaded_image, 1, length(loaded_image)) = '0'||substring(loaded_image, 1, length(loaded_image))) IS FALSE
           AND ('1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))) IS NOT FALSE
           AND '1'||substring(loaded_image, 1, length(loaded_image)) BETWEEN '0'||substring(loaded_image, 1, length(loaded_image)) AND 2||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) NOT BETWEEN '1'||substring(loaded_image, 1, length(loaded_image)) AND '0'||substring(loaded_image, 1, length(loaded_image))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) like '%'
           AND '1'||substring(loaded_image, 1, length(loaded_image)) not like '__DOES_NOT_EXIST__%'
           AND '1'||substring(loaded_image, 1, length(loaded_image)) IN ('0'||substring(loaded_image, 1, length(loaded_image)),
                                                                         1||substring(loaded_image, 1, length(loaded_image)),
                                                                         2||substring(loaded_image, 1, length(loaded_image)))
           AND '1'||substring(loaded_image, 1, length(loaded_image)) NOT IN ('0'||substring(loaded_image, 1, length(loaded_image)),
                                                                             2||substring(loaded_image, 1, length(loaded_image))))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS NULL
       OR '1'||substring(loaded_image, 1, length(loaded_image)) IN
         (SELECT '1'||substring(loaded_image, 1, length(loaded_image))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS NULL
                 OR ('1'||substring(loaded_image, 1, length(loaded_image)) = 1||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) IS NOT DISTINCT
                     FROM 1||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))
                     AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS DISTINCT
                          FROM '0'||substring(loaded_image, 1, length(loaded_image)))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) > '0'||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) >= '0'||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) < 2||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) <= 2||substring(loaded_image, 1, length(loaded_image))
                     AND ('1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))) IS TRUE
                     AND ('1'||substring(loaded_image, 1, length(loaded_image)) = '0'||substring(loaded_image, 1, length(loaded_image))) IS NOT TRUE
                     AND ('1'||substring(loaded_image, 1, length(loaded_image)) = '0'||substring(loaded_image, 1, length(loaded_image))) IS FALSE
                     AND ('1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))) IS NOT FALSE
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) BETWEEN '0'||substring(loaded_image, 1, length(loaded_image)) AND 2||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) NOT BETWEEN '1'||substring(loaded_image, 1, length(loaded_image)) AND '0'||substring(loaded_image, 1, length(loaded_image))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) like '%'
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) not like '__DOES_NOT_EXIST__%'
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) IN ('0'||substring(loaded_image, 1, length(loaded_image)),
                                                                                   1||substring(loaded_image, 1, length(loaded_image)),
                                                                                   2||substring(loaded_image, 1, length(loaded_image)))
                     AND '1'||substring(loaded_image, 1, length(loaded_image)) NOT IN ('0'||substring(loaded_image, 1, length(loaded_image)),
                                                                                       2||substring(loaded_image, 1, length(loaded_image)))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||substring(loaded_image, 1, length(loaded_image)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS NULL
          OR ('1'||substring(loaded_image, 1, length(loaded_image)) = 1||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) IS NOT DISTINCT
              FROM 1||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))
              AND ('1'||substring(loaded_image, 1, length(loaded_image)) IS DISTINCT
                   FROM '0'||substring(loaded_image, 1, length(loaded_image)))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) > '0'||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) >= '0'||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) < 2||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) <= 2||substring(loaded_image, 1, length(loaded_image))
              AND ('1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))) IS TRUE
              AND ('1'||substring(loaded_image, 1, length(loaded_image)) = '0'||substring(loaded_image, 1, length(loaded_image))) IS NOT TRUE
              AND ('1'||substring(loaded_image, 1, length(loaded_image)) = '0'||substring(loaded_image, 1, length(loaded_image))) IS FALSE
              AND ('1'||substring(loaded_image, 1, length(loaded_image)) <> '0'||substring(loaded_image, 1, length(loaded_image))) IS NOT FALSE
              AND '1'||substring(loaded_image, 1, length(loaded_image)) BETWEEN '0'||substring(loaded_image, 1, length(loaded_image)) AND 2||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) NOT BETWEEN '1'||substring(loaded_image, 1, length(loaded_image)) AND '0'||substring(loaded_image, 1, length(loaded_image))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) like '%'
              AND '1'||substring(loaded_image, 1, length(loaded_image)) not like '__DOES_NOT_EXIST__%'
              AND '1'||substring(loaded_image, 1, length(loaded_image)) IN ('0'||substring(loaded_image, 1, length(loaded_image)),
                                                                            1||substring(loaded_image, 1, length(loaded_image)),
                                                                            2||substring(loaded_image, 1, length(loaded_image)))
              AND '1'||substring(loaded_image, 1, length(loaded_image)) NOT IN ('0'||substring(loaded_image, 1, length(loaded_image)),
                                                                                2||substring(loaded_image, 1, length(loaded_image)))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A22: right
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||right(loaded_image, 2) IS NULL
       OR ('1'||right(loaded_image, 2) = 1||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) IS NOT DISTINCT
           FROM 1||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)
           AND ('1'||right(loaded_image, 2) IS DISTINCT
                FROM '0'||right(loaded_image, 2))
           AND '1'||right(loaded_image, 2) > '0'||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) >= '0'||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) < 2||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) <= 2||right(loaded_image, 2)
           AND ('1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)) IS TRUE
           AND ('1'||right(loaded_image, 2) = '0'||right(loaded_image, 2)) IS NOT TRUE
           AND ('1'||right(loaded_image, 2) = '0'||right(loaded_image, 2)) IS FALSE
           AND ('1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)) IS NOT FALSE
           AND '1'||right(loaded_image, 2) BETWEEN '0'||right(loaded_image, 2) AND 2||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) NOT BETWEEN '1'||right(loaded_image, 2) AND '0'||right(loaded_image, 2)
           AND '1'||right(loaded_image, 2) like '%'
           AND '1'||right(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
           AND '1'||right(loaded_image, 2) IN ('0'||right(loaded_image, 2),
                                               1||right(loaded_image, 2),
                                               2||right(loaded_image, 2))
           AND '1'||right(loaded_image, 2) NOT IN ('0'||right(loaded_image, 2),
                                                   2||right(loaded_image, 2)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||right(loaded_image, 2) IS NULL
       OR '1'||right(loaded_image, 2) IN
         (SELECT '1'||right(loaded_image, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||right(loaded_image, 2) IS NULL
                 OR ('1'||right(loaded_image, 2) = 1||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) IS NOT DISTINCT
                     FROM 1||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)
                     AND ('1'||right(loaded_image, 2) IS DISTINCT
                          FROM '0'||right(loaded_image, 2))
                     AND '1'||right(loaded_image, 2) > '0'||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) >= '0'||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) < 2||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) <= 2||right(loaded_image, 2)
                     AND ('1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)) IS TRUE
                     AND ('1'||right(loaded_image, 2) = '0'||right(loaded_image, 2)) IS NOT TRUE
                     AND ('1'||right(loaded_image, 2) = '0'||right(loaded_image, 2)) IS FALSE
                     AND ('1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)) IS NOT FALSE
                     AND '1'||right(loaded_image, 2) BETWEEN '0'||right(loaded_image, 2) AND 2||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) NOT BETWEEN '1'||right(loaded_image, 2) AND '0'||right(loaded_image, 2)
                     AND '1'||right(loaded_image, 2) like '%'
                     AND '1'||right(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
                     AND '1'||right(loaded_image, 2) IN ('0'||right(loaded_image, 2),
                                                         1||right(loaded_image, 2),
                                                         2||right(loaded_image, 2))
                     AND '1'||right(loaded_image, 2) NOT IN ('0'||right(loaded_image, 2),
                                                             2||right(loaded_image, 2))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||right(loaded_image, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||right(loaded_image, 2) IS NULL
          OR ('1'||right(loaded_image, 2) = 1||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) IS NOT DISTINCT
              FROM 1||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)
              AND ('1'||right(loaded_image, 2) IS DISTINCT
                   FROM '0'||right(loaded_image, 2))
              AND '1'||right(loaded_image, 2) > '0'||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) >= '0'||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) < 2||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) <= 2||right(loaded_image, 2)
              AND ('1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)) IS TRUE
              AND ('1'||right(loaded_image, 2) = '0'||right(loaded_image, 2)) IS NOT TRUE
              AND ('1'||right(loaded_image, 2) = '0'||right(loaded_image, 2)) IS FALSE
              AND ('1'||right(loaded_image, 2) <> '0'||right(loaded_image, 2)) IS NOT FALSE
              AND '1'||right(loaded_image, 2) BETWEEN '0'||right(loaded_image, 2) AND 2||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) NOT BETWEEN '1'||right(loaded_image, 2) AND '0'||right(loaded_image, 2)
              AND '1'||right(loaded_image, 2) like '%'
              AND '1'||right(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
              AND '1'||right(loaded_image, 2) IN ('0'||right(loaded_image, 2),
                                                  1||right(loaded_image, 2),
                                                  2||right(loaded_image, 2))
              AND '1'||right(loaded_image, 2) NOT IN ('0'||right(loaded_image, 2),
                                                      2||right(loaded_image, 2))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A23: left
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||left(loaded_image, 2) IS NULL
       OR ('1'||left(loaded_image, 2) = 1||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) IS NOT DISTINCT
           FROM 1||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)
           AND ('1'||left(loaded_image, 2) IS DISTINCT
                FROM '0'||left(loaded_image, 2))
           AND '1'||left(loaded_image, 2) > '0'||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) >= '0'||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) < 2||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) <= 2||left(loaded_image, 2)
           AND ('1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)) IS TRUE
           AND ('1'||left(loaded_image, 2) = '0'||left(loaded_image, 2)) IS NOT TRUE
           AND ('1'||left(loaded_image, 2) = '0'||left(loaded_image, 2)) IS FALSE
           AND ('1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)) IS NOT FALSE
           AND '1'||left(loaded_image, 2) BETWEEN '0'||left(loaded_image, 2) AND 2||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) NOT BETWEEN '1'||left(loaded_image, 2) AND '0'||left(loaded_image, 2)
           AND '1'||left(loaded_image, 2) like '%'
           AND '1'||left(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
           AND '1'||left(loaded_image, 2) IN ('0'||left(loaded_image, 2),
                                              1||left(loaded_image, 2),
                                              2||left(loaded_image, 2))
           AND '1'||left(loaded_image, 2) NOT IN ('0'||left(loaded_image, 2),
                                                  2||left(loaded_image, 2)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||left(loaded_image, 2) IS NULL
       OR '1'||left(loaded_image, 2) IN
         (SELECT '1'||left(loaded_image, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||left(loaded_image, 2) IS NULL
                 OR ('1'||left(loaded_image, 2) = 1||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) IS NOT DISTINCT
                     FROM 1||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)
                     AND ('1'||left(loaded_image, 2) IS DISTINCT
                          FROM '0'||left(loaded_image, 2))
                     AND '1'||left(loaded_image, 2) > '0'||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) >= '0'||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) < 2||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) <= 2||left(loaded_image, 2)
                     AND ('1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)) IS TRUE
                     AND ('1'||left(loaded_image, 2) = '0'||left(loaded_image, 2)) IS NOT TRUE
                     AND ('1'||left(loaded_image, 2) = '0'||left(loaded_image, 2)) IS FALSE
                     AND ('1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)) IS NOT FALSE
                     AND '1'||left(loaded_image, 2) BETWEEN '0'||left(loaded_image, 2) AND 2||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) NOT BETWEEN '1'||left(loaded_image, 2) AND '0'||left(loaded_image, 2)
                     AND '1'||left(loaded_image, 2) like '%'
                     AND '1'||left(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
                     AND '1'||left(loaded_image, 2) IN ('0'||left(loaded_image, 2),
                                                        1||left(loaded_image, 2),
                                                        2||left(loaded_image, 2))
                     AND '1'||left(loaded_image, 2) NOT IN ('0'||left(loaded_image, 2),
                                                            2||left(loaded_image, 2))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||left(loaded_image, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||left(loaded_image, 2) IS NULL
          OR ('1'||left(loaded_image, 2) = 1||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) IS NOT DISTINCT
              FROM 1||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)
              AND ('1'||left(loaded_image, 2) IS DISTINCT
                   FROM '0'||left(loaded_image, 2))
              AND '1'||left(loaded_image, 2) > '0'||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) >= '0'||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) < 2||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) <= 2||left(loaded_image, 2)
              AND ('1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)) IS TRUE
              AND ('1'||left(loaded_image, 2) = '0'||left(loaded_image, 2)) IS NOT TRUE
              AND ('1'||left(loaded_image, 2) = '0'||left(loaded_image, 2)) IS FALSE
              AND ('1'||left(loaded_image, 2) <> '0'||left(loaded_image, 2)) IS NOT FALSE
              AND '1'||left(loaded_image, 2) BETWEEN '0'||left(loaded_image, 2) AND 2||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) NOT BETWEEN '1'||left(loaded_image, 2) AND '0'||left(loaded_image, 2)
              AND '1'||left(loaded_image, 2) like '%'
              AND '1'||left(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
              AND '1'||left(loaded_image, 2) IN ('0'||left(loaded_image, 2),
                                                 1||left(loaded_image, 2),
                                                 2||left(loaded_image, 2))
              AND '1'||left(loaded_image, 2) NOT IN ('0'||left(loaded_image, 2),
                                                     2||left(loaded_image, 2))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A24: substr
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS NULL
       OR ('1'||substr(loaded_image, 1, length(loaded_image)) = 1||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) IS NOT DISTINCT
           FROM 1||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))
           AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS DISTINCT
                FROM '0'||substr(loaded_image, 1, length(loaded_image)))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) > '0'||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) >= '0'||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) < 2||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) <= 2||substr(loaded_image, 1, length(loaded_image))
           AND ('1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))) IS TRUE
           AND ('1'||substr(loaded_image, 1, length(loaded_image)) = '0'||substr(loaded_image, 1, length(loaded_image))) IS NOT TRUE
           AND ('1'||substr(loaded_image, 1, length(loaded_image)) = '0'||substr(loaded_image, 1, length(loaded_image))) IS FALSE
           AND ('1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))) IS NOT FALSE
           AND '1'||substr(loaded_image, 1, length(loaded_image)) BETWEEN '0'||substr(loaded_image, 1, length(loaded_image)) AND 2||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) NOT BETWEEN '1'||substr(loaded_image, 1, length(loaded_image)) AND '0'||substr(loaded_image, 1, length(loaded_image))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) like '%'
           AND '1'||substr(loaded_image, 1, length(loaded_image)) not like '__DOES_NOT_EXIST__%'
           AND '1'||substr(loaded_image, 1, length(loaded_image)) IN ('0'||substr(loaded_image, 1, length(loaded_image)),
                                                                      1||substr(loaded_image, 1, length(loaded_image)),
                                                                      2||substr(loaded_image, 1, length(loaded_image)))
           AND '1'||substr(loaded_image, 1, length(loaded_image)) NOT IN ('0'||substr(loaded_image, 1, length(loaded_image)),
                                                                          2||substr(loaded_image, 1, length(loaded_image))))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS NULL
       OR '1'||substr(loaded_image, 1, length(loaded_image)) IN
         (SELECT '1'||substr(loaded_image, 1, length(loaded_image))
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS NULL
                 OR ('1'||substr(loaded_image, 1, length(loaded_image)) = 1||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) IS NOT DISTINCT
                     FROM 1||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))
                     AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS DISTINCT
                          FROM '0'||substr(loaded_image, 1, length(loaded_image)))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) > '0'||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) >= '0'||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) < 2||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) <= 2||substr(loaded_image, 1, length(loaded_image))
                     AND ('1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))) IS TRUE
                     AND ('1'||substr(loaded_image, 1, length(loaded_image)) = '0'||substr(loaded_image, 1, length(loaded_image))) IS NOT TRUE
                     AND ('1'||substr(loaded_image, 1, length(loaded_image)) = '0'||substr(loaded_image, 1, length(loaded_image))) IS FALSE
                     AND ('1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))) IS NOT FALSE
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) BETWEEN '0'||substr(loaded_image, 1, length(loaded_image)) AND 2||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) NOT BETWEEN '1'||substr(loaded_image, 1, length(loaded_image)) AND '0'||substr(loaded_image, 1, length(loaded_image))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) like '%'
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) not like '__DOES_NOT_EXIST__%'
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) IN ('0'||substr(loaded_image, 1, length(loaded_image)),
                                                                                1||substr(loaded_image, 1, length(loaded_image)),
                                                                                2||substr(loaded_image, 1, length(loaded_image)))
                     AND '1'||substr(loaded_image, 1, length(loaded_image)) NOT IN ('0'||substr(loaded_image, 1, length(loaded_image)),
                                                                                    2||substr(loaded_image, 1, length(loaded_image)))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||substr(loaded_image, 1, length(loaded_image)),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS NULL
          OR ('1'||substr(loaded_image, 1, length(loaded_image)) = 1||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) IS NOT DISTINCT
              FROM 1||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))
              AND ('1'||substr(loaded_image, 1, length(loaded_image)) IS DISTINCT
                   FROM '0'||substr(loaded_image, 1, length(loaded_image)))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) > '0'||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) >= '0'||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) < 2||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) <= 2||substr(loaded_image, 1, length(loaded_image))
              AND ('1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))) IS TRUE
              AND ('1'||substr(loaded_image, 1, length(loaded_image)) = '0'||substr(loaded_image, 1, length(loaded_image))) IS NOT TRUE
              AND ('1'||substr(loaded_image, 1, length(loaded_image)) = '0'||substr(loaded_image, 1, length(loaded_image))) IS FALSE
              AND ('1'||substr(loaded_image, 1, length(loaded_image)) <> '0'||substr(loaded_image, 1, length(loaded_image))) IS NOT FALSE
              AND '1'||substr(loaded_image, 1, length(loaded_image)) BETWEEN '0'||substr(loaded_image, 1, length(loaded_image)) AND 2||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) NOT BETWEEN '1'||substr(loaded_image, 1, length(loaded_image)) AND '0'||substr(loaded_image, 1, length(loaded_image))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) like '%'
              AND '1'||substr(loaded_image, 1, length(loaded_image)) not like '__DOES_NOT_EXIST__%'
              AND '1'||substr(loaded_image, 1, length(loaded_image)) IN ('0'||substr(loaded_image, 1, length(loaded_image)),
                                                                         1||substr(loaded_image, 1, length(loaded_image)),
                                                                         2||substr(loaded_image, 1, length(loaded_image)))
              AND '1'||substr(loaded_image, 1, length(loaded_image)) NOT IN ('0'||substr(loaded_image, 1, length(loaded_image)),
                                                                             2||substr(loaded_image, 1, length(loaded_image)))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A25: trim
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||trim(BOTH 'A'
                 FROM loaded_image) IS NULL
       OR ('1'||trim(BOTH 'A'
                     FROM loaded_image) = 1||trim(BOTH 'A'
                                                  FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) IS NOT DISTINCT
           FROM 1||trim(BOTH 'A'
                        FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                         FROM loaded_image)
           AND ('1'||trim(BOTH 'A'
                          FROM loaded_image) IS DISTINCT
                FROM '0'||trim(BOTH 'A'
                               FROM loaded_image))
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) > '0'||trim(BOTH 'A'
                                                        FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) >= '0'||trim(BOTH 'A'
                                                         FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) < 2||trim(BOTH 'A'
                                                      FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) <= 2||trim(BOTH 'A'
                                                       FROM loaded_image)
           AND ('1'||trim(BOTH 'A'
                          FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                          FROM loaded_image)) IS TRUE
           AND ('1'||trim(BOTH 'A'
                          FROM loaded_image) = '0'||trim(BOTH 'A'
                                                         FROM loaded_image)) IS NOT TRUE
           AND ('1'||trim(BOTH 'A'
                          FROM loaded_image) = '0'||trim(BOTH 'A'
                                                         FROM loaded_image)) IS FALSE
           AND ('1'||trim(BOTH 'A'
                          FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                          FROM loaded_image)) IS NOT FALSE
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) BETWEEN '0'||trim(BOTH 'A'
                                                              FROM loaded_image) AND 2||trim(BOTH 'A'
                                                                                             FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) NOT BETWEEN '1'||trim(BOTH 'A'
                                                                  FROM loaded_image) AND '0'||trim(BOTH 'A'
                                                                                                   FROM loaded_image)
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) like '%'
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) IN ('0'||trim(BOTH 'A'
                                                          FROM loaded_image),
                                                1||trim(BOTH 'A'
                                                        FROM loaded_image),
                                                2||trim(BOTH 'A'
                                                        FROM loaded_image))
           AND '1'||trim(BOTH 'A'
                         FROM loaded_image) NOT IN ('0'||trim(BOTH 'A'
                                                              FROM loaded_image),
                                                    2||trim(BOTH 'A'
                                                            FROM loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||trim(BOTH 'A'
                 FROM loaded_image) IS NULL
       OR '1'||trim(BOTH 'A'
                    FROM loaded_image) IN
         (SELECT '1'||trim(BOTH 'A'
                           FROM loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||trim(BOTH 'A'
                           FROM loaded_image) IS NULL
                 OR ('1'||trim(BOTH 'A'
                               FROM loaded_image) = 1||trim(BOTH 'A'
                                                            FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) IS NOT DISTINCT
                     FROM 1||trim(BOTH 'A'
                                  FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                                   FROM loaded_image)
                     AND ('1'||trim(BOTH 'A'
                                    FROM loaded_image) IS DISTINCT
                          FROM '0'||trim(BOTH 'A'
                                         FROM loaded_image))
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) > '0'||trim(BOTH 'A'
                                                                  FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) >= '0'||trim(BOTH 'A'
                                                                   FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) < 2||trim(BOTH 'A'
                                                                FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) <= 2||trim(BOTH 'A'
                                                                 FROM loaded_image)
                     AND ('1'||trim(BOTH 'A'
                                    FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                                    FROM loaded_image)) IS TRUE
                     AND ('1'||trim(BOTH 'A'
                                    FROM loaded_image) = '0'||trim(BOTH 'A'
                                                                   FROM loaded_image)) IS NOT TRUE
                     AND ('1'||trim(BOTH 'A'
                                    FROM loaded_image) = '0'||trim(BOTH 'A'
                                                                   FROM loaded_image)) IS FALSE
                     AND ('1'||trim(BOTH 'A'
                                    FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                                    FROM loaded_image)) IS NOT FALSE
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) BETWEEN '0'||trim(BOTH 'A'
                                                                        FROM loaded_image) AND 2||trim(BOTH 'A'
                                                                                                       FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) NOT BETWEEN '1'||trim(BOTH 'A'
                                                                            FROM loaded_image) AND '0'||trim(BOTH 'A'
                                                                                                             FROM loaded_image)
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) like '%'
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) IN ('0'||trim(BOTH 'A'
                                                                    FROM loaded_image),
                                                          1||trim(BOTH 'A'
                                                                  FROM loaded_image),
                                                          2||trim(BOTH 'A'
                                                                  FROM loaded_image))
                     AND '1'||trim(BOTH 'A'
                                   FROM loaded_image) NOT IN ('0'||trim(BOTH 'A'
                                                                        FROM loaded_image),
                                                              2||trim(BOTH 'A'
                                                                      FROM loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||trim(BOTH 'A'
                                    FROM loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||trim(BOTH 'A'
                    FROM loaded_image) IS NULL
          OR ('1'||trim(BOTH 'A'
                        FROM loaded_image) = 1||trim(BOTH 'A'
                                                     FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) IS NOT DISTINCT
              FROM 1||trim(BOTH 'A'
                           FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                            FROM loaded_image)
              AND ('1'||trim(BOTH 'A'
                             FROM loaded_image) IS DISTINCT
                   FROM '0'||trim(BOTH 'A'
                                  FROM loaded_image))
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) > '0'||trim(BOTH 'A'
                                                           FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) >= '0'||trim(BOTH 'A'
                                                            FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) < 2||trim(BOTH 'A'
                                                         FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) <= 2||trim(BOTH 'A'
                                                          FROM loaded_image)
              AND ('1'||trim(BOTH 'A'
                             FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                             FROM loaded_image)) IS TRUE
              AND ('1'||trim(BOTH 'A'
                             FROM loaded_image) = '0'||trim(BOTH 'A'
                                                            FROM loaded_image)) IS NOT TRUE
              AND ('1'||trim(BOTH 'A'
                             FROM loaded_image) = '0'||trim(BOTH 'A'
                                                            FROM loaded_image)) IS FALSE
              AND ('1'||trim(BOTH 'A'
                             FROM loaded_image) <> '0'||trim(BOTH 'A'
                                                             FROM loaded_image)) IS NOT FALSE
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) BETWEEN '0'||trim(BOTH 'A'
                                                                 FROM loaded_image) AND 2||trim(BOTH 'A'
                                                                                                FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) NOT BETWEEN '1'||trim(BOTH 'A'
                                                                     FROM loaded_image) AND '0'||trim(BOTH 'A'
                                                                                                      FROM loaded_image)
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) like '%'
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) IN ('0'||trim(BOTH 'A'
                                                             FROM loaded_image),
                                                   1||trim(BOTH 'A'
                                                           FROM loaded_image),
                                                   2||trim(BOTH 'A'
                                                           FROM loaded_image))
              AND '1'||trim(BOTH 'A'
                            FROM loaded_image) NOT IN ('0'||trim(BOTH 'A'
                                                                 FROM loaded_image),
                                                       2||trim(BOTH 'A'
                                                               FROM loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A26: btrim
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||btrim(loaded_image, 'A') IS NULL
       OR ('1'||btrim(loaded_image, 'A') = 1||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') IS NOT DISTINCT
           FROM 1||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')
           AND ('1'||btrim(loaded_image, 'A') IS DISTINCT
                FROM '0'||btrim(loaded_image, 'A'))
           AND '1'||btrim(loaded_image, 'A') > '0'||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') >= '0'||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') < 2||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') <= 2||btrim(loaded_image, 'A')
           AND ('1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')) IS TRUE
           AND ('1'||btrim(loaded_image, 'A') = '0'||btrim(loaded_image, 'A')) IS NOT TRUE
           AND ('1'||btrim(loaded_image, 'A') = '0'||btrim(loaded_image, 'A')) IS FALSE
           AND ('1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')) IS NOT FALSE
           AND '1'||btrim(loaded_image, 'A') BETWEEN '0'||btrim(loaded_image, 'A') AND 2||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') NOT BETWEEN '1'||btrim(loaded_image, 'A') AND '0'||btrim(loaded_image, 'A')
           AND '1'||btrim(loaded_image, 'A') like '%'
           AND '1'||btrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
           AND '1'||btrim(loaded_image, 'A') IN ('0'||btrim(loaded_image, 'A'),
                                                 1||btrim(loaded_image, 'A'),
                                                 2||btrim(loaded_image, 'A'))
           AND '1'||btrim(loaded_image, 'A') NOT IN ('0'||btrim(loaded_image, 'A'),
                                                     2||btrim(loaded_image, 'A')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||btrim(loaded_image, 'A') IS NULL
       OR '1'||btrim(loaded_image, 'A') IN
         (SELECT '1'||btrim(loaded_image, 'A')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||btrim(loaded_image, 'A') IS NULL
                 OR ('1'||btrim(loaded_image, 'A') = 1||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') IS NOT DISTINCT
                     FROM 1||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')
                     AND ('1'||btrim(loaded_image, 'A') IS DISTINCT
                          FROM '0'||btrim(loaded_image, 'A'))
                     AND '1'||btrim(loaded_image, 'A') > '0'||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') >= '0'||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') < 2||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') <= 2||btrim(loaded_image, 'A')
                     AND ('1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')) IS TRUE
                     AND ('1'||btrim(loaded_image, 'A') = '0'||btrim(loaded_image, 'A')) IS NOT TRUE
                     AND ('1'||btrim(loaded_image, 'A') = '0'||btrim(loaded_image, 'A')) IS FALSE
                     AND ('1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')) IS NOT FALSE
                     AND '1'||btrim(loaded_image, 'A') BETWEEN '0'||btrim(loaded_image, 'A') AND 2||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') NOT BETWEEN '1'||btrim(loaded_image, 'A') AND '0'||btrim(loaded_image, 'A')
                     AND '1'||btrim(loaded_image, 'A') like '%'
                     AND '1'||btrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
                     AND '1'||btrim(loaded_image, 'A') IN ('0'||btrim(loaded_image, 'A'),
                                                           1||btrim(loaded_image, 'A'),
                                                           2||btrim(loaded_image, 'A'))
                     AND '1'||btrim(loaded_image, 'A') NOT IN ('0'||btrim(loaded_image, 'A'),
                                                               2||btrim(loaded_image, 'A'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||btrim(loaded_image, 'A'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||btrim(loaded_image, 'A') IS NULL
          OR ('1'||btrim(loaded_image, 'A') = 1||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') IS NOT DISTINCT
              FROM 1||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')
              AND ('1'||btrim(loaded_image, 'A') IS DISTINCT
                   FROM '0'||btrim(loaded_image, 'A'))
              AND '1'||btrim(loaded_image, 'A') > '0'||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') >= '0'||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') < 2||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') <= 2||btrim(loaded_image, 'A')
              AND ('1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')) IS TRUE
              AND ('1'||btrim(loaded_image, 'A') = '0'||btrim(loaded_image, 'A')) IS NOT TRUE
              AND ('1'||btrim(loaded_image, 'A') = '0'||btrim(loaded_image, 'A')) IS FALSE
              AND ('1'||btrim(loaded_image, 'A') <> '0'||btrim(loaded_image, 'A')) IS NOT FALSE
              AND '1'||btrim(loaded_image, 'A') BETWEEN '0'||btrim(loaded_image, 'A') AND 2||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') NOT BETWEEN '1'||btrim(loaded_image, 'A') AND '0'||btrim(loaded_image, 'A')
              AND '1'||btrim(loaded_image, 'A') like '%'
              AND '1'||btrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
              AND '1'||btrim(loaded_image, 'A') IN ('0'||btrim(loaded_image, 'A'),
                                                    1||btrim(loaded_image, 'A'),
                                                    2||btrim(loaded_image, 'A'))
              AND '1'||btrim(loaded_image, 'A') NOT IN ('0'||btrim(loaded_image, 'A'),
                                                        2||btrim(loaded_image, 'A'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A27: ltrim
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||ltrim(loaded_image, 'A') IS NULL
       OR ('1'||ltrim(loaded_image, 'A') = 1||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') IS NOT DISTINCT
           FROM 1||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')
           AND ('1'||ltrim(loaded_image, 'A') IS DISTINCT
                FROM '0'||ltrim(loaded_image, 'A'))
           AND '1'||ltrim(loaded_image, 'A') > '0'||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') >= '0'||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') < 2||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') <= 2||ltrim(loaded_image, 'A')
           AND ('1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')) IS TRUE
           AND ('1'||ltrim(loaded_image, 'A') = '0'||ltrim(loaded_image, 'A')) IS NOT TRUE
           AND ('1'||ltrim(loaded_image, 'A') = '0'||ltrim(loaded_image, 'A')) IS FALSE
           AND ('1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')) IS NOT FALSE
           AND '1'||ltrim(loaded_image, 'A') BETWEEN '0'||ltrim(loaded_image, 'A') AND 2||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') NOT BETWEEN '1'||ltrim(loaded_image, 'A') AND '0'||ltrim(loaded_image, 'A')
           AND '1'||ltrim(loaded_image, 'A') like '%'
           AND '1'||ltrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
           AND '1'||ltrim(loaded_image, 'A') IN ('0'||ltrim(loaded_image, 'A'),
                                                 1||ltrim(loaded_image, 'A'),
                                                 2||ltrim(loaded_image, 'A'))
           AND '1'||ltrim(loaded_image, 'A') NOT IN ('0'||ltrim(loaded_image, 'A'),
                                                     2||ltrim(loaded_image, 'A')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||ltrim(loaded_image, 'A') IS NULL
       OR '1'||ltrim(loaded_image, 'A') IN
         (SELECT '1'||ltrim(loaded_image, 'A')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||ltrim(loaded_image, 'A') IS NULL
                 OR ('1'||ltrim(loaded_image, 'A') = 1||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') IS NOT DISTINCT
                     FROM 1||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')
                     AND ('1'||ltrim(loaded_image, 'A') IS DISTINCT
                          FROM '0'||ltrim(loaded_image, 'A'))
                     AND '1'||ltrim(loaded_image, 'A') > '0'||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') >= '0'||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') < 2||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') <= 2||ltrim(loaded_image, 'A')
                     AND ('1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')) IS TRUE
                     AND ('1'||ltrim(loaded_image, 'A') = '0'||ltrim(loaded_image, 'A')) IS NOT TRUE
                     AND ('1'||ltrim(loaded_image, 'A') = '0'||ltrim(loaded_image, 'A')) IS FALSE
                     AND ('1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')) IS NOT FALSE
                     AND '1'||ltrim(loaded_image, 'A') BETWEEN '0'||ltrim(loaded_image, 'A') AND 2||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') NOT BETWEEN '1'||ltrim(loaded_image, 'A') AND '0'||ltrim(loaded_image, 'A')
                     AND '1'||ltrim(loaded_image, 'A') like '%'
                     AND '1'||ltrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
                     AND '1'||ltrim(loaded_image, 'A') IN ('0'||ltrim(loaded_image, 'A'),
                                                           1||ltrim(loaded_image, 'A'),
                                                           2||ltrim(loaded_image, 'A'))
                     AND '1'||ltrim(loaded_image, 'A') NOT IN ('0'||ltrim(loaded_image, 'A'),
                                                               2||ltrim(loaded_image, 'A'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||ltrim(loaded_image, 'A'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||ltrim(loaded_image, 'A') IS NULL
          OR ('1'||ltrim(loaded_image, 'A') = 1||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') IS NOT DISTINCT
              FROM 1||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')
              AND ('1'||ltrim(loaded_image, 'A') IS DISTINCT
                   FROM '0'||ltrim(loaded_image, 'A'))
              AND '1'||ltrim(loaded_image, 'A') > '0'||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') >= '0'||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') < 2||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') <= 2||ltrim(loaded_image, 'A')
              AND ('1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')) IS TRUE
              AND ('1'||ltrim(loaded_image, 'A') = '0'||ltrim(loaded_image, 'A')) IS NOT TRUE
              AND ('1'||ltrim(loaded_image, 'A') = '0'||ltrim(loaded_image, 'A')) IS FALSE
              AND ('1'||ltrim(loaded_image, 'A') <> '0'||ltrim(loaded_image, 'A')) IS NOT FALSE
              AND '1'||ltrim(loaded_image, 'A') BETWEEN '0'||ltrim(loaded_image, 'A') AND 2||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') NOT BETWEEN '1'||ltrim(loaded_image, 'A') AND '0'||ltrim(loaded_image, 'A')
              AND '1'||ltrim(loaded_image, 'A') like '%'
              AND '1'||ltrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
              AND '1'||ltrim(loaded_image, 'A') IN ('0'||ltrim(loaded_image, 'A'),
                                                    1||ltrim(loaded_image, 'A'),
                                                    2||ltrim(loaded_image, 'A'))
              AND '1'||ltrim(loaded_image, 'A') NOT IN ('0'||ltrim(loaded_image, 'A'),
                                                        2||ltrim(loaded_image, 'A'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A28: rtrim
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||rtrim(loaded_image, 'A') IS NULL
       OR ('1'||rtrim(loaded_image, 'A') = 1||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') IS NOT DISTINCT
           FROM 1||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')
           AND ('1'||rtrim(loaded_image, 'A') IS DISTINCT
                FROM '0'||rtrim(loaded_image, 'A'))
           AND '1'||rtrim(loaded_image, 'A') > '0'||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') >= '0'||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') < 2||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') <= 2||rtrim(loaded_image, 'A')
           AND ('1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')) IS TRUE
           AND ('1'||rtrim(loaded_image, 'A') = '0'||rtrim(loaded_image, 'A')) IS NOT TRUE
           AND ('1'||rtrim(loaded_image, 'A') = '0'||rtrim(loaded_image, 'A')) IS FALSE
           AND ('1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')) IS NOT FALSE
           AND '1'||rtrim(loaded_image, 'A') BETWEEN '0'||rtrim(loaded_image, 'A') AND 2||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') NOT BETWEEN '1'||rtrim(loaded_image, 'A') AND '0'||rtrim(loaded_image, 'A')
           AND '1'||rtrim(loaded_image, 'A') like '%'
           AND '1'||rtrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
           AND '1'||rtrim(loaded_image, 'A') IN ('0'||rtrim(loaded_image, 'A'),
                                                 1||rtrim(loaded_image, 'A'),
                                                 2||rtrim(loaded_image, 'A'))
           AND '1'||rtrim(loaded_image, 'A') NOT IN ('0'||rtrim(loaded_image, 'A'),
                                                     2||rtrim(loaded_image, 'A')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||rtrim(loaded_image, 'A') IS NULL
       OR '1'||rtrim(loaded_image, 'A') IN
         (SELECT '1'||rtrim(loaded_image, 'A')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||rtrim(loaded_image, 'A') IS NULL
                 OR ('1'||rtrim(loaded_image, 'A') = 1||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') IS NOT DISTINCT
                     FROM 1||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')
                     AND ('1'||rtrim(loaded_image, 'A') IS DISTINCT
                          FROM '0'||rtrim(loaded_image, 'A'))
                     AND '1'||rtrim(loaded_image, 'A') > '0'||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') >= '0'||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') < 2||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') <= 2||rtrim(loaded_image, 'A')
                     AND ('1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')) IS TRUE
                     AND ('1'||rtrim(loaded_image, 'A') = '0'||rtrim(loaded_image, 'A')) IS NOT TRUE
                     AND ('1'||rtrim(loaded_image, 'A') = '0'||rtrim(loaded_image, 'A')) IS FALSE
                     AND ('1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')) IS NOT FALSE
                     AND '1'||rtrim(loaded_image, 'A') BETWEEN '0'||rtrim(loaded_image, 'A') AND 2||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') NOT BETWEEN '1'||rtrim(loaded_image, 'A') AND '0'||rtrim(loaded_image, 'A')
                     AND '1'||rtrim(loaded_image, 'A') like '%'
                     AND '1'||rtrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
                     AND '1'||rtrim(loaded_image, 'A') IN ('0'||rtrim(loaded_image, 'A'),
                                                           1||rtrim(loaded_image, 'A'),
                                                           2||rtrim(loaded_image, 'A'))
                     AND '1'||rtrim(loaded_image, 'A') NOT IN ('0'||rtrim(loaded_image, 'A'),
                                                               2||rtrim(loaded_image, 'A'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||rtrim(loaded_image, 'A'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||rtrim(loaded_image, 'A') IS NULL
          OR ('1'||rtrim(loaded_image, 'A') = 1||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') IS NOT DISTINCT
              FROM 1||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')
              AND ('1'||rtrim(loaded_image, 'A') IS DISTINCT
                   FROM '0'||rtrim(loaded_image, 'A'))
              AND '1'||rtrim(loaded_image, 'A') > '0'||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') >= '0'||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') < 2||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') <= 2||rtrim(loaded_image, 'A')
              AND ('1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')) IS TRUE
              AND ('1'||rtrim(loaded_image, 'A') = '0'||rtrim(loaded_image, 'A')) IS NOT TRUE
              AND ('1'||rtrim(loaded_image, 'A') = '0'||rtrim(loaded_image, 'A')) IS FALSE
              AND ('1'||rtrim(loaded_image, 'A') <> '0'||rtrim(loaded_image, 'A')) IS NOT FALSE
              AND '1'||rtrim(loaded_image, 'A') BETWEEN '0'||rtrim(loaded_image, 'A') AND 2||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') NOT BETWEEN '1'||rtrim(loaded_image, 'A') AND '0'||rtrim(loaded_image, 'A')
              AND '1'||rtrim(loaded_image, 'A') like '%'
              AND '1'||rtrim(loaded_image, 'A') not like '__DOES_NOT_EXIST__%'
              AND '1'||rtrim(loaded_image, 'A') IN ('0'||rtrim(loaded_image, 'A'),
                                                    1||rtrim(loaded_image, 'A'),
                                                    2||rtrim(loaded_image, 'A'))
              AND '1'||rtrim(loaded_image, 'A') NOT IN ('0'||rtrim(loaded_image, 'A'),
                                                        2||rtrim(loaded_image, 'A'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A29: reverse
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||reverse(loaded_image) IS NULL
       OR ('1'||reverse(loaded_image) = 1||reverse(loaded_image)
           AND '1'||reverse(loaded_image) IS NOT DISTINCT
           FROM 1||reverse(loaded_image)
           AND '1'||reverse(loaded_image) <> '0'||reverse(loaded_image)
           AND ('1'||reverse(loaded_image) IS DISTINCT
                FROM '0'||reverse(loaded_image))
           AND '1'||reverse(loaded_image) > '0'||reverse(loaded_image)
           AND '1'||reverse(loaded_image) >= '0'||reverse(loaded_image)
           AND '1'||reverse(loaded_image) < 2||reverse(loaded_image)
           AND '1'||reverse(loaded_image) <= 2||reverse(loaded_image)
           AND ('1'||reverse(loaded_image) <> '0'||reverse(loaded_image)) IS TRUE
           AND ('1'||reverse(loaded_image) = '0'||reverse(loaded_image)) IS NOT TRUE
           AND ('1'||reverse(loaded_image) = '0'||reverse(loaded_image)) IS FALSE
           AND ('1'||reverse(loaded_image) <> '0'||reverse(loaded_image)) IS NOT FALSE
           AND '1'||reverse(loaded_image) BETWEEN '0'||reverse(loaded_image) AND 2||reverse(loaded_image)
           AND '1'||reverse(loaded_image) NOT BETWEEN '1'||reverse(loaded_image) AND '0'||reverse(loaded_image)
           AND '1'||reverse(loaded_image) like '%'
           AND '1'||reverse(loaded_image) not like '__DOES_NOT_EXIST__%'
           AND '1'||reverse(loaded_image) IN ('0'||reverse(loaded_image),
                                              1||reverse(loaded_image),
                                              2||reverse(loaded_image))
           AND '1'||reverse(loaded_image) NOT IN ('0'||reverse(loaded_image),
                                                  2||reverse(loaded_image)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||reverse(loaded_image) IS NULL
       OR '1'||reverse(loaded_image) IN
         (SELECT '1'||reverse(loaded_image)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||reverse(loaded_image) IS NULL
                 OR ('1'||reverse(loaded_image) = 1||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) IS NOT DISTINCT
                     FROM 1||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) <> '0'||reverse(loaded_image)
                     AND ('1'||reverse(loaded_image) IS DISTINCT
                          FROM '0'||reverse(loaded_image))
                     AND '1'||reverse(loaded_image) > '0'||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) >= '0'||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) < 2||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) <= 2||reverse(loaded_image)
                     AND ('1'||reverse(loaded_image) <> '0'||reverse(loaded_image)) IS TRUE
                     AND ('1'||reverse(loaded_image) = '0'||reverse(loaded_image)) IS NOT TRUE
                     AND ('1'||reverse(loaded_image) = '0'||reverse(loaded_image)) IS FALSE
                     AND ('1'||reverse(loaded_image) <> '0'||reverse(loaded_image)) IS NOT FALSE
                     AND '1'||reverse(loaded_image) BETWEEN '0'||reverse(loaded_image) AND 2||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) NOT BETWEEN '1'||reverse(loaded_image) AND '0'||reverse(loaded_image)
                     AND '1'||reverse(loaded_image) like '%'
                     AND '1'||reverse(loaded_image) not like '__DOES_NOT_EXIST__%'
                     AND '1'||reverse(loaded_image) IN ('0'||reverse(loaded_image),
                                                        1||reverse(loaded_image),
                                                        2||reverse(loaded_image))
                     AND '1'||reverse(loaded_image) NOT IN ('0'||reverse(loaded_image),
                                                            2||reverse(loaded_image))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||reverse(loaded_image),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||reverse(loaded_image) IS NULL
          OR ('1'||reverse(loaded_image) = 1||reverse(loaded_image)
              AND '1'||reverse(loaded_image) IS NOT DISTINCT
              FROM 1||reverse(loaded_image)
              AND '1'||reverse(loaded_image) <> '0'||reverse(loaded_image)
              AND ('1'||reverse(loaded_image) IS DISTINCT
                   FROM '0'||reverse(loaded_image))
              AND '1'||reverse(loaded_image) > '0'||reverse(loaded_image)
              AND '1'||reverse(loaded_image) >= '0'||reverse(loaded_image)
              AND '1'||reverse(loaded_image) < 2||reverse(loaded_image)
              AND '1'||reverse(loaded_image) <= 2||reverse(loaded_image)
              AND ('1'||reverse(loaded_image) <> '0'||reverse(loaded_image)) IS TRUE
              AND ('1'||reverse(loaded_image) = '0'||reverse(loaded_image)) IS NOT TRUE
              AND ('1'||reverse(loaded_image) = '0'||reverse(loaded_image)) IS FALSE
              AND ('1'||reverse(loaded_image) <> '0'||reverse(loaded_image)) IS NOT FALSE
              AND '1'||reverse(loaded_image) BETWEEN '0'||reverse(loaded_image) AND 2||reverse(loaded_image)
              AND '1'||reverse(loaded_image) NOT BETWEEN '1'||reverse(loaded_image) AND '0'||reverse(loaded_image)
              AND '1'||reverse(loaded_image) like '%'
              AND '1'||reverse(loaded_image) not like '__DOES_NOT_EXIST__%'
              AND '1'||reverse(loaded_image) IN ('0'||reverse(loaded_image),
                                                 1||reverse(loaded_image),
                                                 2||reverse(loaded_image))
              AND '1'||reverse(loaded_image) NOT IN ('0'||reverse(loaded_image),
                                                     2||reverse(loaded_image))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A30: repeat
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||repeat(loaded_image, 2) IS NULL
       OR ('1'||repeat(loaded_image, 2) = 1||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) IS NOT DISTINCT
           FROM 1||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)
           AND ('1'||repeat(loaded_image, 2) IS DISTINCT
                FROM '0'||repeat(loaded_image, 2))
           AND '1'||repeat(loaded_image, 2) > '0'||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) >= '0'||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) < 2||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) <= 2||repeat(loaded_image, 2)
           AND ('1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)) IS TRUE
           AND ('1'||repeat(loaded_image, 2) = '0'||repeat(loaded_image, 2)) IS NOT TRUE
           AND ('1'||repeat(loaded_image, 2) = '0'||repeat(loaded_image, 2)) IS FALSE
           AND ('1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)) IS NOT FALSE
           AND '1'||repeat(loaded_image, 2) BETWEEN '0'||repeat(loaded_image, 2) AND 2||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) NOT BETWEEN '1'||repeat(loaded_image, 2) AND '0'||repeat(loaded_image, 2)
           AND '1'||repeat(loaded_image, 2) like '%'
           AND '1'||repeat(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
           AND '1'||repeat(loaded_image, 2) IN ('0'||repeat(loaded_image, 2),
                                                1||repeat(loaded_image, 2),
                                                2||repeat(loaded_image, 2))
           AND '1'||repeat(loaded_image, 2) NOT IN ('0'||repeat(loaded_image, 2),
                                                    2||repeat(loaded_image, 2)))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||repeat(loaded_image, 2) IS NULL
       OR '1'||repeat(loaded_image, 2) IN
         (SELECT '1'||repeat(loaded_image, 2)
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||repeat(loaded_image, 2) IS NULL
                 OR ('1'||repeat(loaded_image, 2) = 1||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) IS NOT DISTINCT
                     FROM 1||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)
                     AND ('1'||repeat(loaded_image, 2) IS DISTINCT
                          FROM '0'||repeat(loaded_image, 2))
                     AND '1'||repeat(loaded_image, 2) > '0'||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) >= '0'||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) < 2||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) <= 2||repeat(loaded_image, 2)
                     AND ('1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)) IS TRUE
                     AND ('1'||repeat(loaded_image, 2) = '0'||repeat(loaded_image, 2)) IS NOT TRUE
                     AND ('1'||repeat(loaded_image, 2) = '0'||repeat(loaded_image, 2)) IS FALSE
                     AND ('1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)) IS NOT FALSE
                     AND '1'||repeat(loaded_image, 2) BETWEEN '0'||repeat(loaded_image, 2) AND 2||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) NOT BETWEEN '1'||repeat(loaded_image, 2) AND '0'||repeat(loaded_image, 2)
                     AND '1'||repeat(loaded_image, 2) like '%'
                     AND '1'||repeat(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
                     AND '1'||repeat(loaded_image, 2) IN ('0'||repeat(loaded_image, 2),
                                                          1||repeat(loaded_image, 2),
                                                          2||repeat(loaded_image, 2))
                     AND '1'||repeat(loaded_image, 2) NOT IN ('0'||repeat(loaded_image, 2),
                                                              2||repeat(loaded_image, 2))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||repeat(loaded_image, 2),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||repeat(loaded_image, 2) IS NULL
          OR ('1'||repeat(loaded_image, 2) = 1||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) IS NOT DISTINCT
              FROM 1||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)
              AND ('1'||repeat(loaded_image, 2) IS DISTINCT
                   FROM '0'||repeat(loaded_image, 2))
              AND '1'||repeat(loaded_image, 2) > '0'||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) >= '0'||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) < 2||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) <= 2||repeat(loaded_image, 2)
              AND ('1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)) IS TRUE
              AND ('1'||repeat(loaded_image, 2) = '0'||repeat(loaded_image, 2)) IS NOT TRUE
              AND ('1'||repeat(loaded_image, 2) = '0'||repeat(loaded_image, 2)) IS FALSE
              AND ('1'||repeat(loaded_image, 2) <> '0'||repeat(loaded_image, 2)) IS NOT FALSE
              AND '1'||repeat(loaded_image, 2) BETWEEN '0'||repeat(loaded_image, 2) AND 2||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) NOT BETWEEN '1'||repeat(loaded_image, 2) AND '0'||repeat(loaded_image, 2)
              AND '1'||repeat(loaded_image, 2) like '%'
              AND '1'||repeat(loaded_image, 2) not like '__DOES_NOT_EXIST__%'
              AND '1'||repeat(loaded_image, 2) IN ('0'||repeat(loaded_image, 2),
                                                   1||repeat(loaded_image, 2),
                                                   2||repeat(loaded_image, 2))
              AND '1'||repeat(loaded_image, 2) NOT IN ('0'||repeat(loaded_image, 2),
                                                       2||repeat(loaded_image, 2))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A31: lpad
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||lpad(loaded_image, 10, 'z') IS NULL
       OR ('1'||lpad(loaded_image, 10, 'z') = 1||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') IS NOT DISTINCT
           FROM 1||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')
           AND ('1'||lpad(loaded_image, 10, 'z') IS DISTINCT
                FROM '0'||lpad(loaded_image, 10, 'z'))
           AND '1'||lpad(loaded_image, 10, 'z') > '0'||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') >= '0'||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') < 2||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') <= 2||lpad(loaded_image, 10, 'z')
           AND ('1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')) IS TRUE
           AND ('1'||lpad(loaded_image, 10, 'z') = '0'||lpad(loaded_image, 10, 'z')) IS NOT TRUE
           AND ('1'||lpad(loaded_image, 10, 'z') = '0'||lpad(loaded_image, 10, 'z')) IS FALSE
           AND ('1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')) IS NOT FALSE
           AND '1'||lpad(loaded_image, 10, 'z') BETWEEN '0'||lpad(loaded_image, 10, 'z') AND 2||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') NOT BETWEEN '1'||lpad(loaded_image, 10, 'z') AND '0'||lpad(loaded_image, 10, 'z')
           AND '1'||lpad(loaded_image, 10, 'z') like '%'
           AND '1'||lpad(loaded_image, 10, 'z') not like '__DOES_NOT_EXIST__%'
           AND '1'||lpad(loaded_image, 10, 'z') IN ('0'||lpad(loaded_image, 10, 'z'),
                                                    1||lpad(loaded_image, 10, 'z'),
                                                    2||lpad(loaded_image, 10, 'z'))
           AND '1'||lpad(loaded_image, 10, 'z') NOT IN ('0'||lpad(loaded_image, 10, 'z'),
                                                        2||lpad(loaded_image, 10, 'z')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||lpad(loaded_image, 10, 'z') IS NULL
       OR '1'||lpad(loaded_image, 10, 'z') IN
         (SELECT '1'||lpad(loaded_image, 10, 'z')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||lpad(loaded_image, 10, 'z') IS NULL
                 OR ('1'||lpad(loaded_image, 10, 'z') = 1||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') IS NOT DISTINCT
                     FROM 1||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')
                     AND ('1'||lpad(loaded_image, 10, 'z') IS DISTINCT
                          FROM '0'||lpad(loaded_image, 10, 'z'))
                     AND '1'||lpad(loaded_image, 10, 'z') > '0'||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') >= '0'||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') < 2||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') <= 2||lpad(loaded_image, 10, 'z')
                     AND ('1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')) IS TRUE
                     AND ('1'||lpad(loaded_image, 10, 'z') = '0'||lpad(loaded_image, 10, 'z')) IS NOT TRUE
                     AND ('1'||lpad(loaded_image, 10, 'z') = '0'||lpad(loaded_image, 10, 'z')) IS FALSE
                     AND ('1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')) IS NOT FALSE
                     AND '1'||lpad(loaded_image, 10, 'z') BETWEEN '0'||lpad(loaded_image, 10, 'z') AND 2||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') NOT BETWEEN '1'||lpad(loaded_image, 10, 'z') AND '0'||lpad(loaded_image, 10, 'z')
                     AND '1'||lpad(loaded_image, 10, 'z') like '%'
                     AND '1'||lpad(loaded_image, 10, 'z') not like '__DOES_NOT_EXIST__%'
                     AND '1'||lpad(loaded_image, 10, 'z') IN ('0'||lpad(loaded_image, 10, 'z'),
                                                              1||lpad(loaded_image, 10, 'z'),
                                                              2||lpad(loaded_image, 10, 'z'))
                     AND '1'||lpad(loaded_image, 10, 'z') NOT IN ('0'||lpad(loaded_image, 10, 'z'),
                                                                  2||lpad(loaded_image, 10, 'z'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||lpad(loaded_image, 10, 'z'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||lpad(loaded_image, 10, 'z') IS NULL
          OR ('1'||lpad(loaded_image, 10, 'z') = 1||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') IS NOT DISTINCT
              FROM 1||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')
              AND ('1'||lpad(loaded_image, 10, 'z') IS DISTINCT
                   FROM '0'||lpad(loaded_image, 10, 'z'))
              AND '1'||lpad(loaded_image, 10, 'z') > '0'||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') >= '0'||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') < 2||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') <= 2||lpad(loaded_image, 10, 'z')
              AND ('1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')) IS TRUE
              AND ('1'||lpad(loaded_image, 10, 'z') = '0'||lpad(loaded_image, 10, 'z')) IS NOT TRUE
              AND ('1'||lpad(loaded_image, 10, 'z') = '0'||lpad(loaded_image, 10, 'z')) IS FALSE
              AND ('1'||lpad(loaded_image, 10, 'z') <> '0'||lpad(loaded_image, 10, 'z')) IS NOT FALSE
              AND '1'||lpad(loaded_image, 10, 'z') BETWEEN '0'||lpad(loaded_image, 10, 'z') AND 2||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') NOT BETWEEN '1'||lpad(loaded_image, 10, 'z') AND '0'||lpad(loaded_image, 10, 'z')
              AND '1'||lpad(loaded_image, 10, 'z') like '%'
              AND '1'||lpad(loaded_image, 10, 'z') not like '__DOES_NOT_EXIST__%'
              AND '1'||lpad(loaded_image, 10, 'z') IN ('0'||lpad(loaded_image, 10, 'z'),
                                                       1||lpad(loaded_image, 10, 'z'),
                                                       2||lpad(loaded_image, 10, 'z'))
              AND '1'||lpad(loaded_image, 10, 'z') NOT IN ('0'||lpad(loaded_image, 10, 'z'),
                                                           2||lpad(loaded_image, 10, 'z'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# TEST_ID: A32: rpad
#-------------------------------------------------------------------------
SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||rpad(loaded_image, 10, 'z') IS NULL
       OR ('1'||rpad(loaded_image, 10, 'z') = 1||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') IS NOT DISTINCT
           FROM 1||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')
           AND ('1'||rpad(loaded_image, 10, 'z') IS DISTINCT
                FROM '0'||rpad(loaded_image, 10, 'z'))
           AND '1'||rpad(loaded_image, 10, 'z') > '0'||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') >= '0'||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') < 2||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') <= 2||rpad(loaded_image, 10, 'z')
           AND ('1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')) IS TRUE
           AND ('1'||rpad(loaded_image, 10, 'z') = '0'||rpad(loaded_image, 10, 'z')) IS NOT TRUE
           AND ('1'||rpad(loaded_image, 10, 'z') = '0'||rpad(loaded_image, 10, 'z')) IS FALSE
           AND ('1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')) IS NOT FALSE
           AND '1'||rpad(loaded_image, 10, 'z') BETWEEN '0'||rpad(loaded_image, 10, 'z') AND 2||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') NOT BETWEEN '1'||rpad(loaded_image, 10, 'z') AND '0'||rpad(loaded_image, 10, 'z')
           AND '1'||rpad(loaded_image, 10, 'z') like '%'
           AND '1'||rpad(loaded_image, 10, 'z') not like '__DOES_NOT_EXIST__%'
           AND '1'||rpad(loaded_image, 10, 'z') IN ('0'||rpad(loaded_image, 10, 'z'),
                                                    1||rpad(loaded_image, 10, 'z'),
                                                    2||rpad(loaded_image, 10, 'z'))
           AND '1'||rpad(loaded_image, 10, 'z') NOT IN ('0'||rpad(loaded_image, 10, 'z'),
                                                        2||rpad(loaded_image, 10, 'z')))) ;
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM kttm_nested
WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
  AND ('1'||rpad(loaded_image, 10, 'z') IS NULL
       OR '1'||rpad(loaded_image, 10, 'z') IN
         (SELECT '1'||rpad(loaded_image, 10, 'z')
          FROM kttm_nested
          WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
            AND ('1'||rpad(loaded_image, 10, 'z') IS NULL
                 OR ('1'||rpad(loaded_image, 10, 'z') = 1||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') IS NOT DISTINCT
                     FROM 1||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')
                     AND ('1'||rpad(loaded_image, 10, 'z') IS DISTINCT
                          FROM '0'||rpad(loaded_image, 10, 'z'))
                     AND '1'||rpad(loaded_image, 10, 'z') > '0'||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') >= '0'||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') < 2||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') <= 2||rpad(loaded_image, 10, 'z')
                     AND ('1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')) IS TRUE
                     AND ('1'||rpad(loaded_image, 10, 'z') = '0'||rpad(loaded_image, 10, 'z')) IS NOT TRUE
                     AND ('1'||rpad(loaded_image, 10, 'z') = '0'||rpad(loaded_image, 10, 'z')) IS FALSE
                     AND ('1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')) IS NOT FALSE
                     AND '1'||rpad(loaded_image, 10, 'z') BETWEEN '0'||rpad(loaded_image, 10, 'z') AND 2||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') NOT BETWEEN '1'||rpad(loaded_image, 10, 'z') AND '0'||rpad(loaded_image, 10, 'z')
                     AND '1'||rpad(loaded_image, 10, 'z') like '%'
                     AND '1'||rpad(loaded_image, 10, 'z') not like '__DOES_NOT_EXIST__%'
                     AND '1'||rpad(loaded_image, 10, 'z') IN ('0'||rpad(loaded_image, 10, 'z'),
                                                              1||rpad(loaded_image, 10, 'z'),
                                                              2||rpad(loaded_image, 10, 'z'))
                     AND '1'||rpad(loaded_image, 10, 'z') NOT IN ('0'||rpad(loaded_image, 10, 'z'),
                                                                  2||rpad(loaded_image, 10, 'z'))))));
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

SELECT count(*) cnt
FROM
  (SELECT __time, number, client_ip,
                          '1'||rpad(loaded_image, 10, 'z'),
                          count(*)
   FROM kttm_nested
   WHERE time_floor(__time, 'PT1H') BETWEEN timestamp '2019-08-25 00:00:00' AND timestamp '2019-08-25 06:00:00'
     AND ('1'||rpad(loaded_image, 10, 'z') IS NULL
          OR ('1'||rpad(loaded_image, 10, 'z') = 1||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') IS NOT DISTINCT
              FROM 1||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')
              AND ('1'||rpad(loaded_image, 10, 'z') IS DISTINCT
                   FROM '0'||rpad(loaded_image, 10, 'z'))
              AND '1'||rpad(loaded_image, 10, 'z') > '0'||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') >= '0'||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') < 2||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') <= 2||rpad(loaded_image, 10, 'z')
              AND ('1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')) IS TRUE
              AND ('1'||rpad(loaded_image, 10, 'z') = '0'||rpad(loaded_image, 10, 'z')) IS NOT TRUE
              AND ('1'||rpad(loaded_image, 10, 'z') = '0'||rpad(loaded_image, 10, 'z')) IS FALSE
              AND ('1'||rpad(loaded_image, 10, 'z') <> '0'||rpad(loaded_image, 10, 'z')) IS NOT FALSE
              AND '1'||rpad(loaded_image, 10, 'z') BETWEEN '0'||rpad(loaded_image, 10, 'z') AND 2||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') NOT BETWEEN '1'||rpad(loaded_image, 10, 'z') AND '0'||rpad(loaded_image, 10, 'z')
              AND '1'||rpad(loaded_image, 10, 'z') like '%'
              AND '1'||rpad(loaded_image, 10, 'z') not like '__DOES_NOT_EXIST__%'
              AND '1'||rpad(loaded_image, 10, 'z') IN ('0'||rpad(loaded_image, 10, 'z'),
                                                       1||rpad(loaded_image, 10, 'z'),
                                                       2||rpad(loaded_image, 10, 'z'))
              AND '1'||rpad(loaded_image, 10, 'z') NOT IN ('0'||rpad(loaded_image, 10, 'z'),
                                                           2||rpad(loaded_image, 10, 'z'))))
   GROUP BY 1,
            2,
            3,
            4);
+-------+
| cnt   |
+-------+
| 78197 |
+-------+
(1 row)

!ok

#-------------------------------------------------------------------------
# Total query count 97
#-------------------------------------------------------------------------
