type: "operatorValidation"

sql: |
  SELECT
    __time,
    "user",
    page,
    LAG(page, 1) OVER (PARTITION BY "user" ORDER BY __time) as priorPage
  FROM wikipedia
  WHERE countryIsoCode IN ('AT', 'JP', 'AU', 'UK')

expectedOperators:
  - { type: "naiveSort", columns: [ { column: "user", direction: "ASC" }, { column: "__time", direction: "ASC" } ]}
  - { type: "naivePartition",  partitionColumns: [ "user" ] }
  - type: "window"
    processor:
      type: "offset"
      inputColumn: page
      outputColumn: w0
      offset: -1

expectedResults:
  - [1442055495852,"1.121.160.49","Walker, Texas Ranger",null]
  - [1442056175946,"1.121.160.49","Walker, Texas Ranger","Walker, Texas Ranger"]
  - [1442062719426,"1.121.160.49","Richard Norton (actor)","Walker, Texas Ranger"]
  - [1442053449011,"1.123.133.249","Inside Out",null]
  - [1442030282870,"1.123.149.111","Christina Ricci",null]
  - [1442062306734,"1.129.96.160","Andrew Hastie (politician)",null]
  - [1442052408695,"1.129.96.219","Dorrigo Steam Railway and Museum",null]
  - [1442049229239,"1.129.96.242","Dorrigo Steam Railway and Museum",null]
  - [1442046541914,"1.152.96.170","Ayrton Senna",null]
  - [1442056892106,"101.128.232.140","清水浩",null]
  - [1442057005310,"101.128.232.140","清水浩","清水浩"]
  - [1442033283609,"101.140.3.146","水原茂",null]
  - [1442036282693,"101.162.15.184","The Biggest Loser (U.S. TV series)",null]
  - [1442036494525,"101.162.15.184","The Biggest Loser (U.S. TV series)","The Biggest Loser (U.S. TV series)"]
  - [1442053239190,"101.162.15.184","The Biggest Loser (season 3)","The Biggest Loser (U.S. TV series)"]
  - [1442094543511,"101.162.15.184","The Biggest Loser (season 3)","The Biggest Loser (season 3)"]
  - [1442054030928,"101.162.192.189","Second Keating Ministry",null]
  - [1442054439219,"101.162.192.189","Second Keating Ministry","Second Keating Ministry"]
  - [1442062617292,"101.180.202.153","2015 AFL season",null]
  - [1442042291553,"103.18.40.202","Wikipedia:Auskunft",null]
  - [1442030546957,"103.20.255.191","Same-sex marriage in New Zealand",null]
  - [1442028937717,"103.225.121.237","AKB48握手会傷害事件",null]
  - [1442025765045,"103.56.218.196","욱일기",null]
  - [1442018949298,"106.131.175.193","正岡大介",null]
  - [1442061568629,"106.132.207.6","白石涼子",null]
  - [1442074511372,"106.150.80.109","ノート:アズ熊谷",null]
  - [1442022640886,"106.161.56.138","山口敬之",null]
  - [1442061180690,"106.188.137.190","救急救命士養成所",null]
  - [1442061491224,"106.188.137.190","救急救命士","救急救命士養成所"]
  - [1442100695886,"106.188.187.22","Petronas Towers",null]
  - [1442033017165,"106.188.237.163","ダウンロード違法化",null]
  - [1442019638402,"110.1.177.43","ユーロビート",null]
  - [1442039765889,"110.1.177.43","虹の都へ","ユーロビート"]
  - [1442097432832,"110.20.158.121","Flavia Pennetta",null]
  - [1442097158335,"110.20.234.69","Yaoi",null]
  - [1442101346090,"110.20.234.69","Yaoi fandom","Yaoi"]
  - [1442022181729,"110.21.43.182","Planet Hollywood Resort & Casino",null]
  - [1442054156682,"110.22.186.92","Aris F.C. (Thessaloniki)",null]
  - [1442060921634,"110.32.28.203","Politics of Réunion",null]
  - [1442095172937,"110.67.252.181","Shinya",null]
  - [1442073188151,"111.216.35.85","うしおそうじ",null]
  - [1442070741096,"113.197.250.14","フィンテック",null]
  - [1442065282546,"113.36.127.77","福岡県立修猷館高等学校の人物一覧",null]
  - [1442020617093,"113.38.112.244","エフエム東京",null]
  - [1442043701284,"114.148.67.27","オウム真理教の修行",null]
  - [1442057752095,"114.149.159.81","鮎川誠",null]
  - [1442030463066,"114.149.98.37","2015年全米オープン (テニス)",null]
  - [1442036595334,"114.161.17.122","京都放送",null]
  - [1442085773238,"114.163.215.4","コンコルド墜落事故",null]
  - [1442019941523,"114.165.9.29","架空の乗り物一覧",null]
  - [1442073082802,"114.167.235.83","ランドール・パーク",null]
  - [1442036882364,"114.168.102.41","杉浦圭子",null]
  - [1442046282828,"114.186.112.218","オイルショック",null]
  - [1442030866019,"115.64.101.40","Snow leopard",null]
  - [1442030416128,"115.69.63.229","Ibrahim Sunday",null]
  - [1442046588882,"117.18.154.84","969運動",null]
  - [1442022015086,"117.55.68.51","セルゲーエフ",null]
  - [1442022520647,"117.55.68.51","セルゲーエワ","セルゲーエフ"]
  - [1442063719891,"117.74.50.110","ソード・ワールド2.0リプレイ from USA",null]
  - [1442039556838,"118.106.18.200","今夜もオトパラ!",null]
  - [1442049541582,"118.106.18.200","青森放送","今夜もオトパラ!"]
  - [1442047677181,"118.109.38.229","ケイゾク",null]
  - [1442049350391,"118.109.38.229","ケイゾク","ケイゾク"]
  - [1442063820782,"118.109.38.229","ケイゾク","ケイゾク"]
  - [1442080232899,"118.111.38.174","外傷初期診療ガイドライン日本版",null]
  - [1442033322693,"118.238.237.196","推理小説",null]
  - [1442090528892,"119.104.157.254","おかしな二人",null]
  - [1442075598708,"119.104.36.170","パスポート",null]
  - [1442038707947,"119.170.41.230","スーパーマン (1978年の映画)",null]
  - [1442031883720,"119.25.37.181","六甲人工島線",null]
  - [1442018890048,"119.26.148.34","青野武",null]
  - [1442046705300,"119.26.148.34","クッキングパパの登場人物","青野武"]
  - [1442058062503,"119.26.148.34","林先生が驚く初耳学!","クッキングパパの登場人物"]
  - [1442059524102,"119.26.148.34","エンジェル・ハート","林先生が驚く初耳学!"]
  - [1442065445099,"119.26.148.34","本田望結","エンジェル・ハート"]
  - [1442068465888,"119.63.112.86","DIABOLIK LOVERS",null]
  - [1442069164239,"119.63.112.86","GANGSTA.","DIABOLIK LOVERS"]
  - [1442091530861,"119.63.112.86","BS-TBS独占放送深夜アニメ枠","GANGSTA."]
  - [1442030131807,"119.72.245.161","The VISIONALUX",null]
  - [1442047214542,"120.147.6.7","African Union Mission to Somalia",null]
  - [1442032176994,"121.102.43.4","利用者‐会話:Yasuyuki Takeo",null]
  - [1442066932287,"121.117.180.156","Ulmendorf",null]
  - [1442023340480,"121.208.92.28","Moreton Bay",null]
  - [1442050348689,"121.211.56.55","Dominique Dunne",null]
  - [1442100154443,"121.211.82.121","List of Harry Potter characters",null]
  - [1442048444641,"121.223.129.191","List of dinosaur genera",null]
  - [1442027637932,"121.45.214.80","Total Drama Presents: The Ridonculous Race",null]
  - [1442054470231,"121.93.47.91","チキンハート",null]
  - [1442069124156,"121.93.97.147","機甲創世記モスピーダ",null]
  - [1442095062216,"122.108.156.100","United States presidential election, 1892",null]
  - [1442098671579,"122.108.156.100","United States presidential election, 1892","United States presidential election, 1892"]
  - [1442023533650,"122.25.10.78","星のカービィ! も〜れつプププアワー!",null]
  - [1442024788039,"122.25.10.78","陸上防衛隊まおちゃん","星のカービィ! も〜れつプププアワー!"]
  - [1442072416878,"122.25.10.78","黒鷺死体宅配便","陸上防衛隊まおちゃん"]
  - [1442074382146,"122.25.10.78","ロリコンフェニックス","黒鷺死体宅配便"]
  - [1442072607975,"123.100.63.20","User:MichelleFranklin/AustralianSkeptics",null]
  - [1442084541627,"123.217.1.75","JOIN ALIVE",null]
  - [1442056682107,"123.223.224.148","相馬康一",null]
  - [1442056818652,"123.223.224.148","杉崎亮","相馬康一"]
  - [1442057183557,"123.223.224.148","日高里菜","杉崎亮"]
  - [1442037245734,"124.148.87.34","List of Doctor Who audio plays by Big Finish",null]
  - [1442038279908,"124.148.87.34","List of Doctor Who audio plays by Big Finish","List of Doctor Who audio plays by Big Finish"]
  - [1442039505649,"124.148.87.34","List of Doctor Who audio plays by Big Finish","List of Doctor Who audio plays by Big Finish"]
  - [1442051202571,"124.148.87.34","List of Doctor Who audio plays by Big Finish","List of Doctor Who audio plays by Big Finish"]
  - [1442027954979,"124.169.165.146","Talk:Peter O'Toole",null]
  - [1442096498423,"124.169.17.234","Coca-Cola formula",null]
  - [1442046696410,"124.170.55.214","Northern Football League (Australia)",null]
  - [1442049310216,"124.171.44.159","Liberal Democratic Party (Australia)",null]
  - [1442035151510,"124.188.44.154","List of Doctor Who audio plays by Big Finish",null]
  - [1442092615464,"124.45.73.228","鹿児島県立加治木高等学校",null]
  - [1442023710710,"125.168.85.156","Beatrix Potter",null]
  - [1442050705594,"125.192.149.97","ドカチン",null]
  - [1442063450156,"125.198.182.94","交響曲第5番 (チャイコフスキー)",null]
  - [1442036586983,"125.2.29.54","バトルスピリッツ 烈火魂",null]
  - [1442020773422,"125.205.166.177","粉河町",null]
  - [1442070671364,"126.10.25.69","民王",null]
  - [1442065314043,"126.120.17.52","ガンズ・アンド・ローゼズ",null]
  - [1442057530890,"126.144.8.136","小柳友貴美",null]
  - [1442057729757,"126.144.8.136","張込み","小柳友貴美"]
  - [1442058237893,"126.144.8.136","篠原涼子","張込み"]
  - [1442058403152,"126.144.8.136","瀬戸朝香","篠原涼子"]
  - [1442058944024,"126.144.8.136","顔田顔彦","瀬戸朝香"]
  - [1442059192896,"126.144.8.136","山中聡","顔田顔彦"]
  - [1442064154338,"126.29.44.172","アンフェア the answer",null]
  - [1442046633404,"126.64.184.114","中山道",null]
  - [1442045829839,"130.54.130.227","静岡空港",null]
  - [1442056451492,"137.147.143.241","Royal Australian Air Force",null]
  - [1442020256428,"137.147.165.107","Michael Sharkey",null]
  - [1442045368765,"139.218.187.26","National Youth Competition (rugby league)",null]
  - [1442021132744,"14.201.22.221","2015 Roger Federer tennis season",null]
  - [1442078715198,"14.203.177.143","Captain (cricket)",null]
  - [1442063042912,"153.170.91.23","一色氏",null]
  - [1442040686108,"153.200.114.68","芋たこなんきん",null]
  - [1442042536291,"153.200.114.68","ごちそうさん (2013年のテレビドラマ)","芋たこなんきん"]
  - [1442042555091,"153.200.114.68","ごちそうさん (2013年のテレビドラマ)","ごちそうさん (2013年のテレビドラマ)"]
  - [1442024836364,"153.207.13.117","リーガ・エスパニョーラ",null]
  - [1442055615954,"153.230.62.16","刺客 聶隱娘",null]
  - [1442079228153,"161.202.72.168","Shaun King (activist)",null]
  - [1442080592078,"161.202.72.168","Talk:Shaun King (activist)","Shaun King (activist)"]
  - [1442082673917,"161.202.72.168","Talk:Shaun King (activist)","Talk:Shaun King (activist)"]
  - [1442054785180,"180.17.65.26","88式鉄帽",null]
  - [1442064037343,"180.27.228.108","虎ノ門事件",null]
  - [1442092840431,"180.54.251.210","鹿児島県立加治木高等学校",null]
  - [1442026399564,"182.168.99.4","ミャンマー",null]
  - [1442080053112,"182.173.142.88","ドクタースランプ",null]
  - [1442080079822,"182.173.142.88","ドクタースランプ","ドクタースランプ"]
  - [1442071861338,"188.23.31.111","Diskussion:Löwengrube (Serie)",null]
  - [1442041218594,"202.174.58.102","テッド (映画)",null]
  - [1442043359400,"202.174.58.102","立川流 (密教)","テッド (映画)"]
  - [1442050346906,"203.112.37.97","ABCフレッシュアップベースボール",null]
  - [1442037360618,"203.87.72.77","Hakoah Sydney City East FC",null]
  - [1442033433557,"210.128.82.94","列車種別",null]
  - [1442059451406,"210.132.145.235","キン肉マンスーパー・フェニックス",null]
  - [1442028766085,"210.145.159.111","小桜エツコ",null]
  - [1442047728381,"210.159.186.209","ハウス食品",null]
  - [1442073460368,"210.160.37.25","沖野晃司",null]
  - [1442073648703,"210.160.37.25","沖野晃司","沖野晃司"]
  - [1442025498133,"210.171.30.75","車塚 (伊丹市)",null]
  - [1442053077021,"210.194.52.87","小田急多摩線",null]
  - [1442079405551,"210.199.238.238","ズバリ!当てましょう",null]
  - [1442084605765,"210.199.238.238","インド","ズバリ!当てましょう"]
  - [1442048760081,"211.0.97.62","アフガニスタン紛争 (1978年-1989年)",null]
  - [1442058690158,"211.1.73.194","筑波山",null]
  - [1442066152552,"211.135.251.28","FNSスーパースペシャルテレビ夢列島",null]
  - [1442090789576,"212.95.7.43","Pamela (Vorname)",null]
  - [1442093822018,"212.95.7.57","Eşkıya Dünyaya Hükümdar Olmaz (dizi)",null]
  - [1442052594311,"213.102.112.181","Diskussion:Schlacht um die Krim",null]
  - [1442055194535,"213.102.112.181","Diskussion:Schlacht um die Krim","Diskussion:Schlacht um die Krim"]
  - [1442055264461,"213.102.112.181","Diskussion:Schlacht um die Krim","Diskussion:Schlacht um die Krim"]
  - [1442087241623,"213.240.105.56","16. Mai",null]
  - [1442073949064,"218.110.166.206","エゴグラム",null]
  - [1442048197658,"218.227.98.24","福岡空港",null]
  - [1442031289907,"218.45.13.57","サムライエッジ",null]
  - [1442043817524,"219.102.143.16","ヒルナンデス!",null]
  - [1442076175461,"219.106.24.95","中村れい子",null]
  - [1442076262194,"219.106.24.95","阿藤快","中村れい子"]
  - [1442076443347,"219.106.24.95","西岡善信","阿藤快"]
  - [1442067732777,"219.106.70.167","アンフェア the end",null]
  - [1442047016164,"219.110.114.95","永田久光",null]
  - [1442039078679,"219.110.28.111","こちら葛飾区亀有公園前派出所の登場人物",null]
  - [1442039059890,"219.112.132.106","野口茂樹",null]
  - [1442039204914,"219.112.132.106","野口茂樹","野口茂樹"]
  - [1442039593604,"219.112.132.106","井場友和","野口茂樹"]
  - [1442042116370,"219.112.132.106","高村祐","井場友和"]
  - [1442043631086,"219.112.132.106","岩本勉","高村祐"]
  - [1442033187371,"219.127.27.114","あんハピ♪",null]
  - [1442033425162,"219.127.27.114","林田理沙","あんハピ♪"]
  - [1442034666225,"219.127.27.114","八木沼純子","林田理沙"]
  - [1442026079559,"219.127.82.26","Wikipedia:サンドボックス",null]
  - [1442047519920,"219.161.34.177","小川虎之助",null]
  - [1442088730524,"219.171.105.167","2015 FIFA U-20ワールドカップ",null]
  - [1442090473730,"219.171.105.167","AFC U-19女子選手権2015","2015 FIFA U-20ワールドカップ"]
  - [1442098469728,"219.182.78.3","宮里久美",null]
  - [1442029124664,"219.198.137.251","逆転イッパツマン",null]
  - [1442048505685,"219.51.50.31","突撃!ナマイキTV",null]
  - [1442053430316,"219.51.50.31","突撃!ナマイキTV","突撃!ナマイキTV"]
  - [1442075782897,"219.67.166.28","オリンピア・ミラノ",null]
  - [1442035985727,"220.109.120.102","ワールドサッカー ウイニングイレブン 2016",null]
  - [1442036083342,"220.210.178.20","櫻井よしこ",null]
  - [1442024997507,"220.212.136.113","国際地学オリンピック",null]
  - [1442024799232,"220.213.14.136","甲府市中心市街地活性化基本計画",null]
  - [1442025695124,"220.213.14.136","放置自転車","甲府市中心市街地活性化基本計画"]
  - [1442026228735,"220.213.14.136","甲府市中心市街地活性化基本計画","放置自転車"]
  - [1442051686890,"220.62.54.3","坂上忍の成長マン!!",null]
  - [1442044538982,"221.170.137.161","週末キッズタイム",null]
  - [1442053936462,"221.77.244.149","ボーダーブレイク",null]
  - [1442101230028,"222.12.9.108","ネプリーグのクイズ・企画一覧",null]
  - [1442046505197,"222.148.228.64","おじゃる丸のエピソード一覧",null]
  - [1442046590842,"222.148.228.64","おじゃる丸","おじゃる丸のエピソード一覧"]
  - [1442051878307,"223.132.42.72","THE IDOLM@STER CINDERELLA GIRLS ANIMATION PROJECT",null]
  - [1442027068163,"49.128.148.160","パンク・ファッション",null]
  - [1442035102420,"49.181.161.0","Hazelbrook railway station",null]
  - [1442059510611,"49.183.149.106","2015 AFL finals series",null]
  - [1442045663055,"49.199.44.74","List of fictional European countries",null]
  - [1442047899247,"49.199.44.74","List of fictional European countries","List of fictional European countries"]
  - [1442051573911,"49.199.44.74","List of fictional European countries","List of fictional European countries"]
  - [1442051658029,"49.199.44.74","List of fictional European countries","List of fictional European countries"]
  - [1442055279567,"58.106.135.42","Newcastle Jets FC Youth",null]
  - [1442059004452,"58.111.155.139","Stadium Australia",null]
  - [1442048316558,"58.156.119.18","特盛!よしもと 今田・八光のおしゃべりジャングル",null]
  - [1442028373987,"58.156.158.18","ソーラーパネル",null]
  - [1442046515015,"58.174.137.134","Jarryd Hayne",null]
  - [1442055231108,"58.175.186.6","Animals in Islam",null]
  - [1442056110424,"58.175.59.60","Queer Lion",null]
  - [1442040037037,"58.183.124.153","ジュラシック・パークIII",null]
  - [1442046294050,"58.188.28.158","小山薫堂の“温故知新堂”",null]
  - [1442051739818,"58.188.28.158","平塚競技場","小山薫堂の“温故知新堂”"]
  - [1442058986459,"58.188.28.158","2015年ワールドカップバレーボール","平塚競技場"]
  - [1442065595186,"58.188.28.158","ザ・ラストヒロイン〜ワルキューレの審判〜","2015年ワールドカップバレーボール"]
  - [1442065723868,"58.188.28.158","癒し屋キリコの約束","ザ・ラストヒロイン〜ワルキューレの審判〜"]
  - [1442068144671,"58.188.28.158","地域発ドラマ","癒し屋キリコの約束"]
  - [1442068557997,"58.7.81.140","Nose gunner",null]
  - [1442056051721,"58.70.174.162","トヨタ・エスティマ",null]
  - [1442042617971,"58.89.8.10","津軽信枚",null]
  - [1442038469110,"58.93.38.113","ウエルシア薬局",null]
  - [1442072948002,"59.166.42.154","コミック乱ツインズ",null]
  - [1442034973871,"59.86.97.35","パズドラZ",null]
  - [1442071403042,"59.87.28.229","История создания сил специальных операций Армии США",null]
  - [1442072375155,"59.87.28.229","Армия США","История создания сил специальных операций Армии США"]
  - [1442027556018,"60.224.133.167","Torres Strait Islanders",null]
  - [1442018825474,"60.225.66.142","Peremptory norm",null]
  - [1442043839445,"61.200.121.189","コズミックフロント",null]
  - [1442036042205,"61.245.69.54","テレビ朝日系列日曜昼前の情報番組枠",null]
  - [1442063039021,"62.178.213.52","Cimburgis von Masowien",null]
  - [1442068687074,"77.80.5.199","Santiago Niño Becerra",null]
  - [1442088415400,"83.65.220.213","Philomena Höltkemeier Story Consulting",null]
  - [1442093778448,"90.146.48.55","Z Nation",null]
  - [1442088395645,"91.115.65.157","Al-Masdschid al-Harām",null]
