type: "operatorValidation"

sql: |
    SELECT
      countryName,
      cityName,
      __time,
      ROW_NUMBER() OVER (PARTITION BY countryName ORDER BY cityName),
      ROW_NUMBER() OVER (ORDER BY countryName desc, cityName),
      ROW_NUMBER() OVER (ORDER BY countryName, cityName),
      ROW_NUMBER() OVER (PARTITION BY cityName),
      ROW_NUMBER() OVER ()
    FROM wikipedia
    where page < '0' and channel like '#en%'

expectedOperators:
  - type: "naivePartition"
    partitionColumns: [ ]
  - type: "window"
    processor:
      type: "rowNumber"
      outputColumn: "w4"
  - type: "naiveSort"
    columns:
      - column: "cityName"
        direction: "ASC"
  - type: "naivePartition"
    partitionColumns: [ "cityName" ]
  - type: "window"
    processor:
      type: "rowNumber"
      outputColumn: "w3"
  - type: "naiveSort"
    columns:
      - column: "countryName"
        direction: "ASC"
      - column: "cityName"
        direction: "ASC"
  - type: "naivePartition"
    partitionColumns: [ ]
  - type: "window"
    processor:
      type: "rowNumber"
      outputColumn: "w2"
  - type: "naivePartition"
    partitionColumns: [ "countryName" ]
  - type: "window"
    processor:
      type: "rowNumber"
      outputColumn: "w0"
  - type: "naiveSort"
    columns:
      - column: "countryName"
        direction: "DESC"
      - column: "cityName"
        direction: "ASC"
  - type: "naivePartition"
    partitionColumns: [ ]
  - type: "window"
    processor:
      type: "rowNumber"
      outputColumn: "w1"

expectedResults:
  - ["United States","Crescent City",1442035449448,1,1,8,1,4]
  - ["Ukraine","Vinnytsya",1442100940306,1,2,7,1,8]
  - [null,null,1442019358364,1,3,1,1,1]
  - [null,null,1442021099146,2,4,2,2,2]
  - [null,null,1442033539153,3,5,3,3,3]
  - [null,null,1442095704125,4,6,4,4,5]
  - [null,null,1442096110867,5,7,5,5,6]
  - [null,null,1442100368226,6,8,6,6,7]
