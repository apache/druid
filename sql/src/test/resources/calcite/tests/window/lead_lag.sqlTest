type: "operatorValidation"

sql: |
  SELECT
    dim1,
    LAG(dim1,111) OVER ()
  FROM foo
  WHERE length(dim1) = 0 and dim1 is not null
  GROUP BY dim1

expectedOperators:
  - type: "naivePartition"
    partitionColumns: []
  - type: "window"
    processor:
      type: "composing"
      processors:
        - type: "offset"
          inputColumn: "d0"
          outputColumn: "w0"
          offset: -2
        - type: "offset"
          inputColumn: "d0"
          outputColumn: "w1"
          offset: -1
        - type: "offset"
          inputColumn: "d0"
          outputColumn: "w2"
          offset: 0
        - type: "offset"
          inputColumn: "d0"
          outputColumn: "w3"
          offset: 0
        - type: "offset"
          inputColumn: "d0"
          outputColumn: "w4"
          offset: 1
        - type: "offset"
          inputColumn: "d0"
          outputColumn: "w5"
          offset: 2
expectedResults:
  - ["",null,null,"","",null,null]
