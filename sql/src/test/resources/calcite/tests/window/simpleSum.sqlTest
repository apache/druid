type: "operatorValidation"

sql: |
    SELECT
      channel,
      cityName, 
      __time,delta,
      SUM(delta) OVER (ORDER BY __time  desc ) windowedDelta
    FROM wikipedia
    where cityName = 'Beijing'
    LIMIT 20

expectedOperators:
  - {type: "naiveSort", columns: [{column: "d0", direction: "ASC"}, {column: "d1", direction: "DESC"}]}
  - { type: "naivePartition",  partitionColumns: [ "d0" ] }
  - type: "window"
    processor:
      type: "framedAgg"
      frame: { peerType: "ROWS", lowUnbounded: false, lowOffset: 3, uppUnbounded: false, uppOffset: 2 }
      aggregations:
        - { type: "longSum", name: "w0", fieldName: "a0" }
  - { type: "naiveSort", columns: [ { column: "d1", direction: "ASC" }, { column: "a0", direction: "DESC"} ]}
  - { type: "naivePartition",  partitionColumns: [ "d1" ] }
  - type: "window"
    processor: { type: "rowNumber", outputColumn: "w1"}
