type: "operatorValidation"

sql: |
  SELECT
    --case when countryIsoCode = 'a' then 'channel' else 'asd' end,
    case when countryIsoCode = 'a' then channel else 'asd' end,
    --case when countryIsoCode = 'a' then cityName          when countryIsoCode ='x' then countryName         else 'asd' end,
    SUM(delta) c
  FROM wikipedia
  GROUP BY 1

expectedOperators:
  - { type: "naivePartition", partitionColumns: [ ] }
  - type: "window"
    processor:
      type: "framedAgg"
      frame: { peerType: "ROWS", lowUnbounded: true, lowOffset: 0, uppUnbounded: false, uppOffset: 0 }
      aggregations:
        - { type: "longSum", name: "w0", fieldName: "a0" }

expectedResults:
  - [ 946684800000, 1, 1 ]
  - [ 946771200000, 1, 2 ]
  - [ 946857600000, 1, 3 ]
  - [ 978307200000, 1, 4 ]
  - [ 978393600000, 1, 5 ]
  - [ 978480000000, 1, 6 ]
