type: "operatorValidation"

sql: |
    SELECT
      cityName,
      __time,
      ROW_NUMBER() OVER (ORDER BY cityName desc nulls last, __time ) windowedDelta,
      ROW_NUMBER() OVER (ORDER BY cityName nulls first, __time ) windowedDelta
    FROM wikipedia
    where page < '0' and channel like '#en%'

expectedOperators:
  - {type: "naiveSort", columns: [{column: "d0", direction: "ASC"}, {column: "d1", direction: "DESC"}]}
  - { type: "naivePartition",  partitionColumns: [ "d0" ] }
  - type: "window"
    processor:
      type: "framedAgg"
      frame: { peerType: "ROWS", lowUnbounded: false, lowOffset: 3, uppUnbounded: false, uppOffset: 2 }
      aggregations:
        - { type: "longSum", name: "w0", fieldName: "a0" }
  - { type: "naiveSort", columns: [ { column: "d1", direction: "ASC" }, { column: "a0", direction: "DESC"} ]}
  - { type: "naivePartition",  partitionColumns: [ "d1" ] }
  - type: "window"
    processor: { type: "rowNumber", outputColumn: "w1"}
