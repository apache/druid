# testGroupBySortPushDown case-crc:19417c11
# quidem testcase reason: AGG_COL_EXCHANGE
!set debug true
!set defaultTimeout 300000
!set maxScatterGatherBytes 9223372036854775807
!set plannerStrategy DECOUPLED
!set sqlCurrentTimestamp 2000-01-01T00:00:00Z
!set sqlQueryId dummy
!set outputformat mysql
!use druidtest:///
SELECT dim2, dim1, SUM(cnt) FROM druid.foo GROUP BY dim2, dim1 ORDER BY dim1 LIMIT 4;
+------+------+--------+
| dim2 | dim1 | EXPR$2 |
+------+------+--------+
| a    |      |      1 |
| a    | 1    |      1 |
|      | 10.1 |      1 |
|      | 2    |      1 |
+------+------+--------+
(4 rows)

!ok
LogicalProject(dim2=[$1], dim1=[$0], EXPR$2=[$2])
  LogicalSort(sort0=[$0], dir0=[ASC], fetch=[4])
    LogicalAggregate(group=[{1, 2}], EXPR$2=[SUM($4)])
      LogicalTableScan(table=[[druid, foo]])

!logicalPlan
DruidProject(dim2=[$1], dim1=[$0], EXPR$2=[$2], druid=[logical])
  DruidSort(sort0=[$0], dir0=[ASC], fetch=[4], druid=[logical])
    DruidAggregate(group=[{1, 2}], EXPR$2=[SUM($4)], druid=[logical])
      DruidTableScan(table=[[druid, foo]], druid=[logical])

!druidPlan
