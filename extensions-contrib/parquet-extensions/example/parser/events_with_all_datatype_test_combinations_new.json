{
  "type": "index_hadoop",
  "spec": {
    "dataSchema": {
      "dataSource": "test_datasource",
      "parser": {
        "type": "parquet",
        "binaryAsString": true,
        "parquetParser": {
          "fields": [
            {
              "key": "eventId",
              "fieldType": "STRING"
            },
            {
              "key": "eventTimestamp",
              "fieldType": "LONG"
            },
            {
              "rootFieldName": "attributes",
              "key": "geo",
              "fieldType": "MAP",
              "dimensionName": "valid_map_access"
            },
            {
              "rootFieldName": "attributes",
              "key": "non_existing_key",
              "fieldType": "MAP",
              "dimensionName": "max_access_with_non_existing_key"
            },
            {
              "rootFieldName": "un_available_map",
              "key": "attrA",
              "fieldType": "MAP",
              "dimensionName": "max_access_with_un_available_map"
            },
            {
              "key": "referenceIds",
              "fieldType": "LIST",
              "index": 1,
              "dimensionName": "array_access_with_index"
            },
            {
              "key": "referenceIds",
              "fieldType": "LIST",
              "dimensionName": "array_access_with_default_index"
            },
            {
              "key": "referenceIds",
              "fieldType": "LIST",
              "index": 3,
              "dimensionName": "array_access_with_overbound_index"
            },
            {
              "key": "referenceIds",
              "fieldType": "LIST",
              "dimensionName": "reference_ids"
            },
            {
              "key": "headers_tmp",
              "fieldType": "UNION",
              "field": {
                "key": "member1",
                "rootFieldName": "member1",
                "fieldType": "STRUCT",
                "index": 1
              },
              "dimensionName": "union_attribute"
            },
            {
              "key": "tags",
              "fieldType": "LIST",
              "field": {
                "key": "tagId",
                "fieldType": "STRUCT"
              },
              "dimensionName": "tag_ids"
            },
            {
              "key": "tags",
              "fieldType": "LIST",
              "field": {
                "key": "tagCostAttributes",
                "fieldType": "STRUCT",
                "field": {
                  "key": "CostA",
                  "fieldType": "MAP",
                  "rootFieldName": "tagCostAttributes"
                }
              },
              "dimensionName": "cost_a"
            },
            {
              "key": "tags",
              "fieldType": "LIST",
              "index": 0,
              "field": {
                "key": "CostB",
                "fieldType": "MAP",
                "rootFieldName": "tagCostAttributes"
              },
              "dimensionName": "cost_b_1st_tag"
            },
            {
              "key": "tags",
              "fieldType": "LIST",
              "index": 1,
              "field": {
                "key": "CostB",
                "fieldType": "MAP",
                "rootFieldName": "tagCostAttributes"
              },
              "dimensionName": "cost_b_2nd_tag"
            }
          ]
        },
        "parseSpec": {
          "format": "timeAndDims",
          "timestampSpec": {
            "column": "eventTimestamp",
            "format": "millis"
          },
          "dimensionsSpec": {
            "dimensions": [
              "eventId",
              "valid_map_access",
              "max_access_with_non_existing_key",
              "max_access_with_un_available_map",
              "array_access_with_index",
              "array_access_with_default_index",
              "array_access_with_overbound_index",
              "union_attribute",
              "tag_ids",
              "reference_ids",
              "cost_a",
              "cost_b_1st_tag"
            ],
            "dimensionExclusions": [
            ],
            "spatialDimensions": [
            ]
          }
        }
      },
      "metricsSpec": [
        {
          "type": "count",
          "name": "count"
        },
        {
          "type": "doubleSum",
          "name": "cost_b_2nd_tag_sum",
          "fieldName": "cost_b_2nd_tag"
        }
      ],
      "granularitySpec": {
        "type": "uniform",
        "segmentGranularity": "DAY",
        "queryGranularity": "DAY",
        "rollup": true,
        "intervals": [
          "2017-07-26T00:00:00.000Z/2017-07-27T00:59:59.000Z"
        ]
      }
    },
    "ioConfig": {
      "type": "hadoop",
      "inputSpec": {
        "type": "static",
        "inputFormat": "io.druid.data.input.parquet.DruidParquetInputFormat",
        "paths": "example/events/events_with_all_datatypes.parquet"
      },
      "segmentOutputPath": "/tmp/segments"
    },
    "tuningConfig": {
      "type": "hadoop",
      "workingPath": "tmp/working_path",
      "version": "2017-02-09T07:36:09.249Z",
      "partitionsSpec": {
        "type": "hashed",
        "targetPartitionSize": 750000,
        "maxPartitionSize": 750000,
        "assumeGrouped": false,
        "numShards": -1,
        "partitionDimensions": [
        ]
      },
      "shardSpecs": {
      },
      "indexSpec": {
        "bitmap": {
          "type": "concise"
        },
        "dimensionCompression": "lz4",
        "metricCompression": "lz4",
        "longEncoding": "longs"
      },
      "maxRowsInMemory": 75000,
      "leaveIntermediate": true,
      "cleanupOnFailure": true,
      "overwriteFiles": false,
      "ignoreInvalidRows": false,
      "jobProperties": {
        "hdp.version": "2.5.3.58-3",
        "mapreduce.job.user.classpath.first": "true",
        "mapreduce.task.timeout": "1800000",
        "mapreduce.map.memory.mb": "2048",
        "mapreduce.map.java.opts": "-server -Xmx3072m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
        "mapreduce.reduce.memory.mb": "2048",
        "mapreduce.reduce.java.opts": "-server -Xmx8192m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
        "mapreduce.job.queuename": "experimentation",
        "mapred.child.ulimit": "16777216",
        "mapreduce.map.output.compress": "true",
        "mapred.map.output.compress.codec": "org.apache.hadoop.io.compress.GzipCodec"
      },
      "combineText": false,
      "useCombiner": false,
      "buildV9Directly": false,
      "numBackgroundPersistThreads": 0,
      "forceExtendableShardSpecs": false
    },
    "uniqueId": "715f31321096480b869aca2cc9c5d252"
  },
  "hadoopDependencyCoordinates": [
    "org.apache.hadoop:hadoop-client:2.6.0"
  ]
}