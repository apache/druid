[
  {
    "suite_name": "test_map_validations",
    "description": "Test Map data type validations",
    "druid_spec": {
      "type": "index_hadoop",
      "spec": {
        "dataSchema": {
          "dataSource": "test_datasource",
          "parser": {
            "type": "parquet",
            "binaryAsString": true,
            "parquetParser": {
              "fields": [
                {
                  "key": "map_key",
                  "rootFieldName": "root_map_key",
                  "fieldType": "MAP",
                  "dimensionName": "dimension_1"
                },
                {
                  "key": "utf8type_string",
                  "fieldType": "UTF8"
                }
              ]
            },
            "parseSpec": {
              "format": "timeAndDims",
              "timestampSpec": {
                "column": "eventTimestamp",
                "format": "millis"
              },
              "dimensionsSpec": {
                "dimensions": [
                  "dimension_1",
                  "utf8type_string"
                ],
                "dimensionExclusions": [
                ],
                "spatialDimensions": [
                ]
              }
            }
          },
          "metricsSpec": [
            {
              "type": "count",
              "name": "count"
            }
          ],
          "granularitySpec": {
            "type": "uniform",
            "segmentGranularity": "DAY",
            "queryGranularity": "DAY",
            "rollup": true,
            "intervals": [
              "2017-07-26T00:00:00.000Z/2017-07-27T00:59:59.000Z"
            ]
          }
        },
        "ioConfig": {
          "type": "hadoop",
          "inputSpec": {
            "type": "static",
            "inputFormat": "io.druid.data.input.parquet.DruidParquetInputFormat",
            "paths": "example/events/events_with_all_datatypes.parquet"
          },
          "segmentOutputPath": "/tmp/segments"
        },
        "tuningConfig": {
          "type": "hadoop",
          "workingPath": "tmp/working_path",
          "version": "2017-02-09T07:36:09.249Z",
          "partitionsSpec": {
            "type": "hashed",
            "targetPartitionSize": 750000,
            "maxPartitionSize": 750000,
            "assumeGrouped": false,
            "numShards": -1,
            "partitionDimensions": [
            ]
          },
          "shardSpecs": {
          },
          "indexSpec": {
            "bitmap": {
              "type": "concise"
            },
            "dimensionCompression": "lz4",
            "metricCompression": "lz4",
            "longEncoding": "longs"
          },
          "maxRowsInMemory": 75000,
          "leaveIntermediate": true,
          "cleanupOnFailure": true,
          "overwriteFiles": false,
          "ignoreInvalidRows": false,
          "jobProperties": {
            "hdp.version": "2.5.3.58-3",
            "mapreduce.job.user.classpath.first": "true",
            "mapreduce.task.timeout": "1800000",
            "mapreduce.map.memory.mb": "2048",
            "mapreduce.map.java.opts": "-server -Xmx3072m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.reduce.memory.mb": "2048",
            "mapreduce.reduce.java.opts": "-server -Xmx8192m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.job.queuename": "experimentation",
            "mapred.child.ulimit": "16777216",
            "mapreduce.map.output.compress": "true",
            "mapred.map.output.compress.codec": "org.apache.hadoop.io.compress.GzipCodec"
          },
          "combineText": false,
          "useCombiner": false,
          "buildV9Directly": false,
          "numBackgroundPersistThreads": 0,
          "forceExtendableShardSpecs": false
        },
        "uniqueId": "715f31321096480b869aca2cc9c5d252"
      },
      "hadoopDependencyCoordinates": [
        "org.apache.hadoop:hadoop-client:2.6.0"
      ]
    }
  },
  {
    "suite_name": "test_map_with_empty_field",
    "description": "Test Map data type validations with empty field",
    "druid_spec": {
      "type": "index_hadoop",
      "spec": {
        "dataSchema": {
          "dataSource": "test_datasource",
          "parser": {
            "type": "parquet",
            "binaryAsString": true,
            "parquetParser": {
              "fields": [
              ]
            },
            "parseSpec": {
              "format": "timeAndDims",
              "timestampSpec": {
                "column": "eventTimestamp",
                "format": "millis"
              },
              "dimensionsSpec": {
                "dimensions": [
                  "dimension_1"
                ],
                "dimensionExclusions": [
                ],
                "spatialDimensions": [
                ]
              }
            }
          },
          "metricsSpec": [
            {
              "type": "count",
              "name": "count"
            },
            {
              "type": "doubleSum",
              "name": "cost_b_2nd_tag_sum",
              "fieldName": "cost_b_2nd_tag"
            }
          ],
          "granularitySpec": {
            "type": "uniform",
            "segmentGranularity": "DAY",
            "queryGranularity": "DAY",
            "rollup": true,
            "intervals": [
              "2017-07-26T00:00:00.000Z/2017-07-27T00:59:59.000Z"
            ]
          }
        },
        "ioConfig": {
          "type": "hadoop",
          "inputSpec": {
            "type": "static",
            "inputFormat": "io.druid.data.input.parquet.DruidParquetInputFormat",
            "paths": "example/events/events_with_all_datatypes.parquet"
          },
          "segmentOutputPath": "/tmp/segments"
        },
        "tuningConfig": {
          "type": "hadoop",
          "workingPath": "tmp/working_path",
          "version": "2017-02-09T07:36:09.249Z",
          "partitionsSpec": {
            "type": "hashed",
            "targetPartitionSize": 750000,
            "maxPartitionSize": 750000,
            "assumeGrouped": false,
            "numShards": -1,
            "partitionDimensions": [
            ]
          },
          "shardSpecs": {
          },
          "indexSpec": {
            "bitmap": {
              "type": "concise"
            },
            "dimensionCompression": "lz4",
            "metricCompression": "lz4",
            "longEncoding": "longs"
          },
          "maxRowsInMemory": 75000,
          "leaveIntermediate": true,
          "cleanupOnFailure": true,
          "overwriteFiles": false,
          "ignoreInvalidRows": false,
          "jobProperties": {
            "hdp.version": "2.5.3.58-3",
            "mapreduce.job.user.classpath.first": "true",
            "mapreduce.task.timeout": "1800000",
            "mapreduce.map.memory.mb": "2048",
            "mapreduce.map.java.opts": "-server -Xmx3072m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.reduce.memory.mb": "2048",
            "mapreduce.reduce.java.opts": "-server -Xmx8192m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.job.queuename": "experimentation",
            "mapred.child.ulimit": "16777216",
            "mapreduce.map.output.compress": "true",
            "mapred.map.output.compress.codec": "org.apache.hadoop.io.compress.GzipCodec"
          },
          "combineText": false,
          "useCombiner": false,
          "buildV9Directly": false,
          "numBackgroundPersistThreads": 0,
          "forceExtendableShardSpecs": false
        },
        "uniqueId": "715f31321096480b869aca2cc9c5d252"
      },
      "hadoopDependencyCoordinates": [
        "org.apache.hadoop:hadoop-client:2.6.0"
      ]
    }
  },
  {
    "suite_name": "test_nested_map",
    "description": "Test Nested map lookup",
    "druid_spec": {
      "type": "index_hadoop",
      "spec": {
        "dataSchema": {
          "dataSource": "test_datasource",
          "parser": {
            "type": "parquet",
            "binaryAsString": true,
            "parquetParser": {
              "fields": [
                {
                  "key": "map_key",
                  "rootFieldName": "root_map_key",
                  "fieldType": "MAP",
                  "field": {
                    "key": "child1_key",
                    "rootFieldName": "map_key",
                    "fieldType": "MAP",
                    "field": {
                      "key": "child2_key",
                      "rootFieldName": "map_key",
                      "fieldType": "MAP"
                    }
                  },
                  "dimensionName": "dimension_1"
                }
              ]
            },
            "parseSpec": {
              "format": "timeAndDims",
              "timestampSpec": {
                "column": "eventTimestamp",
                "format": "millis"
              },
              "dimensionsSpec": {
                "dimensions": [
                  "dimension_1"
                ],
                "dimensionExclusions": [
                ],
                "spatialDimensions": [
                ]
              }
            }
          },
          "metricsSpec": [
            {
              "type": "count",
              "name": "count"
            },
            {
              "type": "doubleSum",
              "name": "cost_b_2nd_tag_sum",
              "fieldName": "cost_b_2nd_tag"
            }
          ],
          "granularitySpec": {
            "type": "uniform",
            "segmentGranularity": "DAY",
            "queryGranularity": "DAY",
            "rollup": true,
            "intervals": [
              "2017-07-26T00:00:00.000Z/2017-07-27T00:59:59.000Z"
            ]
          }
        },
        "ioConfig": {
          "type": "hadoop",
          "inputSpec": {
            "type": "static",
            "inputFormat": "io.druid.data.input.parquet.DruidParquetInputFormat",
            "paths": "example/events/events_with_all_datatypes.parquet"
          },
          "segmentOutputPath": "/tmp/segments"
        },
        "tuningConfig": {
          "type": "hadoop",
          "workingPath": "tmp/working_path",
          "version": "2017-02-09T07:36:09.249Z",
          "partitionsSpec": {
            "type": "hashed",
            "targetPartitionSize": 750000,
            "maxPartitionSize": 750000,
            "assumeGrouped": false,
            "numShards": -1,
            "partitionDimensions": [
            ]
          },
          "shardSpecs": {
          },
          "indexSpec": {
            "bitmap": {
              "type": "concise"
            },
            "dimensionCompression": "lz4",
            "metricCompression": "lz4",
            "longEncoding": "longs"
          },
          "maxRowsInMemory": 75000,
          "leaveIntermediate": true,
          "cleanupOnFailure": true,
          "overwriteFiles": false,
          "ignoreInvalidRows": false,
          "jobProperties": {
            "hdp.version": "2.5.3.58-3",
            "mapreduce.job.user.classpath.first": "true",
            "mapreduce.task.timeout": "1800000",
            "mapreduce.map.memory.mb": "2048",
            "mapreduce.map.java.opts": "-server -Xmx3072m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.reduce.memory.mb": "2048",
            "mapreduce.reduce.java.opts": "-server -Xmx8192m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.job.queuename": "experimentation",
            "mapred.child.ulimit": "16777216",
            "mapreduce.map.output.compress": "true",
            "mapred.map.output.compress.codec": "org.apache.hadoop.io.compress.GzipCodec"
          },
          "combineText": false,
          "useCombiner": false,
          "buildV9Directly": false,
          "numBackgroundPersistThreads": 0,
          "forceExtendableShardSpecs": false
        },
        "uniqueId": "715f31321096480b869aca2cc9c5d252"
      },
      "hadoopDependencyCoordinates": [
        "org.apache.hadoop:hadoop-client:2.6.0"
      ]
    }
  },
  {
    "suite_name": "test_dimensions_in_both_parser_spec_and_as_parquet_column",
    "description": "test_dimensions_in_both_parser_spec_and_as_parquet_column",
    "druid_spec": {
      "type": "index_hadoop",
      "spec": {
        "dataSchema": {
          "dataSource": "test_datasource",
          "parser": {
            "type": "parquet",
            "binaryAsString": true,
            "parquetParser": {
              "fields": [
                {
                  "key": "map_key",
                  "rootFieldName": "root_map_key",
                  "fieldType": "MAP",
                  "dimensionName": "dimension_1"
                },
                {
                  "key": "utf8type_string",
                  "fieldType": "UTF8"
                }
              ]
            },
            "parseSpec": {
              "format": "timeAndDims",
              "timestampSpec": {
                "column": "eventTimestamp",
                "format": "millis"
              },
              "dimensionsSpec": {
                "dimensions": [
                  "dimension_1",
                  "utf8type_string",
                  "long_column",
                  "double_column",
                  "string_column"
                ],
                "dimensionExclusions": [
                ],
                "spatialDimensions": [
                ]
              }
            }
          },
          "metricsSpec": [
            {
              "type": "count",
              "name": "count"
            }
          ],
          "granularitySpec": {
            "type": "uniform",
            "segmentGranularity": "DAY",
            "queryGranularity": "DAY",
            "rollup": true,
            "intervals": [
              "2017-07-26T00:00:00.000Z/2017-07-27T00:59:59.000Z"
            ]
          }
        },
        "ioConfig": {
          "type": "hadoop",
          "inputSpec": {
            "type": "static",
            "inputFormat": "io.druid.data.input.parquet.DruidParquetInputFormat",
            "paths": "example/events/events_with_all_datatypes.parquet"
          },
          "segmentOutputPath": "/tmp/segments"
        },
        "tuningConfig": {
          "type": "hadoop",
          "workingPath": "tmp/working_path",
          "version": "2017-02-09T07:36:09.249Z",
          "partitionsSpec": {
            "type": "hashed",
            "targetPartitionSize": 750000,
            "maxPartitionSize": 750000,
            "assumeGrouped": false,
            "numShards": -1,
            "partitionDimensions": [
            ]
          },
          "shardSpecs": {
          },
          "indexSpec": {
            "bitmap": {
              "type": "concise"
            },
            "dimensionCompression": "lz4",
            "metricCompression": "lz4",
            "longEncoding": "longs"
          },
          "maxRowsInMemory": 75000,
          "leaveIntermediate": true,
          "cleanupOnFailure": true,
          "overwriteFiles": false,
          "ignoreInvalidRows": false,
          "jobProperties": {
            "hdp.version": "2.5.3.58-3",
            "mapreduce.job.user.classpath.first": "true",
            "mapreduce.task.timeout": "1800000",
            "mapreduce.map.memory.mb": "2048",
            "mapreduce.map.java.opts": "-server -Xmx3072m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.reduce.memory.mb": "2048",
            "mapreduce.reduce.java.opts": "-server -Xmx8192m -Duser.timezone=UTC -Dfile.encoding=UTF-8",
            "mapreduce.job.queuename": "experimentation",
            "mapred.child.ulimit": "16777216",
            "mapreduce.map.output.compress": "true",
            "mapred.map.output.compress.codec": "org.apache.hadoop.io.compress.GzipCodec"
          },
          "combineText": false,
          "useCombiner": false,
          "buildV9Directly": false,
          "numBackgroundPersistThreads": 0,
          "forceExtendableShardSpecs": false
        },
        "uniqueId": "715f31321096480b869aca2cc9c5d252"
      },
      "hadoopDependencyCoordinates": [
        "org.apache.hadoop:hadoop-client:2.6.0"
      ]
    }
  }
]