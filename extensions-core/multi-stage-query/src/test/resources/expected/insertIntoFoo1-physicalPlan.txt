{
  "type" : "query_controller",
  "id" : "query-test-query",
  "spec" : {
    "query" : {
      "queryType" : "groupBy",
      "dataSource" : {
        "type" : "table",
        "name" : "foo"
      },
      "intervals" : {
        "type" : "intervals",
        "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
      },
      "virtualColumns" : [ {
        "type" : "expression",
        "name" : "v0",
        "expression" : "timestamp_floor(\"__time\",'P1D',null,'UTC')",
        "outputType" : "LONG"
      } ],
      "filter" : {
        "type" : "not",
        "field" : {
          "type" : "selector",
          "dimension" : "dim1",
          "value" : null
        }
      },
      "granularity" : {
        "type" : "all"
      },
      "dimensions" : [ {
        "type" : "default",
        "dimension" : "v0",
        "outputName" : "d0",
        "outputType" : "LONG"
      }, {
        "type" : "default",
        "dimension" : "dim1",
        "outputName" : "d1",
        "outputType" : "STRING"
      } ],
      "aggregations" : [ {
        "type" : "count",
        "name" : "a0"
      } ],
      "limitSpec" : {
        "type" : "default",
        "columns" : [ {
          "dimension" : "d1",
          "direction" : "ascending",
          "dimensionOrder" : {
            "type" : "lexicographic"
          }
        } ]
      },
      "context" : {
        "finalize" : true,
        "sqlInsertSegmentGranularity" : "\"DAY\"",
        "sqlQueryId" : "test-query",
        "timestampResultField" : "d0",
        "timestampResultFieldGranularity" : "\"DAY\"",
        "timestampResultFieldInOriginalDimensions" : 0
      }
    },
    "columnMappings" : [ {
      "queryColumn" : "d0",
      "outputColumn" : "__time"
    }, {
      "queryColumn" : "d1",
      "outputColumn" : "dim1"
    }, {
      "queryColumn" : "a0",
      "outputColumn" : "cnt"
    } ],
    "destination" : {
      "type" : "dataSource",
      "dataSource" : "foo1",
      "segmentGranularity" : "DAY"
    },
    "assignmentStrategy" : "max",
    "tuningConfig" : {
      "maxNumWorkers" : 1,
      "maxRowsInMemory" : 100000,
      "rowsPerSegment" : 3000000
    }
  },
  "sqlQuery" : "insert into foo1 select  floor(__time to day) as __time , dim1 , count(*) as cnt from foo where dim1 is not null group by 1, 2 PARTITIONED by day clustered by dim1",
  "sqlQueryContext" : {
    "finalize" : true,
    "maxParseExceptions" : 0,
    "sqlQueryId" : "test-query",
    "sqlInsertSegmentGranularity" : "\"DAY\""
  },
  "sqlTypeNames" : [ "TIMESTAMP", "VARCHAR", "BIGINT" ],
  "context" : {
    "forceTimeChunkLock" : true
  },
  "storageTypes" : {
    "__time" : "LONG",
    "dim1" : "STRING",
    "cnt" : "LONG"
  },
  "groupId" : "query-test-query",
  "dataSource" : "foo1",
  "resource" : {
    "availabilityGroup" : "query-test-query",
    "requiredCapacity" : 1
  }
}
