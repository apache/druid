<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.21) on Mon Feb 12 22:16:29 UTC 2024 -->
<title>QuorumCnxManager (Apache ZooKeeper - Server 3.8.4 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2024-02-12">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="QuorumCnxManager (Apache ZooKeeper - Server 3.8.4 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/QuorumCnxManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.zookeeper.server.quorum</a></div>
<h2 title="Class QuorumCnxManager" class="title">Class QuorumCnxManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.zookeeper.server.quorum.QuorumCnxManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">QuorumCnxManager</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">This class implements a connection manager for leader election using TCP. It
 maintains one connection for every pair of servers. The tricky part is to
 guarantee that there is exactly one connection for every pair of servers that
 are operating correctly and that can communicate over the network.

 If two servers try to start a connection concurrently, then the connection
 manager uses a very simple tie-breaking mechanism to decide which connection
 to drop based on the IP addressed of the two parties.

 For every peer, the manager maintains a queue of messages to send. If the
 connection to any particular peer drops, then the sender thread puts the
 message back on the list. As this implementation currently uses a queue
 implementation to maintain messages to send to another peer, we add the
 message to the tail of the queue, thus changing the order of messages.
 Although this is not a problem for the leader election, it could be a problem
 when consolidating peer communication. This is to be verified, though.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="QuorumCnxManager.InitialMessage.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.InitialMessage</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="QuorumCnxManager.Listener.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Listener</a></span></code></th>
<td class="colLast">
<div class="block">Thread to listen on some ports</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="QuorumCnxManager.Listener.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Listener</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#listener">listener</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#maxBuffer">maxBuffer</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROTOCOL_VERSION_V1">PROTOCOL_VERSION_V1</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROTOCOL_VERSION_V2">PROTOCOL_VERSION_V2</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">BlockingQueue</a>&lt;<a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recvQueue">recvQueue</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.apache.zookeeper.server.quorum.QuorumPeer,long,java.util.Map,org.apache.zookeeper.server.quorum.auth.QuorumAuthServer,org.apache.zookeeper.server.quorum.auth.QuorumAuthLearner,int,boolean,int,boolean)">QuorumCnxManager</a></span>&#8203;(<a href="QuorumPeer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer</a>&nbsp;self,
                long&nbsp;mySid,
                <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>,&#8203;<a href="QuorumPeer.QuorumServer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer.QuorumServer</a>&gt;&nbsp;view,
                <a href="auth/QuorumAuthServer.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthServer</a>&nbsp;authServer,
                <a href="auth/QuorumAuthLearner.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthLearner</a>&nbsp;authLearner,
                int&nbsp;socketTimeout,
                boolean&nbsp;listenOnAllIPs,
                int&nbsp;quorumCnxnThreadsSize,
                boolean&nbsp;quorumSaslAuthEnabled)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addToRecvQueue(org.apache.zookeeper.server.quorum.QuorumCnxManager.Message)">addToRecvQueue</a></span>&#8203;(<a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&nbsp;msg)</code></th>
<td class="colLast">
<div class="block">Inserts an element in the <a href="#recvQueue"><code>recvQueue</code></a>.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#connectAll()">connectAll</a></span>()</code></th>
<td class="colLast">
<div class="block">Try to establish a connection with each server if one
 doesn't exist.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#connectedToPeer(long)">connectedToPeer</a></span>&#8203;(long&nbsp;peerSid)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getConnectionThreadCount()">getConnectionThreadCount</a></span>()</code></th>
<td class="colLast">
<div class="block">Return number of connection processing threads.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getThreadCount()">getThreadCount</a></span>()</code></th>
<td class="colLast">
<div class="block">Return number of worker threads</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#halt()">halt</a></span>()</code></th>
<td class="colLast">
<div class="block">Flag that it is time to wrap up all activities and interrupt the listener.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initiateConnection(org.apache.zookeeper.server.quorum.MultipleAddresses,java.lang.Long)">initiateConnection</a></span>&#8203;(<a href="MultipleAddresses.html" title="class in org.apache.zookeeper.server.quorum">MultipleAddresses</a>&nbsp;electionAddr,
                  <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;sid)</code></th>
<td class="colLast">
<div class="block">First we create the socket, perform SSL handshake and authentication if needed.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initiateConnectionAsync(org.apache.zookeeper.server.quorum.MultipleAddresses,java.lang.Long)">initiateConnectionAsync</a></span>&#8203;(<a href="MultipleAddresses.html" title="class in org.apache.zookeeper.server.quorum">MultipleAddresses</a>&nbsp;electionAddr,
                       <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;sid)</code></th>
<td class="colLast">
<div class="block">Server will initiate the connection request to its peer server
 asynchronously via separate connection thread.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isReconfigEnabled()">isReconfigEnabled</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pollRecvQueue(long,java.util.concurrent.TimeUnit)">pollRecvQueue</a></span>&#8203;(long&nbsp;timeout,
             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">TimeUnit</a>&nbsp;unit)</code></th>
<td class="colLast">
<div class="block">Retrieves and removes a message at the head of this queue,
 waiting up to the specified wait time if necessary for an element to
 become available.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#receiveConnection(java.net.Socket)">receiveConnection</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net" class="externalLink">Socket</a>&nbsp;sock)</code></th>
<td class="colLast">
<div class="block">If this server receives a connection request, then it gives up on the new
 connection if it wins.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#receiveConnectionAsync(java.net.Socket)">receiveConnectionAsync</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net" class="externalLink">Socket</a>&nbsp;sock)</code></th>
<td class="colLast">
<div class="block">Server receives a connection request and handles it asynchronously via
 separate thread.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#softHalt()">softHalt</a></span>()</code></th>
<td class="colLast">
<div class="block">A soft halt simply finishes workers.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#testInitiateConnection(long)">testInitiateConnection</a></span>&#8203;(long&nbsp;sid)</code></th>
<td class="colLast">
<div class="block">Invokes initiateConnection for testing purposes</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toSend(java.lang.Long,java.nio.ByteBuffer)">toSend</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;sid,
      <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio" class="externalLink">ByteBuffer</a>&nbsp;b)</code></th>
<td class="colLast">
<div class="block">Processes invoke this message to queue a message to send.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="PROTOCOL_VERSION_V1">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROTOCOL_VERSION_V1</h4>
<pre>public static final&nbsp;long PROTOCOL_VERSION_V1</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.zookeeper.server.quorum.QuorumCnxManager.PROTOCOL_VERSION_V1">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROTOCOL_VERSION_V2">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROTOCOL_VERSION_V2</h4>
<pre>public static final&nbsp;long PROTOCOL_VERSION_V2</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.zookeeper.server.quorum.QuorumCnxManager.PROTOCOL_VERSION_V2">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="maxBuffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxBuffer</h4>
<pre>public static final&nbsp;int maxBuffer</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.zookeeper.server.quorum.QuorumCnxManager.maxBuffer">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="recvQueue">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recvQueue</h4>
<pre>public final&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">BlockingQueue</a>&lt;<a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&gt; recvQueue</pre>
</li>
</ul>
<a id="listener">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>listener</h4>
<pre>public final&nbsp;<a href="QuorumCnxManager.Listener.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Listener</a> listener</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(org.apache.zookeeper.server.quorum.QuorumPeer,long,java.util.Map,org.apache.zookeeper.server.quorum.auth.QuorumAuthServer,org.apache.zookeeper.server.quorum.auth.QuorumAuthLearner,int,boolean,int,boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>QuorumCnxManager</h4>
<pre>public&nbsp;QuorumCnxManager&#8203;(<a href="QuorumPeer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer</a>&nbsp;self,
                        long&nbsp;mySid,
                        <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>,&#8203;<a href="QuorumPeer.QuorumServer.html" title="class in org.apache.zookeeper.server.quorum">QuorumPeer.QuorumServer</a>&gt;&nbsp;view,
                        <a href="auth/QuorumAuthServer.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthServer</a>&nbsp;authServer,
                        <a href="auth/QuorumAuthLearner.html" title="interface in org.apache.zookeeper.server.quorum.auth">QuorumAuthLearner</a>&nbsp;authLearner,
                        int&nbsp;socketTimeout,
                        boolean&nbsp;listenOnAllIPs,
                        int&nbsp;quorumCnxnThreadsSize,
                        boolean&nbsp;quorumSaslAuthEnabled)</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="testInitiateConnection(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>testInitiateConnection</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;testInitiateConnection&#8203;(long&nbsp;sid)</pre>
<div class="block">Invokes initiateConnection for testing purposes</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sid</code> - </dd>
</dl>
</li>
</ul>
<a id="initiateConnection(org.apache.zookeeper.server.quorum.MultipleAddresses,java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initiateConnection</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;initiateConnection&#8203;(<a href="MultipleAddresses.html" title="class in org.apache.zookeeper.server.quorum">MultipleAddresses</a>&nbsp;electionAddr,
                               <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;sid)</pre>
<div class="block">First we create the socket, perform SSL handshake and authentication if needed.
 Then we perform the initiation protocol.
 If this server has initiated the connection, then it gives up on the
 connection if it loses challenge. Otherwise, it keeps the connection.</div>
</li>
</ul>
<a id="initiateConnectionAsync(org.apache.zookeeper.server.quorum.MultipleAddresses,java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initiateConnectionAsync</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;initiateConnectionAsync&#8203;(<a href="MultipleAddresses.html" title="class in org.apache.zookeeper.server.quorum">MultipleAddresses</a>&nbsp;electionAddr,
                                       <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;sid)</pre>
<div class="block">Server will initiate the connection request to its peer server
 asynchronously via separate connection thread.</div>
</li>
</ul>
<a id="receiveConnection(java.net.Socket)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>receiveConnection</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;receiveConnection&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net" class="externalLink">Socket</a>&nbsp;sock)</pre>
<div class="block">If this server receives a connection request, then it gives up on the new
 connection if it wins. Notice that it checks whether it has a connection
 to this server already or not. If it does, then it sends the smallest
 possible long value to lose the challenge.</div>
</li>
</ul>
<a id="receiveConnectionAsync(java.net.Socket)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>receiveConnectionAsync</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;receiveConnectionAsync&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html?is-external=true" title="class or interface in java.net" class="externalLink">Socket</a>&nbsp;sock)</pre>
<div class="block">Server receives a connection request and handles it asynchronously via
 separate thread.</div>
</li>
</ul>
<a id="toSend(java.lang.Long,java.nio.ByteBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toSend</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;toSend&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;sid,
                   <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio" class="externalLink">ByteBuffer</a>&nbsp;b)</pre>
<div class="block">Processes invoke this message to queue a message to send. Currently,
 only leader election uses it.</div>
</li>
</ul>
<a id="connectAll()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connectAll</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;connectAll()</pre>
<div class="block">Try to establish a connection with each server if one
 doesn't exist.</div>
</li>
</ul>
<a id="halt()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>halt</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;halt()</pre>
<div class="block">Flag that it is time to wrap up all activities and interrupt the listener.</div>
</li>
</ul>
<a id="softHalt()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>softHalt</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;softHalt()</pre>
<div class="block">A soft halt simply finishes workers.</div>
</li>
</ul>
<a id="getThreadCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getThreadCount</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getThreadCount()</pre>
<div class="block">Return number of worker threads</div>
</li>
</ul>
<a id="getConnectionThreadCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConnectionThreadCount</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getConnectionThreadCount()</pre>
<div class="block">Return number of connection processing threads.</div>
</li>
</ul>
<a id="addToRecvQueue(org.apache.zookeeper.server.quorum.QuorumCnxManager.Message)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addToRecvQueue</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;addToRecvQueue&#8203;(<a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&nbsp;msg)</pre>
<div class="block">Inserts an element in the <a href="#recvQueue"><code>recvQueue</code></a>. If the Queue is full, this
 methods removes an element from the head of the Queue and then inserts the
 element at the tail of the queue.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>msg</code> - Reference to the message to be inserted in the queue</dd>
</dl>
</li>
</ul>
<a id="pollRecvQueue(long,java.util.concurrent.TimeUnit)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pollRecvQueue</h4>
<pre class="methodSignature">public&nbsp;<a href="QuorumCnxManager.Message.html" title="class in org.apache.zookeeper.server.quorum">QuorumCnxManager.Message</a>&nbsp;pollRecvQueue&#8203;(long&nbsp;timeout,
                                              <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">TimeUnit</a>&nbsp;unit)
                                       throws <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang" class="externalLink">InterruptedException</a></pre>
<div class="block">Retrieves and removes a message at the head of this queue,
 waiting up to the specified wait time if necessary for an element to
 become available.

 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html?is-external=true#poll-long-java.util.concurrent.TimeUnit-" title="class or interface in java.util.concurrent" class="externalLink"><code>BlockingQueue.poll(long, java.util.concurrent.TimeUnit)</code></a></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang" class="externalLink">InterruptedException</a></code></dd>
</dl>
</li>
</ul>
<a id="connectedToPeer(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connectedToPeer</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;connectedToPeer&#8203;(long&nbsp;peerSid)</pre>
</li>
</ul>
<a id="isReconfigEnabled()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isReconfigEnabled</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;isReconfigEnabled()</pre>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/QuorumCnxManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2008&#x2013;2024 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
