{
  "queryType" : "windowOperator",
  "dataSource" : {
    "type" : "join",
    "left" : {
      "type" : "query",
      "query" : {
        "queryType" : "topN",
        "dataSource" : {
          "type" : "table",
          "name" : "foo"
        },
        "dimension" : {
          "type" : "default",
          "dimension" : "dim1",
          "outputName" : "d0",
          "outputType" : "STRING"
        },
        "metric" : {
          "type" : "numeric",
          "metric" : "a0"
        },
        "threshold" : 200,
        "intervals" : {
          "type" : "intervals",
          "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
        },
        "granularity" : {
          "type" : "all"
        },
        "aggregations" : [ {
          "type" : "count",
          "name" : "a0"
        } ],
        "context" : {
          "debug" : "true",
          "enableWindowing" : "true",
          "outputformat" : "MYSQL",
          "plannerStrategy" : "DECOUPLED",
          "sqlQueryId" : "82ec0abd-1c78-40c3-8510-96850b00a5a7",
          "sqlStringifyArrays" : false
        }
      }
    },
    "right" : {
      "type" : "query",
      "query" : {
        "queryType" : "topN",
        "dataSource" : {
          "type" : "table",
          "name" : "numfoo"
        },
        "dimension" : {
          "type" : "default",
          "dimension" : "dim1",
          "outputName" : "_d0",
          "outputType" : "STRING"
        },
        "metric" : {
          "type" : "numeric",
          "metric" : "a0"
        },
        "threshold" : 200,
        "intervals" : {
          "type" : "intervals",
          "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
        },
        "granularity" : {
          "type" : "all"
        },
        "aggregations" : [ {
          "type" : "count",
          "name" : "a0"
        } ],
        "context" : {
          "debug" : "true",
          "enableWindowing" : "true",
          "outputformat" : "MYSQL",
          "plannerStrategy" : "DECOUPLED",
          "sqlQueryId" : "82ec0abd-1c78-40c3-8510-96850b00a5a7",
          "sqlStringifyArrays" : false
        }
      }
    },
    "rightPrefix" : "j0.",
    "condition" : "notdistinctfrom(\"d0\",\"j0._d0\")",
    "joinType" : "LEFT"
  },
  "intervals" : {
    "type" : "LegacySegmentSpec",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "context" : {
    "debug" : "true",
    "enableWindowing" : "true",
    "outputformat" : "MYSQL",
    "plannerStrategy" : "DECOUPLED",
    "sqlQueryId" : "82ec0abd-1c78-40c3-8510-96850b00a5a7",
    "sqlStringifyArrays" : false
  },
  "outputSignature" : [ {
    "name" : "d0",
    "type" : "STRING"
  }, {
    "name" : "a0",
    "type" : "LONG"
  }, {
    "name" : "j0.a0",
    "type" : "LONG"
  }, {
    "name" : "w0",
    "type" : "LONG"
  } ],
  "operatorDefinition" : [ {
    "type" : "naiveSort",
    "columns" : [ {
      "column" : "d0",
      "direction" : "ASC"
    } ]
  }, {
    "type" : "naivePartition",
    "partitionColumns" : [ ]
  }, {
    "type" : "window",
    "processor" : {
      "type" : "framedAgg",
      "frame" : {
        "type" : "groups",
        "lowerOffset" : null,
        "upperOffset" : 0,
        "orderByColumns" : [ "d0" ]
      },
      "aggregations" : [ {
        "type" : "longSum",
        "name" : "w0",
        "fieldName" : "a0"
      } ]
    }
  } ],
  "leafOperators" : [ ],
  "granularity" : {
    "type" : "all"
  }
}
!nativePlan
# !ok
